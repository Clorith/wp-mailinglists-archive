From casey.bisson at gmail.com  Tue Oct  1 01:08:38 2013
From: casey.bisson at gmail.com (Casey Bisson)
Date: Mon, 30 Sep 2013 18:08:38 -0700
Subject: [wp-hackers] Improving performance for lots of comments
In-Reply-To: <CAEdQCeW1A_f14do2V-mtSiSxT2-HetRfif5RHkvGuLEdp1qsRg@mail.gmail.com>
References: <CAEdQCeW1A_f14do2V-mtSiSxT2-HetRfif5RHkvGuLEdp1qsRg@mail.gmail.com>
Message-ID: <7ED5115C-7762-42CB-B54C-597FDEFCB8E0@gmail.com>

Roger,

I've faced similar problems elsewhere. The solution I used at the time was to capture the comment markup and save it as meta on the post. In most cases the template would fetch the markup from the post meta rather than generating it fresh. 

Any time a comment was added or removed, etc, the cache was deleted and the list regenerated. 

The performance improvement for posts with hundreds or thousands of comments was ten to 20 seconds. 

Since then we've shifted to paged comments, though because of how the comment walker class works, we still suffer many of the performance affects related to iterating all the comments that we did previously. 

Another important aspect to consider is gravatars. 1000 gravatars can take many tens of seconds to load in the browser. Lazy loading those has a huge performance effect. 

--Casey Bisson

> On Sep 30, 2013, at 4:23 PM, Roger Chen <developer at rogerhub.com> wrote:
> 
> Hi all,
> 
> One of my WordPress pages has 2,000+ comments and when I visit it, it can
> take 5-6 seconds to load. Of course, this isn't a problem for visitors
> because a cached version gets served, but it is still annoying to have to
> wait that long for all of the comments to render. I don't want to break the
> comments into pages either, since all of those comments are a huge SEO
> boost.
> 
> I have removed cut down my comments template to the bare minimum, but the
> comment markup loop still takes too long. I wish there were some way for
> WordPress to automatically cache the markup for past comments so that every
> time a new comment is posted, it only needs to generate markup for new
> comments.
> 
> Does anyone have experience with something like this?
> 
> Roger
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From vid at zippykid.com  Tue Oct  1 04:55:19 2013
From: vid at zippykid.com (Vid Luther)
Date: Mon, 30 Sep 2013 23:55:19 -0500
Subject: [wp-hackers] Is it possible to hook into the wp_http API?
Message-ID: <CALNB6gY1nXCHMvoVHa+3fiVn5RutHTir2PZZ7LxcxoLon7hMRw@mail.gmail.com>

Hi,
 We seem to have an issue with our systems and SSL. And, I think I need to
sleep, so I'm asking a possibly silly question..

*The Problem*

The version of PHP we have, and the version of OpenSSL it's compiled with,
causes an issue with requests to some HTTPs servers. While I try and work
with the Ubuntu/Debian maintainers to fix this bug upstream.. or build our
own version of PHP which could take a few weeks to test..

https://bugs.launchpad.net/ubuntu/+source/openssl/+bug/861137

I was wondering if it's possible for us to put in an mu-plugin that hooks
into the wp_http API. In a local test, we've already verified that if we
add a line to the request method of WP_Http, specifically the line saying


 curl_setopt($handle, CURLOPT_SSLVERSION, 3);

Then the request works..

*The question*

Since this problem will probably be fixed on the distribution/PHP side when
the next LTS comes out, it doesn't make sense to send a patch against core
for this.

But, we need to let the customer make his request..so we need to tell the
WP HTTP api to use SSL v3 on purpose.

>From my understanding of Filters and Actions, a filter would be
inappropriate here.. but an action may work.. but I don't know/can't think
of what hook to attach this action to.

Any ideas?

From wordpress at dd32.id.au  Tue Oct  1 05:04:12 2013
From: wordpress at dd32.id.au (Dion Hulse (dd32))
Date: Tue, 1 Oct 2013 15:04:12 +1000
Subject: [wp-hackers] Is it possible to hook into the wp_http API?
In-Reply-To: <CALNB6gY1nXCHMvoVHa+3fiVn5RutHTir2PZZ7LxcxoLon7hMRw@mail.gmail.com>
References: <CALNB6gY1nXCHMvoVHa+3fiVn5RutHTir2PZZ7LxcxoLon7hMRw@mail.gmail.com>
Message-ID: <CAL4EHfkX8BNWvaooWO7yHqkHiwRxnS-g4W7DX4xiwVmS8gJ9gg@mail.gmail.com>

This should fix it for requests using the cURL transport, but some requests
might not:

add_action( 'http_api_curl', 'mysite_curl_ssl_v3' );
function mysite_curl_ssl_v3( $handle ) {
    curl_setopt($handle, CURLOPT_SSLVERSION, 3);
}

Can you please let us know what versions/distro's of PHP which you know is
affected by this? If you're affected, others will surely be affected, so
I'd like to get 3.7 to support, or, work around, the issue.

D


On 1 October 2013 14:55, Vid Luther <vid at zippykid.com> wrote:

> Hi,
>  We seem to have an issue with our systems and SSL. And, I think I need to
> sleep, so I'm asking a possibly silly question..
>
> *The Problem*
>
> The version of PHP we have, and the version of OpenSSL it's compiled with,
> causes an issue with requests to some HTTPs servers. While I try and work
> with the Ubuntu/Debian maintainers to fix this bug upstream.. or build our
> own version of PHP which could take a few weeks to test..
>
> https://bugs.launchpad.net/ubuntu/+source/openssl/+bug/861137
>
> I was wondering if it's possible for us to put in an mu-plugin that hooks
> into the wp_http API. In a local test, we've already verified that if we
> add a line to the request method of WP_Http, specifically the line saying
>
>
>  curl_setopt($handle, CURLOPT_SSLVERSION, 3);
>
> Then the request works..
>
> *The question*
>
> Since this problem will probably be fixed on the distribution/PHP side when
> the next LTS comes out, it doesn't make sense to send a patch against core
> for this.
>
> But, we need to let the customer make his request..so we need to tell the
> WP HTTP api to use SSL v3 on purpose.
>
> From my understanding of Filters and Actions, a filter would be
> inappropriate here.. but an action may work.. but I don't know/can't think
> of what hook to attach this action to.
>
> Any ideas?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From highfive at jesserfriedman.com  Tue Oct  1 13:07:27 2013
From: highfive at jesserfriedman.com (Jesse Friedman)
Date: Tue, 1 Oct 2013 09:07:27 -0400
Subject: [wp-hackers] Multisite global user setting reset
In-Reply-To: <CAEJabWjpg0JwhN1aexx6CpAQnFVNBCcHX8QUag3kSt3aCbiNZw@mail.gmail.com>
References: <CAGtTZ+bdgFJr00honT65n+XtdBJW=Aj8a-3rPDJqBBcPZtB8cA@mail.gmail.com>
 <CAOwx47e0PG0s+hMfMV_4rnGjVnYZL7SfdDDcoPeLD+cEg6+QRw@mail.gmail.com>
 <CAEJabWjpg0JwhN1aexx6CpAQnFVNBCcHX8QUag3kSt3aCbiNZw@mail.gmail.com>
Message-ID: <CAGtTZ+b9TrsGe5DRFyaK=pv6VZpRPz+0vggOXFPVSD+VdQTYag@mail.gmail.com>

Drew and Nikola

Thanks a lot!

Jesse


On Mon, Sep 30, 2013 at 6:00 PM, Drew <xoodrew at gmail.com> wrote:

> You can hook into the 'edit_posts_per_page' filter in
> class-wp-posts-list-table.php.
> It covers any/all pages (afaik) regardless of whether a post_type is
> passed.
>
> Something like this should work. It's set to max at 20, but allows fewer:
>
> /**
> >  * Force all the things to 20 max X per page.
> >  *
> >  * @param int    $per_page  The number of items to show per page.
> >  * @param string $post_type The post type.
> >  *
> >  * @return int Filtered number of items to show per page.
> >  */
> > function force_per_page( $per_page, $post_type ) {
> >     return $per_page >= 21 ? 20 : $per_page;
> > }
> > add_filter( 'edit_posts_per_page', 'force_per_page', 10, 2 );
> >
>
>
> On Mon, Sep 30, 2013 at 2:50 PM, Nikola Nikolov <nikolov.tmw at gmail.com
> >wrote:
>
> > The quickest thing I can think of is a mu-plugin, which would hook to one
> > of the query filters and would simply override the posts_per_page(in case
> > of users it would be different) query variable.
> >
> > Here is an example plugin that you can place straight into *
> > /wp-content/mu-plugins/override-counts.php* :
> >
> >
> > <?php
> > /*
> > Plugin Name: Override WP List Table limit preferences
> > */
> >
> >
> > // Override the posts per page variable
> > function my_ppp_query_overload( $vars ) {
> >     if ( is_admin() ) { // Only affect the admin queries
> >         $vars['posts_per_page'] = *20*;
> >     }
> >     return $vars;
> > }
> > add_filter( 'request', 'my_ppp_query_overload' );
> >
> > function my_users_number_query_overload( $query ) {
> >         if ( is_admin() ) { // Only affect the admin queries
> >                 global $wpdb;
> >                 $query->query_vars['number'] = *20*;
> >                 // limit
> >                 if ( isset( $query->query_vars['number'] ) &&
> > $query->query_vars['number'] ) {
> >                         if ( $query->query_vars['offset'] ) {
> >                                 $query->query_limit =
> > $wpdb->prepare("LIMIT %d, %d",
> > $query->query_vars['offset'], $query->query_vars['number']);
> >                         } else {
> >                                 $query->query_limit =
> > $wpdb->prepare("LIMIT %d",
> > $query->query_vars['number']);
> >                         }
> >                 }
> >         }
> > }
> > add_action( 'pre_user_query', 'my_users_number_query_overload', 10 );
> >
> > // The users list needs some extra help by overriding the user's
> > preference.
> > // Otherwise, the table would list only X users, but the pagination
> > would be incorrect.
> > function my_override_user_dashboard_settings() {
> >         if ( is_admin() && ( $uid = get_current_user_id() ) ) {
> >                 $user_settings = array( 'users_per_page',
> > 'site_users_network_per_page' );
> >                 update_user_option( $uid, 'users_per_page', *20* );
> >         }
> > }
> > add_action( 'init', 'my_override_user_dashboard_settings', 10 );
> >
> >
> > I have only tried this in a normal install, but I see no reason for it
> not
> > to work in a multisite install as well.
> >
> > You can adjust all "20" numbers to whatever you want your users to be
> > limited to. Note that for the post/pages/custom post types they will
> still
> > see their preferred number in the "Screen Options" panel, but for the
> Users
> > lists, they will actually see the number that you enter(and it will be
> > over-ridden on every request).
> >
> > That is because, when hooking to the "request" filter, the posts table
> > pagination adjusts automatically just fine, but the users pagination does
> > not.
> >
> > If that doesn't suite you well enough, it will be at least a pretty good
> > point to start at :)
> >
> > Hope that helps,
> > Nikola Nikolov
> >
> >
> > On Mon, Sep 30, 2013 at 11:01 PM, Jesse Friedman <me at jes.se.com> wrote:
> >
> > > We are experiencing a rather large load on our servers because we have
> > 500
> > > sites on a multisite network with a 100 plus users that are working all
> > day
> > > long.
> > >
> > > One thing I would like to do to limit the load on the server is to
> > globally
> > > control the number of posts, users, cpt's, comments, etc... that
> someone
> > > can display in their admin screen.
> > >
> > > Right now I'm sure many of my users have changed that number to show
> 50,
> > > 100 or more posts on any given screen.
> > >
> > > I would like to reset everything to display 20 items per page. Anyone
> > have
> > > an easy way to do this?
> > >
> > > --
> > > thanks
> > >
> > > *jesse friedman*
> > > jes.se.com *
> > > *
> > > Book: Web Designers Guide to WordPress -
> > > http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> > > Twitter: @professor <http://twitter.com/professor>
> > > Facebook: Like<
> > > https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
>
> ? I've kinda got a thing for WordPress >
> http://www.werdswords.com<http://www.drewapicture.com>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
thanks
*
*
*jesse friedman*
jes.se.com *
*
Book: Web Designers Guide to WordPress -
http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
Twitter: @professor <http://twitter.com/professor>
Facebook: Like<https://www.facebook.com/pages/Jesse-Friedman/204793299545174>

From tcbarrett at gmail.com  Wed Oct  2 10:16:47 2013
From: tcbarrett at gmail.com (Tom Barrett)
Date: Wed, 2 Oct 2013 11:16:47 +0100
Subject: [wp-hackers] Password protected page with SSL network and domain
	mapping
Message-ID: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>

I have a network with SSL login/admin. Password protected pages use
wp-login.php?action=postpass.

I can't get this to work at all on sites with mapped domains. At worst it
tries load https://customdomain.com/wp-login.php (which fails due to lack
of SSL on mapped domain). At best it loads the login page.

Anyone have any experience with this? Can point me in the right direction
for filters to nginx rewrite rules that I need to apply?

Thanks

-- 
http://www.tcbarrett.com | http://gplus.to/tcbarrett |
http://twitter.com/tcbarrett

From mailing at markoheijnen.nl  Wed Oct  2 11:54:33 2013
From: mailing at markoheijnen.nl (Marko Heijnen)
Date: Wed, 2 Oct 2013 13:54:33 +0200
Subject: [wp-hackers] Password protected page with SSL network and
	domain mapping
In-Reply-To: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>
References: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>
Message-ID: <E5D9636C-E839-4B1C-8B20-2A489FC45FAA@markoheijnen.nl>

At the moment I'm rewriting the domain mapping plugin and this is one of the things I play with.
I got the same situation but it quite a mess. Since the site url is without SSL and when you go there it should map to the admin/network url with https.

Marko


Op 2 okt. 2013, om 12:16 heeft Tom Barrett <tcbarrett at gmail.com> het volgende geschreven:

> I have a network with SSL login/admin. Password protected pages use
> wp-login.php?action=postpass.
> 
> I can't get this to work at all on sites with mapped domains. At worst it
> tries load https://customdomain.com/wp-login.php (which fails due to lack
> of SSL on mapped domain). At best it loads the login page.
> 
> Anyone have any experience with this? Can point me in the right direction
> for filters to nginx rewrite rules that I need to apply?
> 
> Thanks
> 
> -- 
> http://www.tcbarrett.com | http://gplus.to/tcbarrett |
> http://twitter.com/tcbarrett
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From tcbarrett at gmail.com  Wed Oct  2 14:20:16 2013
From: tcbarrett at gmail.com (Tom Barrett)
Date: Wed, 2 Oct 2013 15:20:16 +0100
Subject: [wp-hackers] Password protected page with SSL network and
	domain mapping
In-Reply-To: <E5D9636C-E839-4B1C-8B20-2A489FC45FAA@markoheijnen.nl>
References: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>
 <E5D9636C-E839-4B1C-8B20-2A489FC45FAA@markoheijnen.nl>
Message-ID: <CAEgmxabV2WNR+OGfPoc_djmsVM3SE8hSBn-MWa8k33cNNqVSNg@mail.gmail.com>

It would certainly be interesting to see an alternative.

I think the basic issue is that the domain mapping plugin filters
the_content with str_replace() to update all URLs. Irrespective of them
being admin (wp-admin/wp-login/admin-ajax) or not. I've not had the chance
to evaluate the cost of replacing it with something like preg_replace() (or
whether that will suffice).

Potentially a lot of variables/permutations to consider....


On 2 October 2013 12:54, Marko Heijnen <mailing at markoheijnen.nl> wrote:

> At the moment I'm rewriting the domain mapping plugin and this is one of
> the things I play with.
> I got the same situation but it quite a mess. Since the site url is
> without SSL and when you go there it should map to the admin/network url
> with https.
>
> Marko
>
>
> Op 2 okt. 2013, om 12:16 heeft Tom Barrett <tcbarrett at gmail.com> het
> volgende geschreven:
>
> > I have a network with SSL login/admin. Password protected pages use
> > wp-login.php?action=postpass.
> >
> > I can't get this to work at all on sites with mapped domains. At worst it
> > tries load https://customdomain.com/wp-login.php (which fails due to
> lack
> > of SSL on mapped domain). At best it loads the login page.
> >
> > Anyone have any experience with this? Can point me in the right direction
> > for filters to nginx rewrite rules that I need to apply?
> >
> > Thanks
> >
> > --
> > http://www.tcbarrett.com | http://gplus.to/tcbarrett |
> > http://twitter.com/tcbarrett
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
http://www.tcbarrett.com | http://gplus.to/tcbarrett |
http://twitter.com/tcbarrett

From highfive at jesserfriedman.com  Wed Oct  2 14:45:08 2013
From: highfive at jesserfriedman.com (Jesse Friedman)
Date: Wed, 2 Oct 2013 10:45:08 -0400
Subject: [wp-hackers] Password protected page with SSL network and
	domain mapping
In-Reply-To: <CAEgmxabV2WNR+OGfPoc_djmsVM3SE8hSBn-MWa8k33cNNqVSNg@mail.gmail.com>
References: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>
 <E5D9636C-E839-4B1C-8B20-2A489FC45FAA@markoheijnen.nl>
 <CAEgmxabV2WNR+OGfPoc_djmsVM3SE8hSBn-MWa8k33cNNqVSNg@mail.gmail.com>
Message-ID: <CAGtTZ+ZRR1=Z=CJQW--b-cyfskXkqAP9je4UtpAtUiwrFfR74A@mail.gmail.com>

The engineers at WP Engine offer this as a service so they've mastered it.
Maybe you can get with someone there and they'll share how they do it.


On Wed, Oct 2, 2013 at 10:20 AM, Tom Barrett <tcbarrett at gmail.com> wrote:

> It would certainly be interesting to see an alternative.
>
> I think the basic issue is that the domain mapping plugin filters
> the_content with str_replace() to update all URLs. Irrespective of them
> being admin (wp-admin/wp-login/admin-ajax) or not. I've not had the chance
> to evaluate the cost of replacing it with something like preg_replace() (or
> whether that will suffice).
>
> Potentially a lot of variables/permutations to consider....
>
>
> On 2 October 2013 12:54, Marko Heijnen <mailing at markoheijnen.nl> wrote:
>
> > At the moment I'm rewriting the domain mapping plugin and this is one of
> > the things I play with.
> > I got the same situation but it quite a mess. Since the site url is
> > without SSL and when you go there it should map to the admin/network url
> > with https.
> >
> > Marko
> >
> >
> > Op 2 okt. 2013, om 12:16 heeft Tom Barrett <tcbarrett at gmail.com> het
> > volgende geschreven:
> >
> > > I have a network with SSL login/admin. Password protected pages use
> > > wp-login.php?action=postpass.
> > >
> > > I can't get this to work at all on sites with mapped domains. At worst
> it
> > > tries load https://customdomain.com/wp-login.php (which fails due to
> > lack
> > > of SSL on mapped domain). At best it loads the login page.
> > >
> > > Anyone have any experience with this? Can point me in the right
> direction
> > > for filters to nginx rewrite rules that I need to apply?
> > >
> > > Thanks
> > >
> > > --
> > > http://www.tcbarrett.com | http://gplus.to/tcbarrett |
> > > http://twitter.com/tcbarrett
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> http://www.tcbarrett.com | http://gplus.to/tcbarrett |
> http://twitter.com/tcbarrett
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
thanks
*
*
*jesse friedman*
jes.se.com *
*
Book: Web Designers Guide to WordPress -
http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
Twitter: @professor <http://twitter.com/professor>
Facebook: Like<https://www.facebook.com/pages/Jesse-Friedman/204793299545174>

From tcbarrett at gmail.com  Thu Oct  3 11:17:40 2013
From: tcbarrett at gmail.com (Tom Barrett)
Date: Thu, 3 Oct 2013 12:17:40 +0100
Subject: [wp-hackers] Apostrophes and is_email() alternative
Message-ID: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>

I'm looking at an 'apostrophe in email' issue. The codex page for
is_email() says it is deprecated (but not what to use instead). Other
functions in core appear to use the function (eg: sanitize_option()).

Trying to add a user to a vanilla 3.6.1 install with an apostrophe in the
email fails.

What is the accepted method to check email validity (for use as WordPress
user accounts)?

Is there a good reason not to use FILTER_VALIDATE_EMAIL ?

Thanks.

-- 
http://www.tcbarrett.com | http://gplus.to/tcbarrett |
http://twitter.com/tcbarrett

From info at toscho.de  Thu Oct  3 11:24:23 2013
From: info at toscho.de (Thomas Scholz)
Date: Thu, 03 Oct 2013 13:24:23 +0200
Subject: [wp-hackers] Apostrophes and is_email() alternative
In-Reply-To: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
References: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
Message-ID: <op.w4dlyxi9r6yny2@fqdn.toscho.de>

> What is the accepted method to check email validity (for use as WordPress
> user accounts)?
>
> Is there a good reason not to use FILTER_VALIDATE_EMAIL ?

No, there is no good reason. You can extend the internal checker with  
filter_var().

See this plugin for an example:
https://gist.github.com/toscho/972837

Thomas

From jdg at codesymphony.co  Thu Oct  3 12:47:34 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 3 Oct 2013 08:47:34 -0400
Subject: [wp-hackers] Apostrophes and is_email() alternative
In-Reply-To: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
References: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
Message-ID: <04E60DC4-3959-4947-86B5-4CA41DC69E00@codesymphony.co>


On Oct 3, 2013, at 7:17 AM, Tom Barrett <tcbarrett at gmail.com> wrote:

> The codex page for
> is_email() says it is deprecated (but not what to use instead). Other
> functions in core appear to use the function (eg: sanitize_option()).

Right, it really isn't deprecated, just the second argument. I've updated the codex page to make this clear.

From tcbarrett at gmail.com  Thu Oct  3 14:42:05 2013
From: tcbarrett at gmail.com (Tom Barrett)
Date: Thu, 3 Oct 2013 15:42:05 +0100
Subject: [wp-hackers] Apostrophes and is_email() alternative
In-Reply-To: <04E60DC4-3959-4947-86B5-4CA41DC69E00@codesymphony.co>
References: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
 <04E60DC4-3959-4947-86B5-4CA41DC69E00@codesymphony.co>
Message-ID: <CAEgmxaYtRWYCpkRWQ8Sr=0e0BV+DXevGzwB8X3z6YQjoeefEcQ@mail.gmail.com>

Thanks JD! Much clearer.

Thanks Thomas, the gist needs a little tweaking as it doesn't work in it's
current state.

The next step in this lovely journey is that the $email var passed around
in the hooks has the apostrophe escaped. And back slashes are not valid.

This is fun :)

// Sent by Nexus
On 3 Oct 2013 13:47, "J.D. Grimes" <jdg at codesymphony.co> wrote:

>
> On Oct 3, 2013, at 7:17 AM, Tom Barrett <tcbarrett at gmail.com> wrote:
>
> > The codex page for
> > is_email() says it is deprecated (but not what to use instead). Other
> > functions in core appear to use the function (eg: sanitize_option()).
>
> Right, it really isn't deprecated, just the second argument. I've updated
> the codex page to make this clear.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From ian at iandunn.name  Thu Oct  3 17:26:10 2013
From: ian at iandunn.name (Ian Dunn)
Date: Thu, 03 Oct 2013 10:26:10 -0700
Subject: [wp-hackers] Apostrophes and is_email() alternative
In-Reply-To: <CAEgmxaYtRWYCpkRWQ8Sr=0e0BV+DXevGzwB8X3z6YQjoeefEcQ@mail.gmail.com>
References: <CAEgmxaaqVjx-c=nE0EtNB4dSV03C259w59u8uuUZndqcS9ohTw@mail.gmail.com>
 <04E60DC4-3959-4947-86B5-4CA41DC69E00@codesymphony.co>
 <CAEgmxaYtRWYCpkRWQ8Sr=0e0BV+DXevGzwB8X3z6YQjoeefEcQ@mail.gmail.com>
Message-ID: <524DA8B2.30405@iandunn.name>

FYI, there are some Core tickets around this (and related) issues:

http://core.trac.wordpress.org/ticket/16867
http://core.trac.wordpress.org/ticket/18658
http://core.trac.wordpress.org/ticket/18039


On 10/3/13 7:42 AM, Tom Barrett wrote:
> Thanks JD! Much clearer.
>
> Thanks Thomas, the gist needs a little tweaking as it doesn't work in it's
> current state.
>
> The next step in this lovely journey is that the $email var passed around
> in the hooks has the apostrophe escaped. And back slashes are not valid.
>
> This is fun :)
>
> // Sent by Nexus
> On 3 Oct 2013 13:47, "J.D. Grimes" <jdg at codesymphony.co> wrote:
>
>>
>> On Oct 3, 2013, at 7:17 AM, Tom Barrett <tcbarrett at gmail.com> wrote:
>>
>>> The codex page for
>>> is_email() says it is deprecated (but not what to use instead). Other
>>> functions in core appear to use the function (eg: sanitize_option()).
>>
>> Right, it really isn't deprecated, just the second argument. I've updated
>> the codex page to make this clear.


From tcbarrett at gmail.com  Thu Oct  3 18:51:35 2013
From: tcbarrett at gmail.com (Tom Barrett)
Date: Thu, 3 Oct 2013 19:51:35 +0100
Subject: [wp-hackers] Password protected page with SSL network and
	domain mapping
In-Reply-To: <CAGtTZ+ZRR1=Z=CJQW--b-cyfskXkqAP9je4UtpAtUiwrFfR74A@mail.gmail.com>
References: <CAEgmxaZ_YS5a7yuxx2A+Y6u90S2y+51vvnVqwic+M8H5H4sQgA@mail.gmail.com>
 <E5D9636C-E839-4B1C-8B20-2A489FC45FAA@markoheijnen.nl>
 <CAEgmxabV2WNR+OGfPoc_djmsVM3SE8hSBn-MWa8k33cNNqVSNg@mail.gmail.com>
 <CAGtTZ+ZRR1=Z=CJQW--b-cyfskXkqAP9je4UtpAtUiwrFfR74A@mail.gmail.com>
Message-ID: <CAEgmxaaX6DqMWycVyd9bKiacSyDLGUT=ATwfSNXQkNzBbvdpTw@mail.gmail.com>

At the moment I'm playing with this idea:
- Update the password form to poke the SSL admin URL using AJAX
- Add mapped domain to allowed origins
- Return the cookie settings
- Set the cookie in AJAX callback and refresh the screen

Obviously that doesn't have a non js fallback..

From lukebryan at sharefaith.com  Fri Oct  4 00:07:03 2013
From: lukebryan at sharefaith.com (Luke Bryan)
Date: Thu, 3 Oct 2013 17:07:03 -0700
Subject: [wp-hackers] Auto-upgrade questions
Message-ID: <CAFnKAk2UYbFAwDR3Uz15UFyJ8jxZx8qCP-H8+yH_cROieirVCw@mail.gmail.com>

Greetings all,

I was just going through the new auto-update codein class-wp-upgrader.php
(function perform_auto_updates), and it appears that all plugins will also
be updated automatically? Is this correct, or is this just for testing in
beta for now?

I also noticed in update.php in wp_schedule_update_checks() it is setting
the cron to twice-daily updates - is this the recommended setting, even
when there may be many blogs on the same server, that may get bogged down
if they all update at the same time?

Best regards.
Luke

From james at om4.com.au  Fri Oct  4 02:03:30 2013
From: james at om4.com.au (James Collins)
Date: Fri, 4 Oct 2013 12:03:30 +1000
Subject: [wp-hackers] Auto-upgrade questions
In-Reply-To: <CAFnKAk2UYbFAwDR3Uz15UFyJ8jxZx8qCP-H8+yH_cROieirVCw@mail.gmail.com>
References: <CAFnKAk2UYbFAwDR3Uz15UFyJ8jxZx8qCP-H8+yH_cROieirVCw@mail.gmail.com>
Message-ID: <CAPpsh_y8xX+W0ou83SUF8Fo8FGDc4CmdQ-CegV7sogn5RDHRkQ@mail.gmail.com>

Hi Luke,

This post should answer some of your questions:
http://make.wordpress.org/core/2013/09/24/automatic-core-updates/.

Plugin & theme updates are opt-in (currently via filters).

James



On 4 October 2013 10:07, Luke Bryan <lukebryan at sharefaith.com> wrote:

> Greetings all,
>
> I was just going through the new auto-update codein class-wp-upgrader.php
> (function perform_auto_updates), and it appears that all plugins will also
> be updated automatically? Is this correct, or is this just for testing in
> beta for now?
>
> I also noticed in update.php in wp_schedule_update_checks() it is setting
> the cron to twice-daily updates - is this the recommended setting, even
> when there may be many blogs on the same server, that may get bogged down
> if they all update at the same time?
>
> Best regards.
> Luke
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From ipstenu at ipstenu.org  Fri Oct  4 15:36:11 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Fri, 04 Oct 2013 08:36:11 -0700
Subject: [wp-hackers] Auto-upgrade questions
In-Reply-To: <CAPpsh_y8xX+W0ou83SUF8Fo8FGDc4CmdQ-CegV7sogn5RDHRkQ@mail.gmail.com>
References: <CAFnKAk2UYbFAwDR3Uz15UFyJ8jxZx8qCP-H8+yH_cROieirVCw@mail.gmail.com>
 <CAPpsh_y8xX+W0ou83SUF8Fo8FGDc4CmdQ-CegV7sogn5RDHRkQ@mail.gmail.com>
Message-ID: <524EE06B.1020008@ipstenu.org>

The Twice Daily is not explained there, but yes, it's okay. Right now, 
if you're on nightlies, you get it twice a day. This will be changed 
later, but right now pretend we're stress testing the system ;)

> James Collins <mailto:james at om4.com.au>
> October 3, 2013 7:03 PM
> Hi Luke,
>
> This post should answer some of your questions:
> http://make.wordpress.org/core/2013/09/24/automatic-core-updates/.
>
> Plugin & theme updates are opt-in (currently via filters).
>
> James
>
>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
> Luke Bryan <mailto:lukebryan at sharefaith.com>
> October 3, 2013 5:07 PM
> Greetings all,
>
> I was just going through the new auto-update codein class-wp-upgrader.php
> (function perform_auto_updates), and it appears that all plugins will also
> be updated automatically? Is this correct, or is this just for testing in
> beta for now?
>
> I also noticed in update.php in wp_schedule_update_checks() it is setting
> the cron to twice-daily updates - is this the recommended setting, even
> when there may be many blogs on the same server, that may get bogged down
> if they all update at the same time?
>
> Best regards.
> Luke
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

-- 
Mika A Epstein (aka Ipstenu)
http://ipstenu.org | http://halfelf.org


From lukebryan at sharefaith.com  Fri Oct  4 19:21:56 2013
From: lukebryan at sharefaith.com (Luke Bryan)
Date: Fri, 4 Oct 2013 12:21:56 -0700
Subject: [wp-hackers] WP 3.7 auto-update
Message-ID: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>

Greetings all,

I have a couple questions about the new auto-update feature: I was just
notified by email:
"Updating to WordPress 3.7-beta1-25639-20131003"

However It seems only 5 files in wp-includes have a modification date of
today. Is this normal?

I was also wondering if it could tell you what site had updated in the
email? Looks like another testing site was not getting the update, probably
because it was using autoFTP to modify files. It would be great to see what
site was updated.

Best regards,
Luke

From steve at sltaylor.co.uk  Sat Oct  5 16:20:40 2013
From: steve at sltaylor.co.uk (Steve Taylor)
Date: Sat, 5 Oct 2013 17:20:40 +0100
Subject: [wp-hackers] 3.7 auto-updates and remote management services
Message-ID: <CAGEuVU1V4U95oquW6zPj5E99OcSs_ndLY23RZZyXgdX0jOL1+Q@mail.gmail.com>

Hi,

I'm just finding time to look into remote management services like
ManageWP. I know, late to the party. But I dunno, is that a good thing
perhaps, what with 3.7 auto-updates?

I've read the Make WordPress Core post on auto-updates, and as far as
I can tell this could render that aspect of remote management
redundant. Any thoughts from people familiar with remote management
and the new 3.7 features?

I know ManageWP has a load of other great features, so I don't see
total redundancy. But I imagine the task of weighing options up is
changing radically with 3.7... ?

Cheers,

Steve Taylor

From greglancaster71 at gmail.com  Sat Oct  5 23:22:35 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sat, 5 Oct 2013 16:22:35 -0700 (PDT)
Subject: [wp-hackers] getting user_id in buddypress profile page
Message-ID: <1381015355092-42444.post@n5.nabble.com>

This is likely very simple, but I am having an issue with it.

I am using 

<?php 
	global $wpdb, $userdata, $current_user;
	$current_user = wp_get_current_user();
	$userid = $current_user->ID;
?>


I can echo out $userid and it shows the correct user ID, but when I put it
into the form submit;

$wpdb->insert(wp_jo_plugin_options, array (
		'user_id' => $userid,
		'length'  => $_POST['length'],
		'girth'  => $_POST['girth'],
		'date'    => $_POST['date'],

it just posts a 0 to the database.  Am I doing something wrong here?  It
seems very straight forward, never had an issue with such a simple task. 
But trying to add this code to buddypress is a real hassle. 




--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/getting-user-id-in-buddypress-profile-page-tp42444.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From hendronix at gmail.com  Sun Oct  6 03:05:39 2013
From: hendronix at gmail.com (Eric Hendrix)
Date: Sat, 5 Oct 2013 23:05:39 -0400
Subject: [wp-hackers] getting user_id in buddypress profile page
In-Reply-To: <1381015355092-42444.post@n5.nabble.com>
References: <1381015355092-42444.post@n5.nabble.com>
Message-ID: <CAAkktv3o-jBKoFG-OsAKfS78Ruv5d=HAGxvTSfCJuNB7cDFeHg@mail.gmail.com>

Shouldn't you be using double quotes around your vars (associative array
syntax)?


On Sat, Oct 5, 2013 at 7:22 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> This is likely very simple, but I am having an issue with it.
>
> I am using
>
> <?php
>         global $wpdb, $userdata, $current_user;
>         $current_user = wp_get_current_user();
>         $userid = $current_user->ID;
> ?>
>
>
> I can echo out $userid and it shows the correct user ID, but when I put it
> into the form submit;
>
> $wpdb->insert(wp_jo_plugin_options, array (
>                 'user_id' => $userid,
>                 'length'  => $_POST['length'],
>                 'girth'  => $_POST['girth'],
>                 'date'    => $_POST['date'],
>
> it just posts a 0 to the database.  Am I doing something wrong here?  It
> seems very straight forward, never had an issue with such a simple task.
> But trying to add this code to buddypress is a real hassle.
>
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/getting-user-id-in-buddypress-profile-page-tp42444.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
*Eric A. Hendrix*
hendronix at gmail.com
(910) 644-8940

*"Non Timebo Mala"*

From greglancaster71 at gmail.com  Sun Oct  6 09:15:00 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sun, 6 Oct 2013 02:15:00 -0700 (PDT)
Subject: [wp-hackers] adding custom fields to a comment form
Message-ID: <1381050900918-42446.post@n5.nabble.com>

I would like to add custom fields to a comment form - but only for a custom
post type.  I have searched online for the last hour for a tutorial
explaining how to just add basic custom fields to a comment form and haven't
had any luck.  Most if not all of it is outdated.   

Would someone point me to a good tutorial, or if someone has already coded
something like this and doesnt mind sharing?  Just being able to look at how
to properly hook into comment functions would help a lot. 



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-comment-form-tp42446.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From ljunior2005 at gmail.com  Sun Oct  6 18:33:16 2013
From: ljunior2005 at gmail.com (Leo Baiano)
Date: Sun, 6 Oct 2013 15:33:16 -0300
Subject: [wp-hackers] You can view the amount of posts, a CPT, the menu?
Message-ID: <CAL1O-KXzNsJWa=s+=3iA575ZXTYOA+4B3STGqAar1HS9QnK9DQ@mail.gmail.com>

You can view the amount of posts, a CPT, the menu? Equal to the amount of
plugins that need updating and the amount of reviews that are shown next to
their respective menus inside a black ball.

-- 
Amplexos,

Leo Baiano
Web Developer

From jdg at codesymphony.co  Sun Oct  6 20:24:28 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sun, 6 Oct 2013 16:24:28 -0400
Subject: [wp-hackers] getting user_id in buddypress profile page
In-Reply-To: <1381015355092-42444.post@n5.nabble.com>
References: <1381015355092-42444.post@n5.nabble.com>
Message-ID: <0618D68E-9D91-4692-8EB9-2724AFB0E19D@codesymphony.co>

I don't see anything wrong with that. Try changing it to 

'user_id' => get_current_user_id(),

Are you sure that $userid is being set above your insert code?

-J.D.

On Oct 5, 2013, at 7:22 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> This is likely very simple, but I am having an issue with it.
> 
> I am using 
> 
> <?php 
> 	global $wpdb, $userdata, $current_user;
> 	$current_user = wp_get_current_user();
> 	$userid = $current_user->ID;
> ?>
> 
> 
> I can echo out $userid and it shows the correct user ID, but when I put it
> into the form submit;
> 
> $wpdb->insert(wp_jo_plugin_options, array (
> 		'user_id' => $userid,
> 		'length'  => $_POST['length'],
> 		'girth'  => $_POST['girth'],
> 		'date'    => $_POST['date'],
> 
> it just posts a 0 to the database.  Am I doing something wrong here?  It
> seems very straight forward, never had an issue with such a simple task. 
> But trying to add this code to buddypress is a real hassle. 
> 
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/getting-user-id-in-buddypress-profile-page-tp42444.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From m.websoft at gmail.com  Sun Oct  6 20:31:47 2013
From: m.websoft at gmail.com (mohammad aghanabi)
Date: Mon, 7 Oct 2013 00:01:47 +0330
Subject: [wp-hackers] getting user_id in buddypress profile page
In-Reply-To: <0618D68E-9D91-4692-8EB9-2724AFB0E19D@codesymphony.co>
References: <1381015355092-42444.post@n5.nabble.com>
 <0618D68E-9D91-4692-8EB9-2724AFB0E19D@codesymphony.co>
Message-ID: <CAB3o1XPEZCNvCU02N4OX9pRTuwtUz3ec=bmdyMrR+C0SiA10og@mail.gmail.com>

Please vardump the $userid variable. also try to use bp_displayed_user_id()
for getting user id in a profile.


On Sun, Oct 6, 2013 at 11:54 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> I don't see anything wrong with that. Try changing it to
>
> 'user_id' => get_current_user_id(),
>
> Are you sure that $userid is being set above your insert code?
>
> -J.D.
>
> On Oct 5, 2013, at 7:22 PM, BenderisGreat <greglancaster71 at gmail.com>
> wrote:
>
> > This is likely very simple, but I am having an issue with it.
> >
> > I am using
> >
> > <?php
> >       global $wpdb, $userdata, $current_user;
> >       $current_user = wp_get_current_user();
> >       $userid = $current_user->ID;
> > ?>
> >
> >
> > I can echo out $userid and it shows the correct user ID, but when I put
> it
> > into the form submit;
> >
> > $wpdb->insert(wp_jo_plugin_options, array (
> >               'user_id' => $userid,
> >               'length'  => $_POST['length'],
> >               'girth'  => $_POST['girth'],
> >               'date'    => $_POST['date'],
> >
> > it just posts a 0 to the database.  Am I doing something wrong here?  It
> > seems very straight forward, never had an issue with such a simple task.
> > But trying to add this code to buddypress is a real hassle.
> >
> >
> >
> >
> > --
> > View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/getting-user-id-in-buddypress-profile-page-tp42444.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Sun Oct  6 21:01:13 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sun, 6 Oct 2013 17:01:13 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <1381050900918-42446.post@n5.nabble.com>
References: <1381050900918-42446.post@n5.nabble.com>
Message-ID: <8171407E-6378-4E7A-A4EB-050D24058D43@codesymphony.co>

I'm sure you've already seen this: http://wp.smashingmagazine.com/2012/05/08/adding-custom-fields-in-wordpress-comment-form/

On Oct 6, 2013, at 5:15 AM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> I would like to add custom fields to a comment form - but only for a custom
> post type.  I have searched online for the last hour for a tutorial
> explaining how to just add basic custom fields to a comment form and haven't
> had any luck.  Most if not all of it is outdated.   
> 
> Would someone point me to a good tutorial, or if someone has already coded
> something like this and doesnt mind sharing?  Just being able to look at how
> to properly hook into comment functions would help a lot. 
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-comment-form-tp42446.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From abdussamad at abdussamad.com  Sun Oct  6 23:19:59 2013
From: abdussamad at abdussamad.com (Abdussamad Abdurrazzaq)
Date: Mon, 07 Oct 2013 04:19:59 +0500
Subject: [wp-hackers] getting user_id in buddypress profile page
In-Reply-To: <1381015355092-42444.post@n5.nabble.com>
References: <1381015355092-42444.post@n5.nabble.com>
Message-ID: <5251F01F.5060502@abdussamad.com>

In the below code the first argument has to be a string so you should 
put the table name in quotes. Also use $wpdb->prefix to refer to the 
table prefix instead of "wp_" because this is something that can be 
changed when installing wordpress and varies in multi site installs.

$wpdb->insert(wp_jo_plugin_options, array (
						 		'user_id' => $userid,
						 		'length'  => $_POST['length'],
						 		'girth'  => $_POST['girth'],
						 		'date'    => $_POST['date'],
							)
		);

If you want to use the global variable $current_user why call 
wp_get_current_user again?

Finally there is this:

  "Use the init or any subsequent action to call this function. Calling 
it outside of an action can lead to troubles. See #14024 for details. "

http://codex.wordpress.org/Function_Reference/wp_get_current_user

On 10/06/2013 04:22 AM, BenderisGreat wrote:
> This is likely very simple, but I am having an issue with it.
>
> I am using
>
> <?php
> 	global $wpdb, $userdata, $current_user;
> 	$current_user = wp_get_current_user();
> 	$userid = $current_user->ID;
> ?>
>
>
> I can echo out $userid and it shows the correct user ID, but when I put it
> into the form submit;
>
> $wpdb->insert(wp_jo_plugin_options, array (
> 		'user_id' => $userid,
> 		'length'  => $_POST['length'],
> 		'girth'  => $_POST['girth'],
> 		'date'    => $_POST['date'],
>
> it just posts a 0 to the database.  Am I doing something wrong here?  It
> seems very straight forward, never had an issue with such a simple task.
> But trying to add this code to buddypress is a real hassle.
>
>
>
>
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/getting-user-id-in-buddypress-profile-page-tp42444.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From developer at rogerhub.com  Mon Oct  7 00:11:49 2013
From: developer at rogerhub.com (Roger Chen)
Date: Sun, 6 Oct 2013 17:11:49 -0700
Subject: [wp-hackers] Improving performance for lots of comments
In-Reply-To: <7ED5115C-7762-42CB-B54C-597FDEFCB8E0@gmail.com>
References: <CAEdQCeW1A_f14do2V-mtSiSxT2-HetRfif5RHkvGuLEdp1qsRg@mail.gmail.com>
 <7ED5115C-7762-42CB-B54C-597FDEFCB8E0@gmail.com>
Message-ID: <CAEdQCeWE6fD_9q9zvLdKkQ9Fznno0DAUr1dokmCHmz1yUaBPtA@mail.gmail.com>

Thanks Casey, your tips helped a lot.

I settled on storing the comment markup in APC via the WP Transients API
for all comments past the first hundred. Each comment was keyed
individually, since I had surrounding markup based on the comment's
location as well. Response times have gone from ~5500ms to ~1000ms for
logged-in users.

Roger


On Mon, Sep 30, 2013 at 6:08 PM, Casey Bisson <casey.bisson at gmail.com>wrote:

> Roger,
>
> I've faced similar problems elsewhere. The solution I used at the time was
> to capture the comment markup and save it as meta on the post. In most
> cases the template would fetch the markup from the post meta rather than
> generating it fresh.
>
> Any time a comment was added or removed, etc, the cache was deleted and
> the list regenerated.
>
> The performance improvement for posts with hundreds or thousands of
> comments was ten to 20 seconds.
>
> Since then we've shifted to paged comments, though because of how the
> comment walker class works, we still suffer many of the performance affects
> related to iterating all the comments that we did previously.
>
> Another important aspect to consider is gravatars. 1000 gravatars can take
> many tens of seconds to load in the browser. Lazy loading those has a huge
> performance effect.
>
> --Casey Bisson
>
> > On Sep 30, 2013, at 4:23 PM, Roger Chen <developer at rogerhub.com> wrote:
> >
> > Hi all,
> >
> > One of my WordPress pages has 2,000+ comments and when I visit it, it can
> > take 5-6 seconds to load. Of course, this isn't a problem for visitors
> > because a cached version gets served, but it is still annoying to have to
> > wait that long for all of the comments to render. I don't want to break
> the
> > comments into pages either, since all of those comments are a huge SEO
> > boost.
> >
> > I have removed cut down my comments template to the bare minimum, but the
> > comment markup loop still takes too long. I wish there were some way for
> > WordPress to automatically cache the markup for past comments so that
> every
> > time a new comment is posted, it only needs to generate markup for new
> > comments.
> >
> > Does anyone have experience with something like this?
> >
> > Roger
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct  7 18:45:04 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Mon, 7 Oct 2013 11:45:04 -0700 (PDT)
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <8171407E-6378-4E7A-A4EB-050D24058D43@codesymphony.co>
References: <1381050900918-42446.post@n5.nabble.com>
 <8171407E-6378-4E7A-A4EB-050D24058D43@codesymphony.co>
Message-ID: <1381171504988-42453.post@n5.nabble.com>

I did see that, but I need to add the custom comment fields only to the
custom post type



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-comment-form-tp42446p42453.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From chris at lod.com  Mon Oct  7 18:50:33 2013
From: chris at lod.com (Chris McCoy)
Date: Mon, 07 Oct 2013 14:50:33 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <1381171504988-42453.post@n5.nabble.com>
Message-ID: <CE787A8E.3E33%chris@lod.com>

I would check for the post type, if its the one you wish to add to do the
process like in the tutorial, so it only shows on the comment form for the
post type.



On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com> wrote:

>I did see that, but I need to add the custom comment fields only to the
>custom post type
>
>
>
>--
>View this message in context:
>http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>omment-form-tp42446p42453.html
>Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>_______________________________________________
>wp-hackers mailing list
>wp-hackers at lists.automattic.com
>http://lists.automattic.com/mailman/listinfo/wp-hackers



From greglancaster71 at gmail.com  Mon Oct  7 18:54:09 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 11:54:09 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <CE787A8E.3E33%chris@lod.com>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
Message-ID: <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>

I was going to (i am tryign to code the plugin I emailed you about myself
today, I have all day :)  )  but the is_post_type was depreciated.  Not
sure what to use now.


On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:

> I would check for the post type, if its the one you wish to add to do the
> process like in the tutorial, so it only shows on the comment form for the
> post type.
>
>
>
> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com> wrote:
>
> >I did see that, but I need to add the custom comment fields only to the
> >custom post type
> >
> >
> >
> >--
> >View this message in context:
> >
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >omment-form-tp42446p42453.html
> >Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >_______________________________________________
> >wp-hackers mailing list
> >wp-hackers at lists.automattic.com
> >http://lists.automattic.com/mailman/listinfo/wp-hackers
>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct  7 18:54:47 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 14:54:47 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <1381171504988-42453.post@n5.nabble.com>
References: <1381050900918-42446.post@n5.nabble.com>
 <8171407E-6378-4E7A-A4EB-050D24058D43@codesymphony.co>
 <1381171504988-42453.post@n5.nabble.com>
Message-ID: <A3CA9DE0-A0D3-43C4-BAD4-A59F651BDC97@codesymphony.co>

Find the post type with get_post_type() - http://codex.wordpress.org/Function_Reference/get_post_type

If it's the wrong post type, don't display/save the fields.


On Oct 7, 2013, at 2:45 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> I did see that, but I need to add the custom comment fields only to the
> custom post type
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-comment-form-tp42446p42453.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jdg at codesymphony.co  Mon Oct  7 18:57:49 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 14:57:49 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
Message-ID: <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>

I tried to send a reply to that earlier, but I don't think it went through - I just resent it now, let me know if you get it.

On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I was going to (i am tryign to code the plugin I emailed you about myself
> today, I have all day :)  )  but the is_post_type was depreciated.  Not
> sure what to use now.
> 
> 
> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> 
>> I would check for the post type, if its the one you wish to add to do the
>> process like in the tutorial, so it only shows on the comment form for the
>> post type.
>> 
>> 
>> 
>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com> wrote:
>> 
>>> I did see that, but I need to add the custom comment fields only to the
>>> custom post type
>>> 
>>> 
>>> 
>>> --
>>> View this message in context:
>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>>> omment-form-tp42446p42453.html
>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct  7 19:01:11 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 12:01:11 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
Message-ID: <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>

I got it :)

I followed the smashing guide, and no fields showed up.  So I tried just
copy pasting their example code and that didnt work either.   Is there
something wrong with this code I used here:

function add_comment_fields($fields) {

    $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
'Age' ) . '</label>' .
        '<input id="age" name="age" type="text" size="30" /></p>';
    return $fields;

}
add_filter('comment_form_default_fields','add_comment_fields');

function add_comment_meta_values($comment_id) {

    if(isset($_POST['age'])) {
        $age = wp_filter_nohtml_kses($_POST['age']);
        add_comment_meta($comment_id, 'age', $age, false);
    }

}
add_action ('comment_post', 'add_comment_meta_values', 1);


On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> I tried to send a reply to that earlier, but I don't think it went through
> - I just resent it now, let me know if you get it.
>
> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > I was going to (i am tryign to code the plugin I emailed you about myself
> > today, I have all day :)  )  but the is_post_type was depreciated.  Not
> > sure what to use now.
> >
> >
> > On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> >
> >> I would check for the post type, if its the one you wish to add to do
> the
> >> process like in the tutorial, so it only shows on the comment form for
> the
> >> post type.
> >>
> >>
> >>
> >> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
> wrote:
> >>
> >>> I did see that, but I need to add the custom comment fields only to the
> >>> custom post type
> >>>
> >>>
> >>>
> >>> --
> >>> View this message in context:
> >>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >>> omment-form-tp42446p42453.html
> >>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct  7 19:13:06 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 15:13:06 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
Message-ID: <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>

No, there's nothing wrong with that code. Actually, it works, but this:
> // Default comment form elements are hidden when user is logged in
So, if you want them to show even when the user is logged in, you will have to use a different hook. I don't know any off of the top of my head...

On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I got it :)
> 
> I followed the smashing guide, and no fields showed up.  So I tried just
> copy pasting their example code and that didnt work either.   Is there
> something wrong with this code I used here:
> 
> function add_comment_fields($fields) {
> 
>    $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
> 'Age' ) . '</label>' .
>        '<input id="age" name="age" type="text" size="30" /></p>';
>    return $fields;
> 
> }
> add_filter('comment_form_default_fields','add_comment_fields');
> 
> function add_comment_meta_values($comment_id) {
> 
>    if(isset($_POST['age'])) {
>        $age = wp_filter_nohtml_kses($_POST['age']);
>        add_comment_meta($comment_id, 'age', $age, false);
>    }
> 
> }
> add_action ('comment_post', 'add_comment_meta_values', 1);
> 
> 
> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> I tried to send a reply to that earlier, but I don't think it went through
>> - I just resent it now, let me know if you get it.
>> 
>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> I was going to (i am tryign to code the plugin I emailed you about myself
>>> today, I have all day :)  )  but the is_post_type was depreciated.  Not
>>> sure what to use now.
>>> 
>>> 
>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
>>> 
>>>> I would check for the post type, if its the one you wish to add to do
>> the
>>>> process like in the tutorial, so it only shows on the comment form for
>> the
>>>> post type.
>>>> 
>>>> 
>>>> 
>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
>> wrote:
>>>> 
>>>>> I did see that, but I need to add the custom comment fields only to the
>>>>> custom post type
>>>>> 
>>>>> 
>>>>> 
>>>>> --
>>>>> View this message in context:
>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>>>>> omment-form-tp42446p42453.html
>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jdg at codesymphony.co  Mon Oct  7 19:26:32 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 15:26:32 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
Message-ID: <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>

Ah, found an action hook you can use to display the field: comment_form_logged_in_after

So:

function add_comment_fields( $fields ) {

	?>

	<p class="comment-form-age">
		<label for="age"><?php _e( 'Age' ); ?></label>
		<input id="age" name="age" type="text" size="30" />
	</p>

   <?php
}
add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );


That will display to logged in users only. Just echo out the form input. The saving should work the same as before, I think.

On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:

> No, there's nothing wrong with that code. Actually, it works, but this:
>> // Default comment form elements are hidden when user is logged in
> So, if you want them to show even when the user is logged in, you will have to use a different hook. I don't know any off of the top of my head...
> 
> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:
> 
>> I got it :)
>> 
>> I followed the smashing guide, and no fields showed up.  So I tried just
>> copy pasting their example code and that didnt work either.   Is there
>> something wrong with this code I used here:
>> 
>> function add_comment_fields($fields) {
>> 
>>   $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
>> 'Age' ) . '</label>' .
>>       '<input id="age" name="age" type="text" size="30" /></p>';
>>   return $fields;
>> 
>> }
>> add_filter('comment_form_default_fields','add_comment_fields');
>> 
>> function add_comment_meta_values($comment_id) {
>> 
>>   if(isset($_POST['age'])) {
>>       $age = wp_filter_nohtml_kses($_POST['age']);
>>       add_comment_meta($comment_id, 'age', $age, false);
>>   }
>> 
>> }
>> add_action ('comment_post', 'add_comment_meta_values', 1);
>> 
>> 
>> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
>> 
>>> I tried to send a reply to that earlier, but I don't think it went through
>>> - I just resent it now, let me know if you get it.
>>> 
>>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>>> wrote:
>>> 
>>>> I was going to (i am tryign to code the plugin I emailed you about myself
>>>> today, I have all day :)  )  but the is_post_type was depreciated.  Not
>>>> sure what to use now.
>>>> 
>>>> 
>>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
>>>> 
>>>>> I would check for the post type, if its the one you wish to add to do
>>> the
>>>>> process like in the tutorial, so it only shows on the comment form for
>>> the
>>>>> post type.
>>>>> 
>>>>> 
>>>>> 
>>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
>>> wrote:
>>>>> 
>>>>>> I did see that, but I need to add the custom comment fields only to the
>>>>>> custom post type
>>>>>> 
>>>>>> 
>>>>>> 
>>>>>> --
>>>>>> View this message in context:
>>>>>> 
>>>>> 
>>> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>>>>>> omment-form-tp42446p42453.html
>>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>> 
>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct  7 19:35:09 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 12:35:09 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
Message-ID: <CAPN-N+bqTZcnODpq8mmw=2aUpmET+f3hc-mHJ+RNorwm776D_g@mail.gmail.com>

No something isnt right here.  Even if I drop that code in functions.php no
extra field is showing. Maybe its because I use roots framework theme.  Not
sure gonna try the code on a different theme now.


On Mon, Oct 7, 2013 at 12:13 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> No, there's nothing wrong with that code. Actually, it works, but this:
> > // Default comment form elements are hidden when user is logged in
> So, if you want them to show even when the user is logged in, you will
> have to use a different hook. I don't know any off of the top of my head...
>
> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > I got it :)
> >
> > I followed the smashing guide, and no fields showed up.  So I tried just
> > copy pasting their example code and that didnt work either.   Is there
> > something wrong with this code I used here:
> >
> > function add_comment_fields($fields) {
> >
> >    $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
> > 'Age' ) . '</label>' .
> >        '<input id="age" name="age" type="text" size="30" /></p>';
> >    return $fields;
> >
> > }
> > add_filter('comment_form_default_fields','add_comment_fields');
> >
> > function add_comment_meta_values($comment_id) {
> >
> >    if(isset($_POST['age'])) {
> >        $age = wp_filter_nohtml_kses($_POST['age']);
> >        add_comment_meta($comment_id, 'age', $age, false);
> >    }
> >
> > }
> > add_action ('comment_post', 'add_comment_meta_values', 1);
> >
> >
> > On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> I tried to send a reply to that earlier, but I don't think it went
> through
> >> - I just resent it now, let me know if you get it.
> >>
> >> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> I was going to (i am tryign to code the plugin I emailed you about
> myself
> >>> today, I have all day :)  )  but the is_post_type was depreciated.  Not
> >>> sure what to use now.
> >>>
> >>>
> >>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> >>>
> >>>> I would check for the post type, if its the one you wish to add to do
> >> the
> >>>> process like in the tutorial, so it only shows on the comment form for
> >> the
> >>>> post type.
> >>>>
> >>>>
> >>>>
> >>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
> >> wrote:
> >>>>
> >>>>> I did see that, but I need to add the custom comment fields only to
> the
> >>>>> custom post type
> >>>>>
> >>>>>
> >>>>>
> >>>>> --
> >>>>> View this message in context:
> >>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >>>>> omment-form-tp42446p42453.html
> >>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct  7 19:53:25 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 12:53:25 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
 <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
Message-ID: <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>

awesome! Thats exactly what I needed.  Apparently with this framework the
comments.php isnt affected by the add_comment_fields, I have to add it
manually.  Since thats the case, I can skip the function right?


On Mon, Oct 7, 2013 at 12:26 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Ah, found an action hook you can use to display the field:
> comment_form_logged_in_after
>
> So:
>
> function add_comment_fields( $fields ) {
>
>         ?>
>
>         <p class="comment-form-age">
>                 <label for="age"><?php _e( 'Age' ); ?></label>
>                 <input id="age" name="age" type="text" size="30" />
>         </p>
>
>    <?php
> }
> add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );
>
>
> That will display to logged in users only. Just echo out the form input.
> The saving should work the same as before, I think.
>
> On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:
>
> > No, there's nothing wrong with that code. Actually, it works, but this:
> >> // Default comment form elements are hidden when user is logged in
> > So, if you want them to show even when the user is logged in, you will
> have to use a different hook. I don't know any off of the top of my head...
> >
> > On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
> >
> >> I got it :)
> >>
> >> I followed the smashing guide, and no fields showed up.  So I tried just
> >> copy pasting their example code and that didnt work either.   Is there
> >> something wrong with this code I used here:
> >>
> >> function add_comment_fields($fields) {
> >>
> >>   $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
> >> 'Age' ) . '</label>' .
> >>       '<input id="age" name="age" type="text" size="30" /></p>';
> >>   return $fields;
> >>
> >> }
> >> add_filter('comment_form_default_fields','add_comment_fields');
> >>
> >> function add_comment_meta_values($comment_id) {
> >>
> >>   if(isset($_POST['age'])) {
> >>       $age = wp_filter_nohtml_kses($_POST['age']);
> >>       add_comment_meta($comment_id, 'age', $age, false);
> >>   }
> >>
> >> }
> >> add_action ('comment_post', 'add_comment_meta_values', 1);
> >>
> >>
> >> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >>
> >>> I tried to send a reply to that earlier, but I don't think it went
> through
> >>> - I just resent it now, let me know if you get it.
> >>>
> >>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >>> wrote:
> >>>
> >>>> I was going to (i am tryign to code the plugin I emailed you about
> myself
> >>>> today, I have all day :)  )  but the is_post_type was depreciated.
>  Not
> >>>> sure what to use now.
> >>>>
> >>>>
> >>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> >>>>
> >>>>> I would check for the post type, if its the one you wish to add to do
> >>> the
> >>>>> process like in the tutorial, so it only shows on the comment form
> for
> >>> the
> >>>>> post type.
> >>>>>
> >>>>>
> >>>>>
> >>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
> >>> wrote:
> >>>>>
> >>>>>> I did see that, but I need to add the custom comment fields only to
> the
> >>>>>> custom post type
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> --
> >>>>>> View this message in context:
> >>>>>>
> >>>>>
> >>>
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >>>>>> omment-form-tp42446p42453.html
> >>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct  7 19:59:05 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 15:59:05 -0400
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
 <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
 <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>
Message-ID: <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>

Yes. That means it must be using its own version of the comment_form() function. Maybe it has similar hooks? 

On Oct 7, 2013, at 3:53 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> awesome! Thats exactly what I needed.  Apparently with this framework the
> comments.php isnt affected by the add_comment_fields, I have to add it
> manually.  Since thats the case, I can skip the function right?
> 
> 
> On Mon, Oct 7, 2013 at 12:26 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Ah, found an action hook you can use to display the field:
>> comment_form_logged_in_after
>> 
>> So:
>> 
>> function add_comment_fields( $fields ) {
>> 
>>        ?>
>> 
>>        <p class="comment-form-age">
>>                <label for="age"><?php _e( 'Age' ); ?></label>
>>                <input id="age" name="age" type="text" size="30" />
>>        </p>
>> 
>>   <?php
>> }
>> add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );
>> 
>> 
>> That will display to logged in users only. Just echo out the form input.
>> The saving should work the same as before, I think.
>> 
>> On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:
>> 
>>> No, there's nothing wrong with that code. Actually, it works, but this:
>>>> // Default comment form elements are hidden when user is logged in
>>> So, if you want them to show even when the user is logged in, you will
>> have to use a different hook. I don't know any off of the top of my head...
>>> 
>>> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>>> 
>>>> I got it :)
>>>> 
>>>> I followed the smashing guide, and no fields showed up.  So I tried just
>>>> copy pasting their example code and that didnt work either.   Is there
>>>> something wrong with this code I used here:
>>>> 
>>>> function add_comment_fields($fields) {
>>>> 
>>>>  $fields['age'] = '<p class="comment-form-age"><label for="age">' . __(
>>>> 'Age' ) . '</label>' .
>>>>      '<input id="age" name="age" type="text" size="30" /></p>';
>>>>  return $fields;
>>>> 
>>>> }
>>>> add_filter('comment_form_default_fields','add_comment_fields');
>>>> 
>>>> function add_comment_meta_values($comment_id) {
>>>> 
>>>>  if(isset($_POST['age'])) {
>>>>      $age = wp_filter_nohtml_kses($_POST['age']);
>>>>      add_comment_meta($comment_id, 'age', $age, false);
>>>>  }
>>>> 
>>>> }
>>>> add_action ('comment_post', 'add_comment_meta_values', 1);
>>>> 
>>>> 
>>>> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>>> 
>>>>> I tried to send a reply to that earlier, but I don't think it went
>> through
>>>>> - I just resent it now, let me know if you get it.
>>>>> 
>>>>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>>> wrote:
>>>>> 
>>>>>> I was going to (i am tryign to code the plugin I emailed you about
>> myself
>>>>>> today, I have all day :)  )  but the is_post_type was depreciated.
>> Not
>>>>>> sure what to use now.
>>>>>> 
>>>>>> 
>>>>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
>>>>>> 
>>>>>>> I would check for the post type, if its the one you wish to add to do
>>>>> the
>>>>>>> process like in the tutorial, so it only shows on the comment form
>> for
>>>>> the
>>>>>>> post type.
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
>>>>> wrote:
>>>>>>> 
>>>>>>>> I did see that, but I need to add the custom comment fields only to
>> the
>>>>>>>> custom post type
>>>>>>>> 
>>>>>>>> 
>>>>>>>> 
>>>>>>>> --
>>>>>>>> View this message in context:
>>>>>>>> 
>>>>>>> 
>>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>>>>>>>> omment-form-tp42446p42453.html
>>>>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>> 
>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jdg at codesymphony.co  Mon Oct  7 20:05:50 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 16:05:50 -0400
Subject: [wp-hackers] You can view the amount of posts, a CPT, the menu?
In-Reply-To: <CAL1O-KXzNsJWa=s+=3iA575ZXTYOA+4B3STGqAar1HS9QnK9DQ@mail.gmail.com>
References: <CAL1O-KXzNsJWa=s+=3iA575ZXTYOA+4B3STGqAar1HS9QnK9DQ@mail.gmail.com>
Message-ID: <1BF03072-D57A-4BF5-AF22-F75D004D7164@codesymphony.co>

You can get the post found with wp_count_posts() - http://codex.wordpress.org/Function_Reference/wp_count_posts

To add the number to the admin bar, see the $wp_admin_bar->add_node() function - http://codex.wordpress.org/Function_Reference/add_node

On Oct 6, 2013, at 2:33 PM, Leo Baiano <ljunior2005 at gmail.com> wrote:

> You can view the amount of posts, a CPT, the menu? Equal to the amount of
> plugins that need updating and the amount of reviews that are shown next to
> their respective menus inside a black ball.
> 
> -- 
> Amplexos,
> 
> Leo Baiano
> Web Developer
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From ljunior2005 at gmail.com  Mon Oct  7 20:14:28 2013
From: ljunior2005 at gmail.com (Leo Baiano)
Date: Mon, 7 Oct 2013 17:14:28 -0300
Subject: [wp-hackers] You can view the amount of posts, a CPT, the menu?
In-Reply-To: <1BF03072-D57A-4BF5-AF22-F75D004D7164@codesymphony.co>
References: <CAL1O-KXzNsJWa=s+=3iA575ZXTYOA+4B3STGqAar1HS9QnK9DQ@mail.gmail.com>
 <1BF03072-D57A-4BF5-AF22-F75D004D7164@codesymphony.co>
Message-ID: <CAL1O-KU3o6JJTfk3RLkQd-wnNNjD65qTBngn4WHiQeB+R0qh6w@mail.gmail.com>

The number of posts is quietly picking up, my difficulty is showing that
amount off the menu as well as the CPT appears the amount of comments waiting
for approval, for example.


2013/10/7 J.D. Grimes <jdg at codesymphony.co>

> You can get the post found with wp_count_posts() -
> http://codex.wordpress.org/Function_Reference/wp_count_posts
>
> To add the number to the admin bar, see the $wp_admin_bar->add_node()
> function - http://codex.wordpress.org/Function_Reference/add_node
>
> On Oct 6, 2013, at 2:33 PM, Leo Baiano <ljunior2005 at gmail.com> wrote:
>
> > You can view the amount of posts, a CPT, the menu? Equal to the amount of
> > plugins that need updating and the amount of reviews that are shown next
> to
> > their respective menus inside a black ball.
> >
> > --
> > Amplexos,
> >
> > Leo Baiano
> > Web Developer
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Amplexos,

Leo Baiano
Web Developer

From greglancaster71 at gmail.com  Mon Oct  7 20:31:44 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 13:31:44 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
 <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
 <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>
 <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>
Message-ID: <CAPN-N+ZjASoj+Ba9Q8bO6ScgVyXBhJSb40sPUddeER3tBmb2SQ@mail.gmail.com>

I am not sure.  I used the code you suggested in functions.php, and then I
edited the comments.php template so it checks the post type - see the
bolded portion.  The field data was showing before, but now it is not.

<?php
/**
 * Use Bootstrap's media object for listing comments
 *
 * @link http://twitter.github.com/bootstrap/components.html#media
 */
class Roots_Walker_Comment extends Walker_Comment {
  function start_lvl(&$output, $depth = 0, $args = array()) {
    $GLOBALS['comment_depth'] = $depth + 1; ?>
    <ul <?php comment_class('media unstyled comment-' . get_comment_ID());
?>>
    <?php
  }

  function end_lvl(&$output, $depth = 0, $args = array()) {
    $GLOBALS['comment_depth'] = $depth + 1;
    echo '</ul>';
  }

  function start_el(&$output, $comment, $depth = 0, $args = array(), $id =
0) {
    $depth++;
    $GLOBALS['comment_depth'] = $depth;
    $GLOBALS['comment'] = $comment;

    if (!empty($args['callback'])) {
      call_user_func($args['callback'], $comment, $args, $depth);
      return;
    }

    extract($args, EXTR_SKIP); ?>


  <li id="comment-<?php comment_ID(); ?>" <?php comment_class('media
comment-' . get_comment_ID()); ?>>
 *   <?php if (get_post_type() == 'profile') { *
*    include(locate_template('templates/comment-profile.php')); } else {*
*    include(locate_template('templates/comment.php')); } ?>*
    }
  <?php
  }

  function end_el(&$output, $comment, $depth = 0, $args = array()) {
    if (!empty($args['end-callback'])) {
      call_user_func($args['end-callback'], $comment, $args, $depth);
      return;
    }
    echo "</div></li>\n";
  }
}

function roots_get_avatar($avatar) {
  $avatar = str_replace("class='avatar", "class='avatar pull-left
media-object", $avatar);
  return $avatar;
}
add_filter('get_avatar', 'roots_get_avatar');




On Mon, Oct 7, 2013 at 12:59 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes. That means it must be using its own version of the comment_form()
> function. Maybe it has similar hooks?
>
> On Oct 7, 2013, at 3:53 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > awesome! Thats exactly what I needed.  Apparently with this framework the
> > comments.php isnt affected by the add_comment_fields, I have to add it
> > manually.  Since thats the case, I can skip the function right?
> >
> >
> > On Mon, Oct 7, 2013 at 12:26 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Ah, found an action hook you can use to display the field:
> >> comment_form_logged_in_after
> >>
> >> So:
> >>
> >> function add_comment_fields( $fields ) {
> >>
> >>        ?>
> >>
> >>        <p class="comment-form-age">
> >>                <label for="age"><?php _e( 'Age' ); ?></label>
> >>                <input id="age" name="age" type="text" size="30" />
> >>        </p>
> >>
> >>   <?php
> >> }
> >> add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );
> >>
> >>
> >> That will display to logged in users only. Just echo out the form input.
> >> The saving should work the same as before, I think.
> >>
> >> On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:
> >>
> >>> No, there's nothing wrong with that code. Actually, it works, but this:
> >>>> // Default comment form elements are hidden when user is logged in
> >>> So, if you want them to show even when the user is logged in, you will
> >> have to use a different hook. I don't know any off of the top of my
> head...
> >>>
> >>> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>>
> >>>> I got it :)
> >>>>
> >>>> I followed the smashing guide, and no fields showed up.  So I tried
> just
> >>>> copy pasting their example code and that didnt work either.   Is there
> >>>> something wrong with this code I used here:
> >>>>
> >>>> function add_comment_fields($fields) {
> >>>>
> >>>>  $fields['age'] = '<p class="comment-form-age"><label for="age">' .
> __(
> >>>> 'Age' ) . '</label>' .
> >>>>      '<input id="age" name="age" type="text" size="30" /></p>';
> >>>>  return $fields;
> >>>>
> >>>> }
> >>>> add_filter('comment_form_default_fields','add_comment_fields');
> >>>>
> >>>> function add_comment_meta_values($comment_id) {
> >>>>
> >>>>  if(isset($_POST['age'])) {
> >>>>      $age = wp_filter_nohtml_kses($_POST['age']);
> >>>>      add_comment_meta($comment_id, 'age', $age, false);
> >>>>  }
> >>>>
> >>>> }
> >>>> add_action ('comment_post', 'add_comment_meta_values', 1);
> >>>>
> >>>>
> >>>> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>>
> >>>>> I tried to send a reply to that earlier, but I don't think it went
> >> through
> >>>>> - I just resent it now, let me know if you get it.
> >>>>>
> >>>>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>>> wrote:
> >>>>>
> >>>>>> I was going to (i am tryign to code the plugin I emailed you about
> >> myself
> >>>>>> today, I have all day :)  )  but the is_post_type was depreciated.
> >> Not
> >>>>>> sure what to use now.
> >>>>>>
> >>>>>>
> >>>>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> >>>>>>
> >>>>>>> I would check for the post type, if its the one you wish to add to
> do
> >>>>> the
> >>>>>>> process like in the tutorial, so it only shows on the comment form
> >> for
> >>>>> the
> >>>>>>> post type.
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
> >>>>> wrote:
> >>>>>>>
> >>>>>>>> I did see that, but I need to add the custom comment fields only
> to
> >> the
> >>>>>>>> custom post type
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> --
> >>>>>>>> View this message in context:
> >>>>>>>>
> >>>>>>>
> >>>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >>>>>>>> omment-form-tp42446p42453.html
> >>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> Nabble.com.
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>
> >>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct  7 20:35:40 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 7 Oct 2013 16:35:40 -0400
Subject: [wp-hackers] You can view the amount of posts, a CPT, the menu?
In-Reply-To: <CAL1O-KU3o6JJTfk3RLkQd-wnNNjD65qTBngn4WHiQeB+R0qh6w@mail.gmail.com>
References: <CAL1O-KXzNsJWa=s+=3iA575ZXTYOA+4B3STGqAar1HS9QnK9DQ@mail.gmail.com>
 <1BF03072-D57A-4BF5-AF22-F75D004D7164@codesymphony.co>
 <CAL1O-KU3o6JJTfk3RLkQd-wnNNjD65qTBngn4WHiQeB+R0qh6w@mail.gmail.com>
Message-ID: <011168B8-D239-4B9E-8523-B9DFDD84EBCD@codesymphony.co>

This might be helpful for you: http://wordpress.stackexchange.com/questions/9211/changing-admin-menu-labels

You could also hook into the 'admin_menu' action, and manipulate the global $menu array.

On Oct 7, 2013, at 4:14 PM, Leo Baiano <ljunior2005 at gmail.com> wrote:

> The number of posts is quietly picking up, my difficulty is showing that
> amount off the menu as well as the CPT appears the amount of comments waiting
> for approval, for example.
> 
> 
> 2013/10/7 J.D. Grimes <jdg at codesymphony.co>
> 
>> You can get the post found with wp_count_posts() -
>> http://codex.wordpress.org/Function_Reference/wp_count_posts
>> 
>> To add the number to the admin bar, see the $wp_admin_bar->add_node()
>> function - http://codex.wordpress.org/Function_Reference/add_node
>> 
>> On Oct 6, 2013, at 2:33 PM, Leo Baiano <ljunior2005 at gmail.com> wrote:
>> 
>>> You can view the amount of posts, a CPT, the menu? Equal to the amount of
>>> plugins that need updating and the amount of reviews that are shown next
>> to
>>> their respective menus inside a black ball.
>>> 
>>> --
>>> Amplexos,
>>> 
>>> Leo Baiano
>>> Web Developer
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> 
> 
> 
> -- 
> Amplexos,
> 
> Leo Baiano
> Web Developer
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct  7 21:30:29 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 14:30:29 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
 <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
 <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>
 <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>
Message-ID: <CAPN-N+b2B4qYMjd6GCRqcWr_hVWDPzKcn-NEf9MCc47ubdfR8A@mail.gmail.com>

I dont think the comment meta can not save on custom post types by default.


On Mon, Oct 7, 2013 at 12:59 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes. That means it must be using its own version of the comment_form()
> function. Maybe it has similar hooks?
>
> On Oct 7, 2013, at 3:53 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > awesome! Thats exactly what I needed.  Apparently with this framework the
> > comments.php isnt affected by the add_comment_fields, I have to add it
> > manually.  Since thats the case, I can skip the function right?
> >
> >
> > On Mon, Oct 7, 2013 at 12:26 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Ah, found an action hook you can use to display the field:
> >> comment_form_logged_in_after
> >>
> >> So:
> >>
> >> function add_comment_fields( $fields ) {
> >>
> >>        ?>
> >>
> >>        <p class="comment-form-age">
> >>                <label for="age"><?php _e( 'Age' ); ?></label>
> >>                <input id="age" name="age" type="text" size="30" />
> >>        </p>
> >>
> >>   <?php
> >> }
> >> add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );
> >>
> >>
> >> That will display to logged in users only. Just echo out the form input.
> >> The saving should work the same as before, I think.
> >>
> >> On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:
> >>
> >>> No, there's nothing wrong with that code. Actually, it works, but this:
> >>>> // Default comment form elements are hidden when user is logged in
> >>> So, if you want them to show even when the user is logged in, you will
> >> have to use a different hook. I don't know any off of the top of my
> head...
> >>>
> >>> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>>
> >>>> I got it :)
> >>>>
> >>>> I followed the smashing guide, and no fields showed up.  So I tried
> just
> >>>> copy pasting their example code and that didnt work either.   Is there
> >>>> something wrong with this code I used here:
> >>>>
> >>>> function add_comment_fields($fields) {
> >>>>
> >>>>  $fields['age'] = '<p class="comment-form-age"><label for="age">' .
> __(
> >>>> 'Age' ) . '</label>' .
> >>>>      '<input id="age" name="age" type="text" size="30" /></p>';
> >>>>  return $fields;
> >>>>
> >>>> }
> >>>> add_filter('comment_form_default_fields','add_comment_fields');
> >>>>
> >>>> function add_comment_meta_values($comment_id) {
> >>>>
> >>>>  if(isset($_POST['age'])) {
> >>>>      $age = wp_filter_nohtml_kses($_POST['age']);
> >>>>      add_comment_meta($comment_id, 'age', $age, false);
> >>>>  }
> >>>>
> >>>> }
> >>>> add_action ('comment_post', 'add_comment_meta_values', 1);
> >>>>
> >>>>
> >>>> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>>
> >>>>> I tried to send a reply to that earlier, but I don't think it went
> >> through
> >>>>> - I just resent it now, let me know if you get it.
> >>>>>
> >>>>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>>> wrote:
> >>>>>
> >>>>>> I was going to (i am tryign to code the plugin I emailed you about
> >> myself
> >>>>>> today, I have all day :)  )  but the is_post_type was depreciated.
> >> Not
> >>>>>> sure what to use now.
> >>>>>>
> >>>>>>
> >>>>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com> wrote:
> >>>>>>
> >>>>>>> I would check for the post type, if its the one you wish to add to
> do
> >>>>> the
> >>>>>>> process like in the tutorial, so it only shows on the comment form
> >> for
> >>>>> the
> >>>>>>> post type.
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com>
> >>>>> wrote:
> >>>>>>>
> >>>>>>>> I did see that, but I need to add the custom comment fields only
> to
> >> the
> >>>>>>>> custom post type
> >>>>>>>>
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> --
> >>>>>>>> View this message in context:
> >>>>>>>>
> >>>>>>>
> >>>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
> >>>>>>>> omment-form-tp42446p42453.html
> >>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> Nabble.com.
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>
> >>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct  7 22:33:44 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 7 Oct 2013 15:33:44 -0700
Subject: [wp-hackers] adding custom fields to a comment form
In-Reply-To: <CAPN-N+b2B4qYMjd6GCRqcWr_hVWDPzKcn-NEf9MCc47ubdfR8A@mail.gmail.com>
References: <1381171504988-42453.post@n5.nabble.com>
 <CE787A8E.3E33%chris@lod.com>
 <CAPN-N+YsONq8-2PXgwdxC11te54NRXLfRUzh9v4sAkeRm1TQxw@mail.gmail.com>
 <99A2328B-EC93-4FE7-ADD5-ED97B5A2AC78@codesymphony.co>
 <CAPN-N+bP+rF0gxcMbVP6tbit5OhEfW0LSbTNe5RS2feyte5dDQ@mail.gmail.com>
 <05A7F6B7-B68D-47AD-9D20-FCA57E3B9A92@codesymphony.co>
 <9F9E81A8-DBC2-421F-A8F2-9D39C96C3D13@codesymphony.co>
 <CAPN-N+YLjfFLijjAWwthNzGO=44tRj2VGAdgmqh-8JZsLy1JTw@mail.gmail.com>
 <BC6E94CE-AAD7-4FC0-8038-114AD0EE7467@codesymphony.co>
 <CAPN-N+b2B4qYMjd6GCRqcWr_hVWDPzKcn-NEf9MCc47ubdfR8A@mail.gmail.com>
Message-ID: <CAPN-N+Z+8dV8fUR8E1RUHdQ5G7=NHP94SHaJ-mmdgA3gdv4R2w@mail.gmail.com>

Got it thanks to your help JD. Thank you!


On Mon, Oct 7, 2013 at 2:30 PM, Gregory Lancaster <greglancaster71 at gmail.com
> wrote:

> I dont think the comment meta can not save on custom post types by
> default.
>
>
> On Mon, Oct 7, 2013 at 12:59 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
>> Yes. That means it must be using its own version of the comment_form()
>> function. Maybe it has similar hooks?
>>
>> On Oct 7, 2013, at 3:53 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>>
>> > awesome! Thats exactly what I needed.  Apparently with this framework
>> the
>> > comments.php isnt affected by the add_comment_fields, I have to add it
>> > manually.  Since thats the case, I can skip the function right?
>> >
>> >
>> > On Mon, Oct 7, 2013 at 12:26 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>> >
>> >> Ah, found an action hook you can use to display the field:
>> >> comment_form_logged_in_after
>> >>
>> >> So:
>> >>
>> >> function add_comment_fields( $fields ) {
>> >>
>> >>        ?>
>> >>
>> >>        <p class="comment-form-age">
>> >>                <label for="age"><?php _e( 'Age' ); ?></label>
>> >>                <input id="age" name="age" type="text" size="30" />
>> >>        </p>
>> >>
>> >>   <?php
>> >> }
>> >> add_filter( 'comment_form_logged_in_after', 'add_comment_fields' );
>> >>
>> >>
>> >> That will display to logged in users only. Just echo out the form
>> input.
>> >> The saving should work the same as before, I think.
>> >>
>> >> On Oct 7, 2013, at 3:13 PM, "J.D. Grimes" <jdg at codesymphony.co> wrote:
>> >>
>> >>> No, there's nothing wrong with that code. Actually, it works, but
>> this:
>> >>>> // Default comment form elements are hidden when user is logged in
>> >>> So, if you want them to show even when the user is logged in, you will
>> >> have to use a different hook. I don't know any off of the top of my
>> head...
>> >>>
>> >>> On Oct 7, 2013, at 3:01 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>> >> wrote:
>> >>>
>> >>>> I got it :)
>> >>>>
>> >>>> I followed the smashing guide, and no fields showed up.  So I tried
>> just
>> >>>> copy pasting their example code and that didnt work either.   Is
>> there
>> >>>> something wrong with this code I used here:
>> >>>>
>> >>>> function add_comment_fields($fields) {
>> >>>>
>> >>>>  $fields['age'] = '<p class="comment-form-age"><label for="age">' .
>> __(
>> >>>> 'Age' ) . '</label>' .
>> >>>>      '<input id="age" name="age" type="text" size="30" /></p>';
>> >>>>  return $fields;
>> >>>>
>> >>>> }
>> >>>> add_filter('comment_form_default_fields','add_comment_fields');
>> >>>>
>> >>>> function add_comment_meta_values($comment_id) {
>> >>>>
>> >>>>  if(isset($_POST['age'])) {
>> >>>>      $age = wp_filter_nohtml_kses($_POST['age']);
>> >>>>      add_comment_meta($comment_id, 'age', $age, false);
>> >>>>  }
>> >>>>
>> >>>> }
>> >>>> add_action ('comment_post', 'add_comment_meta_values', 1);
>> >>>>
>> >>>>
>> >>>> On Mon, Oct 7, 2013 at 11:57 AM, J.D. Grimes <jdg at codesymphony.co>
>> >> wrote:
>> >>>>
>> >>>>> I tried to send a reply to that earlier, but I don't think it went
>> >> through
>> >>>>> - I just resent it now, let me know if you get it.
>> >>>>>
>> >>>>> On Oct 7, 2013, at 2:54 PM, Gregory Lancaster <
>> >> greglancaster71 at gmail.com>
>> >>>>> wrote:
>> >>>>>
>> >>>>>> I was going to (i am tryign to code the plugin I emailed you about
>> >> myself
>> >>>>>> today, I have all day :)  )  but the is_post_type was depreciated.
>> >> Not
>> >>>>>> sure what to use now.
>> >>>>>>
>> >>>>>>
>> >>>>>> On Mon, Oct 7, 2013 at 11:50 AM, Chris McCoy <chris at lod.com>
>> wrote:
>> >>>>>>
>> >>>>>>> I would check for the post type, if its the one you wish to add
>> to do
>> >>>>> the
>> >>>>>>> process like in the tutorial, so it only shows on the comment form
>> >> for
>> >>>>> the
>> >>>>>>> post type.
>> >>>>>>>
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> On 10/7/2013, 2:45 PM, "BenderisGreat" <greglancaster71 at gmail.com
>> >
>> >>>>> wrote:
>> >>>>>>>
>> >>>>>>>> I did see that, but I need to add the custom comment fields only
>> to
>> >> the
>> >>>>>>>> custom post type
>> >>>>>>>>
>> >>>>>>>>
>> >>>>>>>>
>> >>>>>>>> --
>> >>>>>>>> View this message in context:
>> >>>>>>>>
>> >>>>>>>
>> >>>>>
>> >>
>> http://wordpress-hackers.1065353.n5.nabble.com/adding-custom-fields-to-a-c
>> >>>>>>>> omment-form-tp42446p42453.html
>> >>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>> Nabble.com.
>> >>>>>>>> _______________________________________________
>> >>>>>>>> wp-hackers mailing list
>> >>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> _______________________________________________
>> >>>>>>> wp-hackers mailing list
>> >>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>
>> >>>>>> _______________________________________________
>> >>>>>> wp-hackers mailing list
>> >>>>>> wp-hackers at lists.automattic.com
>> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>
>> >>>>> _______________________________________________
>> >>>>> wp-hackers mailing list
>> >>>>> wp-hackers at lists.automattic.com
>> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>
>> >>>> _______________________________________________
>> >>>> wp-hackers mailing list
>> >>>> wp-hackers at lists.automattic.com
>> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>
>> >>> _______________________________________________
>> >>> wp-hackers mailing list
>> >>> wp-hackers at lists.automattic.com
>> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> >> _______________________________________________
>> >> wp-hackers mailing list
>> >> wp-hackers at lists.automattic.com
>> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

From kkarpieszuk at gmail.com  Tue Oct  8 16:56:12 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Tue, 8 Oct 2013 18:56:12 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
Message-ID: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>

hello

today few people reported me that instead of main page of my wordpress
site, they see installation wizard. after few minutes main website was ok,
but every subpages had error 404.

i went to dashborad > settings > permalink and refreshed structure of
permalinks. after that all website was ok.

but i see i logs that really somebody tried to get into install.php script,
even few times per second, this is apache log from begging of attack:

http://wklej.org/id/1145478/

question: how it was possible that regular visitors saw installation script
during this attack? and why affter attack permalinks was broken?

at this domain i have two sites:
dev.wpzlecenia.pl - everything is up to date
wpzlecenia.pl - two plugins are in older versions
  - Google XML Sitemaps (i have 3.2.9) here is changelog
http://www.arnebrachhold.de/projects/wordpress-plugins/google-xml-sitemaps-generator/changelog/,
it looks that this plugin has no security issue in this version
  - WordPress SEO by Yoast - (i have version 1.4.15)  here is changelog
http://wordpress.org/plugins/wordpress-seo/changelog/ , it looks that
everything is ok in this older version



--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski

From ipstenu at ipstenu.org  Tue Oct  8 18:47:06 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Tue, 08 Oct 2013 11:47:06 -0700
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
Message-ID: <5254532A.9030100@ipstenu.org>

I think causality is the other way around.

People were hitting install.php so much because the wizard was showing. 
Was your SQL server glitching?

> Konrad Karpieszuk <mailto:kkarpieszuk at gmail.com>
> October 8, 2013 9:56 AM
> hello
>
> today few people reported me that instead of main page of my wordpress
> site, they see installation wizard. after few minutes main website was ok,
> but every subpages had error 404.
>
> i went to dashborad > settings > permalink and refreshed structure of
> permalinks. after that all website was ok.
>
> but i see i logs that really somebody tried to get into install.php 
> script,
> even few times per second, this is apache log from begging of attack:
>
> http://wklej.org/id/1145478/
>
> question: how it was possible that regular visitors saw installation 
> script
> during this attack? and why affter attack permalinks was broken?
>
> at this domain i have two sites:
> dev.wpzlecenia.pl - everything is up to date
> wpzlecenia.pl - two plugins are in older versions
> - Google XML Sitemaps (i have 3.2.9) here is changelog
> http://www.arnebrachhold.de/projects/wordpress-plugins/google-xml-sitemaps-generator/changelog/,
> it looks that this plugin has no security issue in this version
> - WordPress SEO by Yoast - (i have version 1.4.15) here is changelog
> http://wordpress.org/plugins/wordpress-seo/changelog/ , it looks that
> everything is ok in this older version
>
>
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

-- 
Mika A Epstein (aka Ipstenu)
http://ipstenu.org | http://halfelf.org


From mpwalsh8 at gmail.com  Tue Oct  8 21:24:12 2013
From: mpwalsh8 at gmail.com (Mike Walsh)
Date: Tue, 8 Oct 2013 17:24:12 -0400
Subject: [wp-hackers] Help with wp_mail(), PHPMailer, and CC vs BCC
Message-ID: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>

I am getting reports from a few users that my Email Users plugin is putting
recipient addresses in the CC header instead of the BCC header.  I am
stumped as to how this is happening but I've had three reports in the past
24 hours.

Is there anyway to intercept PHPMailer from actually performing the final
send?  What I'd like to do is let the plugin run normally right up to the
point where wp_mail() calls PHPMailer and then prevent PHPMailer from doing
the actual send.  I'd then like to examine the headers in the PHPMailer
global instance to try and figure out what is going haywire.

I've looked through wp_mail() and the PHPMailer class and I don't see any
obvious way to do this so am hoping someone has had to do something similar
before.  There is a reference in wp_mail() to a hook called
'phpmailer_init' but I haven't found out what it is used for nor when it is
called.

Mike

-- 
Mike Walsh - mpwalsh8 at gmail.com

From info at bungeshea.com  Tue Oct  8 21:28:50 2013
From: info at bungeshea.com (Shea Bunge)
Date: Wed, 9 Oct 2013 08:28:50 +1100
Subject: [wp-hackers] Help with wp_mail(), PHPMailer, and CC vs BCC
In-Reply-To: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>
References: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>
Message-ID: <CAJLbkRbYmi7e1f8L4MprdakxA4ugMz=9U_OR901F1m_FwBjEtg@mail.gmail.com>

wp_mail() is a pluggable function, so you can just copy it into a plugin
and modify it how you like. Your custom wp_mail() will be used instead of
the default function.


On Wed, Oct 9, 2013 at 8:24 AM, Mike Walsh <mpwalsh8 at gmail.com> wrote:

> I am getting reports from a few users that my Email Users plugin is putting
> recipient addresses in the CC header instead of the BCC header.  I am
> stumped as to how this is happening but I've had three reports in the past
> 24 hours.
>
> Is there anyway to intercept PHPMailer from actually performing the final
> send?  What I'd like to do is let the plugin run normally right up to the
> point where wp_mail() calls PHPMailer and then prevent PHPMailer from doing
> the actual send.  I'd then like to examine the headers in the PHPMailer
> global instance to try and figure out what is going haywire.
>
> I've looked through wp_mail() and the PHPMailer class and I don't see any
> obvious way to do this so am hoping someone has had to do something similar
> before.  There is a reference in wp_mail() to a hook called
> 'phpmailer_init' but I haven't found out what it is used for nor when it is
> called.
>
> Mike
>
> --
> Mike Walsh - mpwalsh8 at gmail.com
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Regards,

Shea Bunge
http://bungeshea.com

From mpwalsh8 at gmail.com  Wed Oct  9 00:01:39 2013
From: mpwalsh8 at gmail.com (Mike Walsh)
Date: Tue, 8 Oct 2013 20:01:39 -0400
Subject: [wp-hackers] Help with wp_mail(), PHPMailer, and CC vs BCC
In-Reply-To: <CAJLbkRbYmi7e1f8L4MprdakxA4ugMz=9U_OR901F1m_FwBjEtg@mail.gmail.com>
References: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>
 <CAJLbkRbYmi7e1f8L4MprdakxA4ugMz=9U_OR901F1m_FwBjEtg@mail.gmail.com>
Message-ID: <CAMg3evEa=z5RBxeWSb3CyX6UaNWOHc3Ac23OWM=AbwkWhoryQA@mail.gmail.com>

I understand that wp_mail() is pluggable, in fact, I am concerned that may
be the source of these curious problems.  I've been working with a  user
for the last couple hours to chase this down and now it isn't happening any
more.  She tells me all her plugins and themes are as they were earlier but
something doesn't pass the sniff test.

Is there a way to determine if wp_mail() has indeed been overloaded?

I was able to use the phpmailer_init filter to dump the status of the
PHPMailer instance just before mail is sent so that was helpful.  It would
be nice if wp_mail() had a similar filter but unfortunately it does not.  I
don't want to distribute a modified version of wp_mail() with my plugin
either as I don't need anything but the standard behavior.

Mike


On Tue, Oct 8, 2013 at 5:28 PM, Shea Bunge <info at bungeshea.com> wrote:

> wp_mail() is a pluggable function, so you can just copy it into a plugin
> and modify it how you like. Your custom wp_mail() will be used instead of
> the default function.
>
>
> On Wed, Oct 9, 2013 at 8:24 AM, Mike Walsh <mpwalsh8 at gmail.com> wrote:
>
> > I am getting reports from a few users that my Email Users plugin is
> putting
> > recipient addresses in the CC header instead of the BCC header.  I am
> > stumped as to how this is happening but I've had three reports in the
> past
> > 24 hours.
> >
> > Is there anyway to intercept PHPMailer from actually performing the final
> > send?  What I'd like to do is let the plugin run normally right up to the
> > point where wp_mail() calls PHPMailer and then prevent PHPMailer from
> doing
> > the actual send.  I'd then like to examine the headers in the PHPMailer
> > global instance to try and figure out what is going haywire.
> >
> > I've looked through wp_mail() and the PHPMailer class and I don't see any
> > obvious way to do this so am hoping someone has had to do something
> similar
> > before.  There is a reference in wp_mail() to a hook called
> > 'phpmailer_init' but I haven't found out what it is used for nor when it
> is
> > called.
> >
> > Mike
> >
> > --
> > Mike Walsh - mpwalsh8 at gmail.com
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> Regards,
>
> Shea Bunge
> http://bungeshea.com
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Mike Walsh - mpwalsh8 at gmail.com

From kkarpieszuk at gmail.com  Wed Oct  9 06:39:56 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 08:39:56 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <5254532A.9030100@ipstenu.org>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
Message-ID: <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>

two things:

1. my website is not so popular that in one second 20 person try to connect

2. as you can see in log, /wp-admin/install.php is added not always to main
domain but sometimes to single post urls (ie

/2013/10/wdrozenie-zakupionego-szablonu-wordpress/wp-admin/install.php
) This is not url which somebody type in address bar without reason


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Tue, Oct 8, 2013 at 8:47 PM, Mika A Epstein <ipstenu at ipstenu.org> wrote:

> I think causality is the other way around.
>
> People were hitting install.php so much because the wizard was showing.
> Was your SQL server glitching?
>
>  Konrad Karpieszuk <mailto:kkarpieszuk at gmail.com>
>> October 8, 2013 9:56 AM
>>
>> hello
>>
>> today few people reported me that instead of main page of my wordpress
>> site, they see installation wizard. after few minutes main website was ok,
>> but every subpages had error 404.
>>
>> i went to dashborad > settings > permalink and refreshed structure of
>> permalinks. after that all website was ok.
>>
>> but i see i logs that really somebody tried to get into install.php
>> script,
>> even few times per second, this is apache log from begging of attack:
>>
>> http://wklej.org/id/1145478/
>>
>> question: how it was possible that regular visitors saw installation
>> script
>> during this attack? and why affter attack permalinks was broken?
>>
>> at this domain i have two sites:
>> dev.wpzlecenia.pl - everything is up to date
>> wpzlecenia.pl - two plugins are in older versions
>> - Google XML Sitemaps (i have 3.2.9) here is changelog
>> http://www.arnebrachhold.de/**projects/wordpress-plugins/**
>> google-xml-sitemaps-generator/**changelog/<http://www.arnebrachhold.de/projects/wordpress-plugins/google-xml-sitemaps-generator/changelog/>
>> ,
>> it looks that this plugin has no security issue in this version
>> - WordPress SEO by Yoast - (i have version 1.4.15) here is changelog
>> http://wordpress.org/plugins/**wordpress-seo/changelog/<http://wordpress.org/plugins/wordpress-seo/changelog/>, it looks that
>> everything is ok in this older version
>>
>>
>>
>> --
>> (en) regards / (pl) pozdrawiam
>> Konrad Karpieszuk
>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>> klient?w z Polski
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
>
> --
> Mika A Epstein (aka Ipstenu)
> http://ipstenu.org | http://halfelf.org
>
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From developer at rogerhub.com  Wed Oct  9 06:53:45 2013
From: developer at rogerhub.com (Roger Chen)
Date: Tue, 8 Oct 2013 23:53:45 -0700
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
Message-ID: <CAEdQCeUcxw=F=p4s5m+9Wv6wdkn5GLc88A2RdMu8HUO0T-o2fQ@mail.gmail.com>

>From the response code (302), it looks like your visitors were stuck in a
redirect loop, which is why there are so many requests to install.php
grouped together. WordPress redirects to wp-admin/install.php when it
thinks your database hasn't been setup. It will preserve the existing
request path when it performs this redirect, since it's completely possible
that somebody actually wanted to set up wordpress in a subdirectory like
'/2013/10/..../'. It looks like you just botched your database
configuration somehow.

Roger


On Tue, Oct 8, 2013 at 11:39 PM, Konrad Karpieszuk <kkarpieszuk at gmail.com>wrote:

> two things:
>
> 1. my website is not so popular that in one second 20 person try to connect
>
> 2. as you can see in log, /wp-admin/install.php is added not always to main
> domain but sometimes to single post urls (ie
>
> /2013/10/wdrozenie-zakupionego-szablonu-wordpress/wp-admin/install.php
> ) This is not url which somebody type in address bar without reason
>
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
>
>
>
> On Tue, Oct 8, 2013 at 8:47 PM, Mika A Epstein <ipstenu at ipstenu.org>
> wrote:
>
> > I think causality is the other way around.
> >
> > People were hitting install.php so much because the wizard was showing.
> > Was your SQL server glitching?
> >
> >  Konrad Karpieszuk <mailto:kkarpieszuk at gmail.com>
> >> October 8, 2013 9:56 AM
> >>
> >> hello
> >>
> >> today few people reported me that instead of main page of my wordpress
> >> site, they see installation wizard. after few minutes main website was
> ok,
> >> but every subpages had error 404.
> >>
> >> i went to dashborad > settings > permalink and refreshed structure of
> >> permalinks. after that all website was ok.
> >>
> >> but i see i logs that really somebody tried to get into install.php
> >> script,
> >> even few times per second, this is apache log from begging of attack:
> >>
> >> http://wklej.org/id/1145478/
> >>
> >> question: how it was possible that regular visitors saw installation
> >> script
> >> during this attack? and why affter attack permalinks was broken?
> >>
> >> at this domain i have two sites:
> >> dev.wpzlecenia.pl - everything is up to date
> >> wpzlecenia.pl - two plugins are in older versions
> >> - Google XML Sitemaps (i have 3.2.9) here is changelog
> >> http://www.arnebrachhold.de/**projects/wordpress-plugins/**
> >> google-xml-sitemaps-generator/**changelog/<
> http://www.arnebrachhold.de/projects/wordpress-plugins/google-xml-sitemaps-generator/changelog/
> >
> >> ,
> >> it looks that this plugin has no security issue in this version
> >> - WordPress SEO by Yoast - (i have version 1.4.15) here is changelog
> >> http://wordpress.org/plugins/**wordpress-seo/changelog/<
> http://wordpress.org/plugins/wordpress-seo/changelog/>, it looks that
> >> everything is ok in this older version
> >>
> >>
> >>
> >> --
> >> (en) regards / (pl) pozdrawiam
> >> Konrad Karpieszuk
> >> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> >> klient?w z Polski
> >> ______________________________**_________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> >> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
> http://lists.automattic.com/mailman/listinfo/wp-hackers>
> >>
> >
> > --
> > Mika A Epstein (aka Ipstenu)
> > http://ipstenu.org | http://halfelf.org
> >
> > ______________________________**_________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> > http://lists.automattic.com/**mailman/listinfo/wp-hackers<
> http://lists.automattic.com/mailman/listinfo/wp-hackers>
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From bryan at ibaku.net  Wed Oct  9 06:55:16 2013
From: bryan at ibaku.net (Bryan Petty)
Date: Wed, 9 Oct 2013 00:55:16 -0600
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
Message-ID: <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>

On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
<kkarpieszuk at gmail.com> wrote:
> two things:
>
> 1. my website is not so popular that in one second 20 person try to connect
>
> 2. as you can see in log, /wp-admin/install.php is added not always to main
> domain but sometimes to single post urls (ie
>
> /2013/10/wdrozenie-zakupionego-szablonu-wordpress/wp-admin/install.php
> ) This is not url which somebody type in address bar without reason

It's actually fairly likely that in the event that your DB has dropped
as Mika was suggesting, that one of your plugins or server
configuration was causing a redirect loop back to install.php itself
as well.

Most hack attempts don't intentionally claim a user agent as
"Feedfetcher-Google" (which was also seeing that install.php redirect
loop).

-- 
Regards,
Bryan Petty

From kkarpieszuk at gmail.com  Wed Oct  9 07:35:56 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 09:35:56 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
Message-ID: <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>

ok, one more  info which i thought isn't relative to this problem, but
maybe.

three months ago somebody start this famous ddos attack to wp-login.php at
those websites. tens of times per second somebody tried to login into
dashboard using random passwords. at beginning i resolved this in .htaccess
by adding rules that nobody except from my ip address can acces to
wp-login.php. but beacouse i have cowriter without permamnent IP address,
this was not good solution

so few days ago i changed in files:
wp-login.php
wp-admin/index.php

first line from:

<?php

to

<?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony"); //


it check if we got some 'secret' cookie and if cookie is absent it
immadietly execute die().

It looks like good solution: wordpress core isnt started at all, server is
happy.
Can it be somehow related to this attack on wp-admin/install.php? i dont
belive that this kind of change has something common with install script,
but maybe i dont know wordpress core very good. Or maybe this attacker when
saw that wp-login.php and wp-admin/index.php are secured started new way to
attack? )or he or she started this long time ago but htaccess prevented
from this)? all ip's from log are outside of Poland, but my regular
visitors are almost only from Poland


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty <bryan at ibaku.net> wrote:

> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
> <kkarpieszuk at gmail.com> wrote:
> > two things:
> >
> > 1. my website is not so popular that in one second 20 person try to
> connect
> >
> > 2. as you can see in log, /wp-admin/install.php is added not always to
> main
> > domain but sometimes to single post urls (ie
> >
> > /2013/10/wdrozenie-zakupionego-szablonu-wordpress/wp-admin/install.php
> > ) This is not url which somebody type in address bar without reason
>
> It's actually fairly likely that in the event that your DB has dropped
> as Mika was suggesting, that one of your plugins or server
> configuration was causing a redirect loop back to install.php itself
> as well.
>
> Most hack attempts don't intentionally claim a user agent as
> "Feedfetcher-Google" (which was also seeing that install.php redirect
> loop).
>
> --
> Regards,
> Bryan Petty
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From abdussamad at abdussamad.com  Wed Oct  9 07:54:56 2013
From: abdussamad at abdussamad.com (Abdussamad Abdurrazzaq)
Date: Wed, 09 Oct 2013 12:54:56 +0500
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
Message-ID: <52550BD0.5010507@abdussamad.com>

If you are this worried you can always delete install.php.

On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
> ok, one more  info which i thought isn't relative to this problem, but
> maybe.
>
> three months ago somebody start this famous ddos attack to wp-login.php at
> those websites. tens of times per second somebody tried to login into
> dashboard using random passwords. at beginning i resolved this in .htaccess
> by adding rules that nobody except from my ip address can acces to
> wp-login.php. but beacouse i have cowriter without permamnent IP address,
> this was not good solution
>
> so few days ago i changed in files:
> wp-login.php
> wp-admin/index.php
>
> first line from:
>
> <?php
>
> to
>
> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony"); //
>
>
> it check if we got some 'secret' cookie and if cookie is absent it
> immadietly execute die().
>
> It looks like good solution: wordpress core isnt started at all, server is
> happy.
> Can it be somehow related to this attack on wp-admin/install.php? i dont
> belive that this kind of change has something common with install script,
> but maybe i dont know wordpress core very good. Or maybe this attacker when
> saw that wp-login.php and wp-admin/index.php are secured started new way to
> attack? )or he or she started this long time ago but htaccess prevented
> from this)? all ip's from log are outside of Poland, but my regular
> visitors are almost only from Poland
>
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
>
>
>
> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty <bryan at ibaku.net> wrote:
>
>> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
>> <kkarpieszuk at gmail.com> wrote:
>>> two things:
>>>
>>> 1. my website is not so popular that in one second 20 person try to
>> connect
>>>
>>> 2. as you can see in log, /wp-admin/install.php is added not always to
>> main
>>> domain but sometimes to single post urls (ie
>>>
>>> /2013/10/wdrozenie-zakupionego-szablonu-wordpress/wp-admin/install.php
>>> ) This is not url which somebody type in address bar without reason
>>
>> It's actually fairly likely that in the event that your DB has dropped
>> as Mika was suggesting, that one of your plugins or server
>> configuration was causing a redirect loop back to install.php itself
>> as well.
>>
>> Most hack attempts don't intentionally claim a user agent as
>> "Feedfetcher-Google" (which was also seeing that install.php redirect
>> loop).
>>
>> --
>> Regards,
>> Bryan Petty
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From info at toscho.de  Wed Oct  9 07:56:21 2013
From: info at toscho.de (Thomas Scholz)
Date: Wed, 09 Oct 2013 09:56:21 +0200
Subject: [wp-hackers] Help with wp_mail(), PHPMailer, and CC vs BCC
In-Reply-To: <CAMg3evEa=z5RBxeWSb3CyX6UaNWOHc3Ac23OWM=AbwkWhoryQA@mail.gmail.com>
References: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>
 <CAJLbkRbYmi7e1f8L4MprdakxA4ugMz=9U_OR901F1m_FwBjEtg@mail.gmail.com>
 <CAMg3evEa=z5RBxeWSb3CyX6UaNWOHc3Ac23OWM=AbwkWhoryQA@mail.gmail.com>
Message-ID: <op.w4ogb7axr6yny2@fqdn.toscho.de>

Mike Walsh:

> Is there a way to determine if wp_mail() has indeed been overloaded?

Use the Reflection API.
<http://www.php.net/manual/en/book.reflection.php>

$reflection = new ReflectionFunction( 'wp_mail' );
print $reflection->getFileName();

Thomas

From kkarpieszuk at gmail.com  Wed Oct  9 09:19:55 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 11:19:55 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <52550BD0.5010507@abdussamad.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
Message-ID: <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>

first of all i want to know *why*. :) i;ve got tens of wordpress sites and
i will have more. i dont want to delete install.php every time (and after
every wordpress upgrade). also maybe we have totally new way to hack
wordpress sites (as you can see it is somehow working, because intruded
broke my site)


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 9:54 AM, Abdussamad Abdurrazzaq <
abdussamad at abdussamad.com> wrote:

> If you are this worried you can always delete install.php.
>
>
> On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
>
>> ok, one more  info which i thought isn't relative to this problem, but
>> maybe.
>>
>> three months ago somebody start this famous ddos attack to wp-login.php at
>> those websites. tens of times per second somebody tried to login into
>> dashboard using random passwords. at beginning i resolved this in
>> .htaccess
>> by adding rules that nobody except from my ip address can acces to
>> wp-login.php. but beacouse i have cowriter without permamnent IP address,
>> this was not good solution
>>
>> so few days ago i changed in files:
>> wp-login.php
>> wp-admin/index.php
>>
>> first line from:
>>
>> <?php
>>
>> to
>>
>> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony"); //
>>
>>
>> it check if we got some 'secret' cookie and if cookie is absent it
>> immadietly execute die().
>>
>> It looks like good solution: wordpress core isnt started at all, server is
>> happy.
>> Can it be somehow related to this attack on wp-admin/install.php? i dont
>> belive that this kind of change has something common with install script,
>> but maybe i dont know wordpress core very good. Or maybe this attacker
>> when
>> saw that wp-login.php and wp-admin/index.php are secured started new way
>> to
>> attack? )or he or she started this long time ago but htaccess prevented
>> from this)? all ip's from log are outside of Poland, but my regular
>> visitors are almost only from Poland
>>
>>
>> --
>> (en) regards / (pl) pozdrawiam
>> Konrad Karpieszuk
>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>> klient?w z Polski
>>
>>
>>
>> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty <bryan at ibaku.net> wrote:
>>
>>  On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
>>> <kkarpieszuk at gmail.com> wrote:
>>>
>>>> two things:
>>>>
>>>> 1. my website is not so popular that in one second 20 person try to
>>>>
>>> connect
>>>
>>>>
>>>> 2. as you can see in log, /wp-admin/install.php is added not always to
>>>>
>>> main
>>>
>>>> domain but sometimes to single post urls (ie
>>>>
>>>> /2013/10/wdrozenie-**zakupionego-szablonu-**
>>>> wordpress/wp-admin/install.php
>>>> ) This is not url which somebody type in address bar without reason
>>>>
>>>
>>> It's actually fairly likely that in the event that your DB has dropped
>>> as Mika was suggesting, that one of your plugins or server
>>> configuration was causing a redirect loop back to install.php itself
>>> as well.
>>>
>>> Most hack attempts don't intentionally claim a user agent as
>>> "Feedfetcher-Google" (which was also seeing that install.php redirect
>>> loop).
>>>
>>> --
>>> Regards,
>>> Bryan Petty
>>> ______________________________**_________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>>  ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
>>  ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From kkarpieszuk at gmail.com  Wed Oct  9 09:31:42 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 11:31:42 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
 but this what happens with every upgrade of jquery...
Message-ID: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>

Hi people

I think one of most important thing in wordpress is that it supports even
old wordpress api functions (just throwing notice that this is depracated
and you should consider to use new way of doing this thing). This very
important argument when you propose to your customer to build website on
wordpress: you can tell him that website will work for years, and he/she
don't have to be affraid of making wordpress core upgrades.

But this what happens after every upgrade of wordpress which delivers new
version of jQuery i can comment only in three letters: WTF?! :)

Today i upgraded one website of my customer to wp 3.6.1 which brings jquery
1.10. And after that all sliders based on jquery tabs stopped to work.

I found reason: in my sliders i heavily use method 'selected' which in new
version of jQuery is called 'active' and i use 'fx' - now i should use
'show' option.

I changed that, but what with other websites? I developed tens of them
where i am sure problem will be the same after wordpress upgrade.

And also few months ago i sam that jquery tabs method 'rotate' also was
castrated. Then i found some plugin which brought it back.


But this is silly! I include jquery and jquery-ui-tabs using
wp_enqueue_script every time - in the way how codex.wordpress suggest to do
this. Now it looks that because of wp upgrades you cannot depend on this.

I cannot tell my customers not to upgrade wordpress, because of that
animations will stop to work. Also i cannot charge thetm for my additional
work after every wordpress upgarde - this is not the way how i cooperate
with customers.

I know that the problem is in jQuery way of development, not in wordpress,
but maybe you - wordpress core developers - have some idea how to deal with
it?

--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski

From nikolov.tmw at gmail.com  Wed Oct  9 09:42:48 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 9 Oct 2013 12:42:48 +0300
Subject: [wp-hackers] i love wordpress support for php functions,
 but this what happens with every upgrade of jquery...
In-Reply-To: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
Message-ID: <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>

Well a simple solution is to simply register your own version of jQuery and
stick to it. Keep in mind that this might break other plugins that depend
on the latest version of jQuery.

Here's a sample code:

function my_enqueue_scripts() {
    // De-register the core version of jQuery
    wp_deregister_script( 'jquery' );

    // Register our version of jQuery and our script that depends on that
version of jQuery
    wp_register_script( 'jquery', get_bloginfo( 'template_directory' ) .
'/js/jquery.js' );
    wp_register_script( 'my-jquery-dependent-script', get_bloginfo(
'template_directory' ) . '/js/script.js', array( 'jquery' ) );

    // Enqueue the custom script
    wp_enqueue_script( 'my-jquery-dependent-script' );
}
add_action( 'wp_enqueue_scripts', 'my_enqueue_scripts', 10 );


Now, please keep in mind the following: someone else might come after you
and make changes on the theme, or poke around it. Please leave a note as to
why exactly you're using the exact version of jQuery that you're using, so
that the next person doesn't suffer too much :) And I assume that the
syntax that comes with jQuery 1.10 will stick around for longer, so at
least update your themes to use 1.10 and then use local version of 1.10

Nikola


On Wed, Oct 9, 2013 at 12:31 PM, Konrad Karpieszuk <kkarpieszuk at gmail.com>wrote:

> Hi people
>
> I think one of most important thing in wordpress is that it supports even
> old wordpress api functions (just throwing notice that this is depracated
> and you should consider to use new way of doing this thing). This very
> important argument when you propose to your customer to build website on
> wordpress: you can tell him that website will work for years, and he/she
> don't have to be affraid of making wordpress core upgrades.
>
> But this what happens after every upgrade of wordpress which delivers new
> version of jQuery i can comment only in three letters: WTF?! :)
>
> Today i upgraded one website of my customer to wp 3.6.1 which brings jquery
> 1.10. And after that all sliders based on jquery tabs stopped to work.
>
> I found reason: in my sliders i heavily use method 'selected' which in new
> version of jQuery is called 'active' and i use 'fx' - now i should use
> 'show' option.
>
> I changed that, but what with other websites? I developed tens of them
> where i am sure problem will be the same after wordpress upgrade.
>
> And also few months ago i sam that jquery tabs method 'rotate' also was
> castrated. Then i found some plugin which brought it back.
>
>
> But this is silly! I include jquery and jquery-ui-tabs using
> wp_enqueue_script every time - in the way how codex.wordpress suggest to do
> this. Now it looks that because of wp upgrades you cannot depend on this.
>
> I cannot tell my customers not to upgrade wordpress, because of that
> animations will stop to work. Also i cannot charge thetm for my additional
> work after every wordpress upgarde - this is not the way how i cooperate
> with customers.
>
> I know that the problem is in jQuery way of development, not in wordpress,
> but maybe you - wordpress core developers - have some idea how to deal with
> it?
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From kkarpieszuk at gmail.com  Wed Oct  9 10:20:24 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 12:20:24 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
 but this what happens with every upgrade of jquery...
In-Reply-To: <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
Message-ID: <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>

Nikola, i know how to register own version of jquery, but as you wrote:

"Keep in mind that this might break other plugins that depend
on the latest version of jQuery."

exactly: registering own version o jQ looks like waiting for troubles. i
hate when i see that some plugin developers do this and i see that beacouse
of that wordpress is linking to some cdn with quite old version.

i think wordpress core developers really shouldnt bring cutting edge of
jquery with every minor upgrade of this cms. in php functions support for
old and deprecated is very good, but in javascript looks like horror for
front end developers


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 11:42 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Well a simple solution is to simply register your own version of jQuery and
> stick to it. Keep in mind that this might break other plugins that depend
> on the latest version of jQuery.
>
> Here's a sample code:
>
> function my_enqueue_scripts() {
>     // De-register the core version of jQuery
>     wp_deregister_script( 'jquery' );
>
>     // Register our version of jQuery and our script that depends on that
> version of jQuery
>     wp_register_script( 'jquery', get_bloginfo( 'template_directory' ) .
> '/js/jquery.js' );
>     wp_register_script( 'my-jquery-dependent-script', get_bloginfo(
> 'template_directory' ) . '/js/script.js', array( 'jquery' ) );
>
>     // Enqueue the custom script
>     wp_enqueue_script( 'my-jquery-dependent-script' );
> }
> add_action( 'wp_enqueue_scripts', 'my_enqueue_scripts', 10 );
>
>
> Now, please keep in mind the following: someone else might come after you
> and make changes on the theme, or poke around it. Please leave a note as to
> why exactly you're using the exact version of jQuery that you're using, so
> that the next person doesn't suffer too much :) And I assume that the
> syntax that comes with jQuery 1.10 will stick around for longer, so at
> least update your themes to use 1.10 and then use local version of 1.10
>
> Nikola
>
>
> On Wed, Oct 9, 2013 at 12:31 PM, Konrad Karpieszuk <kkarpieszuk at gmail.com
> >wrote:
>
> > Hi people
> >
> > I think one of most important thing in wordpress is that it supports even
> > old wordpress api functions (just throwing notice that this is depracated
> > and you should consider to use new way of doing this thing). This very
> > important argument when you propose to your customer to build website on
> > wordpress: you can tell him that website will work for years, and he/she
> > don't have to be affraid of making wordpress core upgrades.
> >
> > But this what happens after every upgrade of wordpress which delivers new
> > version of jQuery i can comment only in three letters: WTF?! :)
> >
> > Today i upgraded one website of my customer to wp 3.6.1 which brings
> jquery
> > 1.10. And after that all sliders based on jquery tabs stopped to work.
> >
> > I found reason: in my sliders i heavily use method 'selected' which in
> new
> > version of jQuery is called 'active' and i use 'fx' - now i should use
> > 'show' option.
> >
> > I changed that, but what with other websites? I developed tens of them
> > where i am sure problem will be the same after wordpress upgrade.
> >
> > And also few months ago i sam that jquery tabs method 'rotate' also was
> > castrated. Then i found some plugin which brought it back.
> >
> >
> > But this is silly! I include jquery and jquery-ui-tabs using
> > wp_enqueue_script every time - in the way how codex.wordpress suggest to
> do
> > this. Now it looks that because of wp upgrades you cannot depend on this.
> >
> > I cannot tell my customers not to upgrade wordpress, because of that
> > animations will stop to work. Also i cannot charge thetm for my
> additional
> > work after every wordpress upgarde - this is not the way how i cooperate
> > with customers.
> >
> > I know that the problem is in jQuery way of development, not in
> wordpress,
> > but maybe you - wordpress core developers - have some idea how to deal
> with
> > it?
> >
> > --
> > (en) regards / (pl) pozdrawiam
> > Konrad Karpieszuk
> > http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> > klient?w z Polski
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From mailing at markoheijnen.nl  Wed Oct  9 10:40:47 2013
From: mailing at markoheijnen.nl (Marko Heijnen)
Date: Wed, 9 Oct 2013 12:40:47 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
	but this what happens with every upgrade of jquery...
In-Reply-To: <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
 <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
Message-ID: <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>

Looking at the jQuery documentation I don't  see what you mean. selected() still seems to be fine.
That said. As a developer it's also your task to make sure that all jQuery scripts are updated. Even if a plugin using deprecated functions it doesn't mean you should not update it.

In general I don't think a lot of sites break during a jQuery update. The current one is a more tricky one because of a lot of deprecated functions. Because of the WordPress does load jQuery migrate.
So my feeling saids that the upgrade to jQuery 1.10 was maybe the most tricky upgrade we ever did. And that is not wrong. It just means another step forward. And to me that was needed.

Marko


Op 9 okt. 2013, om 12:20 heeft Konrad Karpieszuk <kkarpieszuk at gmail.com> het volgende geschreven:

> Nikola, i know how to register own version of jquery, but as you wrote:
> 
> "Keep in mind that this might break other plugins that depend
> on the latest version of jQuery."
> 
> exactly: registering own version o jQ looks like waiting for troubles. i
> hate when i see that some plugin developers do this and i see that beacouse
> of that wordpress is linking to some cdn with quite old version.
> 
> i think wordpress core developers really shouldnt bring cutting edge of
> jquery with every minor upgrade of this cms. in php functions support for
> old and deprecated is very good, but in javascript looks like horror for
> front end developers
> 
> 
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
> 
> 
> 
> On Wed, Oct 9, 2013 at 11:42 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:
> 
>> Well a simple solution is to simply register your own version of jQuery and
>> stick to it. Keep in mind that this might break other plugins that depend
>> on the latest version of jQuery.
>> 
>> Here's a sample code:
>> 
>> function my_enqueue_scripts() {
>>    // De-register the core version of jQuery
>>    wp_deregister_script( 'jquery' );
>> 
>>    // Register our version of jQuery and our script that depends on that
>> version of jQuery
>>    wp_register_script( 'jquery', get_bloginfo( 'template_directory' ) .
>> '/js/jquery.js' );
>>    wp_register_script( 'my-jquery-dependent-script', get_bloginfo(
>> 'template_directory' ) . '/js/script.js', array( 'jquery' ) );
>> 
>>    // Enqueue the custom script
>>    wp_enqueue_script( 'my-jquery-dependent-script' );
>> }
>> add_action( 'wp_enqueue_scripts', 'my_enqueue_scripts', 10 );
>> 
>> 
>> Now, please keep in mind the following: someone else might come after you
>> and make changes on the theme, or poke around it. Please leave a note as to
>> why exactly you're using the exact version of jQuery that you're using, so
>> that the next person doesn't suffer too much :) And I assume that the
>> syntax that comes with jQuery 1.10 will stick around for longer, so at
>> least update your themes to use 1.10 and then use local version of 1.10
>> 
>> Nikola
>> 
>> 
>> On Wed, Oct 9, 2013 at 12:31 PM, Konrad Karpieszuk <kkarpieszuk at gmail.com
>>> wrote:
>> 
>>> Hi people
>>> 
>>> I think one of most important thing in wordpress is that it supports even
>>> old wordpress api functions (just throwing notice that this is depracated
>>> and you should consider to use new way of doing this thing). This very
>>> important argument when you propose to your customer to build website on
>>> wordpress: you can tell him that website will work for years, and he/she
>>> don't have to be affraid of making wordpress core upgrades.
>>> 
>>> But this what happens after every upgrade of wordpress which delivers new
>>> version of jQuery i can comment only in three letters: WTF?! :)
>>> 
>>> Today i upgraded one website of my customer to wp 3.6.1 which brings
>> jquery
>>> 1.10. And after that all sliders based on jquery tabs stopped to work.
>>> 
>>> I found reason: in my sliders i heavily use method 'selected' which in
>> new
>>> version of jQuery is called 'active' and i use 'fx' - now i should use
>>> 'show' option.
>>> 
>>> I changed that, but what with other websites? I developed tens of them
>>> where i am sure problem will be the same after wordpress upgrade.
>>> 
>>> And also few months ago i sam that jquery tabs method 'rotate' also was
>>> castrated. Then i found some plugin which brought it back.
>>> 
>>> 
>>> But this is silly! I include jquery and jquery-ui-tabs using
>>> wp_enqueue_script every time - in the way how codex.wordpress suggest to
>> do
>>> this. Now it looks that because of wp upgrades you cannot depend on this.
>>> 
>>> I cannot tell my customers not to upgrade wordpress, because of that
>>> animations will stop to work. Also i cannot charge thetm for my
>> additional
>>> work after every wordpress upgarde - this is not the way how i cooperate
>>> with customers.
>>> 
>>> I know that the problem is in jQuery way of development, not in
>> wordpress,
>>> but maybe you - wordpress core developers - have some idea how to deal
>> with
>>> it?
>>> 
>>> --
>>> (en) regards / (pl) pozdrawiam
>>> Konrad Karpieszuk
>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>> klient?w z Polski
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From kkarpieszuk at gmail.com  Wed Oct  9 13:05:23 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 15:05:23 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
 but this what happens with every upgrade of jquery...
In-Reply-To: <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
 <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
 <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>
Message-ID: <CAGhUOaBhdF7BdOnkuokTDjCza9QY=UkdxxiR_hS6+CuSsh9xYg@mail.gmail.com>

Looking at the jQuery documentation I don't  see what you mean. selected()
> still seems to be fine.


i am not talking about selected() but about this cosntruction:

$('#someDiv').tabs('selected', 1); // to select 2nd tab

which now is


$('#someDiv').tabs('active, 1);


and

$('#someDiv').tabs('option', 'fx', {...}); // to choose transition type
between tabs

which now is

$('#someDiv').tabs('option', 'show', {...});

they just changed names of option. i still dont understand why, what was
wrong with old names, and how bad was that, that now i have to just open
ftp connections to tens of my websites and change those two words. it looks
like some drunk man just did it for fun. and of course i can do this (it
will take a few hours to find every occurencies on every servers witb
wordpress) but i wonder what will be next.

few months ago jquery tabs lost support for option 'rotate', now this...

i really cannot in every half year write email for my customers (some of
them are really big fishes like city halls, music stars) and tell them:
"hey, remember when i told you that wordpress is so trustworthy and stable
platform for website, but you have to remember to upgrade wordpres core and
everything will be fine? i lied, it looks that again they changed something
that wordpress template, which i wrote for you will be broken after cms
upgrade. give me your ftp credentials and i will solve this, or stay with
older, security risk version" ;)

From mailing at markoheijnen.nl  Wed Oct  9 13:20:32 2013
From: mailing at markoheijnen.nl (Marko Heijnen)
Date: Wed, 9 Oct 2013 15:20:32 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
	but this what happens with every upgrade of jquery...
In-Reply-To: <CAGhUOaBhdF7BdOnkuokTDjCza9QY=UkdxxiR_hS6+CuSsh9xYg@mail.gmail.com>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
 <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
 <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>
 <CAGhUOaBhdF7BdOnkuokTDjCza9QY=UkdxxiR_hS6+CuSsh9xYg@mail.gmail.com>
Message-ID: <D06F9304-D236-47EA-B537-D90C21C4BD1B@markoheijnen.nl>

Ah okay. That has nothing to do with jQuery but with jQuery UI. What are two different things.
From there I can see what you mean. After reading http://jqueryui.com/upgrade-guide/1.9/ I see that they did change a lot of things and I can understand you now.

I do have to say that all the breakage could have been prevented because the changes you described happened already in the jQuery UI version of WordPress 3.5. in jQuery UI 1.9.
The deprecated functions got removed in WordPress 3.6 because of jQuery UI 1.10. Maybe we should have waited to upgrade jQuery UI until 3.7 or 3.8 but I guess in both situation your slider would have been broken then.

I can understand how you feel in this situation but using external libraries isn't always easy. WordPress can't prevent those changes in jQuery UI, so we also test it really well if we upgrade it.

Marko


Op 9 okt. 2013, om 15:05 heeft Konrad Karpieszuk <kkarpieszuk at gmail.com> het volgende geschreven:

> Looking at the jQuery documentation I don't  see what you mean. selected()
>> still seems to be fine.
> 
> 
> i am not talking about selected() but about this cosntruction:
> 
> $('#someDiv').tabs('selected', 1); // to select 2nd tab
> 
> which now is
> 
> 
> $('#someDiv').tabs('active, 1);
> 
> 
> and
> 
> $('#someDiv').tabs('option', 'fx', {...}); // to choose transition type
> between tabs
> 
> which now is
> 
> $('#someDiv').tabs('option', 'show', {...});
> 
> they just changed names of option. i still dont understand why, what was
> wrong with old names, and how bad was that, that now i have to just open
> ftp connections to tens of my websites and change those two words. it looks
> like some drunk man just did it for fun. and of course i can do this (it
> will take a few hours to find every occurencies on every servers witb
> wordpress) but i wonder what will be next.
> 
> few months ago jquery tabs lost support for option 'rotate', now this...
> 
> i really cannot in every half year write email for my customers (some of
> them are really big fishes like city halls, music stars) and tell them:
> "hey, remember when i told you that wordpress is so trustworthy and stable
> platform for website, but you have to remember to upgrade wordpres core and
> everything will be fine? i lied, it looks that again they changed something
> that wordpress template, which i wrote for you will be broken after cms
> upgrade. give me your ftp credentials and i will solve this, or stay with
> older, security risk version" ;)
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From ipstenu at ipstenu.org  Wed Oct  9 13:29:09 2013
From: ipstenu at ipstenu.org (Mika Epstein)
Date: Wed, 9 Oct 2013 06:29:09 -0700
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
Message-ID: <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>

Block it in your htacess first, actually. That's way easier.

Based on what info you gave us, we can't diagnosis anything. Check your SERVER logs. Did a file get edited or go missing? The problem is not that the file was being hit by millions of people, the problem is why did WP not know it was installed? Check your logs to see if anything happened to the DB. Was it unreadable? Did you add/remove a plugin recently? Did you upgrade?

Your mentioned changes to login and admin shouldn't cause anything like this, it's purely WP no longer thinking it was installed. So what have you done to diagnosis THAT? :)

> On Oct 9, 2013, at 2:19 AM, Konrad Karpieszuk <kkarpieszuk at gmail.com> wrote:
> 
> first of all i want to know *why*. :) i;ve got tens of wordpress sites and
> i will have more. i dont want to delete install.php every time (and after
> every wordpress upgrade). also maybe we have totally new way to hack
> wordpress sites (as you can see it is somehow working, because intruded
> broke my site)
> 
> 
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
> 
> 
> 
> On Wed, Oct 9, 2013 at 9:54 AM, Abdussamad Abdurrazzaq <
> abdussamad at abdussamad.com> wrote:
> 
>> If you are this worried you can always delete install.php.
>> 
>> 
>>> On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
>>> 
>>> ok, one more  info which i thought isn't relative to this problem, but
>>> maybe.
>>> 
>>> three months ago somebody start this famous ddos attack to wp-login.php at
>>> those websites. tens of times per second somebody tried to login into
>>> dashboard using random passwords. at beginning i resolved this in
>>> .htaccess
>>> by adding rules that nobody except from my ip address can acces to
>>> wp-login.php. but beacouse i have cowriter without permamnent IP address,
>>> this was not good solution
>>> 
>>> so few days ago i changed in files:
>>> wp-login.php
>>> wp-admin/index.php
>>> 
>>> first line from:
>>> 
>>> <?php
>>> 
>>> to
>>> 
>>> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony"); //
>>> 
>>> 
>>> it check if we got some 'secret' cookie and if cookie is absent it
>>> immadietly execute die().
>>> 
>>> It looks like good solution: wordpress core isnt started at all, server is
>>> happy.
>>> Can it be somehow related to this attack on wp-admin/install.php? i dont
>>> belive that this kind of change has something common with install script,
>>> but maybe i dont know wordpress core very good. Or maybe this attacker
>>> when
>>> saw that wp-login.php and wp-admin/index.php are secured started new way
>>> to
>>> attack? )or he or she started this long time ago but htaccess prevented
>>> from this)? all ip's from log are outside of Poland, but my regular
>>> visitors are almost only from Poland
>>> 
>>> 
>>> --
>>> (en) regards / (pl) pozdrawiam
>>> Konrad Karpieszuk
>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>> klient?w z Polski
>>> 
>>> 
>>> 
>>> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty <bryan at ibaku.net> wrote:
>>> 
>>> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
>>>> <kkarpieszuk at gmail.com> wrote:
>>>> 
>>>>> two things:
>>>>> 
>>>>> 1. my website is not so popular that in one second 20 person try to
>>>> connect
>>>> 
>>>>> 
>>>>> 2. as you can see in log, /wp-admin/install.php is added not always to
>>>> main
>>>> 
>>>>> domain but sometimes to single post urls (ie
>>>>> 
>>>>> /2013/10/wdrozenie-**zakupionego-szablonu-**
>>>>> wordpress/wp-admin/install.php
>>>>> ) This is not url which somebody type in address bar without reason
>>>> 
>>>> It's actually fairly likely that in the event that your DB has dropped
>>>> as Mika was suggesting, that one of your plugins or server
>>>> configuration was causing a redirect loop back to install.php itself
>>>> as well.
>>>> 
>>>> Most hack attempts don't intentionally claim a user agent as
>>>> "Feedfetcher-Google" (which was also seeing that install.php redirect
>>>> loop).
>>>> 
>>>> --
>>>> Regards,
>>>> Bryan Petty
>>>> ______________________________**_________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>> 
>>>> ______________________________**_________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>> 
>>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From mpwalsh8 at gmail.com  Wed Oct  9 15:22:24 2013
From: mpwalsh8 at gmail.com (Mike Walsh)
Date: Wed, 9 Oct 2013 11:22:24 -0400
Subject: [wp-hackers] Help with wp_mail(), PHPMailer, and CC vs BCC
In-Reply-To: <op.w4ogb7axr6yny2@fqdn.toscho.de>
References: <CAMg3evEvKPOv5SfrVGVp50+_W3uDw=P=jueG99F+2DZbOu88kQ@mail.gmail.com>
 <CAJLbkRbYmi7e1f8L4MprdakxA4ugMz=9U_OR901F1m_FwBjEtg@mail.gmail.com>
 <CAMg3evEa=z5RBxeWSb3CyX6UaNWOHc3Ac23OWM=AbwkWhoryQA@mail.gmail.com>
 <op.w4ogb7axr6yny2@fqdn.toscho.de>
Message-ID: <CAMg3evGwRikufs1hBtgN4hq1U2jpnoUkeriTPEKam6TG8bqG7w@mail.gmail.com>

This is perfect, thanks very much, it is exactly what I was looking for.

Mike


On Wed, Oct 9, 2013 at 3:56 AM, Thomas Scholz <info at toscho.de> wrote:

> Mike Walsh:
>
>  Is there a way to determine if wp_mail() has indeed been overloaded?
>>
>
> Use the Reflection API.
> <http://www.php.net/manual/en/**book.reflection.php<http://www.php.net/manual/en/book.reflection.php>
> >
>
> $reflection = new ReflectionFunction( 'wp_mail' );
> print $reflection->getFileName();
>
> Thomas
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>



-- 
Mike Walsh - mpwalsh8 at gmail.com

From kkarpieszuk at gmail.com  Wed Oct  9 15:49:36 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 17:49:36 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
 <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
Message-ID: <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>

hello Mika

i dont know if i understand you. I saw you logs in first email. Also i
asked server admin if something wrong was with server in time of this
problem. He said that this was day like every other, only on my server they
saw huge amount of i/o operations, They know that from 3 months somebody
attacks my wp-login.php and it looked like next attack (but this time on
install.php)


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 3:29 PM, Mika Epstein <ipstenu at ipstenu.org> wrote:

> Block it in your htacess first, actually. That's way easier.
>
> Based on what info you gave us, we can't diagnosis anything. Check your
> SERVER logs. Did a file get edited or go missing? The problem is not that
> the file was being hit by millions of people, the problem is why did WP not
> know it was installed? Check your logs to see if anything happened to the
> DB. Was it unreadable? Did you add/remove a plugin recently? Did you
> upgrade?
>
> Your mentioned changes to login and admin shouldn't cause anything like
> this, it's purely WP no longer thinking it was installed. So what have you
> done to diagnosis THAT? :)
>
> > On Oct 9, 2013, at 2:19 AM, Konrad Karpieszuk <kkarpieszuk at gmail.com>
> wrote:
> >
> > first of all i want to know *why*. :) i;ve got tens of wordpress sites
> and
> > i will have more. i dont want to delete install.php every time (and after
> > every wordpress upgrade). also maybe we have totally new way to hack
> > wordpress sites (as you can see it is somehow working, because intruded
> > broke my site)
> >
> >
> > --
> > (en) regards / (pl) pozdrawiam
> > Konrad Karpieszuk
> > http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> > klient?w z Polski
> >
> >
> >
> > On Wed, Oct 9, 2013 at 9:54 AM, Abdussamad Abdurrazzaq <
> > abdussamad at abdussamad.com> wrote:
> >
> >> If you are this worried you can always delete install.php.
> >>
> >>
> >>> On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
> >>>
> >>> ok, one more  info which i thought isn't relative to this problem, but
> >>> maybe.
> >>>
> >>> three months ago somebody start this famous ddos attack to
> wp-login.php at
> >>> those websites. tens of times per second somebody tried to login into
> >>> dashboard using random passwords. at beginning i resolved this in
> >>> .htaccess
> >>> by adding rules that nobody except from my ip address can acces to
> >>> wp-login.php. but beacouse i have cowriter without permamnent IP
> address,
> >>> this was not good solution
> >>>
> >>> so few days ago i changed in files:
> >>> wp-login.php
> >>> wp-admin/index.php
> >>>
> >>> first line from:
> >>>
> >>> <?php
> >>>
> >>> to
> >>>
> >>> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony"); //
> >>>
> >>>
> >>> it check if we got some 'secret' cookie and if cookie is absent it
> >>> immadietly execute die().
> >>>
> >>> It looks like good solution: wordpress core isnt started at all,
> server is
> >>> happy.
> >>> Can it be somehow related to this attack on wp-admin/install.php? i
> dont
> >>> belive that this kind of change has something common with install
> script,
> >>> but maybe i dont know wordpress core very good. Or maybe this attacker
> >>> when
> >>> saw that wp-login.php and wp-admin/index.php are secured started new
> way
> >>> to
> >>> attack? )or he or she started this long time ago but htaccess prevented
> >>> from this)? all ip's from log are outside of Poland, but my regular
> >>> visitors are almost only from Poland
> >>>
> >>>
> >>> --
> >>> (en) regards / (pl) pozdrawiam
> >>> Konrad Karpieszuk
> >>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> >>> klient?w z Polski
> >>>
> >>>
> >>>
> >>> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty <bryan at ibaku.net> wrote:
> >>>
> >>> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
> >>>> <kkarpieszuk at gmail.com> wrote:
> >>>>
> >>>>> two things:
> >>>>>
> >>>>> 1. my website is not so popular that in one second 20 person try to
> >>>> connect
> >>>>
> >>>>>
> >>>>> 2. as you can see in log, /wp-admin/install.php is added not always
> to
> >>>> main
> >>>>
> >>>>> domain but sometimes to single post urls (ie
> >>>>>
> >>>>> /2013/10/wdrozenie-**zakupionego-szablonu-**
> >>>>> wordpress/wp-admin/install.php
> >>>>> ) This is not url which somebody type in address bar without reason
> >>>>
> >>>> It's actually fairly likely that in the event that your DB has dropped
> >>>> as Mika was suggesting, that one of your plugins or server
> >>>> configuration was causing a redirect loop back to install.php itself
> >>>> as well.
> >>>>
> >>>> Most hack attempts don't intentionally claim a user agent as
> >>>> "Feedfetcher-Google" (which was also seeing that install.php redirect
> >>>> loop).
> >>>>
> >>>> --
> >>>> Regards,
> >>>> Bryan Petty
> >>>> ______________________________**_________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> >>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
> http://lists.automattic.com/mailman/listinfo/wp-hackers>
> >>>>
> >>>> ______________________________**_________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> >>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
> http://lists.automattic.com/mailman/listinfo/wp-hackers>
> >>>
> >>> ______________________________**_________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> >> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
> http://lists.automattic.com/mailman/listinfo/wp-hackers>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From kkarpieszuk at gmail.com  Wed Oct  9 15:58:31 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 17:58:31 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
 but this what happens with every upgrade of jquery...
In-Reply-To: <D06F9304-D236-47EA-B537-D90C21C4BD1B@markoheijnen.nl>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
 <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
 <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>
 <CAGhUOaBhdF7BdOnkuokTDjCza9QY=UkdxxiR_hS6+CuSsh9xYg@mail.gmail.com>
 <D06F9304-D236-47EA-B537-D90C21C4BD1B@markoheijnen.nl>
Message-ID: <CAGhUOaCh=tVSmXFO--tHkjVby2qOk6BuJXbyy+W5+LofQhyR7w@mail.gmail.com>

ok, thank you for this answer, really!

but what can i do now? i still have some websites not upgraded and now i
know that when i do this, this will break .tabs() on them. i see two
solution:

- upgrade and change theme code (all occurencies of 'selected into
'active'), this will take me a lot of time

- create plugin with .js which will add those things. but... i dont know
how :) can anyone give me a tip how to add option to .tabs() which will
just delegate things to new one? i know it is not wordpress question, but
maybe somebody know exact link to help



--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 3:20 PM, Marko Heijnen <mailing at markoheijnen.nl>wrote:

> Ah okay. That has nothing to do with jQuery but with jQuery UI. What are
> two different things.
> From there I can see what you mean. After reading
> http://jqueryui.com/upgrade-guide/1.9/ I see that they did change a lot
> of things and I can understand you now.
>
> I do have to say that all the breakage could have been prevented because
> the changes you described happened already in the jQuery UI version of
> WordPress 3.5. in jQuery UI 1.9.
> The deprecated functions got removed in WordPress 3.6 because of jQuery UI
> 1.10. Maybe we should have waited to upgrade jQuery UI until 3.7 or 3.8 but
> I guess in both situation your slider would have been broken then.
>
> I can understand how you feel in this situation but using external
> libraries isn't always easy. WordPress can't prevent those changes in
> jQuery UI, so we also test it really well if we upgrade it.
>
> Marko
>
>
> Op 9 okt. 2013, om 15:05 heeft Konrad Karpieszuk <kkarpieszuk at gmail.com>
> het volgende geschreven:
>
> > Looking at the jQuery documentation I don't  see what you mean.
> selected()
> >> still seems to be fine.
> >
> >
> > i am not talking about selected() but about this cosntruction:
> >
> > $('#someDiv').tabs('selected', 1); // to select 2nd tab
> >
> > which now is
> >
> >
> > $('#someDiv').tabs('active, 1);
> >
> >
> > and
> >
> > $('#someDiv').tabs('option', 'fx', {...}); // to choose transition type
> > between tabs
> >
> > which now is
> >
> > $('#someDiv').tabs('option', 'show', {...});
> >
> > they just changed names of option. i still dont understand why, what was
> > wrong with old names, and how bad was that, that now i have to just open
> > ftp connections to tens of my websites and change those two words. it
> looks
> > like some drunk man just did it for fun. and of course i can do this (it
> > will take a few hours to find every occurencies on every servers witb
> > wordpress) but i wonder what will be next.
> >
> > few months ago jquery tabs lost support for option 'rotate', now this...
> >
> > i really cannot in every half year write email for my customers (some of
> > them are really big fishes like city halls, music stars) and tell them:
> > "hey, remember when i told you that wordpress is so trustworthy and
> stable
> > platform for website, but you have to remember to upgrade wordpres core
> and
> > everything will be fine? i lied, it looks that again they changed
> something
> > that wordpress template, which i wrote for you will be broken after cms
> > upgrade. give me your ftp credentials and i will solve this, or stay with
> > older, security risk version" ;)
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From ipstenu at ipstenu.org  Wed Oct  9 16:39:50 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Wed, 09 Oct 2013 09:39:50 -0700
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
 <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
 <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>
Message-ID: <525586D6.10706@ipstenu.org>

It's not the next attack. It's your WP site not seeing it's installed. 
This means that the DB tables weren't accessible for some reason OR the 
wp-config.php was unreadable.

Konrad Karpieszuk wrote:
>
> hello Mika
>
> i dont know if i understand you. I saw you logs in first email. Also i
> asked server admin if something wrong was with server in time of this
> problem. He said that this was day like every other, only on my server 
> they
> saw huge amount of i/o operations, They know that from 3 months somebody
> attacks my wp-login.php and it looked like next attack (but this time on
> install.php)
>
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
>
>
>
> On Wed, Oct 9, 2013 at 3:29 PM, Mika Epstein<ipstenu at ipstenu.org> wrote:
>
>>
>> Block it in your htacess first, actually. That's way easier.
>>
>> Based on what info you gave us, we can't diagnosis anything. Check your
>> SERVER logs. Did a file get edited or go missing? The problem is not that
>> the file was being hit by millions of people, the problem is why did 
>> WP not
>> know it was installed? Check your logs to see if anything happened to the
>> DB. Was it unreadable? Did you add/remove a plugin recently? Did you
>> upgrade?
>>
>> Your mentioned changes to login and admin shouldn't cause anything like
>> this, it's purely WP no longer thinking it was installed. So what 
>> have you
>> done to diagnosis THAT? :)
>>
>>>
>>> On Oct 9, 2013, at 2:19 AM, Konrad Karpieszuk<kkarpieszuk at gmail.com>
>>
>> wrote:
>>>
>>> first of all i want to know *why*. :) i;ve got tens of wordpress sites
>>
>> and
>>>
>>> i will have more. i dont want to delete install.php every time (and 
>>> after
>>> every wordpress upgrade). also maybe we have totally new way to hack
>>> wordpress sites (as you can see it is somehow working, because intruded
>>> broke my site)
>>>
>>>
>>> --
>>> (en) regards / (pl) pozdrawiam
>>> Konrad Karpieszuk
>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>> klient?w z Polski
>>>
>>>
>>>
>>> On Wed, Oct 9, 2013 at 9:54 AM, Abdussamad Abdurrazzaq<
>>> abdussamad at abdussamad.com> wrote:
>>>
>>>>
>>>> If you are this worried you can always delete install.php.
>>>>
>>>>
>>>>>
>>>>> On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
>>>>>
>>>>> ok, one more info which i thought isn't relative to this problem, but
>>>>> maybe.
>>>>>
>>>>> three months ago somebody start this famous ddos attack to
>>>>
>>>
>>
>> wp-login.php at
>>>
>>>>
>>>>>
>>>>> those websites. tens of times per second somebody tried to login into
>>>>> dashboard using random passwords. at beginning i resolved this in
>>>>> .htaccess
>>>>> by adding rules that nobody except from my ip address can acces to
>>>>> wp-login.php. but beacouse i have cowriter without permamnent IP
>>>>
>>>
>>
>> address,
>>>
>>>>
>>>>>
>>>>> this was not good solution
>>>>>
>>>>> so few days ago i changed in files:
>>>>> wp-login.php
>>>>> wp-admin/index.php
>>>>>
>>>>> first line from:
>>>>>
>>>>> <?php
>>>>>
>>>>> to
>>>>>
>>>>> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep 
>>>>> zabroniony"); //
>>>>>
>>>>>
>>>>> it check if we got some 'secret' cookie and if cookie is absent it
>>>>> immadietly execute die().
>>>>>
>>>>> It looks like good solution: wordpress core isnt started at all,
>>>>
>>>
>>
>> server is
>>>
>>>>
>>>>>
>>>>> happy.
>>>>> Can it be somehow related to this attack on wp-admin/install.php? i
>>>>
>>>
>>
>> dont
>>>
>>>>
>>>>>
>>>>> belive that this kind of change has something common with install
>>>>
>>>
>>
>> script,
>>>
>>>>
>>>>>
>>>>> but maybe i dont know wordpress core very good. Or maybe this attacker
>>>>> when
>>>>> saw that wp-login.php and wp-admin/index.php are secured started new
>>>>
>>>
>>
>> way
>>>
>>>>
>>>>>
>>>>> to
>>>>> attack? )or he or she started this long time ago but htaccess 
>>>>> prevented
>>>>> from this)? all ip's from log are outside of Poland, but my regular
>>>>> visitors are almost only from Poland
>>>>>
>>>>>
>>>>> --
>>>>> (en) regards / (pl) pozdrawiam
>>>>> Konrad Karpieszuk
>>>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>>>> klient?w z Polski
>>>>>
>>>>>
>>>>>
>>>>> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty<bryan at ibaku.net> wrote:
>>>>>
>>>>> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
>>>>>>
>>>>>> <kkarpieszuk at gmail.com> wrote:
>>>>>>
>>>>>>>
>>>>>>> two things:
>>>>>>>
>>>>>>> 1. my website is not so popular that in one second 20 person try to
>>>>>>
>>>>>> connect
>>>>>>
>>>>>>>
>>>>>>> 2. as you can see in log, /wp-admin/install.php is added not always
>>>>>>
>>>>>
>>>>
>>>
>>
>> to
>>>
>>>>
>>>>>
>>>>>>
>>>>>> main
>>>>>>
>>>>>>>
>>>>>>> domain but sometimes to single post urls (ie
>>>>>>>
>>>>>>> /2013/10/wdrozenie-**zakupionego-szablonu-**
>>>>>>> wordpress/wp-admin/install.php
>>>>>>> ) This is not url which somebody type in address bar without reason
>>>>>>
>>>>>> It's actually fairly likely that in the event that your DB has 
>>>>>> dropped
>>>>>> as Mika was suggesting, that one of your plugins or server
>>>>>> configuration was causing a redirect loop back to install.php itself
>>>>>> as well.
>>>>>>
>>>>>> Most hack attempts don't intentionally claim a user agent as
>>>>>> "Feedfetcher-Google" (which was also seeing that install.php redirect
>>>>>> loop).
>>>>>>
>>>>>> --
>>>>>> Regards,
>>>>>> Bryan Petty
>>>>>> ______________________________**_________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.**com<wp-hackers at lists.automattic.com>
>>>>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
>>>>>
>>>>
>>>
>>
>> http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>>>
>>>>>
>>>>>>
>>>>>> ______________________________**_________________
>>>>>
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.**com<wp-hackers at lists.automattic.com>
>>>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
>>>>
>>>
>>
>> http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>>>
>>>>>
>>>>> ______________________________**_________________
>>>>
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.**com<wp-hackers at lists.automattic.com>
>>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<
>>>
>>
>> http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From kkarpieszuk at gmail.com  Wed Oct  9 16:58:45 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 18:58:45 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <525586D6.10706@ipstenu.org>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
 <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
 <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>
 <525586D6.10706@ipstenu.org>
Message-ID: <CAGhUOaAwwXt640Nnzjb7Cfh9Q4gFbXn7mEGi9Yjd3=aSSNm1mw@mail.gmail.com>

ok, but why? server admin told me (and i have to trust him) that everything
was ok with connection to DB. or even if it wasnt... why somebody tried to
connect to file /wp-admin/install.php (i still belive that this was not
accident).

what do i think.

i think that somebody in purpose made ddos attack because somehow (maybe he
tested this before) he knewed that during huge ddos attack wordpress will
'lost its mind'. during huge ddos attack server as hardware stops to play
correctly and sometimes for php command like "if
(!file_exists('wp-config.php'))" will not be able to check if file really
exists, will return true (there is now file wp-config.php) and php will
delegate chain of command to installation file. and then hacker will be
able to reinstall my wordpress with his credential



--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 6:39 PM, Mika A Epstein <ipstenu at ipstenu.org> wrote:

> It's not the next attack. It's your WP site not seeing it's installed.
> This means that the DB tables weren't accessible for some reason OR the
> wp-config.php was unreadable.
>
>
> Konrad Karpieszuk wrote:
>
>>
>> hello Mika
>>
>> i dont know if i understand you. I saw you logs in first email. Also i
>> asked server admin if something wrong was with server in time of this
>> problem. He said that this was day like every other, only on my server
>> they
>> saw huge amount of i/o operations, They know that from 3 months somebody
>> attacks my wp-login.php and it looked like next attack (but this time on
>> install.php)
>>
>>
>> --
>> (en) regards / (pl) pozdrawiam
>> Konrad Karpieszuk
>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>> klient?w z Polski
>>
>>
>>
>> On Wed, Oct 9, 2013 at 3:29 PM, Mika Epstein<ipstenu at ipstenu.org> wrote:
>>
>>
>>> Block it in your htacess first, actually. That's way easier.
>>>
>>> Based on what info you gave us, we can't diagnosis anything. Check your
>>> SERVER logs. Did a file get edited or go missing? The problem is not that
>>> the file was being hit by millions of people, the problem is why did WP
>>> not
>>> know it was installed? Check your logs to see if anything happened to the
>>> DB. Was it unreadable? Did you add/remove a plugin recently? Did you
>>> upgrade?
>>>
>>> Your mentioned changes to login and admin shouldn't cause anything like
>>> this, it's purely WP no longer thinking it was installed. So what have
>>> you
>>> done to diagnosis THAT? :)
>>>
>>>
>>>> On Oct 9, 2013, at 2:19 AM, Konrad Karpieszuk<kkarpieszuk at gmail.**com<kkarpieszuk at gmail.com>
>>>> >
>>>>
>>>
>>> wrote:
>>>
>>>>
>>>> first of all i want to know *why*. :) i;ve got tens of wordpress sites
>>>>
>>>
>>> and
>>>
>>>>
>>>> i will have more. i dont want to delete install.php every time (and
>>>> after
>>>> every wordpress upgrade). also maybe we have totally new way to hack
>>>> wordpress sites (as you can see it is somehow working, because intruded
>>>> broke my site)
>>>>
>>>>
>>>> --
>>>> (en) regards / (pl) pozdrawiam
>>>> Konrad Karpieszuk
>>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>>> klient?w z Polski
>>>>
>>>>
>>>>
>>>> On Wed, Oct 9, 2013 at 9:54 AM, Abdussamad Abdurrazzaq<
>>>> abdussamad at abdussamad.com> wrote:
>>>>
>>>>
>>>>> If you are this worried you can always delete install.php.
>>>>>
>>>>>
>>>>>
>>>>>> On 10/09/2013 12:35 PM, Konrad Karpieszuk wrote:
>>>>>>
>>>>>> ok, one more info which i thought isn't relative to this problem, but
>>>>>> maybe.
>>>>>>
>>>>>> three months ago somebody start this famous ddos attack to
>>>>>>
>>>>>
>>>>>
>>>>
>>> wp-login.php at
>>>
>>>>
>>>>
>>>>>
>>>>>> those websites. tens of times per second somebody tried to login into
>>>>>> dashboard using random passwords. at beginning i resolved this in
>>>>>> .htaccess
>>>>>> by adding rules that nobody except from my ip address can acces to
>>>>>> wp-login.php. but beacouse i have cowriter without permamnent IP
>>>>>>
>>>>>
>>>>>
>>>>
>>> address,
>>>
>>>>
>>>>
>>>>>
>>>>>> this was not good solution
>>>>>>
>>>>>> so few days ago i changed in files:
>>>>>> wp-login.php
>>>>>> wp-admin/index.php
>>>>>>
>>>>>> first line from:
>>>>>>
>>>>>> <?php
>>>>>>
>>>>>> to
>>>>>>
>>>>>> <?php if ($_COOKIE["superauth"] != "yep") exit("dostep zabroniony");
>>>>>> //
>>>>>>
>>>>>>
>>>>>> it check if we got some 'secret' cookie and if cookie is absent it
>>>>>> immadietly execute die().
>>>>>>
>>>>>> It looks like good solution: wordpress core isnt started at all,
>>>>>>
>>>>>
>>>>>
>>>>
>>> server is
>>>
>>>>
>>>>
>>>>>
>>>>>> happy.
>>>>>> Can it be somehow related to this attack on wp-admin/install.php? i
>>>>>>
>>>>>
>>>>>
>>>>
>>> dont
>>>
>>>>
>>>>
>>>>>
>>>>>> belive that this kind of change has something common with install
>>>>>>
>>>>>
>>>>>
>>>>
>>> script,
>>>
>>>>
>>>>
>>>>>
>>>>>> but maybe i dont know wordpress core very good. Or maybe this attacker
>>>>>> when
>>>>>> saw that wp-login.php and wp-admin/index.php are secured started new
>>>>>>
>>>>>
>>>>>
>>>>
>>> way
>>>
>>>>
>>>>
>>>>>
>>>>>> to
>>>>>> attack? )or he or she started this long time ago but htaccess
>>>>>> prevented
>>>>>> from this)? all ip's from log are outside of Poland, but my regular
>>>>>> visitors are almost only from Poland
>>>>>>
>>>>>>
>>>>>> --
>>>>>> (en) regards / (pl) pozdrawiam
>>>>>> Konrad Karpieszuk
>>>>>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>>>>>> klient?w z Polski
>>>>>>
>>>>>>
>>>>>>
>>>>>> On Wed, Oct 9, 2013 at 8:55 AM, Bryan Petty<bryan at ibaku.net> wrote:
>>>>>>
>>>>>> On Wed, Oct 9, 2013 at 12:39 AM, Konrad Karpieszuk
>>>>>>
>>>>>>>
>>>>>>> <kkarpieszuk at gmail.com> wrote:
>>>>>>>
>>>>>>>
>>>>>>>> two things:
>>>>>>>>
>>>>>>>> 1. my website is not so popular that in one second 20 person try to
>>>>>>>>
>>>>>>>
>>>>>>> connect
>>>>>>>
>>>>>>>
>>>>>>>> 2. as you can see in log, /wp-admin/install.php is added not always
>>>>>>>>
>>>>>>>
>>>>>>>
>>>>>>
>>>>>
>>>>
>>> to
>>>
>>>>
>>>>
>>>>>
>>>>>>
>>>>>>> main
>>>>>>>
>>>>>>>
>>>>>>>> domain but sometimes to single post urls (ie
>>>>>>>>
>>>>>>>> /2013/10/wdrozenie-****zakupionego-szablonu-**
>>>>>>>> wordpress/wp-admin/install.php
>>>>>>>> ) This is not url which somebody type in address bar without reason
>>>>>>>>
>>>>>>>
>>>>>>> It's actually fairly likely that in the event that your DB has
>>>>>>> dropped
>>>>>>> as Mika was suggesting, that one of your plugins or server
>>>>>>> configuration was causing a redirect loop back to install.php itself
>>>>>>> as well.
>>>>>>>
>>>>>>> Most hack attempts don't intentionally claim a user agent as
>>>>>>> "Feedfetcher-Google" (which was also seeing that install.php redirect
>>>>>>> loop).
>>>>>>>
>>>>>>> --
>>>>>>> Regards,
>>>>>>> Bryan Petty
>>>>>>> ______________________________****_________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.****com<wp-hackers at lists.**
>>>>>>> automattic.com <wp-hackers at lists.automattic.com>>
>>>>>>> http://lists.automattic.com/****mailman/listinfo/wp-hackers<http://lists.automattic.com/**mailman/listinfo/wp-hackers>
>>>>>>> <
>>>>>>>
>>>>>>
>>>>>>
>>>>>
>>>>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>> >
>>>
>>>>
>>>>
>>>>>
>>>>>>
>>>>>>> ______________________________****_________________
>>>>>>>
>>>>>>
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.****com<wp-hackers at lists.**automattic.com<wp-hackers at lists.automattic.com>
>>>>>> >
>>>>>> http://lists.automattic.com/****mailman/listinfo/wp-hackers<http://lists.automattic.com/**mailman/listinfo/wp-hackers>
>>>>>> <
>>>>>>
>>>>>
>>>>>
>>>>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>> >
>>>
>>>>
>>>>
>>>>>
>>>>>> ______________________________****_________________
>>>>>>
>>>>>
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.****com<wp-hackers at lists.**automattic.com<wp-hackers at lists.automattic.com>
>>>>> >
>>>>> http://lists.automattic.com/****mailman/listinfo/wp-hackers<http://lists.automattic.com/**mailman/listinfo/wp-hackers>
>>>>> <
>>>>>
>>>>
>>>>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>> >
>>>
>>>>
>>>> ______________________________**_________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>>
>>>
>>> ______________________________**_________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>>
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From ipstenu at ipstenu.org  Wed Oct  9 17:35:47 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Wed, 09 Oct 2013 10:35:47 -0700
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <CAGhUOaAwwXt640Nnzjb7Cfh9Q4gFbXn7mEGi9Yjd3=aSSNm1mw@mail.gmail.com>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
 <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
 <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>
 <525586D6.10706@ipstenu.org>
 <CAGhUOaAwwXt640Nnzjb7Cfh9Q4gFbXn7mEGi9Yjd3=aSSNm1mw@mail.gmail.com>
Message-ID: <525593F3.8000207@ipstenu.org>

People tried to access the file because WordPress defaults to that file 
when it thinks it's not installed.

Does that make sense? WP couldn't tell it was installed, and thus 
assumed it was NOT and people who visted wanted to install. That's the 
only logical explanation for the URLs you gave us. Like ttrss pulling 
the install.php? That logically happens when it's actually trying to get 
a feed, but WP says "Oh hai! I'm not installed!"

This is 100% expected behavior :)

I'm very certain it's not a hack (nb I deal with hacked sites for WP at 
my company every single day, it's my job, I'm pretty familiar with how 
hacked WP behaves). Or rather, if it IS a hack, it's not that people are 
attacking install.php, it's that they somehow made your wp-config.php go 
away, or the DB tables.

Honestly though, what we need to know (and what you don't know) is what 
did the install.php page say when you hit it? Did it say "no DB" or 
"There's no config file..." If you go to /wp-admin/install.php now, 
you'll see 'Hai! Already installed!' And I think that was NOT what 
people saw. If it was? Then MAYBE you have a brute force attempt (which 
is not a hack BTW). But I think not.

I don't think your server admin is wrong, but I do think that you don't 
clearly understand how WP handles this sort of thing, so there's some 
confusion in explanations to the admin :/

> Konrad Karpieszuk <mailto:kkarpieszuk at gmail.com>
> October 9, 2013 9:58 AM
> ok, but why? server admin told me (and i have to trust him) that 
> everything
> was ok with connection to DB. or even if it wasnt... why somebody tried to
> connect to file /wp-admin/install.php (i still belive that this was not
> accident).
>
> what do i think.
>
> i think that somebody in purpose made ddos attack because somehow 
> (maybe he
> tested this before) he knewed that during huge ddos attack wordpress will
> 'lost its mind'. during huge ddos attack server as hardware stops to play
> correctly and sometimes for php command like "if
> (!file_exists('wp-config.php'))" will not be able to check if file really
> exists, will return true (there is now file wp-config.php) and php will
> delegate chain of command to installation file. and then hacker will be
> able to reinstall my wordpress with his credential
>
>
>
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
>
>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
> Mika A Epstein <mailto:ipstenu at ipstenu.org>
> October 9, 2013 9:39 AM
> It's not the next attack. It's your WP site not seeing it's installed. 
> This means that the DB tables weren't accessible for some reason OR 
> the wp-config.php was unreadable.
>
> Konrad Karpieszuk wrote:
> Mika Epstein <mailto:ipstenu at ipstenu.org>
> October 9, 2013 6:29 AM
> Block it in your htacess first, actually. That's way easier.
>
> Based on what info you gave us, we can't diagnosis anything. Check 
> your SERVER logs. Did a file get edited or go missing? The problem is 
> not that the file was being hit by millions of people, the problem is 
> why did WP not know it was installed? Check your logs to see if 
> anything happened to the DB. Was it unreadable? Did you add/remove a 
> plugin recently? Did you upgrade?
>
> Your mentioned changes to login and admin shouldn't cause anything 
> like this, it's purely WP no longer thinking it was installed. So what 
> have you done to diagnosis THAT? :)
>
> Mika A Epstein <mailto:ipstenu at ipstenu.org>
> October 8, 2013 11:47 AM
> I think causality is the other way around.
>
> People were hitting install.php so much because the wizard was 
> showing. Was your SQL server glitching?
>
>

-- 
Mika A Epstein (aka Ipstenu)
http://ipstenu.org | http://halfelf.org


From mailing at markoheijnen.nl  Wed Oct  9 17:40:27 2013
From: mailing at markoheijnen.nl (Marko Heijnen)
Date: Wed, 9 Oct 2013 19:40:27 +0200
Subject: [wp-hackers] i love wordpress support for php functions,
	but this what happens with every upgrade of jquery...
In-Reply-To: <CAGhUOaCh=tVSmXFO--tHkjVby2qOk6BuJXbyy+W5+LofQhyR7w@mail.gmail.com>
References: <CAGhUOaD247y53PZgw3wvZua5TKKDRm_oUDOmJ+vuoWHhWNDxsg@mail.gmail.com>
 <CAOwx47d0rcmW_WKMj8w3VxihP2QqcZTv1PeQya=cJKwbBzfN-g@mail.gmail.com>
 <CAGhUOaCJLs_cjR--WNi5f=sQWfQtjq6UTsXJjP_8L85aoaQmhQ@mail.gmail.com>
 <DB969E61-1C39-4DAA-B754-56E851F943CC@markoheijnen.nl>
 <CAGhUOaBhdF7BdOnkuokTDjCza9QY=UkdxxiR_hS6+CuSsh9xYg@mail.gmail.com>
 <D06F9304-D236-47EA-B537-D90C21C4BD1B@markoheijnen.nl>
 <CAGhUOaCh=tVSmXFO--tHkjVby2qOk6BuJXbyy+W5+LofQhyR7w@mail.gmail.com>
Message-ID: <CB6073E1-1F00-451F-A45B-D02655194896@markoheijnen.nl>

In the current case you can already update the code if the site is on WordPress 3.5 since that has already the new naming.
The second thing I can't help you out with. You can look at the link I send you earlier for the rotate code. Maybe that one is helpful.

Marko


Op 9 okt. 2013, om 17:58 heeft Konrad Karpieszuk <kkarpieszuk at gmail.com> het volgende geschreven:

> ok, thank you for this answer, really!
> 
> but what can i do now? i still have some websites not upgraded and now i
> know that when i do this, this will break .tabs() on them. i see two
> solution:
> 
> - upgrade and change theme code (all occurencies of 'selected into
> 'active'), this will take me a lot of time
> 
> - create plugin with .js which will add those things. but... i dont know
> how :) can anyone give me a tip how to add option to .tabs() which will
> just delegate things to new one? i know it is not wordpress question, but
> maybe somebody know exact link to help
> 
> 
> 
> --
> (en) regards / (pl) pozdrawiam
> Konrad Karpieszuk
> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
> klient?w z Polski
> 
> 
> 
> On Wed, Oct 9, 2013 at 3:20 PM, Marko Heijnen <mailing at markoheijnen.nl>wrote:
> 
>> Ah okay. That has nothing to do with jQuery but with jQuery UI. What are
>> two different things.
>> From there I can see what you mean. After reading
>> http://jqueryui.com/upgrade-guide/1.9/ I see that they did change a lot
>> of things and I can understand you now.
>> 
>> I do have to say that all the breakage could have been prevented because
>> the changes you described happened already in the jQuery UI version of
>> WordPress 3.5. in jQuery UI 1.9.
>> The deprecated functions got removed in WordPress 3.6 because of jQuery UI
>> 1.10. Maybe we should have waited to upgrade jQuery UI until 3.7 or 3.8 but
>> I guess in both situation your slider would have been broken then.
>> 
>> I can understand how you feel in this situation but using external
>> libraries isn't always easy. WordPress can't prevent those changes in
>> jQuery UI, so we also test it really well if we upgrade it.
>> 
>> Marko
>> 
>> 
>> Op 9 okt. 2013, om 15:05 heeft Konrad Karpieszuk <kkarpieszuk at gmail.com>
>> het volgende geschreven:
>> 
>>> Looking at the jQuery documentation I don't  see what you mean.
>> selected()
>>>> still seems to be fine.
>>> 
>>> 
>>> i am not talking about selected() but about this cosntruction:
>>> 
>>> $('#someDiv').tabs('selected', 1); // to select 2nd tab
>>> 
>>> which now is
>>> 
>>> 
>>> $('#someDiv').tabs('active, 1);
>>> 
>>> 
>>> and
>>> 
>>> $('#someDiv').tabs('option', 'fx', {...}); // to choose transition type
>>> between tabs
>>> 
>>> which now is
>>> 
>>> $('#someDiv').tabs('option', 'show', {...});
>>> 
>>> they just changed names of option. i still dont understand why, what was
>>> wrong with old names, and how bad was that, that now i have to just open
>>> ftp connections to tens of my websites and change those two words. it
>> looks
>>> like some drunk man just did it for fun. and of course i can do this (it
>>> will take a few hours to find every occurencies on every servers witb
>>> wordpress) but i wonder what will be next.
>>> 
>>> few months ago jquery tabs lost support for option 'rotate', now this...
>>> 
>>> i really cannot in every half year write email for my customers (some of
>>> them are really big fishes like city halls, music stars) and tell them:
>>> "hey, remember when i told you that wordpress is so trustworthy and
>> stable
>>> platform for website, but you have to remember to upgrade wordpres core
>> and
>>> everything will be fine? i lied, it looks that again they changed
>> something
>>> that wordpress template, which i wrote for you will be broken after cms
>>> upgrade. give me your ftp credentials and i will solve this, or stay with
>>> older, security risk version" ;)
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From kkarpieszuk at gmail.com  Wed Oct  9 18:54:38 2013
From: kkarpieszuk at gmail.com (Konrad Karpieszuk)
Date: Wed, 9 Oct 2013 20:54:38 +0200
Subject: [wp-hackers] attack on wp-admin/install.php
In-Reply-To: <525593F3.8000207@ipstenu.org>
References: <CAGhUOaDh4YFdbou=UTy7tzdTj5tR+2EBvuejHUkhv=keVQyy+A@mail.gmail.com>
 <5254532A.9030100@ipstenu.org>
 <CAGhUOaChZ3EMp5+PRkb1GciDsGqRZw3U6kBYhk4SOugYebr+Eg@mail.gmail.com>
 <CAKB8V+oXqdYBFxBA0g7ubH15tL4mUK_S+yc_Wr4QVy5DGH0wGg@mail.gmail.com>
 <CAGhUOaA9D4SRt3ykpFLpChancdc8Z5Hndm4Kc4TfL54X5dZOLw@mail.gmail.com>
 <52550BD0.5010507@abdussamad.com>
 <CAGhUOaCm-5-QsyWdHuuW77C=H2zskGM7Jk1owqXVptSna1Fuag@mail.gmail.com>
 <A67FC866-69B2-466E-8A42-BD52861B5EE4@ipstenu.org>
 <CAGhUOaBjvBkYO_1LVc8obXxB_DEzyyg0G1nPpmgvfcrVS339HQ@mail.gmail.com>
 <525586D6.10706@ipstenu.org>
 <CAGhUOaAwwXt640Nnzjb7Cfh9Q4gFbXn7mEGi9Yjd3=aSSNm1mw@mail.gmail.com>
 <525593F3.8000207@ipstenu.org>
Message-ID: <CAGhUOaCSoHP1rgcjBLuv4nfOFgyv2f2na-0znQRyz4G7zMM66Q@mail.gmail.com>

ok, thank you for those explanations :)


--
(en) regards / (pl) pozdrawiam
Konrad Karpieszuk
http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
klient?w z Polski



On Wed, Oct 9, 2013 at 7:35 PM, Mika A Epstein <ipstenu at ipstenu.org> wrote:

> People tried to access the file because WordPress defaults to that file
> when it thinks it's not installed.
>
> Does that make sense? WP couldn't tell it was installed, and thus assumed
> it was NOT and people who visted wanted to install. That's the only logical
> explanation for the URLs you gave us. Like ttrss pulling the install.php?
> That logically happens when it's actually trying to get a feed, but WP says
> "Oh hai! I'm not installed!"
>
> This is 100% expected behavior :)
>
> I'm very certain it's not a hack (nb I deal with hacked sites for WP at my
> company every single day, it's my job, I'm pretty familiar with how hacked
> WP behaves). Or rather, if it IS a hack, it's not that people are attacking
> install.php, it's that they somehow made your wp-config.php go away, or the
> DB tables.
>
> Honestly though, what we need to know (and what you don't know) is what
> did the install.php page say when you hit it? Did it say "no DB" or
> "There's no config file..." If you go to /wp-admin/install.php now, you'll
> see 'Hai! Already installed!' And I think that was NOT what people saw. If
> it was? Then MAYBE you have a brute force attempt (which is not a hack
> BTW). But I think not.
>
> I don't think your server admin is wrong, but I do think that you don't
> clearly understand how WP handles this sort of thing, so there's some
> confusion in explanations to the admin :/
>
>  Konrad Karpieszuk <mailto:kkarpieszuk at gmail.com>
>> October 9, 2013 9:58 AM
>>
>> ok, but why? server admin told me (and i have to trust him) that
>> everything
>> was ok with connection to DB. or even if it wasnt... why somebody tried to
>> connect to file /wp-admin/install.php (i still belive that this was not
>> accident).
>>
>> what do i think.
>>
>> i think that somebody in purpose made ddos attack because somehow (maybe
>> he
>> tested this before) he knewed that during huge ddos attack wordpress will
>> 'lost its mind'. during huge ddos attack server as hardware stops to play
>> correctly and sometimes for php command like "if
>> (!file_exists('wp-config.php')**)" will not be able to check if file
>> really
>> exists, will return true (there is now file wp-config.php) and php will
>> delegate chain of command to installation file. and then hacker will be
>> able to reinstall my wordpress with his credential
>>
>>
>>
>> --
>> (en) regards / (pl) pozdrawiam
>> Konrad Karpieszuk
>> http://tradematik.pl wtyczka do WordPressa do tworzenia sklep?w dla
>> klient?w z Polski
>>
>>
>>
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>> Mika A Epstein <mailto:ipstenu at ipstenu.org>
>> October 9, 2013 9:39 AM
>>
>> It's not the next attack. It's your WP site not seeing it's installed.
>> This means that the DB tables weren't accessible for some reason OR the
>> wp-config.php was unreadable.
>>
>> Konrad Karpieszuk wrote:
>> Mika Epstein <mailto:ipstenu at ipstenu.org>
>> October 9, 2013 6:29 AM
>>
>> Block it in your htacess first, actually. That's way easier.
>>
>> Based on what info you gave us, we can't diagnosis anything. Check your
>> SERVER logs. Did a file get edited or go missing? The problem is not that
>> the file was being hit by millions of people, the problem is why did WP not
>> know it was installed? Check your logs to see if anything happened to the
>> DB. Was it unreadable? Did you add/remove a plugin recently? Did you
>> upgrade?
>>
>> Your mentioned changes to login and admin shouldn't cause anything like
>> this, it's purely WP no longer thinking it was installed. So what have you
>> done to diagnosis THAT? :)
>>
>> Mika A Epstein <mailto:ipstenu at ipstenu.org>
>> October 8, 2013 11:47 AM
>>
>> I think causality is the other way around.
>>
>> People were hitting install.php so much because the wizard was showing.
>> Was your SQL server glitching?
>>
>>
>>
> --
> Mika A Epstein (aka Ipstenu)
> http://ipstenu.org | http://halfelf.org
>
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From greglancaster71 at gmail.com  Wed Oct  9 18:55:21 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 9 Oct 2013 11:55:21 -0700 (PDT)
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
Message-ID: <1381344921340-42492.post@n5.nabble.com>

Trying to dynamically create user pages (front end) without a plugin. 
Similar to how buddypress does it - no custom post types for users, just
member profile urls.  I tried this:

        add_filter( 'query_vars', 'analytics_rewrite_add_var' );
        
        function analytics_rewrite_add_var( $vars )
        {
            $vars[] = 'member';
            return $vars;
        }
        
        function add_analytic_rewrite_rule(){
            add_rewrite_tag( '%member%', '([^&]+)' );
            add_rewrite_rule(
                '^member/([^/]*)/?',
                'index.php?member=$matches[1]',
                'top'
            );
        }
        add_action('init', 'add_analytic_rewrite_rule');
        add_action( 'template_redirect', 'analytics_rewrite_catch' );
        
        
        function analytics_rewrite_catch()
        {
            global $wp_query;
        
            if ( array_key_exists( 'member', $wp_query->query_vars ) ) {
            	get_header();
            	the_content();
                include_once( ABSPATH .
'/wp-content/plugins/My_Plugin/members.php');
                get_sidebar();
                get_footer();
                exit;
               
            }    
        }

But it generates the same page for every user, and even loads the page if a
random username that isnt registered is entered.   How exactly does
buddypress hook into users to make dynamic pages?  I am looking at the code
now, but they have so many files.  Any help appreciated.



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Wed Oct  9 19:18:28 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 9 Oct 2013 22:18:28 +0300
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <1381344921340-42492.post@n5.nabble.com>
References: <1381344921340-42492.post@n5.nabble.com>
Message-ID: <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>

The problem with displaying the page even when the username does not exist
is due to the fact that you don't check if it exists or not in your
analytics_rewrite_catch() function. Change your function to this instead:

        function analytics_rewrite_catch() {
            global $wp_query;

            if ( array_key_exists( 'member', $wp_query->query_vars ) && (
$_member = get_user_by('login', $wp_query->query_vars['member']) ) ) {
                get_header();
                the_content();
                include_once( ABSPATH .
'/wp-content/plugins/My_Plugin/members.php');
                get_sidebar();
                get_footer();
                exit;
            }

Notice the "get_user_by('login', $wp_query->query_vars['member'])" part.
You would have to change that in case you are using the user id's
instead(right now it's assuming that you use the user's login name). This
way only if the user requested exists you will load your template(and in
that template you will have the "$_member" variable available which should
be an instance of WP_User, so that you can make the template dynamic).

I hope that helps.


On Wed, Oct 9, 2013 at 9:55 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> Trying to dynamically create user pages (front end) without a plugin.
> Similar to how buddypress does it - no custom post types for users, just
> member profile urls.  I tried this:
>
>         add_filter( 'query_vars', 'analytics_rewrite_add_var' );
>
>         function analytics_rewrite_add_var( $vars )
>         {
>             $vars[] = 'member';
>             return $vars;
>         }
>
>         function add_analytic_rewrite_rule(){
>             add_rewrite_tag( '%member%', '([^&]+)' );
>             add_rewrite_rule(
>                 '^member/([^/]*)/?',
>                 'index.php?member=$matches[1]',
>                 'top'
>             );
>         }
>         add_action('init', 'add_analytic_rewrite_rule');
>         add_action( 'template_redirect', 'analytics_rewrite_catch' );
>
>
>         function analytics_rewrite_catch()
>         {
>             global $wp_query;
>
>             if ( array_key_exists( 'member', $wp_query->query_vars ) ) {
>                 get_header();
>                 the_content();
>                 include_once( ABSPATH .
> '/wp-content/plugins/My_Plugin/members.php');
>                 get_sidebar();
>                 get_footer();
>                 exit;
>
>             }
>         }
>
> But it generates the same page for every user, and even loads the page if a
> random username that isnt registered is entered.   How exactly does
> buddypress hook into users to make dynamic pages?  I am looking at the code
> now, but they have so many files.  Any help appreciated.
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Wed Oct  9 19:52:19 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 9 Oct 2013 12:52:19 -0700 (PDT)
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
Message-ID: <1381348339242-42495.post@n5.nabble.com>

Excellent!  That fixed it.   Now for each user I have a dynamic page load,
but how can I populate that page with each users stored data?  I was
previously using custom post types, so the data was easy to grab, just get
the author id of the post and populate the pate with that usermeta.  

Since it is now dynamic, I am unsure how I would go about populating the
page.  I think Iwould need to create a custom query variable when the
username is grabbed, and then I can use the get_query_var. 

Is that right?



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42495.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Wed Oct  9 20:04:55 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 9 Oct 2013 23:04:55 +0300
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <1381348339242-42495.post@n5.nabble.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
Message-ID: <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>

Well depends on what you want to list about your users.

Is the user data stored as user meta? If so, you can simply do

echo get_user_meta( $_member->ID, 'meta_key1', true ):

You can also try accessing that directly from the $_member object:

echo $_member->meta_key1;

As far as I remember WP_User was using the magical __get() method, which
dynamically loads any un-existing properties of the object.


On Wed, Oct 9, 2013 at 10:52 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> Excellent!  That fixed it.   Now for each user I have a dynamic page load,
> but how can I populate that page with each users stored data?  I was
> previously using custom post types, so the data was easy to grab, just get
> the author id of the post and populate the pate with that usermeta.
>
> Since it is now dynamic, I am unsure how I would go about populating the
> page.  I think Iwould need to create a custom query variable when the
> username is grabbed, and then I can use the get_query_var.
>
> Is that right?
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42495.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Wed Oct  9 20:26:21 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 9 Oct 2013 13:26:21 -0700 (PDT)
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
Message-ID: <1381350381912-42497.post@n5.nabble.com>

Right again, I dont know how I missed that.  Now I am faced with one last
problem - using a template was a bad idea because does not load the header
and footer properly on all themes.  Is there a way to insert this into the
content of the page rather than load the template?

I previously used


function add_profile( $content ) {
	if( is_page('')) include_once('member.php');
	else { echo get_the_content(); }
}

add_filter('the_content','add_profile');

but dont think I can really implement that into the current code.  But this
worked great because rather than load a whole custom template, it injects
whatever is inside the member.php inside the_content().  Anyway to repeat
that with this dynamic profile?





--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42497.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Wed Oct  9 20:33:09 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 9 Oct 2013 23:33:09 +0300
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <1381350381912-42497.post@n5.nabble.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
 <1381350381912-42497.post@n5.nabble.com>
Message-ID: <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>

What I would probably do is to add a drop-down in your plugin's interface,
asking the user to pick a page that would be used as a profile page.

You can then modify the query in the 'parse_request' action(you will be
passed the $wp object and not $wp_query - keep that in mind) and tell
WordPress to load the page with ID of whatever page the admin has chosen to
be profile page. This way WordPress will still load a normal page
template(and not the 404 template) and you will be able to use the
'the_content' filter to put whatever you want there :)

It's a bit late here, but if you can't figure it out or there's no one else
to guide you along, I'll be able to provide you with a sample code tomorrow
at some point.

Nikola


On Wed, Oct 9, 2013 at 11:26 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> Right again, I dont know how I missed that.  Now I am faced with one last
> problem - using a template was a bad idea because does not load the header
> and footer properly on all themes.  Is there a way to insert this into the
> content of the page rather than load the template?
>
> I previously used
>
>
> function add_profile( $content ) {
>         if( is_page('')) include_once('member.php');
>         else { echo get_the_content(); }
> }
>
> add_filter('the_content','add_profile');
>
> but dont think I can really implement that into the current code.  But this
> worked great because rather than load a whole custom template, it injects
> whatever is inside the member.php inside the_content().  Anyway to repeat
> that with this dynamic profile?
>
>
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42497.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From pascal.birchler at gmail.com  Thu Oct 10 13:37:38 2013
From: pascal.birchler at gmail.com (Pascal Birchler)
Date: Thu, 10 Oct 2013 15:37:38 +0200
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
Message-ID: <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>

Yes, that's absolutely normal. WordPress only updates files that have
actually changed. Especially in a beta, only a couple of files change
between nightly releases.


2013/10/4 Luke Bryan <lukebryan at sharefaith.com>

> Greetings all,
>
> I have a couple questions about the new auto-update feature: I was just
> notified by email:
> "Updating to WordPress 3.7-beta1-25639-20131003"
>
> However It seems only 5 files in wp-includes have a modification date of
> today. Is this normal?
>
> I was also wondering if it could tell you what site had updated in the
> email? Looks like another testing site was not getting the update, probably
> because it was using autoFTP to modify files. It would be great to see what
> site was updated.
>
> Best regards,
> Luke
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From wp at andrewnacin.com  Thu Oct 10 15:31:40 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Thu, 10 Oct 2013 11:31:40 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
Message-ID: <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>

On Thu, Oct 10, 2013 at 9:37 AM, Pascal Birchler
<pascal.birchler at gmail.com>wrote:

> Yes, that's absolutely normal. WordPress only updates files that have
> actually changed. Especially in a beta, only a couple of files change
> between nightly releases.
>

That part is actually somewhat new. We used to copy over all files we
downloaded, which I guess might trigger an update to access time or change
time (but not modification time). In WordPress 3.7, we now md5 files before
copying and only copy over files that were changed. End result is the same,
but it means faster updates, and more stability as there are less I/O
operations.

Pretty cool, I think.

Nacin

From nikolov.tmw at gmail.com  Thu Oct 10 15:42:07 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Thu, 10 Oct 2013 18:42:07 +0300
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
Message-ID: <CAOwx47ezK7ruty=LWSPtEWGEU6YStF3KJ4uhkB1zbq3iX2C7kg@mail.gmail.com>

That's pretty cool indeed. Is the same going to apply for plugin/theme
updates? As in is it part of the updater class?


On Thu, Oct 10, 2013 at 6:31 PM, Andrew Nacin <wp at andrewnacin.com> wrote:

> On Thu, Oct 10, 2013 at 9:37 AM, Pascal Birchler
> <pascal.birchler at gmail.com>wrote:
>
> > Yes, that's absolutely normal. WordPress only updates files that have
> > actually changed. Especially in a beta, only a couple of files change
> > between nightly releases.
> >
>
> That part is actually somewhat new. We used to copy over all files we
> downloaded, which I guess might trigger an update to access time or change
> time (but not modification time). In WordPress 3.7, we now md5 files before
> copying and only copy over files that were changed. End result is the same,
> but it means faster updates, and more stability as there are less I/O
> operations.
>
> Pretty cool, I think.
>
> Nacin
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From esmi at quirm.net  Fri Oct 11 10:53:28 2013
From: esmi at quirm.net (esmi at quirm dot net)
Date: Fri, 11 Oct 2013 11:53:28 +0100
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
Message-ID: <5257D8A8.5000200@quirm.net>

on 10/10/2013 16:31 Andrew Nacin said the following:
> Pretty cool, I think.

Will users be able to switch off auto-updates - say via wp-config.php - 
in the final release? I've been asked that once or twice already.

Mel
-- 
http://quirm.net
http://blackwidows.co.uk

From nikolov.tmw at gmail.com  Fri Oct 11 11:37:11 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Fri, 11 Oct 2013 14:37:11 +0300
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <5257D8A8.5000200@quirm.net>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
 <5257D8A8.5000200@quirm.net>
Message-ID: <CAOwx47f+qKE3JVWc135tJL+wW5zwM+p-j=-FACGLUYYmJYfbBw@mail.gmail.com>

As stated here -
http://make.wordpress.org/core/2013/09/24/automatic-core-updates/ :

3. If the constants DISALLOW_FILE_MODS or AUTOMATIC_UPDATER_DISABLED are
defined, automatic updates are *disabled*
4. If the constant WP_AUTO_UPDATE_CORE is defined as *false*, automatic
updates are *disabled*

So - yeah you will be able to disable the automatic updates.

You can also check-out the section

I don?t like the sound of this, How do I turn it off?

In the above article - it lists the ways to disable the automatic updates.


On Fri, Oct 11, 2013 at 1:53 PM, esmi at quirm dot net <esmi at quirm.net>wrote:

> on 10/10/2013 16:31 Andrew Nacin said the following:
>
>> Pretty cool, I think.
>>
>
> Will users be able to switch off auto-updates - say via wp-config.php - in
> the final release? I've been asked that once or twice already.
>
> Mel
> --
> http://quirm.net
> http://blackwidows.co.uk
>
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From ipstenu at ipstenu.org  Fri Oct 11 15:32:52 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Fri, 11 Oct 2013 08:32:52 -0700
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAOwx47f+qKE3JVWc135tJL+wW5zwM+p-j=-FACGLUYYmJYfbBw@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
 <5257D8A8.5000200@quirm.net>
 <CAOwx47f+qKE3JVWc135tJL+wW5zwM+p-j=-FACGLUYYmJYfbBw@mail.gmail.com>
Message-ID: <52581A24.8070606@ipstenu.org>

And we'll put that in the OMGWTFBBQ post, and I'm SURE Nacin'll have it 
in the Press Release on .org :)

And I'm sure we'll have people scream.

> Nikola Nikolov <mailto:nikolov.tmw at gmail.com>
> October 11, 2013 4:37 AM
> As stated here -
> http://make.wordpress.org/core/2013/09/24/automatic-core-updates/ :
>
> 3. If the constants DISALLOW_FILE_MODS or AUTOMATIC_UPDATER_DISABLED are
> defined, automatic updates are *disabled*
> 4. If the constant WP_AUTO_UPDATE_CORE is defined as *false*, automatic
> updates are *disabled*
>
> So - yeah you will be able to disable the automatic updates.
>
> You can also check-out the section
>
> I don?t like the sound of this, How do I turn it off?
>
> In the above article - it lists the ways to disable the automatic updates.
>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
> esmi at quirm dot net <mailto:esmi at quirm.net>
> October 11, 2013 3:53 AM
>
>
> Will users be able to switch off auto-updates - say via wp-config.php 
> - in the final release? I've been asked that once or twice already.
>
> Mel

-- 
Mika A Epstein (aka Ipstenu)
http://ipstenu.org | http://halfelf.org


From hendronix at gmail.com  Fri Oct 11 15:36:09 2013
From: hendronix at gmail.com (Eric Hendrix)
Date: Fri, 11 Oct 2013 08:36:09 -0700 (PDT)
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <52581A24.8070606@ipstenu.org>
References: <52581A24.8070606@ipstenu.org>
Message-ID: <1381505768861.51b1aa87@Nodemailer>

I'm sorry, I've got to agree with Nikola, anytime I hear "how do I turn it off" I want to go running screaming out the door and give up. There are certainly good reasons for not wanting to auto-update, but they should be few and far between when you're speaking of core.

Eric A. Hendrix
308 McFadyen Drive
Fayetteville, NC
28314
910.644.8940
Hendronix at gmail.com
www.hendronix.com

On Fri, Oct 11, 2013 at 11:33 AM, Mika A Epstein <ipstenu at ipstenu.org>
wrote:

> And we'll put that in the OMGWTFBBQ post, and I'm SURE Nacin'll have it 
> in the Press Release on .org :)
> And I'm sure we'll have people scream.
>> Nikola Nikolov <mailto:nikolov.tmw at gmail.com>
>> October 11, 2013 4:37 AM
>> As stated here -
>> http://make.wordpress.org/core/2013/09/24/automatic-core-updates/ :
>>
>> 3. If the constants DISALLOW_FILE_MODS or AUTOMATIC_UPDATER_DISABLED are
>> defined, automatic updates are *disabled*
>> 4. If the constant WP_AUTO_UPDATE_CORE is defined as *false*, automatic
>> updates are *disabled*
>>
>> So - yeah you will be able to disable the automatic updates.
>>
>> You can also check-out the section
>>
>> I don?t like the sound of this, How do I turn it off?
>>
>> In the above article - it lists the ways to disable the automatic updates.
>>
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> esmi at quirm dot net <mailto:esmi at quirm.net>
>> October 11, 2013 3:53 AM
>>
>>
>> Will users be able to switch off auto-updates - say via wp-config.php 
>> - in the final release? I've been asked that once or twice already.
>>
>> Mel
> -- 
> Mika A Epstein (aka Ipstenu)
> http://ipstenu.org | http://halfelf.org
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From otto at ottodestruct.com  Fri Oct 11 15:56:55 2013
From: otto at ottodestruct.com (Otto)
Date: Fri, 11 Oct 2013 10:56:55 -0500
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <52581A24.8070606@ipstenu.org>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
 <5257D8A8.5000200@quirm.net>
 <CAOwx47f+qKE3JVWc135tJL+wW5zwM+p-j=-FACGLUYYmJYfbBw@mail.gmail.com>
 <52581A24.8070606@ipstenu.org>
Message-ID: <CAD-FghwSo+B5O3KBe95c50++9-Twa0kDrA8kLTia6SHRN=+2EA@mail.gmail.com>

On Fri, Oct 11, 2013 at 10:32 AM, Mika A Epstein <ipstenu at ipstenu.org> wrote:
> And we'll put that in the OMGWTFBBQ post, and I'm SURE Nacin'll have it in
> the Press Release on .org :)
>
> And I'm sure we'll have people scream.


Note that for the majority of cases where users would legitimately
need it to be turned off, it is turned off automatically.

- If the setup is such that the user must put in FTP credentials or similar,
- If there are .svn or .git directories, indicating the user has a
deployment system for the site,
- If getting files via SSL doesn't work for whatever reason, so it
can't download securely,
- If wp-cron is buggered for whatever reason and the updater doesn't fire,
- If file modification has been manually disabled with
DISALLOW_FILE_MODS being defined,

Any of these will cause it to disable the auto-updater. Turning it off
manually should be a relatively rare operation, for those people with
special cases or needs.

If they do want to turn it off, then there's a few good ways:

1. define ('AUTOMATIC_UPDATER_DISABLED', true); - This is a blunt
instrument. It simply disables the core automatic upgrader code at the
root. Overrides everything.

2. WP_AUTO_UPDATE_CORE can be defined instead to allow more fine
grained control. Set it to one of these:
- false = no updates
- true = ALL updates
- minor = Minor releases only
Using this essentially sets the default values for the following
filters. Using these following filters will allow you to override this
define.

3. Filters exist to allow you to allow specific kinds of updates as well:
allow_dev_auto_core_updates - if you're on a development version, and
this filter gets returned a true value, then it will enable dev/beta
updates.

allow_minor_auto_core_updates
allow_major_auto_core_updates - Pretty much what it says on the box.
Return true to allow each of these, false to disallow them.

-Otto

From nikolov.tmw at gmail.com  Fri Oct 11 16:19:46 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Fri, 11 Oct 2013 19:19:46 +0300
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAD-FghwSo+B5O3KBe95c50++9-Twa0kDrA8kLTia6SHRN=+2EA@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
 <5257D8A8.5000200@quirm.net>
 <CAOwx47f+qKE3JVWc135tJL+wW5zwM+p-j=-FACGLUYYmJYfbBw@mail.gmail.com>
 <52581A24.8070606@ipstenu.org>
 <CAD-FghwSo+B5O3KBe95c50++9-Twa0kDrA8kLTia6SHRN=+2EA@mail.gmail.com>
Message-ID: <CAOwx47exqtiXpo3nz_mUXfc9zpTBubCchVodO08y+z633PmGsw@mail.gmail.com>

The default is to do only minor core updates, correct? If so then it makes
very little sense to have automatic core updates disabled(unless you have
source control or any of the other special cases of course).


On Fri, Oct 11, 2013 at 6:56 PM, Otto <otto at ottodestruct.com> wrote:

> On Fri, Oct 11, 2013 at 10:32 AM, Mika A Epstein <ipstenu at ipstenu.org>
> wrote:
> > And we'll put that in the OMGWTFBBQ post, and I'm SURE Nacin'll have it
> in
> > the Press Release on .org :)
> >
> > And I'm sure we'll have people scream.
>
>
> Note that for the majority of cases where users would legitimately
> need it to be turned off, it is turned off automatically.
>
> - If the setup is such that the user must put in FTP credentials or
> similar,
> - If there are .svn or .git directories, indicating the user has a
> deployment system for the site,
> - If getting files via SSL doesn't work for whatever reason, so it
> can't download securely,
> - If wp-cron is buggered for whatever reason and the updater doesn't fire,
> - If file modification has been manually disabled with
> DISALLOW_FILE_MODS being defined,
>
> Any of these will cause it to disable the auto-updater. Turning it off
> manually should be a relatively rare operation, for those people with
> special cases or needs.
>
> If they do want to turn it off, then there's a few good ways:
>
> 1. define ('AUTOMATIC_UPDATER_DISABLED', true); - This is a blunt
> instrument. It simply disables the core automatic upgrader code at the
> root. Overrides everything.
>
> 2. WP_AUTO_UPDATE_CORE can be defined instead to allow more fine
> grained control. Set it to one of these:
> - false = no updates
> - true = ALL updates
> - minor = Minor releases only
> Using this essentially sets the default values for the following
> filters. Using these following filters will allow you to override this
> define.
>
> 3. Filters exist to allow you to allow specific kinds of updates as well:
> allow_dev_auto_core_updates - if you're on a development version, and
> this filter gets returned a true value, then it will enable dev/beta
> updates.
>
> allow_minor_auto_core_updates
> allow_major_auto_core_updates - Pretty much what it says on the box.
> Return true to allow each of these, false to disallow them.
>
> -Otto
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From esmi at quirm.net  Fri Oct 11 16:34:20 2013
From: esmi at quirm.net (esmi at quirm dot net)
Date: Fri, 11 Oct 2013 17:34:20 +0100
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <1381505768861.51b1aa87@Nodemailer>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
Message-ID: <5258288C.90301@quirm.net>

on 11/10/2013 16:36 Eric Hendrix said the following:
> There are certainly good reasons for not wanting to auto-update, but
> they should be few and far between when you're speaking of core.

Agreed. And it's certainly something that we will be advising *against* 
in the forums if at all possible.

Mel
-- 
http://quirm.net
http://blackwidows.co.uk

From mickyhulse.lists at gmail.com  Fri Oct 11 17:06:42 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Fri, 11 Oct 2013 10:06:42 -0700
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <5258288C.90301@quirm.net>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
Message-ID: <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>

Great thread!

Auto update sounds like an awesome new feature!

For one of my setups, WP core is a GitHub submodule. I have
not tested the beta WP with this new feature, but I was thinking that
auto updates would not mesh well in a submodule situation?

From sabreuse at gmail.com  Fri Oct 11 17:10:08 2013
From: sabreuse at gmail.com (Amy Hendrix)
Date: Fri, 11 Oct 2013 13:10:08 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
Message-ID: <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>

Autoupdates are disabled if you're under version control -- or rather,
you'd have to go way out of your way to make it be otherwise. So your
submodule install won't be messed with.

On Fri, Oct 11, 2013 at 1:06 PM, Micky Hulse <mickyhulse.lists at gmail.com> wrote:
> Great thread!
>
> Auto update sounds like an awesome new feature!
>
> For one of my setups, WP core is a GitHub submodule. I have
> not tested the beta WP with this new feature, but I was thinking that
> auto updates would not mesh well in a submodule situation?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From lists at rotorised.com  Fri Oct 11 17:11:02 2013
From: lists at rotorised.com (Ryan McCue)
Date: Sat, 12 Oct 2013 03:11:02 +1000
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
Message-ID: <52583126.4040009@rotorised.com>

Micky Hulse wrote:
> Great thread!
> 
> Auto update sounds like an awesome new feature!
> 
> For one of my setups, WP core is a GitHub submodule. I have
> not tested the beta WP with this new feature, but I was thinking that
> auto updates would not mesh well in a submodule situation?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
> 

WordPress will automatically detect if you're in a git/svn/hg/bzr
repository and not activate the upgrades if so. This should work for
submodules too (submodules just have a .git file instead of a .git
directory).

-- 
Ryan McCue
<http://ryanmccue.info/>

From wp at andrewnacin.com  Fri Oct 11 17:18:03 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Fri, 11 Oct 2013 13:18:03 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <52583126.4040009@rotorised.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <52583126.4040009@rotorised.com>
Message-ID: <CAP29PviPKO8B2-x=c35WEUQO05a_EXz0jJ28RDUyn8sc26GKRw@mail.gmail.com>

On Fri, Oct 11, 2013 at 1:11 PM, Ryan McCue <lists at rotorised.com> wrote:

> WordPress will automatically detect if you're in a git/svn/hg/bzr
>  repository and not activate the upgrades if so. This should work for
> submodules too (submodules just have a .git file instead of a .git
> directory).
>

It actually uses is_dir() instead of file_exists(). But, we walk up the
directory tree to the very top of the disk. So if your submodule is /srv/
example.com/public_html/wordpress/, we'll look for a .git directory in
these places:

 * /srv/example.com/public_html/wordpress/.git (which will be a file)
 * /srv/example.com/public_html/.git
 * /srv/example.com/.git
 * /srv/.git
 * /.git

So basically: We won't notice your submodule, but we will notice your
submodule is part of a git repository.

If someone thinks we should use file_exists() instead, that's fine. I
wanted to avoid false positives with a file named .svn, .git, .hg, or .bzr,
but I had forgotten that submodules use a .git file, so it might be more
trouble than its worse.

Nacin

From wp at andrewnacin.com  Fri Oct 11 17:19:18 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Fri, 11 Oct 2013 13:19:18 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAOwx47ezK7ruty=LWSPtEWGEU6YStF3KJ4uhkB1zbq3iX2C7kg@mail.gmail.com>
References: <CAFnKAk3g24WX8cqm4i94rJ8u4pvmQM4atayRB7HPei++cnO-zQ@mail.gmail.com>
 <CA+U2bwK-FCcwDORh8i=ztwtOq6fOHwSfnabLbnt96VwJYc_Mww@mail.gmail.com>
 <CAP29Pvgrqh2OJRzqjKSZA86QhUgNi+tO748bPUo97T+iW7KRpQ@mail.gmail.com>
 <CAOwx47ezK7ruty=LWSPtEWGEU6YStF3KJ4uhkB1zbq3iX2C7kg@mail.gmail.com>
Message-ID: <CAP29PviOgLshuURi+gfXvr8eyMWRG7yYTTtA-Y5w9Ufa7nEQxw@mail.gmail.com>

On Thu, Oct 10, 2013 at 11:42 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> That's pretty cool indeed. Is the same going to apply for plugin/theme
> updates?


No, plugin and theme updates still remove the old directory before
unzipping the new.

From mickyhulse.lists at gmail.com  Fri Oct 11 17:32:04 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Fri, 11 Oct 2013 10:32:04 -0700
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>
Message-ID: <CALri7M=UoNtO+6Uc1SwXBKGeB-XdsFeDwL_Y-Z0mdjo_9+ZhHg@mail.gmail.com>

On Fri, Oct 11, 2013 at 10:10 AM, Amy Hendrix <sabreuse at gmail.com> wrote:
> Autoupdates are disabled if you're under version control -- or rather,
> you'd have to go way out of your way to make it be otherwise. So your
> submodule install won't be messed with.

Wow, that's great! Thanks for the clarification.

On one hand, I'd hate to miss out on auto updates, but on the other, I
really love the submodule setup I've got going on.

Thanks!

From hendronix at gmail.com  Fri Oct 11 18:14:17 2013
From: hendronix at gmail.com (Eric Hendrix)
Date: Fri, 11 Oct 2013 14:14:17 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CALri7M=UoNtO+6Uc1SwXBKGeB-XdsFeDwL_Y-Z0mdjo_9+ZhHg@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>
 <CALri7M=UoNtO+6Uc1SwXBKGeB-XdsFeDwL_Y-Z0mdjo_9+ZhHg@mail.gmail.com>
Message-ID: <CAAkktv1fdnbyt-ua40nqUL5-dRCqHDPzOpSxazBB38tCt80cOA@mail.gmail.com>

Amy, are you related to me?


On Fri, Oct 11, 2013 at 1:32 PM, Micky Hulse <mickyhulse.lists at gmail.com>wrote:

> On Fri, Oct 11, 2013 at 10:10 AM, Amy Hendrix <sabreuse at gmail.com> wrote:
> > Autoupdates are disabled if you're under version control -- or rather,
> > you'd have to go way out of your way to make it be otherwise. So your
> > submodule install won't be messed with.
>
> Wow, that's great! Thanks for the clarification.
>
> On one hand, I'd hate to miss out on auto updates, but on the other, I
> really love the submodule setup I've got going on.
>
> Thanks!
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
*Eric A. Hendrix*
hendronix at gmail.com
(910) 644-8940

*"Non Timebo Mala"*

From sabreuse at gmail.com  Fri Oct 11 18:23:11 2013
From: sabreuse at gmail.com (Amy Hendrix)
Date: Fri, 11 Oct 2013 14:23:11 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAAkktv1fdnbyt-ua40nqUL5-dRCqHDPzOpSxazBB38tCt80cOA@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>
 <CALri7M=UoNtO+6Uc1SwXBKGeB-XdsFeDwL_Y-Z0mdjo_9+ZhHg@mail.gmail.com>
 <CAAkktv1fdnbyt-ua40nqUL5-dRCqHDPzOpSxazBB38tCt80cOA@mail.gmail.com>
Message-ID: <CAKnJ9+yw7_jXc+DF_BV7epQ0e=iVOY58zx_+OjWr6cESVGSOsA@mail.gmail.com>

Not that I know of, but nice to meetcha ;)

On Fri, Oct 11, 2013 at 2:14 PM, Eric Hendrix <hendronix at gmail.com> wrote:
> Amy, are you related to me?
>
>
> On Fri, Oct 11, 2013 at 1:32 PM, Micky Hulse <mickyhulse.lists at gmail.com>wrote:
>
>> On Fri, Oct 11, 2013 at 10:10 AM, Amy Hendrix <sabreuse at gmail.com> wrote:
>> > Autoupdates are disabled if you're under version control -- or rather,
>> > you'd have to go way out of your way to make it be otherwise. So your
>> > submodule install won't be messed with.
>>
>> Wow, that's great! Thanks for the clarification.
>>
>> On one hand, I'd hate to miss out on auto updates, but on the other, I
>> really love the submodule setup I've got going on.
>>
>> Thanks!
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>
>
> --
> *Eric A. Hendrix*
> hendronix at gmail.com
> (910) 644-8940
>
> *"Non Timebo Mala"*
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From hendronix at gmail.com  Fri Oct 11 18:26:11 2013
From: hendronix at gmail.com (Eric Hendrix)
Date: Fri, 11 Oct 2013 14:26:11 -0400
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAKnJ9+yw7_jXc+DF_BV7epQ0e=iVOY58zx_+OjWr6cESVGSOsA@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <CAKnJ9+xVApDydN+uED2eJujO84KgTCJwN6NmtSBF7vUAfcrg_w@mail.gmail.com>
 <CALri7M=UoNtO+6Uc1SwXBKGeB-XdsFeDwL_Y-Z0mdjo_9+ZhHg@mail.gmail.com>
 <CAAkktv1fdnbyt-ua40nqUL5-dRCqHDPzOpSxazBB38tCt80cOA@mail.gmail.com>
 <CAKnJ9+yw7_jXc+DF_BV7epQ0e=iVOY58zx_+OjWr6cESVGSOsA@mail.gmail.com>
Message-ID: <CAAkktv1xH1z1nogQAs9pqiJYN2SczMowG6uKs1i6UPecAo-JhQ@mail.gmail.com>

You musta got the smart genes! ;)


On Fri, Oct 11, 2013 at 2:23 PM, Amy Hendrix <sabreuse at gmail.com> wrote:

> Not that I know of, but nice to meetcha ;)
>
> On Fri, Oct 11, 2013 at 2:14 PM, Eric Hendrix <hendronix at gmail.com> wrote:
> > Amy, are you related to me?
> >
> >
> > On Fri, Oct 11, 2013 at 1:32 PM, Micky Hulse <mickyhulse.lists at gmail.com
> >wrote:
> >
> >> On Fri, Oct 11, 2013 at 10:10 AM, Amy Hendrix <sabreuse at gmail.com>
> wrote:
> >> > Autoupdates are disabled if you're under version control -- or rather,
> >> > you'd have to go way out of your way to make it be otherwise. So your
> >> > submodule install won't be messed with.
> >>
> >> Wow, that's great! Thanks for the clarification.
> >>
> >> On one hand, I'd hate to miss out on auto updates, but on the other, I
> >> really love the submodule setup I've got going on.
> >>
> >> Thanks!
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >
> >
> >
> > --
> > *Eric A. Hendrix*
> > hendronix at gmail.com
> > (910) 644-8940
> >
> > *"Non Timebo Mala"*
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
*Eric A. Hendrix*
hendronix at gmail.com
(910) 644-8940

*"Non Timebo Mala"*

From mickyhulse.lists at gmail.com  Fri Oct 11 18:50:12 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Fri, 11 Oct 2013 11:50:12 -0700
Subject: [wp-hackers] WP 3.7 auto-update
In-Reply-To: <CAP29PviPKO8B2-x=c35WEUQO05a_EXz0jJ28RDUyn8sc26GKRw@mail.gmail.com>
References: <52581A24.8070606@ipstenu.org> <1381505768861.51b1aa87@Nodemailer>
 <5258288C.90301@quirm.net>
 <CALri7M=S=tGPdrDpybHhjaWZG+MXVKaz9kebcHkwp8-a5mLvDA@mail.gmail.com>
 <52583126.4040009@rotorised.com>
 <CAP29PviPKO8B2-x=c35WEUQO05a_EXz0jJ28RDUyn8sc26GKRw@mail.gmail.com>
Message-ID: <CALri7MnqjPoES1SCLFPk3hcm+cFdMxQzRDMDZ=nAg6QbgSd48A@mail.gmail.com>

Thanks for the details Andrew!

On Fri, Oct 11, 2013 at 10:18 AM, Andrew Nacin <wp at andrewnacin.com> wrote:
> It actually uses is_dir() instead of file_exists(). But, we walk up the
> ...
>  * /srv/example.com/public_html/wordpress/.git (which will be a file)
>  * /srv/example.com/public_html/.git
>  * /srv/example.com/.git
>  * /srv/.git
>  * /.git
> If someone thinks we should use file_exists() instead, that's fine. I
> wanted to avoid false positives with a file named .svn, .git, .hg, or .bzr,
> but I had forgotten that submodules use a .git file, so it might be more
> trouble than its worse.

Based on your example above, it seems like is_dir() should work well
in a submodule setup.

My particular submodule setup looks essentially like:

/content/
/index.php
/wp (submodule)
/wp-config.php
/.git/

Which should meet the pattern you gave above.

Based on what I have seen, the above submodule setup is a standard way
of doing it. Seems like is_dir() would work perfectly. :)

From greglancaster71 at gmail.com  Fri Oct 11 20:13:57 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Fri, 11 Oct 2013 13:13:57 -0700 (PDT)
Subject: [wp-hackers] Delete Row After Submit - Undefined
Message-ID: <1381522437782-42521.post@n5.nabble.com>

I have an issue that is apparently ongoing that I didnt realize until I
turned on debug mode.  I have a delete button on every row of a table, and
when clicked it grabs the row ID and erases that information.  However it
also grabs a field from the picture row (its a post id for the image
attachment) and attempts to delete that as well.

<?php      
	if (isset($_POST['id'])) {
	$id = $_POST['id'];
	if (isset($_POST['deleteItem'])) {
		get_delete_post_link( get_the_ID( $row['file']));
	$qry = "DELETE FROM wp_jo_plugin_options WHERE id = ".$id."";
	$jo_remove_row = $wpdb->query($qry);
	}    
	} 
?>



The problem is that its telling me that $row is an undefined variable.  If I
put it inside the while loop it works, but then the page requires a refresh
after deletion because the table is loaded before the delete code is.  Is
there any solution to this?  Possible to redefine a variable upwards in the
document order possibily?



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-After-Submit-Undefined-tp42521.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From greglancaster71 at gmail.com  Fri Oct 11 20:15:59 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Fri, 11 Oct 2013 13:15:59 -0700 (PDT)
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
 <1381350381912-42497.post@n5.nabble.com>
 <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>
Message-ID: <1381522559013-42522.post@n5.nabble.com>

Thanks again for your help Nikola - I ended up just pasting a whole template
inside the function before and after the include statement.  It works for
now, but wont work with any other theme but mine.   I was considering
something like echo apply_filters( 'my_filter_name, $content );

Then apply it using add_filter( 'my_filter_name',
'your_function_for_adjusting_the_content' );  Would something like that
work?  



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42522.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From jdg at codesymphony.co  Fri Oct 11 20:21:47 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Fri, 11 Oct 2013 16:21:47 -0400
Subject: [wp-hackers] Delete Row After Submit - Undefined
In-Reply-To: <1381522437782-42521.post@n5.nabble.com>
References: <1381522437782-42521.post@n5.nabble.com>
Message-ID: <D23CE0BE-015A-4B7F-86D7-D8D7D9B9DA18@codesymphony.co>

What are you expecting the $row variable to be? Where are you expecting it to come from?

On Oct 11, 2013, at 4:13 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> I have an issue that is apparently ongoing that I didnt realize until I
> turned on debug mode.  I have a delete button on every row of a table, and
> when clicked it grabs the row ID and erases that information.  However it
> also grabs a field from the picture row (its a post id for the image
> attachment) and attempts to delete that as well.
> 
> <?php      
> 	if (isset($_POST['id'])) {
> 	$id = $_POST['id'];
> 	if (isset($_POST['deleteItem'])) {
> 		get_delete_post_link( get_the_ID( $row['file']));
> 	$qry = "DELETE FROM wp_jo_plugin_options WHERE id = ".$id."";
> 	$jo_remove_row = $wpdb->query($qry);
> 	}    
> 	} 
> ?>
> 
> 
> 
> The problem is that its telling me that $row is an undefined variable.  If I
> put it inside the while loop it works, but then the page requires a refresh
> after deletion because the table is loaded before the delete code is.  Is
> there any solution to this?  Possible to redefine a variable upwards in the
> document order possibily?
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-After-Submit-Undefined-tp42521.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From nikolov.tmw at gmail.com  Fri Oct 11 20:22:43 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Fri, 11 Oct 2013 23:22:43 +0300
Subject: [wp-hackers] Delete Row After Submit - Undefined
In-Reply-To: <1381522437782-42521.post@n5.nabble.com>
References: <1381522437782-42521.post@n5.nabble.com>
Message-ID: <CAOwx47eO7yHu+bD2jnkCiJg6S_a_v=+kG6-=6BO__jTCdwRdZg@mail.gmail.com>

I don't think you need to call the get_delete_post_link() function.

Since you're deleting the entry with $wpdb->query() . Just remove the
get_delete_post_link() line and your code should work just fine :)

Nikola


On Fri, Oct 11, 2013 at 11:13 PM, BenderisGreat
<greglancaster71 at gmail.com>wrote:

> I have an issue that is apparently ongoing that I didnt realize until I
> turned on debug mode.  I have a delete button on every row of a table, and
> when clicked it grabs the row ID and erases that information.  However it
> also grabs a field from the picture row (its a post id for the image
> attachment) and attempts to delete that as well.
>
> <?php
>         if (isset($_POST['id'])) {
>         $id = $_POST['id'];
>         if (isset($_POST['deleteItem'])) {
>                 get_delete_post_link( get_the_ID( $row['file']));
>         $qry = "DELETE FROM wp_jo_plugin_options WHERE id = ".$id."";
>         $jo_remove_row = $wpdb->query($qry);
>         }
>         }
> ?>
>
>
>
> The problem is that its telling me that $row is an undefined variable.  If
> I
> put it inside the while loop it works, but then the page requires a refresh
> after deletion because the table is loaded before the delete code is.  Is
> there any solution to this?  Possible to redefine a variable upwards in the
> document order possibily?
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-After-Submit-Undefined-tp42521.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Fri Oct 11 20:25:52 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Fri, 11 Oct 2013 13:25:52 -0700
Subject: [wp-hackers] Delete Row After Submit - Undefined
In-Reply-To: <CAOwx47eO7yHu+bD2jnkCiJg6S_a_v=+kG6-=6BO__jTCdwRdZg@mail.gmail.com>
References: <1381522437782-42521.post@n5.nabble.com>
 <CAOwx47eO7yHu+bD2jnkCiJg6S_a_v=+kG6-=6BO__jTCdwRdZg@mail.gmail.com>
Message-ID: <CAPN-N+YZ09th6mE4OkHwBzuHmb8fGNy-kCcvZ1578+baywGUkQ@mail.gmail.com>

the delete post link is because I am storing this other information in a
separate table.  So I have to delete it from that table, and then grab the
attachmend-id i stored in the row and call that delete function to remove
it from the wordpress media library.


On Fri, Oct 11, 2013 at 1:22 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> I don't think you need to call the get_delete_post_link() function.
>
> Since you're deleting the entry with $wpdb->query() . Just remove the
> get_delete_post_link() line and your code should work just fine :)
>
> Nikola
>
>
> On Fri, Oct 11, 2013 at 11:13 PM, BenderisGreat
> <greglancaster71 at gmail.com>wrote:
>
> > I have an issue that is apparently ongoing that I didnt realize until I
> > turned on debug mode.  I have a delete button on every row of a table,
> and
> > when clicked it grabs the row ID and erases that information.  However it
> > also grabs a field from the picture row (its a post id for the image
> > attachment) and attempts to delete that as well.
> >
> > <?php
> >         if (isset($_POST['id'])) {
> >         $id = $_POST['id'];
> >         if (isset($_POST['deleteItem'])) {
> >                 get_delete_post_link( get_the_ID( $row['file']));
> >         $qry = "DELETE FROM wp_jo_plugin_options WHERE id = ".$id."";
> >         $jo_remove_row = $wpdb->query($qry);
> >         }
> >         }
> > ?>
> >
> >
> >
> > The problem is that its telling me that $row is an undefined variable.
>  If
> > I
> > put it inside the while loop it works, but then the page requires a
> refresh
> > after deletion because the table is loaded before the delete code is.  Is
> > there any solution to this?  Possible to redefine a variable upwards in
> the
> > document order possibily?
> >
> >
> >
> > --
> > View this message in context:
> >
> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-After-Submit-Undefined-tp42521.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From danielx386 at gmail.com  Sat Oct 12 03:28:07 2013
From: danielx386 at gmail.com (Daniel)
Date: Sat, 12 Oct 2013 14:28:07 +1100
Subject: [wp-hackers] Hacking WordPress's login, logout, register ect links
Message-ID: <CAJ5Hi2jqs+1T2BptOuBCNO3Pe8Pd_mLvEs0XbXkwL5rUw1furw@mail.gmail.com>

Hello all,

Juat a question, does anyone know if there are any hooks that will let
me change the links for wp_login_url, wp_logout_url, wp_loginout, and
wp_register? I know that I could do it in .htaccess but I rather
change it at the source if possible.

Also while I'm at it, is there a hook that can be used to direct
people who go to wp-admin to a different url? This only need to happen
to people who are not admin (Ie subscribers).

Regards,
Daniel Fenn

From will.davis at gmail.com  Sat Oct 12 03:32:59 2013
From: will.davis at gmail.com (William P. Davis)
Date: Sat, 12 Oct 2013 03:32:59 +0000
Subject: [wp-hackers] Hacking WordPress's login, logout,
	register ect links
In-Reply-To: <CAJ5Hi2jqs+1T2BptOuBCNO3Pe8Pd_mLvEs0XbXkwL5rUw1furw@mail.gmail.com>
References: <CAJ5Hi2jqs+1T2BptOuBCNO3Pe8Pd_mLvEs0XbXkwL5rUw1furw@mail.gmail.com>
Message-ID: <234102750-1381548783-cardhu_decombobulator_blackberry.rim.net-1712079647-@b16.c4.bise6.blackberry>

login_url, logout_url and register_url are the filters you're looking for.

Checking current_user_can( 'update_core' ) then redirecting during admin_init would probably do the trick.
Sent from my BlackBerry

-----Original Message-----
From: Daniel <danielx386 at gmail.com>
Sender: "wp-hackers" <wp-hackers-bounces at lists.automattic.com>Date: Sat, 12 Oct 2013 14:28:07 
To: wp-hackers<wp-hackers at lists.automattic.com>
Reply-To: wp-hackers at lists.automattic.com
Subject: [wp-hackers] Hacking WordPress's login, logout, register ect links

Hello all,

Juat a question, does anyone know if there are any hooks that will let
me change the links for wp_login_url, wp_logout_url, wp_loginout, and
wp_register? I know that I could do it in .htaccess but I rather
change it at the source if possible.

Also while I'm at it, is there a hook that can be used to direct
people who go to wp-admin to a different url? This only need to happen
to people who are not admin (Ie subscribers).

Regards,
Daniel Fenn
_______________________________________________
wp-hackers mailing list
wp-hackers at lists.automattic.com
http://lists.automattic.com/mailman/listinfo/wp-hackers

From dave at topekadesign.com  Sat Oct 12 06:36:25 2013
From: dave at topekadesign.com (Dave Navarro)
Date: Sat, 12 Oct 2013 01:36:25 -0500
Subject: [wp-hackers] WordPress Mobile App
Message-ID: <5258EDE9.2080709@topekadesign.com>

Am I correct in assuming that the WordPress mobile app does not run any 
filters when you submit/update a post?

I have a filter that automatically ads a featured image if one isn't 
specified based on categories and user criteria, but it doesn't seem to 
work when submitting posts through the iOS app.

--Dave

From nikolov.tmw at gmail.com  Sat Oct 12 09:16:39 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 12 Oct 2013 12:16:39 +0300
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <1381522559013-42522.post@n5.nabble.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
 <1381350381912-42497.post@n5.nabble.com>
 <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>
 <1381522559013-42522.post@n5.nabble.com>
Message-ID: <CAOwx47eJQrj2SDF9d4bm6AXK_tbKYYe+0M6bc9VuFvVquve4tA@mail.gmail.com>

You can find the sample code that I made here -
https://gist.github.com/nikolov-tmw/8d803ea9b4adfbd7e221

What this does is that it checks for the presence of the "member" query
variable. If it's set and is referencing a valid user, then we overload the
query and tell WordPress to load a specific page(the one taken from the
get_my_page_id() function) and we also hook to a couple of filters in order
to display the correct information.
If on the other hand it's not a valid username(at the moment - you can
change this to user ID for instance) then a 404 page is displayed instead.

There are a couple of things that you can do to improve these functions(and
you probably should):
 - Make the page ID dynamic. Add an option in your plugin's settings where
the user can select which page should be the profile page(right now it's
hard-coded to 2 which is the default "Sample Page" ID).
 - Allow the user to override your plugin's template. You can take a look
at how WooCommerce does it(
http://docs.woothemes.com/wc-apidocs/source-function-woocommerce_get_template.html#596-619
) and
borrow and modify the code to fit your needs. This will basically allow the
user to create a file(for instance) "members-page.php" in their theme
directory and change the template to their liking, instead of having to
edit your plugin's file which would get over-written during an update.

If there's anything else to help with - just post it here.

Nikola


On Fri, Oct 11, 2013 at 11:15 PM, BenderisGreat
<greglancaster71 at gmail.com>wrote:

> Thanks again for your help Nikola - I ended up just pasting a whole
> template
> inside the function before and after the include statement.  It works for
> now, but wont work with any other theme but mine.   I was considering
> something like echo apply_filters( 'my_filter_name, $content );
>
> Then apply it using add_filter( 'my_filter_name',
> 'your_function_for_adjusting_the_content' );  Would something like that
> work?
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42522.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From dragonfly at dragonflyeye.net  Sat Oct 12 10:20:48 2013
From: dragonfly at dragonflyeye.net (Thomas Belknap)
Date: Sat, 12 Oct 2013 06:20:48 -0400
Subject: [wp-hackers] WordPress Mobile App
In-Reply-To: <5258EDE9.2080709@topekadesign.com>
References: <5258EDE9.2080709@topekadesign.com>
Message-ID: <CAEamYWQPiVY-MQEmybjZZnF0xo5HzMirk4Fc-8Do7H-hVTVyEQ@mail.gmail.com>

I think I'd want to have a look at what filter hook you're attaching too
when doing that filter. save_post should work. Because otherwise, yes, WP
Mobile should run all filters normally.


On Sat, Oct 12, 2013 at 2:36 AM, Dave Navarro <dave at topekadesign.com> wrote:

> Am I correct in assuming that the WordPress mobile app does not run any
> filters when you submit/update a post?
>
> I have a filter that automatically ads a featured image if one isn't
> specified based on categories and user criteria, but it doesn't seem to
> work when submitting posts through the iOS app.
>
> --Dave
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>



-- 
Tom Belknap
Owner/Editor, DragonFlyEye.Net
Join me:

   - *Inbox:* http://dragonflyeye.net/subscribe
   - *Web*: http://dragonflyeye.net/
   - *Facebook*: https://www.facebook.com/DragonFlyEye.Net
   - *Twitter*: https://twitter.com/dragonflyeye
   - *Google*: https://plus.google.com/u/1/103251482414903117843/posts

From jdg at codesymphony.co  Sat Oct 12 14:00:48 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sat, 12 Oct 2013 10:00:48 -0400
Subject: [wp-hackers] Delete Row After Submit - Undefined
In-Reply-To: <1381522437782-42521.post@n5.nabble.com>
References: <1381522437782-42521.post@n5.nabble.com>
Message-ID: <A8B9BFC5-D8DC-45D1-80C4-37D1271CF1BC@codesymphony.co>

In this code, you have a potential SQL injection vulnerability:

> <?php      
> 	if (isset($_POST['id'])) {
> 	$id = $_POST['id'];
> 	if (isset($_POST['deleteItem'])) {
> 		get_delete_post_link( get_the_ID( $row['file']));
> 	$qry = "DELETE FROM wp_jo_plugin_options WHERE id = ".$id.""; // ****** <- HERE *******
> 	$jo_remove_row = $wpdb->query($qry);
> 	}    
> 	} 
> ?>

You should be using $wpdb->delete() (http://codex.wordpress.org/Class_Reference/wpdb#DELETE_Rows), and you should really also be using nonces (http://codex.wordpress.org/WordPress_Nonces).

Also, I don't understand why you are calling get_delete_post_link(). All that it does is return the URL that a user can visit to delete a post. If you want to delete the attachment, call wp_delete_post() with the attachment ID (http://codex.wordpress.org/Function_Reference/wp_delete_post).

--J.D.

From filippo.pisano at gmail.com  Tue Oct 15 16:40:23 2013
From: filippo.pisano at gmail.com (Filippo Pisano)
Date: Tue, 15 Oct 2013 18:40:23 +0200
Subject: [wp-hackers] Multi-domains on Multi-site
Message-ID: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>

Hello Hackers,

I need to map multiple domains to a multisite installation. What I need to
do is map domain-one.com and domain-two.com to the same blog id. I've tried
the "Multi Domains" plugin (
https://premium.wpmudev.org/project/multi-domains/) but it doesn't do what
I really need because it maps multiple domains to multiple blog ids. I need
to map different domains all to the main blog.

Is there a way to achieve this? Any suggestions on hooks I could use?

Thank you! :)


Filippo Pisano

From ipstenu at ipstenu.org  Tue Oct 15 17:14:31 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Tue, 15 Oct 2013 10:14:31 -0700
Subject: [wp-hackers] Multi-domains on Multi-site
In-Reply-To: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
References: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
Message-ID: <525D77F7.5030404@ipstenu.org>

You can map as many domains as you want to a site on Multisite, but only 
one site is going to be 'primary'

http://wordpress.org/plugins/wordpress-mu-domain-mapping/ works just 
fine for that.

Are you trying to have two domains that are 100% the same, with 
different URLS? That way lies SEO madness.

Filippo Pisano wrote:
>
> Hello Hackers,
>
> I need to map multiple domains to a multisite installation. What I need to
> do is map domain-one.com and domain-two.com to the same blog id. I've 
> tried
> the "Multi Domains" plugin (
> https://premium.wpmudev.org/project/multi-domains/) but it doesn't do what
> I really need because it maps multiple domains to multiple blog ids. I 
> need
> to map different domains all to the main blog.
>
> Is there a way to achieve this? Any suggestions on hooks I could use?
>
> Thank you! :)
>
>
> Filippo Pisano
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From abdussamad at abdussamad.com  Tue Oct 15 17:15:53 2013
From: abdussamad at abdussamad.com (Abdussamad Abdurrazzaq)
Date: Tue, 15 Oct 2013 22:15:53 +0500
Subject: [wp-hackers] Multi-domains on Multi-site
In-Reply-To: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
References: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
Message-ID: <525D7849.40704@abdussamad.com>

The standard free domain mapping plugin can do this:

http://wordpress.org/plugins/wordpress-mu-domain-mapping/

You can map multiple domains to the same site but one of the domains 
should be set as the primary. Other domains will redirect to the primary 
one.

On 10/15/2013 09:40 PM, Filippo Pisano wrote:
> Hello Hackers,
>
> I need to map multiple domains to a multisite installation. What I need to
> do is map domain-one.com and domain-two.com to the same blog id. I've tried
> the "Multi Domains" plugin (
> https://premium.wpmudev.org/project/multi-domains/) but it doesn't do what
> I really need because it maps multiple domains to multiple blog ids. I need
> to map different domains all to the main blog.
>
> Is there a way to achieve this? Any suggestions on hooks I could use?
>
> Thank you! :)
>
>
> Filippo Pisano
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nl at thoughtrefinery.com  Tue Oct 15 17:36:31 2013
From: nl at thoughtrefinery.com (Nicholas Ciske)
Date: Tue, 15 Oct 2013 12:36:31 -0500
Subject: [wp-hackers] Multi-domains on Multi-site
In-Reply-To: <525D7849.40704@abdussamad.com>
References: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
 <525D7849.40704@abdussamad.com>
Message-ID: <7E82FCFF-D155-4E40-8EAD-D5DF6F2973F6@thoughtrefinery.com>

Domain Mapping plugins can generally map multiple domains to any *sub-site* ... but cannot map additional domains the main site/blog -- something has to be absolute. That way lies madness and redirect loops -- the main site is the main site and can really only have one domain associated with it. You can use a throwaway (non public) domain for the main site (e.g. a .info domain) and run all sites as sub-sites to enable domain mapping for the 'main public' domain.

e.g.
example.info
- example.com <- this is your main public site, but is actually a subsite in MS
- other.net
...

As Abdussamad said, only one mapped domain can be primary and all other domains mapped to a sub-site will flow towards the primary domain (e.g. via a redirect or the users first click). This is pretty fundamental to how WP is architected (e.g. it won't even allow www. and no www. -- you have to choose one to redirect the other to).

If you want multiple domains to point to your main blog domain... use DNS redirects (or .htaccess redirects before the WP rewrite rules *to the main domain* if you need to redirect specific URLs).

Avoid mapping multiple domains to serve the same content -- e.g. using a hook to break WP's preference for a single canonical domain per site -- as Mika said, that way lies SEO madness (and duplicate content penalties).
https://support.google.com/webmasters/answer/66359?hl=en

Basically, any domain + URL combo should ideally serve mostly unique content... if you have multiple domains/urls serving the exact same content, you're probably doing_it_wrong() and will not likely find a plugin to assist you in hosing your SEO ;-)

_________________________
Nick Ciske
http://thoughtrefinery.com/
@nciske	

On Oct 15, 2013, at 12:15 PM, Abdussamad Abdurrazzaq wrote:

> The standard free domain mapping plugin can do this:
> 
> http://wordpress.org/plugins/wordpress-mu-domain-mapping/
> 
> You can map multiple domains to the same site but one of the domains should be set as the primary. Other domains will redirect to the primary one.
> 
> On 10/15/2013 09:40 PM, Filippo Pisano wrote:
>> Hello Hackers,
>> 
>> I need to map multiple domains to a multisite installation. What I need to
>> do is map domain-one.com and domain-two.com to the same blog id. I've tried
>> the "Multi Domains" plugin (
>> https://premium.wpmudev.org/project/multi-domains/) but it doesn't do what
>> I really need because it maps multiple domains to multiple blog ids. I need
>> to map different domains all to the main blog.
>> 
>> Is there a way to achieve this? Any suggestions on hooks I could use?
>> 
>> Thank you! :)
>> 
>> 
>> Filippo Pisano


From abdussamad at abdussamad.com  Tue Oct 15 17:49:23 2013
From: abdussamad at abdussamad.com (Abdussamad Abdurrazzaq)
Date: Tue, 15 Oct 2013 22:49:23 +0500
Subject: [wp-hackers] Multi-domains on Multi-site
In-Reply-To: <7E82FCFF-D155-4E40-8EAD-D5DF6F2973F6@thoughtrefinery.com>
References: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
 <525D7849.40704@abdussamad.com>
 <7E82FCFF-D155-4E40-8EAD-D5DF6F2973F6@thoughtrefinery.com>
Message-ID: <525D8023.70103@abdussamad.com>

You can use a sub-domain as your network home aka throwaway blog. When 
installing multi site choose the subsites as sub folders option.

http://codex.wordpress.org/Create_A_Network

On 10/15/2013 10:36 PM, Nicholas Ciske wrote:
> Domain Mapping plugins can generally map multiple domains to any *sub-site* ... but cannot map additional domains the main site/blog -- something has to be absolute. That way lies madness and redirect loops -- the main site is the main site and can really only have one domain associated with it. You can use a throwaway (non public) domain for the main site (e.g. a .info domain) and run all sites as sub-sites to enable domain mapping for the 'main public' domain.
>
> e.g.
> example.info
> - example.com <- this is your main public site, but is actually a subsite in MS
> - other.net
> ...
>
> As Abdussamad said, only one mapped domain can be primary and all other domains mapped to a sub-site will flow towards the primary domain (e.g. via a redirect or the users first click). This is pretty fundamental to how WP is architected (e.g. it won't even allow www. and no www. -- you have to choose one to redirect the other to).
>
> If you want multiple domains to point to your main blog domain... use DNS redirects (or .htaccess redirects before the WP rewrite rules *to the main domain* if you need to redirect specific URLs).
>
> Avoid mapping multiple domains to serve the same content -- e.g. using a hook to break WP's preference for a single canonical domain per site -- as Mika said, that way lies SEO madness (and duplicate content penalties).
> https://support.google.com/webmasters/answer/66359?hl=en
>
> Basically, any domain + URL combo should ideally serve mostly unique content... if you have multiple domains/urls serving the exact same content, you're probably doing_it_wrong() and will not likely find a plugin to assist you in hosing your SEO ;-)
>
> _________________________
> Nick Ciske
> http://thoughtrefinery.com/
> @nciske	
>
> On Oct 15, 2013, at 12:15 PM, Abdussamad Abdurrazzaq wrote:
>
>> The standard free domain mapping plugin can do this:
>>
>> http://wordpress.org/plugins/wordpress-mu-domain-mapping/
>>
>> You can map multiple domains to the same site but one of the domains should be set as the primary. Other domains will redirect to the primary one.
>>
>> On 10/15/2013 09:40 PM, Filippo Pisano wrote:
>>> Hello Hackers,
>>>
>>> I need to map multiple domains to a multisite installation. What I need to
>>> do is map domain-one.com and domain-two.com to the same blog id. I've tried
>>> the "Multi Domains" plugin (
>>> https://premium.wpmudev.org/project/multi-domains/) but it doesn't do what
>>> I really need because it maps multiple domains to multiple blog ids. I need
>>> to map different domains all to the main blog.
>>>
>>> Is there a way to achieve this? Any suggestions on hooks I could use?
>>>
>>> Thank you! :)
>>>
>>>
>>> Filippo Pisano
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From mailman at haukebruno.de  Tue Oct 15 17:52:50 2013
From: mailman at haukebruno.de (Hauke)
Date: Tue, 15 Oct 2013 19:52:50 +0200
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
Message-ID: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>

Hi there,

is it possible to change code lines like

$current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] . 
$_SERVER['REQUEST_URI'] );

into something like this:

if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
  $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
} else {
   $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
}
$current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );

In my case I changed that in wp-admin/includes/class-wp-list-table.php 
(lines 494 and 651, WP 3.5.1 (same in WP 3.6.1).

I am not a developer, therefore that code isn't that nice. It's more like an 
idea for you guys with a lot more knowledge than mine.

The reason why I need that code:

We use WP (and some other apps) under one domain, e.g. example.com. 
In our case, we want to use (pseudo) subfolder domains for that different 
apps, e.g. 'example.com/blog', 'example.com/shop' or 'example.com/foo'. At 
the same time, we want to seperate these apps in one VHost per app (we 
use Apache + fcgid for separating PHP too).
So we put a load balancer/caching proxy (Varnish) in front of our 
webservers, which handles those URL rewriting stuff. It detects 
example.com/blog and rewrites the HTTP HOST Header Field to something 
internal like 'blog.example.local'. The Requests now reach the correct 
VHosts on the backend webservers. We provide the original hostname in 
the HTTP X_FORWARDED_HOST Header Field.
WP works good at all with that setting, but there are some things like 
pagination or that list table one the 'All Pages' site in the WP backend, 
that doesn't work because of producing URIs with the internal hostname.

-- 
Best regards,
Hauke

From nikolov.tmw at gmail.com  Tue Oct 15 17:59:54 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Tue, 15 Oct 2013 20:59:54 +0300
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
Message-ID: <CAOwx47deyk=01W+b83UZPvh4CZonEZTmd6iu8m9-NKngSi=UCA@mail.gmail.com>

Why don't you just create an mu-plugin that will override the
$_SERVER['HTTP_HOST'] variable?

Simply do something like

if ( isset( $_SERVER['HTTP_X_FORWARDED_HOST'] )
&& $_SERVER['HTTP_X_FORWARDED_HOST'] && _is_valid_host(
$_SERVER['HTTP_X_FORWARDED_HOST'] ) ) {
    $_SERVER['HTT_HOST'] = $_SERVER['HTTP_X_FORWARDED_HOST'];
}

Note that the "_is_valid_host()" function is not an actual function. You
will have to define a function that will check the value passed to it and
make sure that it's acceptable(for instance you can check it against an
array of your domains).


On Tue, Oct 15, 2013 at 8:52 PM, Hauke <mailman at haukebruno.de> wrote:

> Hi there,
>
> is it possible to change code lines like
>
> $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> $_SERVER['REQUEST_URI'] );
>
> into something like this:
>
> if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
>   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> } else {
>    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> }
> $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );
>
> In my case I changed that in wp-admin/includes/class-wp-list-table.php
> (lines 494 and 651, WP 3.5.1 (same in WP 3.6.1).
>
> I am not a developer, therefore that code isn't that nice. It's more like
> an
> idea for you guys with a lot more knowledge than mine.
>
> The reason why I need that code:
>
> We use WP (and some other apps) under one domain, e.g. example.com.
> In our case, we want to use (pseudo) subfolder domains for that different
> apps, e.g. 'example.com/blog', 'example.com/shop' or 'example.com/foo'. At
> the same time, we want to seperate these apps in one VHost per app (we
> use Apache + fcgid for separating PHP too).
> So we put a load balancer/caching proxy (Varnish) in front of our
> webservers, which handles those URL rewriting stuff. It detects
> example.com/blog and rewrites the HTTP HOST Header Field to something
> internal like 'blog.example.local'. The Requests now reach the correct
> VHosts on the backend webservers. We provide the original hostname in
> the HTTP X_FORWARDED_HOST Header Field.
> WP works good at all with that setting, but there are some things like
> pagination or that list table one the 'All Pages' site in the WP backend,
> that doesn't work because of producing URIs with the internal hostname.
>
> --
> Best regards,
> Hauke
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From filippo.pisano at gmail.com  Tue Oct 15 18:01:24 2013
From: filippo.pisano at gmail.com (Filippo Pisano)
Date: Tue, 15 Oct 2013 20:01:24 +0200
Subject: [wp-hackers] Multi-domains on Multi-site
In-Reply-To: <525D8023.70103@abdussamad.com>
References: <CABCyq-kBpsQmoEWxmYomtrD-0adSWDSQerhSvTCPvZkmOhQCcA@mail.gmail.com>
 <525D7849.40704@abdussamad.com>
 <7E82FCFF-D155-4E40-8EAD-D5DF6F2973F6@thoughtrefinery.com>
 <525D8023.70103@abdussamad.com>
Message-ID: <CABCyq-mGWMFoedAEQsd3e4yAd+HW1+vx2xdLv6__sAJeKDC9ng@mail.gmail.com>

Thank you all for your quick and exhaustive responses. The throwaway
approach may be really what I need. I think I'll try and map two different
domains to the same sub-blog.
The SEO side of things is not a problem because the second domain (which is
not public) is only served internally in our network because we expose some
web services to other software.

Thank you :)



Filippo Pisano
cel: 3291821355 / skype: filippopisano


On Tue, Oct 15, 2013 at 7:49 PM, Abdussamad Abdurrazzaq <
abdussamad at abdussamad.com> wrote:

> You can use a sub-domain as your network home aka throwaway blog. When
> installing multi site choose the subsites as sub folders option.
>
> http://codex.wordpress.org/**Create_A_Network<http://codex.wordpress.org/Create_A_Network>
>
>
> On 10/15/2013 10:36 PM, Nicholas Ciske wrote:
>
>> Domain Mapping plugins can generally map multiple domains to any
>> *sub-site* ... but cannot map additional domains the main site/blog --
>> something has to be absolute. That way lies madness and redirect loops --
>> the main site is the main site and can really only have one domain
>> associated with it. You can use a throwaway (non public) domain for the
>> main site (e.g. a .info domain) and run all sites as sub-sites to enable
>> domain mapping for the 'main public' domain.
>>
>> e.g.
>> example.info
>> - example.com <- this is your main public site, but is actually a
>> subsite in MS
>> - other.net
>> ...
>>
>> As Abdussamad said, only one mapped domain can be primary and all other
>> domains mapped to a sub-site will flow towards the primary domain (e.g. via
>> a redirect or the users first click). This is pretty fundamental to how WP
>> is architected (e.g. it won't even allow www. and no www. -- you have to
>> choose one to redirect the other to).
>>
>> If you want multiple domains to point to your main blog domain... use DNS
>> redirects (or .htaccess redirects before the WP rewrite rules *to the main
>> domain* if you need to redirect specific URLs).
>>
>> Avoid mapping multiple domains to serve the same content -- e.g. using a
>> hook to break WP's preference for a single canonical domain per site -- as
>> Mika said, that way lies SEO madness (and duplicate content penalties).
>> https://support.google.com/**webmasters/answer/66359?hl=en<https://support.google.com/webmasters/answer/66359?hl=en>
>>
>> Basically, any domain + URL combo should ideally serve mostly unique
>> content... if you have multiple domains/urls serving the exact same
>> content, you're probably doing_it_wrong() and will not likely find a plugin
>> to assist you in hosing your SEO ;-)
>>
>> _________________________
>> Nick Ciske
>> http://thoughtrefinery.com/
>> @nciske
>>
>> On Oct 15, 2013, at 12:15 PM, Abdussamad Abdurrazzaq wrote:
>>
>>  The standard free domain mapping plugin can do this:
>>>
>>> http://wordpress.org/plugins/**wordpress-mu-domain-mapping/<http://wordpress.org/plugins/wordpress-mu-domain-mapping/>
>>>
>>> You can map multiple domains to the same site but one of the domains
>>> should be set as the primary. Other domains will redirect to the primary
>>> one.
>>>
>>> On 10/15/2013 09:40 PM, Filippo Pisano wrote:
>>>
>>>> Hello Hackers,
>>>>
>>>> I need to map multiple domains to a multisite installation. What I need
>>>> to
>>>> do is map domain-one.com and domain-two.com to the same blog id. I've
>>>> tried
>>>> the "Multi Domains" plugin (
>>>> https://premium.wpmudev.org/**project/multi-domains/<https://premium.wpmudev.org/project/multi-domains/>)
>>>> but it doesn't do what
>>>> I really need because it maps multiple domains to multiple blog ids. I
>>>> need
>>>> to map different domains all to the main blog.
>>>>
>>>> Is there a way to achieve this? Any suggestions on hooks I could use?
>>>>
>>>> Thank you! :)
>>>>
>>>>
>>>> Filippo Pisano
>>>>
>>>
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
>>  ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From mailman at haukebruno.de  Tue Oct 15 20:16:45 2013
From: mailman at haukebruno.de (Hauke)
Date: Tue, 15 Oct 2013 22:16:45 +0200
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <CAOwx47deyk=01W+b83UZPvh4CZonEZTmd6iu8m9-NKngSi=UCA@mail.gmail.com>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
 <CAOwx47deyk=01W+b83UZPvh4CZonEZTmd6iu8m9-NKngSi=UCA@mail.gmail.com>
Message-ID: <276375232.mLR8t8oqqH@notenbuch.haukebruno.de>

Hi Nikola,

thanks so far. I created a very basic plugin: 
https://github.com/haukebruno/wp-xforwardedhost

It works for me now.

Cheers, 
Hauke

-- 
Best regards,
Hauke
On Tuesday, October 15, 2013 08:59:54 PM Nikola Nikolov wrote:
> Why don't you just create an mu-plugin that will override the
> $_SERVER['HTTP_HOST'] variable?
> 
> Simply do something like
> 
> if ( isset( $_SERVER['HTTP_X_FORWARDED_HOST'] )
> && $_SERVER['HTTP_X_FORWARDED_HOST'] && _is_valid_host(
> $_SERVER['HTTP_X_FORWARDED_HOST'] ) ) {
>     $_SERVER['HTT_HOST'] = $_SERVER['HTTP_X_FORWARDED_HOST'];
> }
> 
> Note that the "_is_valid_host()" function is not an actual function. You
> will have to define a function that will check the value passed to it and
> make sure that it's acceptable(for instance you can check it against an
> array of your domains).
> 
> On Tue, Oct 15, 2013 at 8:52 PM, Hauke <mailman at haukebruno.de> wrote:
> > Hi there,
> > 
> > is it possible to change code lines like
> > 
> > $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> > $_SERVER['REQUEST_URI'] );
> > 
> > into something like this:
> > 
> > if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
> > 
> >   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > 
> > } else {
> > 
> >    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> > 
> > }
> > $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );
> > 
> > In my case I changed that in wp-admin/includes/class-wp-list-table.php
> > (lines 494 and 651, WP 3.5.1 (same in WP 3.6.1).
> > 
> > I am not a developer, therefore that code isn't that nice. It's more like
> > an
> > idea for you guys with a lot more knowledge than mine.
> > 
> > The reason why I need that code:
> > 
> > We use WP (and some other apps) under one domain, e.g. example.com.
> > In our case, we want to use (pseudo) subfolder domains for that different
> > apps, e.g. 'example.com/blog', 'example.com/shop' or 'example.com/foo'. At
> > the same time, we want to seperate these apps in one VHost per app (we
> > use Apache + fcgid for separating PHP too).
> > So we put a load balancer/caching proxy (Varnish) in front of our
> > webservers, which handles those URL rewriting stuff. It detects
> > example.com/blog and rewrites the HTTP HOST Header Field to something
> > internal like 'blog.example.local'. The Requests now reach the correct
> > VHosts on the backend webservers. We provide the original hostname in
> > the HTTP X_FORWARDED_HOST Header Field.
> > WP works good at all with that setting, but there are some things like
> > pagination or that list table one the 'All Pages' site in the WP backend,
> > that doesn't work because of producing URIs with the internal hostname.
> > 
> > --
> > Best regards,
> > Hauke
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From nikolov.tmw at gmail.com  Tue Oct 15 22:38:49 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 16 Oct 2013 01:38:49 +0300
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <276375232.mLR8t8oqqH@notenbuch.haukebruno.de>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
 <CAOwx47deyk=01W+b83UZPvh4CZonEZTmd6iu8m9-NKngSi=UCA@mail.gmail.com>
 <276375232.mLR8t8oqqH@notenbuch.haukebruno.de>
Message-ID: <CAOwx47dyWT=7D-ciDd3-O5YPh=DcCSCo2YyUvmaTj_O=Ua38pw@mail.gmail.com>

Yep - that's exactly what I had in mind.

You can shorten your code by simply changing your function to this:

function is_valid_host( $hosts, $xforwardedhost ) {
  return in_array( $xforwardedhost, $hosts );
}


Not that having a loop would make a big difference - but you know being
minimalistic is sometimes cool :)

I'm glad you were able to figure it out though.

Nikola


On Tue, Oct 15, 2013 at 11:16 PM, Hauke <mailman at haukebruno.de> wrote:

> Hi Nikola,
>
> thanks so far. I created a very basic plugin:
> https://github.com/haukebruno/wp-xforwardedhost
>
> It works for me now.
>
> Cheers,
> Hauke
>
> --
> Best regards,
> Hauke
> On Tuesday, October 15, 2013 08:59:54 PM Nikola Nikolov wrote:
> > Why don't you just create an mu-plugin that will override the
> > $_SERVER['HTTP_HOST'] variable?
> >
> > Simply do something like
> >
> > if ( isset( $_SERVER['HTTP_X_FORWARDED_HOST'] )
> > && $_SERVER['HTTP_X_FORWARDED_HOST'] && _is_valid_host(
> > $_SERVER['HTTP_X_FORWARDED_HOST'] ) ) {
> >     $_SERVER['HTT_HOST'] = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > }
> >
> > Note that the "_is_valid_host()" function is not an actual function. You
> > will have to define a function that will check the value passed to it and
> > make sure that it's acceptable(for instance you can check it against an
> > array of your domains).
> >
> > On Tue, Oct 15, 2013 at 8:52 PM, Hauke <mailman at haukebruno.de> wrote:
> > > Hi there,
> > >
> > > is it possible to change code lines like
> > >
> > > $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> > > $_SERVER['REQUEST_URI'] );
> > >
> > > into something like this:
> > >
> > > if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
> > >
> > >   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > >
> > > } else {
> > >
> > >    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> > >
> > > }
> > > $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );
> > >
> > > In my case I changed that in wp-admin/includes/class-wp-list-table.php
> > > (lines 494 and 651, WP 3.5.1 (same in WP 3.6.1).
> > >
> > > I am not a developer, therefore that code isn't that nice. It's more
> like
> > > an
> > > idea for you guys with a lot more knowledge than mine.
> > >
> > > The reason why I need that code:
> > >
> > > We use WP (and some other apps) under one domain, e.g. example.com.
> > > In our case, we want to use (pseudo) subfolder domains for that
> different
> > > apps, e.g. 'example.com/blog', 'example.com/shop' or 'example.com/foo'.
> At
> > > the same time, we want to seperate these apps in one VHost per app (we
> > > use Apache + fcgid for separating PHP too).
> > > So we put a load balancer/caching proxy (Varnish) in front of our
> > > webservers, which handles those URL rewriting stuff. It detects
> > > example.com/blog and rewrites the HTTP HOST Header Field to something
> > > internal like 'blog.example.local'. The Requests now reach the correct
> > > VHosts on the backend webservers. We provide the original hostname in
> > > the HTTP X_FORWARDED_HOST Header Field.
> > > WP works good at all with that setting, but there are some things like
> > > pagination or that list table one the 'All Pages' site in the WP
> backend,
> > > that doesn't work because of producing URIs with the internal hostname.
> > >
> > > --
> > > Best regards,
> > > Hauke
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From wp at andrewnacin.com  Wed Oct 16 04:32:19 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Wed, 16 Oct 2013 00:32:19 -0400
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
Message-ID: <CAP29PvhnS9-dBXB9ijraM6h9jM7fVJbt4FHV_WzH1Ec7-ADB6w@mail.gmail.com>

On Tue, Oct 15, 2013 at 1:52 PM, Hauke <mailman at haukebruno.de> wrote:

> is it possible to change code lines like
>
> $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> $_SERVER['REQUEST_URI'] );
>
> into something like this:
>
> if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
>   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> } else {
>    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> }
> $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );
>

Many load balancers and proxy servers forward HTTP headers for HTTPS, IP
addresses, and more. These typically take the form of HTTP_X_FORWARDED_FOR
(X-Forwarded-For), for remote IP addresses, and HTTP_X_FORWARDED_PROTO
(X-Forwarded-Proto), for whether traffic is going over the HTTPS protocol.
Occasionally other information needs to be forwarded, like the server port
or hostname.

If WordPress blindly listened to these headers ? especially for protocols ?
there is a risk of infinite redirects and general breakage. To make matters
worse, these are not formal standards, and are rather freeform. As a
result, many web server and configurations do this differently. For
example, one configuration might prepend ?HTTP_?, resulting in HTTP_HTTPS.
What should be done instead is a server should either pass properly mapped
headers to PHP, or some code can do the mapping in wp-config.php. For
example:

if ( isset( $_SERVER['HTTP_X_FORWARDED_PROTO'] ) && 'https' ===
$_SERVER['HTTP_X_FORWARDED_PROTO'] ) )
    $_SERVER['HTTPS'] = 'on';

See also:
http://core.trac.wordpress.org/ticket/9235
http://core.trac.wordpress.org/ticket/15009
http://core.trac.wordpress.org/ticket/15733
http://core.trac.wordpress.org/ticket/19337
http://core.trac.wordpress.org/ticket/24394
etc.

Nacin

From mailman at haukebruno.de  Wed Oct 16 07:39:08 2013
From: mailman at haukebruno.de (Hauke)
Date: Wed, 16 Oct 2013 09:39:08 +0200
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <CAOwx47dyWT=7D-ciDd3-O5YPh=DcCSCo2YyUvmaTj_O=Ua38pw@mail.gmail.com>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
 <276375232.mLR8t8oqqH@notenbuch.haukebruno.de>
 <CAOwx47dyWT=7D-ciDd3-O5YPh=DcCSCo2YyUvmaTj_O=Ua38pw@mail.gmail.com>
Message-ID: <1443787.jCA70Wi2cZ@notenbuch.haukebruno.de>

Hi Nikola,

I shortened the code so far. Thank you pretty much for your help ;)

-- 
Best regards,
Hauke
On Wednesday, October 16, 2013 01:38:49 AM Nikola Nikolov wrote:
> Yep - that's exactly what I had in mind.
> 
> You can shorten your code by simply changing your function to this:
> 
> function is_valid_host( $hosts, $xforwardedhost ) {
>   return in_array( $xforwardedhost, $hosts );
> }
> 
> 
> Not that having a loop would make a big difference - but you know being
> minimalistic is sometimes cool :)
> 
> I'm glad you were able to figure it out though.
> 
> Nikola
> 
> On Tue, Oct 15, 2013 at 11:16 PM, Hauke <mailman at haukebruno.de> wrote:
> > Hi Nikola,
> > 
> > thanks so far. I created a very basic plugin:
> > https://github.com/haukebruno/wp-xforwardedhost
> > 
> > It works for me now.
> > 
> > Cheers,
> > Hauke
> > 
> > --
> > Best regards,
> > Hauke
> > 
> > On Tuesday, October 15, 2013 08:59:54 PM Nikola Nikolov wrote:
> > > Why don't you just create an mu-plugin that will override the
> > > $_SERVER['HTTP_HOST'] variable?
> > > 
> > > Simply do something like
> > > 
> > > if ( isset( $_SERVER['HTTP_X_FORWARDED_HOST'] )
> > > && $_SERVER['HTTP_X_FORWARDED_HOST'] && _is_valid_host(
> > > $_SERVER['HTTP_X_FORWARDED_HOST'] ) ) {
> > > 
> > >     $_SERVER['HTT_HOST'] = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > > 
> > > }
> > > 
> > > Note that the "_is_valid_host()" function is not an actual function. You
> > > will have to define a function that will check the value passed to it
> > > and
> > > make sure that it's acceptable(for instance you can check it against an
> > > array of your domains).
> > > 
> > > On Tue, Oct 15, 2013 at 8:52 PM, Hauke <mailman at haukebruno.de> wrote:
> > > > Hi there,
> > > > 
> > > > is it possible to change code lines like
> > > > 
> > > > $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> > > > $_SERVER['REQUEST_URI'] );
> > > > 
> > > > into something like this:
> > > > 
> > > > if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
> > > > 
> > > >   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > > > 
> > > > } else {
> > > > 
> > > >    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> > > > 
> > > > }
> > > > $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI']
> > > > );
> > > > 
> > > > In my case I changed that in wp-admin/includes/class-wp-list-table.php
> > > > (lines 494 and 651, WP 3.5.1 (same in WP 3.6.1).
> > > > 
> > > > I am not a developer, therefore that code isn't that nice. It's more
> > 
> > like
> > 
> > > > an
> > > > idea for you guys with a lot more knowledge than mine.
> > > > 
> > > > The reason why I need that code:
> > > > 
> > > > We use WP (and some other apps) under one domain, e.g. example.com.
> > > > In our case, we want to use (pseudo) subfolder domains for that
> > 
> > different
> > 
> > > > apps, e.g. 'example.com/blog', 'example.com/shop' or
> > > > 'example.com/foo'.
> > 
> > At
> > 
> > > > the same time, we want to seperate these apps in one VHost per app (we
> > > > use Apache + fcgid for separating PHP too).
> > > > So we put a load balancer/caching proxy (Varnish) in front of our
> > > > webservers, which handles those URL rewriting stuff. It detects
> > > > example.com/blog and rewrites the HTTP HOST Header Field to something
> > > > internal like 'blog.example.local'. The Requests now reach the correct
> > > > VHosts on the backend webservers. We provide the original hostname in
> > > > the HTTP X_FORWARDED_HOST Header Field.
> > > > WP works good at all with that setting, but there are some things like
> > > > pagination or that list table one the 'All Pages' site in the WP
> > 
> > backend,
> > 
> > > > that doesn't work because of producing URIs with the internal
> > > > hostname.
> > > > 
> > > > --
> > > > Best regards,
> > > > Hauke
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > 
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > 
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From mailman at haukebruno.de  Wed Oct 16 07:40:27 2013
From: mailman at haukebruno.de (Hauke)
Date: Wed, 16 Oct 2013 09:40:27 +0200
Subject: [wp-hackers] Make WP more usable behind load balancers/proxies
In-Reply-To: <CAP29PvhnS9-dBXB9ijraM6h9jM7fVJbt4FHV_WzH1Ec7-ADB6w@mail.gmail.com>
References: <1573779.e4CFqevfnE@notenbuch.haukebruno.de>
 <CAP29PvhnS9-dBXB9ijraM6h9jM7fVJbt4FHV_WzH1Ec7-ADB6w@mail.gmail.com>
Message-ID: <22655543.zv9roVXZC7@notenbuch.haukebruno.de>

Hi Nacin,

thanks for your advices. I will have a look at it.

-- 
Best regards,
Hauke
On Wednesday, October 16, 2013 12:32:19 AM Andrew Nacin wrote:
> On Tue, Oct 15, 2013 at 1:52 PM, Hauke <mailman at haukebruno.de> wrote:
> > is it possible to change code lines like
> > 
> > $current_url = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] .
> > $_SERVER['REQUEST_URI'] );
> > 
> > into something like this:
> > 
> > if (!empty($_SERVER['HTTP_X_FORWARDED_HOST'])) {
> > 
> >   $serverhost = $_SERVER['HTTP_X_FORWARDED_HOST'];
> > 
> > } else {
> > 
> >    $serverhost = 'http://' . $_SERVER['HTTP_HOST'];
> > 
> > }
> > $current_url = set_url_scheme( $serverhost . $_SERVER['REQUEST_URI'] );
> 
> Many load balancers and proxy servers forward HTTP headers for HTTPS, IP
> addresses, and more. These typically take the form of HTTP_X_FORWARDED_FOR
> (X-Forwarded-For), for remote IP addresses, and HTTP_X_FORWARDED_PROTO
> (X-Forwarded-Proto), for whether traffic is going over the HTTPS protocol.
> Occasionally other information needs to be forwarded, like the server port
> or hostname.
> 
> If WordPress blindly listened to these headers ? especially for protocols ?
> there is a risk of infinite redirects and general breakage. To make matters
> worse, these are not formal standards, and are rather freeform. As a
> result, many web server and configurations do this differently. For
> example, one configuration might prepend ?HTTP_?, resulting in HTTP_HTTPS.
> What should be done instead is a server should either pass properly mapped
> headers to PHP, or some code can do the mapping in wp-config.php. For
> example:
> 
> if ( isset( $_SERVER['HTTP_X_FORWARDED_PROTO'] ) && 'https' ===
> $_SERVER['HTTP_X_FORWARDED_PROTO'] ) )
>     $_SERVER['HTTPS'] = 'on';
> 
> See also:
> http://core.trac.wordpress.org/ticket/9235
> http://core.trac.wordpress.org/ticket/15009
> http://core.trac.wordpress.org/ticket/15733
> http://core.trac.wordpress.org/ticket/19337
> http://core.trac.wordpress.org/ticket/24394
> etc.
> 
> Nacin
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Wed Oct 16 13:58:28 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 16 Oct 2013 06:58:28 -0700 (PDT)
Subject: [wp-hackers] Using WP Transients for User Sessions
Message-ID: <1381931908737-42547.post@n5.nabble.com>

Basically I am using transients to setup a timeout after users login, so
active users names will have a little green label by them.  After the time
period, that dot disappears.  However I know on a busy site transients can
be troublesome, so I setup (I think, I have no idea if I did this properly)
a delete_transient on logout. 

I am checking the database and I dont see anything being deleted from
wp_options, still has the same...


_transient_timeout_feed_mod_ac0b00fe65abe10e0c5b58...
1380374961

you get the idea.  So I am hoping someone more familiar with this can check
out my code here.  Now I should mention that the delete function APPEARS to
be working.  On logout, the user session label is immediately changed (vs it
staying on for 30 mins or so without the function).

Does this all look like its functioning properly?  Why am I not seeing the
hash delete from wp_options upon logout?

*add_action('wp', 'update_online_users_status');
function update_online_users_status(){

    if(is_user_logged_in()){

        if(($logged_in_users = get_transient('users_online')) === false)
$logged_in_users = array();

        $current_user = wp_get_current_user();
        $current_user = $current_user->ID;  
        $current_time = current_time('timestamp');

        if(!isset($logged_in_users[$current_user]) ||
($logged_in_users[$current_user] < ($current_time - (15 * 60)))){
            $logged_in_users[$current_user] = $current_time;
            set_transient('users_online', $logged_in_users, 30 * 60);
        } 
    }
}


function is_user_online( $user_id ) {
    $logged_in_users = get_transient( 'users_online' );
    return isset( $logged_in_users[$user_id] ) && (
$logged_in_users[$user_id] >     ( current_time( 'timestamp' ) - ( 15 * 60 )
) );   
}
*

and on logout, its calling this:

*function clear_transient_on_logout() {
	  
    delete_transient('users_online');
}
add_action('wp_logout', 'clear_transient_on_logout');*




--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Using-WP-Transients-for-User-Sessions-tp42547.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From otto at ottodestruct.com  Wed Oct 16 14:06:54 2013
From: otto at ottodestruct.com (Otto)
Date: Wed, 16 Oct 2013 09:06:54 -0500
Subject: [wp-hackers] Using WP Transients for User Sessions
In-Reply-To: <1381931908737-42547.post@n5.nabble.com>
References: <1381931908737-42547.post@n5.nabble.com>
Message-ID: <CAD-FghzjjW_Pif8SNUgmsLPbO7xakjBnmRNCaCSVUCGLenUAoQ@mail.gmail.com>

On Wed, Oct 16, 2013 at 8:58 AM, BenderisGreat
<greglancaster71 at gmail.com> wrote:
> I am checking the database and I dont see anything being deleted from
> wp_options, still has the same...
>
> _transient_timeout_feed_mod_ac0b00fe65abe10e0c5b58...
> 1380374961
...
>     delete_transient('users_online');

Just checking here, but it seems like you're looking at a different
transient (the "feed_mod_whatever" one). That transient is for storing
the feeds being retrieved from other places.

Each transient entry has its own row for the transient's data and
another for the timeout. Since yours is "users_online", you should
look for "_transient_timeout_users_online" instead.

-Otto

From jdg at codesymphony.co  Wed Oct 16 14:11:38 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Wed, 16 Oct 2013 10:11:38 -0400
Subject: [wp-hackers] Using WP Transients for User Sessions
In-Reply-To: <1381931908737-42547.post@n5.nabble.com>
References: <1381931908737-42547.post@n5.nabble.com>
Message-ID: <4DC76753-7A28-40E6-BD00-D5F60BAC1607@codesymphony.co>

First, this is not your transient:

> _transient_timeout_feed_mod_ac0b00fe65abe10e0c5b58?
> 1380374961

Yours would look have 'users_online' in it. The easiest way to check if it was deleted is to call get_transient(). If it returns false, then the delete must have worked (or it is expired).

Secondly, there is a problem with your logic here, I think. You are deleting the data for all logged in users, when a single user logs out. I don't think that is what you want to do. You will want to either use a different transient for each user, or just delete them from the array when they log out.

--J.D.

From greglancaster71 at gmail.com  Wed Oct 16 14:18:45 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 16 Oct 2013 07:18:45 -0700 (PDT)
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <CAOwx47eJQrj2SDF9d4bm6AXK_tbKYYe+0M6bc9VuFvVquve4tA@mail.gmail.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
 <1381350381912-42497.post@n5.nabble.com>
 <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>
 <1381522559013-42522.post@n5.nabble.com>
 <CAOwx47eJQrj2SDF9d4bm6AXK_tbKYYe+0M6bc9VuFvVquve4tA@mail.gmail.com>
Message-ID: <1381933125776-42550.post@n5.nabble.com>

Thank you man, that was a really clean addition.  I like how you did the
search and replace for shorter names ('%FNAME%') and the content filter to
insert the code into a page template is great.   :)    With your additions I
was even able to style some css into the header block next to the h1 and I
duplicated the my_title_filter and renamed it my_header_filter, changed a
couple simple things and now it allows for custom title tags and h1 post
title.

Thanks a million Nikola!  




--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42550.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Wed Oct 16 15:17:11 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 16 Oct 2013 18:17:11 +0300
Subject: [wp-hackers] Dynamic User Pages - How Does BuddyPress do it?
In-Reply-To: <1381933125776-42550.post@n5.nabble.com>
References: <1381344921340-42492.post@n5.nabble.com>
 <CAOwx47dMdEj04XiD9MFAw4vPTKTmKi-MNgZgRRHAZvwhUcn0OQ@mail.gmail.com>
 <1381348339242-42495.post@n5.nabble.com>
 <CAOwx47fWAatsp5jSaCWuL9C+_m0D_7xfdamNwoiHhhFBg0aoLQ@mail.gmail.com>
 <1381350381912-42497.post@n5.nabble.com>
 <CAOwx47cJgxexeE4A4T5=ynHVkccfU0if3=7kSYEwKBSaz8V6uQ@mail.gmail.com>
 <1381522559013-42522.post@n5.nabble.com>
 <CAOwx47eJQrj2SDF9d4bm6AXK_tbKYYe+0M6bc9VuFvVquve4tA@mail.gmail.com>
 <1381933125776-42550.post@n5.nabble.com>
Message-ID: <CAOwx47feeH3dkaUe3qmJytqus6sF+hvgSHKJVAMNHx4wy=jqRg@mail.gmail.com>

I'm happy that it helped you :)


On Wed, Oct 16, 2013 at 5:18 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> Thank you man, that was a really clean addition.  I like how you did the
> search and replace for shorter names ('%FNAME%') and the content filter to
> insert the code into a page template is great.   :)    With your additions
> I
> was even able to style some css into the header block next to the h1 and I
> duplicated the my_title_filter and renamed it my_header_filter, changed a
> couple simple things and now it allows for custom title tags and h1 post
> title.
>
> Thanks a million Nikola!
>
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Dynamic-User-Pages-How-Does-BuddyPress-do-it-tp42492p42550.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Wed Oct 16 16:22:34 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Wed, 16 Oct 2013 09:22:34 -0700 (PDT)
Subject: [wp-hackers] Using WP Transients for User Sessions
In-Reply-To: <4DC76753-7A28-40E6-BD00-D5F60BAC1607@codesymphony.co>
References: <1381931908737-42547.post@n5.nabble.com>
 <4DC76753-7A28-40E6-BD00-D5F60BAC1607@codesymphony.co>
Message-ID: <1381940554453-42552.post@n5.nabble.com>

thats what I thought it was doing, but I wasnt sure because a var_dump looks
like each session is stored via the user_id

array(2) { [1]=> int(1381939181) [13]=> int(1381940097) }

how would I go about calling delete_transient() from an array like that. On
http://codex.wordpress.org/Function_Reference/delete_transient  it says it
only accepts a single string. 



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Using-WP-Transients-for-User-Sessions-tp42547p42552.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From jdg at codesymphony.co  Wed Oct 16 16:30:20 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Wed, 16 Oct 2013 12:30:20 -0400
Subject: [wp-hackers] Using WP Transients for User Sessions
In-Reply-To: <1381940554453-42552.post@n5.nabble.com>
References: <1381931908737-42547.post@n5.nabble.com>
 <4DC76753-7A28-40E6-BD00-D5F60BAC1607@codesymphony.co>
 <1381940554453-42552.post@n5.nabble.com>
Message-ID: <1CAB7DC5-FCCD-45E4-B777-7C6FD1C024AB@codesymphony.co>


On Oct 16, 2013, at 12:22 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> thats what I thought it was doing, but I wasnt sure because a var_dump looks
> like each session is stored via the user_id
> 
> array(2) { [1]=> int(1381939181) [13]=> int(1381940097) }
> 
> how would I go about calling delete_transient() from an array like that. On
> http://codex.wordpress.org/Function_Reference/delete_transient  it says it
> only accepts a single string. 

Don't call delete_transient(). Do something like this:

<?php

function clear_transient_on_logout() {

	$logged_in_users = get_transient( 'users_online' );
	
	$user_id = get_current_user_id();

	// Remove this user.
	unset( $logged_in_users[ $user_id ] );

	set_transient( 'users_online', $logged_in_users );
}
add_action('wp_logout', 'clear_transient_on_logout');

?>

-J.D.

From halukkaramete at gmail.com  Thu Oct 17 18:26:43 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 17 Oct 2013 11:26:43 -0700
Subject: [wp-hackers] Weird wp-cron.php erorr.
Message-ID: <CAHERW=2-VhL2nLs5V5oF3uwbLPpd1pgB4q9mSkkXkx7jhRrZ0w@mail.gmail.com>

Every once in a while, I get this error on my local host:

Warning: fopen(
http://localhost/ic/wp-cron.php?doing_wp_cron=1382034056.3116404541851806640625)
[<a href='function.fopen'>function.fopen</a>]: failed to open stream: HTTP
request failed!

And when I refresh the page, it goes away.

It usually happens at first visits for each day. But it sometimes happen a
few times a day. 99% percent of the time, I do not experience it.
But I do expereince it 100% of the time for the first visits of the day.

What could be the cause of it?

From jdg at codesymphony.co  Thu Oct 17 19:10:24 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 17 Oct 2013 15:10:24 -0400
Subject: [wp-hackers] Weird wp-cron.php erorr.
In-Reply-To: <CAHERW=2-VhL2nLs5V5oF3uwbLPpd1pgB4q9mSkkXkx7jhRrZ0w@mail.gmail.com>
References: <CAHERW=2-VhL2nLs5V5oF3uwbLPpd1pgB4q9mSkkXkx7jhRrZ0w@mail.gmail.com>
Message-ID: <2730F5CE-DD1A-4815-B934-7B866E2D3A08@codesymphony.co>

The error probably happens each time that cron runs. It usually runs the first time that you visit the site, when it won't have run in a while (it is only triggered when the site is visited). I guess the error is because for some reason the site is not able to make the request to wp-cron.php. I'll leave it to someone else to speculate why that is happening.

-J.D.

On Oct 17, 2013, at 2:26 PM, Haluk Karamete <halukkaramete at gmail.com> wrote:

> Every once in a while, I get this error on my local host:
> 
> Warning: fopen(
> http://localhost/ic/wp-cron.php?doing_wp_cron=1382034056.3116404541851806640625)
> [<a href='function.fopen'>function.fopen</a>]: failed to open stream: HTTP
> request failed!
> 
> And when I refresh the page, it goes away.
> 
> It usually happens at first visits for each day. But it sometimes happen a
> few times a day. 99% percent of the time, I do not experience it.
> But I do expereince it 100% of the time for the first visits of the day.
> 
> What could be the cause of it?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From wp at andrewnacin.com  Thu Oct 17 20:43:58 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Thu, 17 Oct 2013 16:43:58 -0400
Subject: [wp-hackers] Weird wp-cron.php erorr.
In-Reply-To: <CAHERW=2-VhL2nLs5V5oF3uwbLPpd1pgB4q9mSkkXkx7jhRrZ0w@mail.gmail.com>
References: <CAHERW=2-VhL2nLs5V5oF3uwbLPpd1pgB4q9mSkkXkx7jhRrZ0w@mail.gmail.com>
Message-ID: <CAP29PvgtLv9Ettkox=N+hR3mCNYY667H4URZB_Asogejbo+Qig@mail.gmail.com>

Very simply, HTTP requests fail sometimes.

You have WP_DEBUG on, otherwise these warnings are explicitly suppressed.


On Thu, Oct 17, 2013 at 2:26 PM, Haluk Karamete <halukkaramete at gmail.com>wrote:

> Every once in a while, I get this error on my local host:
>
> Warning: fopen(
>
> http://localhost/ic/wp-cron.php?doing_wp_cron=1382034056.3116404541851806640625
> )
> [<a href='function.fopen'>function.fopen</a>]: failed to open stream: HTTP
> request failed!
>
> And when I refresh the page, it goes away.
>
> It usually happens at first visits for each day. But it sometimes happen a
> few times a day. 99% percent of the time, I do not experience it.
> But I do expereince it 100% of the time for the first visits of the day.
>
> What could be the cause of it?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From dyordan1 at ramapo.edu  Fri Oct 18 14:56:05 2013
From: dyordan1 at ramapo.edu (Dobri)
Date: Fri, 18 Oct 2013 10:56:05 -0400
Subject: [wp-hackers] Two multisite installations, same users
Message-ID: <21B273CD-61CA-46EF-ADE4-089A89EDA3E5@ramapo.edu>

Hi all,

I'm dealing with a problem that I'm trying to resolve in the most elegant way possible. I work for an educational institution which has about 200 sites on a WordPress multisite installation. They want to rip out some of the content from their public domain and put it in an Intranet that's restricted in access from only campus. So they decided to create a separate WordPress multisite installation. Now, I'm trying to figure out how to have users on the two sites sync up without running into permissions issues. We have about 150 users and we constantly add and remove them so it's impractical to keep two sets of users.

TLDR: Two multisite installations, need to have the same user accounts.

Here are two solutions I was considering:

1. Have the second multisite installation read/write to the users and usermeta tables of the first one, kicking up blog_id to 2^32+1 (so it's halfway through the range of blog_id)
That way, I hope, usermeta will not have any permissions conflicts because at that point the two wordpress multisite installations become one in terms of user permissions, just with a huge hole in the ids

TLDR 1: second multisite read/writes to wp_users and wp_usermeta. blog_id for wp_blogs on second installation is bumped up to avoid collisions.

2. Have the second multisite installation READ ONLY from the users table, keeping its own usermeta table and then have a service that runs at midnight for usermeta maintenance (copy over first/last name, etc. from main installation and clean up if user was deleted, make sure to not touch permissions on second site except for the case when a user is removed, etc.). This solution seems safer but users cannot be created/deleted from the secondary installation and users will not be able to change their password (and other things stored in wp_users) on the secondary site.

TLDR 2: second multisite only reads wp_users and maintains its own wp_usermeta.

Which one do you think seems like the better option? Do you have any other suggestions that might work better? Thank you!

~Dobri


From wp at andrewnacin.com  Sat Oct 19 02:48:36 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Fri, 18 Oct 2013 22:48:36 -0400
Subject: [wp-hackers] Two multisite installations, same users
In-Reply-To: <21B273CD-61CA-46EF-ADE4-089A89EDA3E5@ramapo.edu>
References: <21B273CD-61CA-46EF-ADE4-089A89EDA3E5@ramapo.edu>
Message-ID: <CAP29PvjP5PDd4Lou60wexfi_HCbukLobDLzHk+VbQ_2y+75w=Q@mail.gmail.com>

You can share user tables across cross installs. Just make sure you are
using different table prefixes.

http://codex.wordpress.org/Editing_wp-config.php#Custom_User_and_Usermeta_Tables
On Oct 18, 2013 10:56 AM, "Dobri" <dyordan1 at ramapo.edu> wrote:

> Hi all,
>
> I'm dealing with a problem that I'm trying to resolve in the most elegant
> way possible. I work for an educational institution which has about 200
> sites on a WordPress multisite installation. They want to rip out some of
> the content from their public domain and put it in an Intranet that's
> restricted in access from only campus. So they decided to create a separate
> WordPress multisite installation. Now, I'm trying to figure out how to have
> users on the two sites sync up without running into permissions issues. We
> have about 150 users and we constantly add and remove them so it's
> impractical to keep two sets of users.
>
> TLDR: Two multisite installations, need to have the same user accounts.
>
> Here are two solutions I was considering:
>
> 1. Have the second multisite installation read/write to the users and
> usermeta tables of the first one, kicking up blog_id to 2^32+1 (so it's
> halfway through the range of blog_id)
> That way, I hope, usermeta will not have any permissions conflicts because
> at that point the two wordpress multisite installations become one in terms
> of user permissions, just with a huge hole in the ids
>
> TLDR 1: second multisite read/writes to wp_users and wp_usermeta. blog_id
> for wp_blogs on second installation is bumped up to avoid collisions.
>
> 2. Have the second multisite installation READ ONLY from the users table,
> keeping its own usermeta table and then have a service that runs at
> midnight for usermeta maintenance (copy over first/last name, etc. from
> main installation and clean up if user was deleted, make sure to not touch
> permissions on second site except for the case when a user is removed,
> etc.). This solution seems safer but users cannot be created/deleted from
> the secondary installation and users will not be able to change their
> password (and other things stored in wp_users) on the secondary site.
>
> TLDR 2: second multisite only reads wp_users and maintains its own
> wp_usermeta.
>
> Which one do you think seems like the better option? Do you have any other
> suggestions that might work better? Thank you!
>
> ~Dobri
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From danielx386 at gmail.com  Sat Oct 19 02:52:00 2013
From: danielx386 at gmail.com (Daniel)
Date: Sat, 19 Oct 2013 13:52:00 +1100
Subject: [wp-hackers] Two multisite installations, same users
In-Reply-To: <CAP29PvjP5PDd4Lou60wexfi_HCbukLobDLzHk+VbQ_2y+75w=Q@mail.gmail.com>
References: <21B273CD-61CA-46EF-ADE4-089A89EDA3E5@ramapo.edu>
 <CAP29PvjP5PDd4Lou60wexfi_HCbukLobDLzHk+VbQ_2y+75w=Q@mail.gmail.com>
Message-ID: <CAJ5Hi2iqGYpcjaehFOco1kj1CaCLwh0C6SYcMOmsZ=tDraOYzg@mail.gmail.com>

And how do you keep the user data in sync?
Regards,
Daniel Fenn






On Sat, Oct 19, 2013 at 1:48 PM, Andrew Nacin <wp at andrewnacin.com> wrote:
> You can share user tables across cross installs. Just make sure you are
> using different table prefixes.
>
> http://codex.wordpress.org/Editing_wp-config.php#Custom_User_and_Usermeta_Tables
> On Oct 18, 2013 10:56 AM, "Dobri" <dyordan1 at ramapo.edu> wrote:
>
>> Hi all,
>>
>> I'm dealing with a problem that I'm trying to resolve in the most elegant
>> way possible. I work for an educational institution which has about 200
>> sites on a WordPress multisite installation. They want to rip out some of
>> the content from their public domain and put it in an Intranet that's
>> restricted in access from only campus. So they decided to create a separate
>> WordPress multisite installation. Now, I'm trying to figure out how to have
>> users on the two sites sync up without running into permissions issues. We
>> have about 150 users and we constantly add and remove them so it's
>> impractical to keep two sets of users.
>>
>> TLDR: Two multisite installations, need to have the same user accounts.
>>
>> Here are two solutions I was considering:
>>
>> 1. Have the second multisite installation read/write to the users and
>> usermeta tables of the first one, kicking up blog_id to 2^32+1 (so it's
>> halfway through the range of blog_id)
>> That way, I hope, usermeta will not have any permissions conflicts because
>> at that point the two wordpress multisite installations become one in terms
>> of user permissions, just with a huge hole in the ids
>>
>> TLDR 1: second multisite read/writes to wp_users and wp_usermeta. blog_id
>> for wp_blogs on second installation is bumped up to avoid collisions.
>>
>> 2. Have the second multisite installation READ ONLY from the users table,
>> keeping its own usermeta table and then have a service that runs at
>> midnight for usermeta maintenance (copy over first/last name, etc. from
>> main installation and clean up if user was deleted, make sure to not touch
>> permissions on second site except for the case when a user is removed,
>> etc.). This solution seems safer but users cannot be created/deleted from
>> the secondary installation and users will not be able to change their
>> password (and other things stored in wp_users) on the secondary site.
>>
>> TLDR 2: second multisite only reads wp_users and maintains its own
>> wp_usermeta.
>>
>> Which one do you think seems like the better option? Do you have any other
>> suggestions that might work better? Thank you!
>>
>> ~Dobri
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From greglancaster71 at gmail.com  Sat Oct 19 07:21:19 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sat, 19 Oct 2013 00:21:19 -0700 (PDT)
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
Message-ID: <1382167279374-42560.post@n5.nabble.com>

*I was having a hard time working out how to implement the ajax into
wordpress with the JSON callback.  So, I hired a guy from freelancer.  His
job was to setup my form as ajax, but im looking at his code now and it does
not make use the same code you used.  

What he did was echo the row-ID in each 
 (is this safe?) and then created this button:*

<div id=&quot;delete&lt;?php echo $row['id']; ?>">
<input type=&quot;submit&quot; name=&quot;deleteItem&quot;
value=&quot;delete&quot; class=&quot;delete-box&quot;
onclick=&quot;delete1(&lt;?php echo $row['id']; ?>) ">delete
</div>

*and this <div>, which shows inside the 
 I click delete on:*

<div style=&quot;display:none&quot;  id=&quot;areusure&lt;?php echo
$row['id']; ?>"></div>

*Then, in the head of the file this is the script that handles the selection
of the 
 etc...*




*and finally, here is the ajax call (which isnt written how you suggested
using ajaxurl in wordpress)*


<?php
    if ( !isset($wp_did_header) ) {
    $wp_did_header = true;
    require_once('../../../wp-load.php' );
    wp();
    require_once( ABSPATH . WPINC . '/template-loader.php' );

}
global $wpdb;
if (isset($_REQUEST['id'])) {
	$id = $_REQUEST['id'];
	$file = $wpdb->get_var("select file from wp_jo_plugin_options WHERE id =
$id");
	//wp_delete_attachment( $file );
	$qry2 = $wpdb->prepare("CREATE TABLE IF NOT EXISTS t2  AS SELECT * from 
wp_jo_plugin_options WHERE id = %s", $id);
	$jo1 = $wpdb->query($qry2);
	$qry = $wpdb->prepare("DELETE FROM wp_jo_plugin_options WHERE id = %s",
$id);
	$jo_remove_row = $wpdb->query($qry);
	}
	if (isset($_REQUEST['undo'])) {
	$undo = $_REQUEST['undo'];
	$qry2 = $wpdb->prepare("insert ignore into wp_jo_plugin_options SELECT *
from  t2 WHERE id = %s", $undo);
	$jo_remove_row = $wpdb->query($qry2);
	}
?>


*Now - I have no idea is this is bad code, but it does not match the same
layout you suggested.  Is this safe? It cost me about 100 bucks on
freelancer.com.  :-/*



J.D. Grimes wrote
> It isn't hard to do, I've done it before. Do you know jQuery? jQuery's
> AJAX handlers are very easy to user (in my opinion, at least). Quick and
> probably somewhat dirty example:
> 
> jQuery( document ).ready( function( $ ) {
> 	
> 	// When a button is clicked within the table with id="mytable"
> 	$( '#mytable button' ).click( function( event ) {
> 		
> 		// Keep the default action from happening (form submitted/page
> refreshed)
> 		event.preventDefault();
> 
> 		if ( ! confirm( 'Are you sure you want to continue' ) )
> 			return;
> 
> 		// Get the id of the row to delete.
> 		// I'd recommend just making the button value the row ID, no need for
> the extra input.
> 		// Then you can access it easier through $( this ).val();
> 		var rowID = $( this ).parent().child( 'input' )[0].val();
> 
> 		// POST data.
> 		var data = {
> 			'action': 'my_delete_row_action',
> 			'rowID': rowID
> 		}
> 
> 		// Send AJAX request to delete this.
> 		$.post( 
> 			ajaxurl, 
> 			data, 
> 			function ( response ) {
> 				
> 				// Check if this was successful.
> 				// Assumes you are using
> http://codex.wordpress.org/Function_Reference/wp_send_json_success
> 				if ( ! response.success ) {
> 
> 					alert( 'Failure!' );
> 				}
> 					
> 				// Success! Hide the row.
> 				$( '#mytable tr#myrow-' + rowID ).hide();
> 			}
> 		);
> 	});
> });
> 
> OK, that probably won't work off the bat, just an example. You'll need to
> give your table an HTML ID, and give each row a unique ID based on $i (in
> the example it's myrow-$i.
> 
> Also you'll need to see http://codex.wordpress.org/AJAX_in_Plugins for
> info on how to handle the AJAX request properly within WordPress.
> 
> I'm sure you can find some great tutorials out there to help you along,
> too.
> 
> J.D.
> 
> On Sep 25, 2013, at 3:22 PM, BenderisGreat &lt;

> greglancaster71@

> &gt; wrote:
> 
>> Right you are [again] J.D.
>> 
>> So should I just start sending you paypal payments for your assistance?  
>> One more followup question -  I don't know any Ajax- is there a simple
>> way
>> (now that the form is fixed) to remove that row without a page refresh?  
>> 
>> Again, not familiar with ajax so coding that myself isn't an option yet,
>> but
>> maybe there is a simple way to implement something like that?
>> 
>> 
>> 
>> --
>> View this message in context:
>> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42403.html
>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>> _______________________________________________
>> wp-hackers mailing list
>> 

> wp-hackers at .automattic

>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> 
> _______________________________________________
> wp-hackers mailing list

> wp-hackers at .automattic

> http://lists.automattic.com/mailman/listinfo/wp-hackers


J.D. Grimes wrote
> It isn't hard to do, I've done it before. Do you know jQuery? jQuery's
> AJAX handlers are very easy to user (in my opinion, at least). Quick and
> probably somewhat dirty example:
> 
> jQuery( document ).ready( function( $ ) {
> 	
> 	// When a button is clicked within the table with id="mytable"
> 	$( '#mytable button' ).click( function( event ) {
> 		
> 		// Keep the default action from happening (form submitted/page
> refreshed)
> 		event.preventDefault();
> 
> 		if ( ! confirm( 'Are you sure you want to continue' ) )
> 			return;
> 
> 		// Get the id of the row to delete.
> 		// I'd recommend just making the button value the row ID, no need for
> the extra input.
> 		// Then you can access it easier through $( this ).val();
> 		var rowID = $( this ).parent().child( 'input' )[0].val();
> 
> 		// POST data.
> 		var data = {
> 			'action': 'my_delete_row_action',
> 			'rowID': rowID
> 		}
> 
> 		// Send AJAX request to delete this.
> 		$.post( 
> 			ajaxurl, 
> 			data, 
> 			function ( response ) {
> 				
> 				// Check if this was successful.
> 				// Assumes you are using
> http://codex.wordpress.org/Function_Reference/wp_send_json_success
> 				if ( ! response.success ) {
> 
> 					alert( 'Failure!' );
> 				}
> 					
> 				// Success! Hide the row.
> 				$( '#mytable tr#myrow-' + rowID ).hide();
> 			}
> 		);
> 	});
> });
> 
> OK, that probably won't work off the bat, just an example. You'll need to
> give your table an HTML ID, and give each row a unique ID based on $i (in
> the example it's myrow-$i.
> 
> Also you'll need to see http://codex.wordpress.org/AJAX_in_Plugins for
> info on how to handle the AJAX request properly within WordPress.
> 
> I'm sure you can find some great tutorials out there to help you along,
> too.
> 
> J.D.
> 
> On Sep 25, 2013, at 3:22 PM, BenderisGreat &lt;

> greglancaster71@

> &gt; wrote:
> 
>> Right you are [again] J.D.
>> 
>> So should I just start sending you paypal payments for your assistance?  
>> One more followup question -  I don't know any Ajax- is there a simple
>> way
>> (now that the form is fixed) to remove that row without a page refresh?  
>> 
>> Again, not familiar with ajax so coding that myself isn't an option yet,
>> but
>> maybe there is a simple way to implement something like that?
>> 
>> 
>> 
>> --
>> View this message in context:
>> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42403.html
>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>> _______________________________________________
>> wp-hackers mailing list
>> 

> wp-hackers at .automattic

>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> 
> _______________________________________________
> wp-hackers mailing list

> wp-hackers at .automattic

> http://lists.automattic.com/mailman/listinfo/wp-hackers





--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42560.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From greglancaster71 at gmail.com  Sat Oct 19 07:25:27 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 00:25:27 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
Message-ID: <CAPN-N+avq3RYj8Kq=Gmy0oMUCwSApp8dFHwCUCSL285GJYaOMA@mail.gmail.com>

<b>I was having a hard time working out how to implement the ajax into
wordpress with the JSON callback.  So, I hired a guy from freelancer.  His
job was to setup my form as ajax, but im looking at his code now and it
does not make use the same code you used.

What he did was echo the row-ID in each < tr  > (is this safe?) and then
created this button:</b>

< div id="delete<?php echo $row['id']; ?>">
< input type="submit" name="deleteItem" value="delete" class="delete-box"
onclick="delete1(<?php echo $row['id']; ?>) ">delete
< /div>

<b>and this <div>, which shows inside the <tr> I click delete on:</b>

< div style="display:none"  id="areusure<?php echo $row['id']; ?>"></ div>

<b>Then, in the head of the file this is the script that handles the
selection of the < tr > etc...</b>

< script type="text/javascript">
var iii=0;
function delete1(id)
{
$.ajax(
{
url: '../../wp-content/plugins/gogonow/ajax1.php?id='+id,
success:function(data){
iii = setTimeout(function(){rm(id)},8000);
$("#areusure"+id).html($("#tr"+id).html());
$("#tr"+id).css("background-color","#FF3700");
$("#tr"+id).html("<td colspan='4'>Are you sure you want to delete it...<a
href='javascript:undo1("+id+")'>Undo</a ></ td >");
}
});
}
function undo1(id) {
$.ajax( {
url: '../../wp-content/plugins/gogonow/ajax1.php?undo='+id,
success:function(data){
clearTimeout(iii);
$("#tr"+id).html($("#areusure"+id).html());
}
})
}
function rm(id) {
$('#tr'+id).fadeOut(400);
}
<  /script>


<b>and finally, here is the ajax call (which isnt written how you suggested
using ajaxurl in wordpress)</b>


<?php
    if ( !isset($wp_did_header) ) {
    $wp_did_header = true;
    require_once('../../../wp-load.php' );
    wp();
    require_once( ABSPATH . WPINC . '/template-loader.php' );

}
global $wpdb;
if (isset($_REQUEST['id'])) {
$id = $_REQUEST['id'];
$file = $wpdb->get_var("select file from wp_jo_plugin_options WHERE id =
$id");
//wp_delete_attachment( $file );
$qry2 = $wpdb->prepare("CREATE TABLE IF NOT EXISTS t2  AS SELECT * from
 wp_jo_plugin_options WHERE id = %s", $id);
$jo1 = $wpdb->query($qry2);
$qry = $wpdb->prepare("DELETE FROM wp_jo_plugin_options WHERE id = %s",
$id);
$jo_remove_row = $wpdb->query($qry);
}
if (isset($_REQUEST['undo'])) {
$undo = $_REQUEST['undo'];
$qry2 = $wpdb->prepare("insert ignore into wp_jo_plugin_options SELECT *
from  t2 WHERE id = %s", $undo);
$jo_remove_row = $wpdb->query($qry2);
}
?>


<b>Now - I have no idea is this is bad code, but it does not match the same
layout you suggested.  Is this safe? It cost me about 100 bucks on
freelancer.com.  :-/</b>


On Wed, Sep 25, 2013 at 12:50 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> It isn't hard to do, I've done it before. Do you know jQuery? jQuery's
> AJAX handlers are very easy to user (in my opinion, at least). Quick and
> probably somewhat dirty example:
>
> jQuery( document ).ready( function( $ ) {
>
>         // When a button is clicked within the table with id="mytable"
>         $( '#mytable button' ).click( function( event ) {
>
>                 // Keep the default action from happening (form
> submitted/page refreshed)
>                 event.preventDefault();
>
>                 if ( ! confirm( 'Are you sure you want to continue' ) )
>                         return;
>
>                 // Get the id of the row to delete.
>                 // I'd recommend just making the button value the row ID,
> no need for the extra input.
>                 // Then you can access it easier through $( this ).val();
>                 var rowID = $( this ).parent().child( 'input' )[0].val();
>
>                 // POST data.
>                 var data = {
>                         'action': 'my_delete_row_action',
>                         'rowID': rowID
>                 }
>
>                 // Send AJAX request to delete this.
>                 $.post(
>                         ajaxurl,
>                         data,
>                         function ( response ) {
>
>                                 // Check if this was successful.
>                                 // Assumes you are using
> http://codex.wordpress.org/Function_Reference/wp_send_json_success
>                                 if ( ! response.success ) {
>
>                                         alert( 'Failure!' );
>                                 }
>
>                                 // Success! Hide the row.
>                                 $( '#mytable tr#myrow-' + rowID ).hide();
>                         }
>                 );
>         });
> });
>
> OK, that probably won't work off the bat, just an example. You'll need to
> give your table an HTML ID, and give each row a unique ID based on $i (in
> the example it's myrow-$i.
>
> Also you'll need to see http://codex.wordpress.org/AJAX_in_Plugins for
> info on how to handle the AJAX request properly within WordPress.
>
> I'm sure you can find some great tutorials out there to help you along,
> too.
>
> J.D.
>
> On Sep 25, 2013, at 3:22 PM, BenderisGreat <greglancaster71 at gmail.com>
> wrote:
>
> > Right you are [again] J.D.
> >
> > So should I just start sending you paypal payments for your assistance?
> > One more followup question -  I don't know any Ajax- is there a simple
> way
> > (now that the form is fixed) to remove that row without a page refresh?
> >
> > Again, not familiar with ajax so coding that myself isn't an option yet,
> but
> > maybe there is a simple way to implement something like that?
> >
> >
> >
> > --
> > View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42403.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From otto at ottodestruct.com  Sat Oct 19 14:08:11 2013
From: otto at ottodestruct.com (Otto)
Date: Sat, 19 Oct 2013 09:08:11 -0500
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1382167279374-42560.post@n5.nabble.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <1382167279374-42560.post@n5.nabble.com>
Message-ID: <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>

On Sat, Oct 19, 2013 at 2:21 AM, BenderisGreat
<greglancaster71 at gmail.com> wrote:
> *and finally, here is the ajax call (which isnt written how you suggested
> using ajaxurl in wordpress)*
>
>
> <?php
>     if ( !isset($wp_did_header) ) {
>     $wp_did_header = true;
>     require_once('../../../wp-load.php' );
>     wp();
>     require_once( ABSPATH . WPINC . '/template-loader.php' );
>
> }
> global $wpdb;
> if (isset($_REQUEST['id'])) {
>         $id = $_REQUEST['id'];
>         $file = $wpdb->get_var("select file from wp_jo_plugin_options WHERE id =
> $id");
>         //wp_delete_attachment( $file );
>         $qry2 = $wpdb->prepare("CREATE TABLE IF NOT EXISTS t2  AS SELECT * from
> wp_jo_plugin_options WHERE id = %s", $id);
>         $jo1 = $wpdb->query($qry2);
>         $qry = $wpdb->prepare("DELETE FROM wp_jo_plugin_options WHERE id = %s",
> $id);
>         $jo_remove_row = $wpdb->query($qry);
>         }
>         if (isset($_REQUEST['undo'])) {
>         $undo = $_REQUEST['undo'];
>         $qry2 = $wpdb->prepare("insert ignore into wp_jo_plugin_options SELECT *
> from  t2 WHERE id = %s", $undo);
>         $jo_remove_row = $wpdb->query($qry2);
>         }
> ?>
>
>
> *Now - I have no idea is this is bad code, but it does not match the same
> layout you suggested.  Is this safe? It cost me about 100 bucks on
> freelancer.com.  :-/*


No, that code is not safe. This code at the start, for example, is an
SQL Injection vulnerability:

if (isset($_REQUEST['id'])) {
         $id = $_REQUEST['id'];
         $file = $wpdb->get_var("select file from wp_jo_plugin_options
WHERE id = $id");

Because he's not prepare'd or otherwise sanitizing the id parameter,
it's easy to inject something there.

In general, anytime you include wp-load.php directly, you're probably
doing-it-wrong. The ajaxurl callback method suggested earlier is
better all around.


-Otto

From david at carrcommunications.com  Sat Oct 19 14:20:16 2013
From: david at carrcommunications.com (David F. Carr)
Date: Sat, 19 Oct 2013 10:20:16 -0400
Subject: [wp-hackers] Can I make a custom post type display with page.php
	rather than single.php
Message-ID: <CAJbdpGu50VMsVzd-B2e5O8i3_MyeMOi42SB8aGB0yX3fyPEQzg@mail.gmail.com>

I'd like to make my RSVPMaker event scheduling plugin a little more plug
and play, and it just occurred to me there might be a simpler way of
getting my event post type to display better.

I've been telling people to create a single-rsvpmaker.php template and add
it to their theme in order to avoid confusion between the event date
displayed in the body of the post and the post publication date that's
prominently displayed in many themes. In the absence of a
single-customtype.php template, WordPress normally uses the theme's
single.php or equivalent.

It occurs to me that most themes do not display the publication date as
prominently in the page template. So the behavior I'd like to achieve would
be to modify the choice of template to be:

First choice: single-rsvpmaker.php (if there is one)
Second choice: page.php
Third choice: default WordPress behavior.

That way, the user would only have to create a custom template file if
page.php is not appropriate. More people who don't feel comfortable mucking
around in code would get the desired behavior out of the box.

Is this doable? If so, can you give pointers on how to accomplish it?

-- 
David F. Carr
Author, Social Collaboration for Dummies
http://www.wiley.com/buy/9781118658543
LinkedIn - http://www.linkedin.com/in/davidfcarr
Facebook - http://www.facebook.com/carrcomm

From nikolov.tmw at gmail.com  Sat Oct 19 16:23:00 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 19:23:00 +0300
Subject: [wp-hackers] Can I make a custom post type display with
 page.php rather than single.php
In-Reply-To: <CAJbdpGu50VMsVzd-B2e5O8i3_MyeMOi42SB8aGB0yX3fyPEQzg@mail.gmail.com>
References: <CAJbdpGu50VMsVzd-B2e5O8i3_MyeMOi42SB8aGB0yX3fyPEQzg@mail.gmail.com>
Message-ID: <CAOwx47f9Z00SFcuEjceNoj9YF+iehXW1_bYHnU+evLKyj1Xp6w@mail.gmail.com>

Yep - it's possible. Hook to the "single_template" filter - as described
here -
https://codex.wordpress.org/Plugin_API/Filter_Reference/single_template then
with the use of the locate_template() function -
http://codex.wordpress.org/Function_Reference/locate_template search for
the templates you want to use - something like this:

$found_template = locate_template( array( 'single-rsvpmaker.php',
'page.php' );

return $found_template ? $found_template : $template;

Where $template would be the value that is passed to your single_template
filtering function.

So to put it all together, it would look something like this:

function filter_rsvpmaker_template( $template ) {
    // Make sure that this is the template for an rsvpmaker post
    $found_template = 'rsvpmaker' == get_post_type() ? locate_template(
array( 'single-rsvpmaker.php', 'page.php' ) : false;

    // If we've found a template - return that instead of the default
template
    return $found_template ? $found_template : $template;
}
add_filter( 'single_template', 'filter_rsvpmaker_template' );

This might possibly have some side effects - the fact that you're loading a
page template instead of a single post template, but I'm not a 100% sure.


On Sat, Oct 19, 2013 at 5:20 PM, David F. Carr <david at carrcommunications.com
> wrote:

> I'd like to make my RSVPMaker event scheduling plugin a little more plug
> and play, and it just occurred to me there might be a simpler way of
> getting my event post type to display better.
>
> I've been telling people to create a single-rsvpmaker.php template and add
> it to their theme in order to avoid confusion between the event date
> displayed in the body of the post and the post publication date that's
> prominently displayed in many themes. In the absence of a
> single-customtype.php template, WordPress normally uses the theme's
> single.php or equivalent.
>
> It occurs to me that most themes do not display the publication date as
> prominently in the page template. So the behavior I'd like to achieve would
> be to modify the choice of template to be:
>
> First choice: single-rsvpmaker.php (if there is one)
> Second choice: page.php
> Third choice: default WordPress behavior.
>
> That way, the user would only have to create a custom template file if
> page.php is not appropriate. More people who don't feel comfortable mucking
> around in code would get the desired behavior out of the box.
>
> Is this doable? If so, can you give pointers on how to accomplish it?
>
> --
> David F. Carr
> Author, Social Collaboration for Dummies
> http://www.wiley.com/buy/9781118658543
> LinkedIn - http://www.linkedin.com/in/davidfcarr
> Facebook - http://www.facebook.com/carrcomm
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Sat Oct 19 16:26:01 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 19:26:01 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <1382167279374-42560.post@n5.nabble.com>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
Message-ID: <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>

PS: I would do a dispute on Freelancer.com(if that's where you hired your
guy) - that's clearly not a good quality code. And as Otto pointed out it's
a potential security hole to your site(or what could be even worse -
plugin). You might be able to get your money back, or get the job done
better.


On Sat, Oct 19, 2013 at 5:08 PM, Otto <otto at ottodestruct.com> wrote:

> On Sat, Oct 19, 2013 at 2:21 AM, BenderisGreat
> <greglancaster71 at gmail.com> wrote:
> > *and finally, here is the ajax call (which isnt written how you suggested
> > using ajaxurl in wordpress)*
> >
> >
> > <?php
> >     if ( !isset($wp_did_header) ) {
> >     $wp_did_header = true;
> >     require_once('../../../wp-load.php' );
> >     wp();
> >     require_once( ABSPATH . WPINC . '/template-loader.php' );
> >
> > }
> > global $wpdb;
> > if (isset($_REQUEST['id'])) {
> >         $id = $_REQUEST['id'];
> >         $file = $wpdb->get_var("select file from wp_jo_plugin_options
> WHERE id =
> > $id");
> >         //wp_delete_attachment( $file );
> >         $qry2 = $wpdb->prepare("CREATE TABLE IF NOT EXISTS t2  AS SELECT
> * from
> > wp_jo_plugin_options WHERE id = %s", $id);
> >         $jo1 = $wpdb->query($qry2);
> >         $qry = $wpdb->prepare("DELETE FROM wp_jo_plugin_options WHERE id
> = %s",
> > $id);
> >         $jo_remove_row = $wpdb->query($qry);
> >         }
> >         if (isset($_REQUEST['undo'])) {
> >         $undo = $_REQUEST['undo'];
> >         $qry2 = $wpdb->prepare("insert ignore into wp_jo_plugin_options
> SELECT *
> > from  t2 WHERE id = %s", $undo);
> >         $jo_remove_row = $wpdb->query($qry2);
> >         }
> > ?>
> >
> >
> > *Now - I have no idea is this is bad code, but it does not match the same
> > layout you suggested.  Is this safe? It cost me about 100 bucks on
> > freelancer.com.  :-/*
>
>
> No, that code is not safe. This code at the start, for example, is an
> SQL Injection vulnerability:
>
> if (isset($_REQUEST['id'])) {
>          $id = $_REQUEST['id'];
>          $file = $wpdb->get_var("select file from wp_jo_plugin_options
> WHERE id = $id");
>
> Because he's not prepare'd or otherwise sanitizing the id parameter,
> it's easy to inject something there.
>
> In general, anytime you include wp-load.php directly, you're probably
> doing-it-wrong. The ajaxurl callback method suggested earlier is
> better all around.
>
>
> -Otto
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sat Oct 19 17:25:25 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sat, 19 Oct 2013 10:25:25 -0700 (PDT)
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
Message-ID: <1382203525770-42566.post@n5.nabble.com>

I thought it looked weird.  I spent some time last night working out the
correct code pasted here, and got it functioning.  I dont think I can get my
money back but I will try. I am so glad I have this resource to check with,
or I would have never had JD showing me the proper way, and then never would
have questioned his code.  

I finally got JDs code working but I have to place this in my functions for
ajax to work:

add_action('wp_head','custom_head');

function custom_head()
{
	echo '';
}


Is that alright?  Otherwise I get ajaxurl undefined error.  

Additionally, the json response works too! However one query always fails.  

$file = $_POST['file'];
$del_image = wp_delete_attachment( $row['file'] ); - fail

I also tried this as an sql query:

$file = $_POST['file'];
$fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
$go_fileQry = $wpdb->query($fileQry);

It still fails.  It IS possible to run multiple queries this way right?  



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42566.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Sat Oct 19 17:35:46 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 20:35:46 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1382203525770-42566.post@n5.nabble.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
Message-ID: <CAOwx47eVAbo0-wWaGmeDG9_Qd9f2s9MAv=FZY4Z6xJkV=bwNcw@mail.gmail.com>

About the ajaxurl - yes that is correct. WordPress only defines the global
JS variable ajaxurl on the admin side - so you have to do it yourself in
order to access it on the front-end.

Why are you not using the $file variable in your other code?

// You are assigning $_POST['file'] to the $file variable and not to
$row['file']
$file = $_POST['file'];
$del_image = wp_delete_attachment( $file );


On Sat, Oct 19, 2013 at 8:25 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> I thought it looked weird.  I spent some time last night working out the
> correct code pasted here, and got it functioning.  I dont think I can get
> my
> money back but I will try. I am so glad I have this resource to check with,
> or I would have never had JD showing me the proper way, and then never
> would
> have questioned his code.
>
> I finally got JDs code working but I have to place this in my functions for
> ajax to work:
>
> add_action('wp_head','custom_head');
>
> function custom_head()
> {
>         echo '';
> }
>
>
> Is that alright?  Otherwise I get ajaxurl undefined error.
>
> Additionally, the json response works too! However one query always fails.
>
> $file = $_POST['file'];
> $del_image = wp_delete_attachment( $row['file'] ); - fail
>
> I also tried this as an sql query:
>
> $file = $_POST['file'];
> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
> $go_fileQry = $wpdb->query($fileQry);
>
> It still fails.  It IS possible to run multiple queries this way right?
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42566.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Sat Oct 19 17:40:56 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sat, 19 Oct 2013 13:40:56 -0400
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1382203525770-42566.post@n5.nabble.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
Message-ID: <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>

Hey man, that's tough. I'm glad you've got the code working though. 

> I finally got JDs code working but I have to place this in my functions for
> ajax to work:
> 
> add_action('wp_head','custom_head');
> 
> function custom_head()
> {
> 	echo '';
> }
> 
> 
> Is that alright?  Otherwise I get ajaxurl undefined error.  

I'm not sure why this would have an effect? If you are using the code on the front end of your site, ajaxurl won't be defined - it is only defined by default in the administration panels. You would need to use wp_localize_script().

> Additionally, the json response works too! However one query always fails.  
> 
> $file = $_POST['file'];
> $del_image = wp_delete_attachment( $row['file'] ); - fail
> 
> I also tried this as an sql query:
> 
> $file = $_POST['file'];
> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
> $go_fileQry = $wpdb->query($fileQry);
> 
> It still fails.  It IS possible to run multiple queries this way right?  

Is it completely failing? The wp_delete_attachment() call will only move the attachment to the trash by default -if you want to delete it permanently you need to set the second parameter to true.

-J.D.

From greglancaster71 at gmail.com  Sat Oct 19 17:53:23 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 10:53:23 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
Message-ID: <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>

Yep, I had to add true.  So all this is executing based on the values of
this button:
 <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
file="<?php echo $row['file']; ?>" class="delete-box"><span
class="glyphicon glyphicon-remove"></span></button>

But couldnt someone just change the values of the fileid or rowid and
delete other peoples content?


On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Hey man, that's tough. I'm glad you've got the code working though.
>
> > I finally got JDs code working but I have to place this in my functions
> for
> > ajax to work:
> >
> > add_action('wp_head','custom_head');
> >
> > function custom_head()
> > {
> >       echo '';
> > }
> >
> >
> > Is that alright?  Otherwise I get ajaxurl undefined error.
>
> I'm not sure why this would have an effect? If you are using the code on
> the front end of your site, ajaxurl won't be defined - it is only defined
> by default in the administration panels. You would need to use
> wp_localize_script().
>
> > Additionally, the json response works too! However one query always
> fails.
> >
> > $file = $_POST['file'];
> > $del_image = wp_delete_attachment( $row['file'] ); - fail
> >
> > I also tried this as an sql query:
> >
> > $file = $_POST['file'];
> > $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
> > $go_fileQry = $wpdb->query($fileQry);
> >
> > It still fails.  It IS possible to run multiple queries this way right?
>
> Is it completely failing? The wp_delete_attachment() call will only move
> the attachment to the trash by default -if you want to delete it
> permanently you need to set the second parameter to true.
>
> -J.D.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Sat Oct 19 17:56:06 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sat, 19 Oct 2013 13:56:06 -0400
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
Message-ID: <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>

Yes, you should be using nonces - http://codex.wordpress.org/WordPress_Nonces

On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> Yep, I had to add true.  So all this is executing based on the values of
> this button:
> <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
> file="<?php echo $row['file']; ?>" class="delete-box"><span
> class="glyphicon glyphicon-remove"></span></button>
> 
> But couldnt someone just change the values of the fileid or rowid and
> delete other peoples content?
> 
> 
> On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Hey man, that's tough. I'm glad you've got the code working though.
>> 
>>> I finally got JDs code working but I have to place this in my functions
>> for
>>> ajax to work:
>>> 
>>> add_action('wp_head','custom_head');
>>> 
>>> function custom_head()
>>> {
>>>      echo '';
>>> }
>>> 
>>> 
>>> Is that alright?  Otherwise I get ajaxurl undefined error.
>> 
>> I'm not sure why this would have an effect? If you are using the code on
>> the front end of your site, ajaxurl won't be defined - it is only defined
>> by default in the administration panels. You would need to use
>> wp_localize_script().
>> 
>>> Additionally, the json response works too! However one query always
>> fails.
>>> 
>>> $file = $_POST['file'];
>>> $del_image = wp_delete_attachment( $row['file'] ); - fail
>>> 
>>> I also tried this as an sql query:
>>> 
>>> $file = $_POST['file'];
>>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
>>> $go_fileQry = $wpdb->query($fileQry);
>>> 
>>> It still fails.  It IS possible to run multiple queries this way right?
>> 
>> Is it completely failing? The wp_delete_attachment() call will only move
>> the attachment to the trash by default -if you want to delete it
>> permanently you need to set the second parameter to true.
>> 
>> -J.D.
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Sat Oct 19 18:11:52 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 11:11:52 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
Message-ID: <CAPN-N+YH=SOpbF78h1JUuu2KcrwqvtWZK2=tL42CRqg-HkrCyA@mail.gmail.com>

that would be handled via jquery/ajax though right?  the button is
triggered that way.


On Sat, Oct 19, 2013 at 10:56 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, you should be using nonces -
> http://codex.wordpress.org/WordPress_Nonces
>
> On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > Yep, I had to add true.  So all this is executing based on the values of
> > this button:
> > <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
> > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > class="glyphicon glyphicon-remove"></span></button>
> >
> > But couldnt someone just change the values of the fileid or rowid and
> > delete other peoples content?
> >
> >
> > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Hey man, that's tough. I'm glad you've got the code working though.
> >>
> >>> I finally got JDs code working but I have to place this in my functions
> >> for
> >>> ajax to work:
> >>>
> >>> add_action('wp_head','custom_head');
> >>>
> >>> function custom_head()
> >>> {
> >>>      echo '';
> >>> }
> >>>
> >>>
> >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> >>
> >> I'm not sure why this would have an effect? If you are using the code on
> >> the front end of your site, ajaxurl won't be defined - it is only
> defined
> >> by default in the administration panels. You would need to use
> >> wp_localize_script().
> >>
> >>> Additionally, the json response works too! However one query always
> >> fails.
> >>>
> >>> $file = $_POST['file'];
> >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> >>>
> >>> I also tried this as an sql query:
> >>>
> >>> $file = $_POST['file'];
> >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
> >>> $go_fileQry = $wpdb->query($fileQry);
> >>>
> >>> It still fails.  It IS possible to run multiple queries this way right?
> >>
> >> Is it completely failing? The wp_delete_attachment() call will only move
> >> the attachment to the trash by default -if you want to delete it
> >> permanently you need to set the second parameter to true.
> >>
> >> -J.D.
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Sat Oct 19 18:16:04 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 21:16:04 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
Message-ID: <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>

So something like this is what you should use instead:

<button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
file="<?php echo $row['file']; ?>" data-nonce="<?php echo wp_create_nonce(
'delete_' . $row['id'] . '_' . $row['file'] ); ?>" class="delete-box"><span
class="glyphicon glyphicon-remove"></span></button>

You would have to add the value of the data-nonce attribute to your AJAX
request(in the below example it's value is set to the 'nonce' parameter)
and then on the PHP side of the request, you should do this:

if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file ) ) {
    exit( 'Cheatin, huh?' );
}

This way if someone changes the value of the file OR "value" attributes,
they won't be able to delete the item they were trying to delete.


On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, you should be using nonces -
> http://codex.wordpress.org/WordPress_Nonces
>
> On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > Yep, I had to add true.  So all this is executing based on the values of
> > this button:
> > <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
> > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > class="glyphicon glyphicon-remove"></span></button>
> >
> > But couldnt someone just change the values of the fileid or rowid and
> > delete other peoples content?
> >
> >
> > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Hey man, that's tough. I'm glad you've got the code working though.
> >>
> >>> I finally got JDs code working but I have to place this in my functions
> >> for
> >>> ajax to work:
> >>>
> >>> add_action('wp_head','custom_head');
> >>>
> >>> function custom_head()
> >>> {
> >>>      echo '';
> >>> }
> >>>
> >>>
> >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> >>
> >> I'm not sure why this would have an effect? If you are using the code on
> >> the front end of your site, ajaxurl won't be defined - it is only
> defined
> >> by default in the administration panels. You would need to use
> >> wp_localize_script().
> >>
> >>> Additionally, the json response works too! However one query always
> >> fails.
> >>>
> >>> $file = $_POST['file'];
> >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> >>>
> >>> I also tried this as an sql query:
> >>>
> >>> $file = $_POST['file'];
> >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s", $file);
> >>> $go_fileQry = $wpdb->query($fileQry);
> >>>
> >>> It still fails.  It IS possible to run multiple queries this way right?
> >>
> >> Is it completely failing? The wp_delete_attachment() call will only move
> >> the attachment to the trash by default -if you want to delete it
> >> permanently you need to set the second parameter to true.
> >>
> >> -J.D.
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sat Oct 19 18:32:23 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 11:32:23 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
Message-ID: <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>

like this?

*jQuery( document ).ready( function( $ ) { *
*        *
*        // When a button is clicked within the table with id="mytable" *
*        $( '#mytable button' ).click( function( event ) { *
* *
*                event.preventDefault(); *
*
*
*                if ( ! confirm( 'Are you sure you want to continue' ) ) *
*                        return; *
*
*
* var $button = $(this);*
* var nonce = $( this ).attr('data-nonce');*
*                **                **var rowID = $( this ).attr('value'); *
* var file = $( this ).attr('file'); *
* *
* $button.closest("tr").css('background-color', '#C60').fadeIn();*
* *
*
*
*                var data = { *
*                        'action': 'my_delete_row_action', *
*                        'id': rowID,*
* 'file': file*
*                } *
*
*
*                $.post( *
*                        ajaxurl, *
*                        data,*
*                        function ( response ) { *
*                                if ( ! response.success ) { *
*
*
*                                        alert( 'Failure!' ); *
*                                } *
*                                        *
* $button.closest("tr").hide();*
*                                *
*                        } *
*                ); *
*        }); *
*}); *
*
*
*
*
*
*
and my remove_row function would function like this?

*function my_delete_row_action() {*
* global $wpdb;*
*
*
* if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file )
) {*
*    exit( 'Cheatin, huh?' );*
*}*
*
*
* $id = $_POST['id'];*
* $file = $_POST['file'];*

seems to fail regardless if I change an item or not.


On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> So something like this is what you should use instead:
>
> <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
> file="<?php echo $row['file']; ?>" data-nonce="<?php echo wp_create_nonce(
> 'delete_' . $row['id'] . '_' . $row['file'] ); ?>" class="delete-box"><span
> class="glyphicon glyphicon-remove"></span></button>
>
> You would have to add the value of the data-nonce attribute to your AJAX
> request(in the below example it's value is set to the 'nonce' parameter)
> and then on the PHP side of the request, you should do this:
>
> if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file ) )
> {
>     exit( 'Cheatin, huh?' );
> }
>
> This way if someone changes the value of the file OR "value" attributes,
> they won't be able to delete the item they were trying to delete.
>
>
> On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
> > Yes, you should be using nonces -
> > http://codex.wordpress.org/WordPress_Nonces
> >
> > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> > wrote:
> >
> > > Yep, I had to add true.  So all this is executing based on the values
> of
> > > this button:
> > > <button type="submit" name="deleteItem" value="<?php echo $row['id'];
> ?>"
> > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > > class="glyphicon glyphicon-remove"></span></button>
> > >
> > > But couldnt someone just change the values of the fileid or rowid and
> > > delete other peoples content?
> > >
> > >
> > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
> > wrote:
> > >
> > >> Hey man, that's tough. I'm glad you've got the code working though.
> > >>
> > >>> I finally got JDs code working but I have to place this in my
> functions
> > >> for
> > >>> ajax to work:
> > >>>
> > >>> add_action('wp_head','custom_head');
> > >>>
> > >>> function custom_head()
> > >>> {
> > >>>      echo '';
> > >>> }
> > >>>
> > >>>
> > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> > >>
> > >> I'm not sure why this would have an effect? If you are using the code
> on
> > >> the front end of your site, ajaxurl won't be defined - it is only
> > defined
> > >> by default in the administration panels. You would need to use
> > >> wp_localize_script().
> > >>
> > >>> Additionally, the json response works too! However one query always
> > >> fails.
> > >>>
> > >>> $file = $_POST['file'];
> > >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> > >>>
> > >>> I also tried this as an sql query:
> > >>>
> > >>> $file = $_POST['file'];
> > >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s",
> $file);
> > >>> $go_fileQry = $wpdb->query($fileQry);
> > >>>
> > >>> It still fails.  It IS possible to run multiple queries this way
> right?
> > >>
> > >> Is it completely failing? The wp_delete_attachment() call will only
> move
> > >> the attachment to the trash by default -if you want to delete it
> > >> permanently you need to set the second parameter to true.
> > >>
> > >> -J.D.
> > >> _______________________________________________
> > >> wp-hackers mailing list
> > >> wp-hackers at lists.automattic.com
> > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >>
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Sat Oct 19 18:35:46 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 21:35:46 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
Message-ID: <CAOwx47cQ58EwWYxkFsgCM3DUmD-3B+O40TannaJXgz=m-+sppA@mail.gmail.com>

Move your

$id = $_POST['id'];
$file = $_POST['file'];

right after

global $wpdb;

They are just not defined when you try to use them in wp_verify_nonce()


On Sat, Oct 19, 2013 at 9:32 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> like this?
>
> *jQuery( document ).ready( function( $ ) { *
> *        *
> *        // When a button is clicked within the table with id="mytable" *
> *        $( '#mytable button' ).click( function( event ) { *
> * *
> *                event.preventDefault(); *
> *
> *
> *                if ( ! confirm( 'Are you sure you want to continue' ) ) *
> *                        return; *
> *
> *
> * var $button = $(this);*
> * var nonce = $( this ).attr('data-nonce');*
> *                **                **var rowID = $( this ).attr('value'); *
> * var file = $( this ).attr('file'); *
> * *
> * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> * *
> *
> *
> *                var data = { *
> *                        'action': 'my_delete_row_action', *
> *                        'id': rowID,*
> * 'file': file*
> *                } *
> *
> *
> *                $.post( *
> *                        ajaxurl, *
> *                        data,*
> *                        function ( response ) { *
> *                                if ( ! response.success ) { *
> *
> *
> *                                        alert( 'Failure!' ); *
> *                                } *
> *                                        *
> * $button.closest("tr").hide();*
> *                                *
> *                        } *
> *                ); *
> *        }); *
> *}); *
> *
> *
> *
> *
> *
> *
> and my remove_row function would function like this?
>
> *function my_delete_row_action() {*
> * global $wpdb;*
> *
> *
> * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file )
> ) {*
> *    exit( 'Cheatin, huh?' );*
> *}*
> *
> *
> * $id = $_POST['id'];*
> * $file = $_POST['file'];*
>
> seems to fail regardless if I change an item or not.
>
>
> On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <nikolov.tmw at gmail.com
> >wrote:
>
> > So something like this is what you should use instead:
> >
> > <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
> > file="<?php echo $row['file']; ?>" data-nonce="<?php echo
> wp_create_nonce(
> > 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
> class="delete-box"><span
> > class="glyphicon glyphicon-remove"></span></button>
> >
> > You would have to add the value of the data-nonce attribute to your AJAX
> > request(in the below example it's value is set to the 'nonce' parameter)
> > and then on the PHP side of the request, you should do this:
> >
> > if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file )
> )
> > {
> >     exit( 'Cheatin, huh?' );
> > }
> >
> > This way if someone changes the value of the file OR "value" attributes,
> > they won't be able to delete the item they were trying to delete.
> >
> >
> > On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> > > Yes, you should be using nonces -
> > > http://codex.wordpress.org/WordPress_Nonces
> > >
> > > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> > greglancaster71 at gmail.com>
> > > wrote:
> > >
> > > > Yep, I had to add true.  So all this is executing based on the values
> > of
> > > > this button:
> > > > <button type="submit" name="deleteItem" value="<?php echo $row['id'];
> > ?>"
> > > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > > > class="glyphicon glyphicon-remove"></span></button>
> > > >
> > > > But couldnt someone just change the values of the fileid or rowid and
> > > > delete other peoples content?
> > > >
> > > >
> > > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
> > > wrote:
> > > >
> > > >> Hey man, that's tough. I'm glad you've got the code working though.
> > > >>
> > > >>> I finally got JDs code working but I have to place this in my
> > functions
> > > >> for
> > > >>> ajax to work:
> > > >>>
> > > >>> add_action('wp_head','custom_head');
> > > >>>
> > > >>> function custom_head()
> > > >>> {
> > > >>>      echo '';
> > > >>> }
> > > >>>
> > > >>>
> > > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> > > >>
> > > >> I'm not sure why this would have an effect? If you are using the
> code
> > on
> > > >> the front end of your site, ajaxurl won't be defined - it is only
> > > defined
> > > >> by default in the administration panels. You would need to use
> > > >> wp_localize_script().
> > > >>
> > > >>> Additionally, the json response works too! However one query always
> > > >> fails.
> > > >>>
> > > >>> $file = $_POST['file'];
> > > >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> > > >>>
> > > >>> I also tried this as an sql query:
> > > >>>
> > > >>> $file = $_POST['file'];
> > > >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s",
> > $file);
> > > >>> $go_fileQry = $wpdb->query($fileQry);
> > > >>>
> > > >>> It still fails.  It IS possible to run multiple queries this way
> > right?
> > > >>
> > > >> Is it completely failing? The wp_delete_attachment() call will only
> > move
> > > >> the attachment to the trash by default -if you want to delete it
> > > >> permanently you need to set the second parameter to true.
> > > >>
> > > >> -J.D.
> > > >> _______________________________________________
> > > >> wp-hackers mailing list
> > > >> wp-hackers at lists.automattic.com
> > > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >>
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sat Oct 19 18:43:52 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 11:43:52 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47cQ58EwWYxkFsgCM3DUmD-3B+O40TannaJXgz=m-+sppA@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAOwx47cQ58EwWYxkFsgCM3DUmD-3B+O40TannaJXgz=m-+sppA@mail.gmail.com>
Message-ID: <CAPN-N+bd5rP0j74jrV4yJW97YztpF9YJOXwZDgHPz8V-zK=qZQ@mail.gmail.com>

Yea I just realized that :-/  Sorry I posted to quickly with the question.
 Works great. :)


On Sat, Oct 19, 2013 at 11:35 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Move your
>
> $id = $_POST['id'];
> $file = $_POST['file'];
>
> right after
>
> global $wpdb;
>
> They are just not defined when you try to use them in wp_verify_nonce()
>
>
> On Sat, Oct 19, 2013 at 9:32 PM, Gregory Lancaster <
> greglancaster71 at gmail.com> wrote:
>
> > like this?
> >
> > *jQuery( document ).ready( function( $ ) { *
> > *        *
> > *        // When a button is clicked within the table with id="mytable" *
> > *        $( '#mytable button' ).click( function( event ) { *
> > * *
> > *                event.preventDefault(); *
> > *
> > *
> > *                if ( ! confirm( 'Are you sure you want to continue' ) )
> *
> > *                        return; *
> > *
> > *
> > * var $button = $(this);*
> > * var nonce = $( this ).attr('data-nonce');*
> > *                **                **var rowID = $( this
> ).attr('value'); *
> > * var file = $( this ).attr('file'); *
> > * *
> > * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> > * *
> > *
> > *
> > *                var data = { *
> > *                        'action': 'my_delete_row_action', *
> > *                        'id': rowID,*
> > * 'file': file*
> > *                } *
> > *
> > *
> > *                $.post( *
> > *                        ajaxurl, *
> > *                        data,*
> > *                        function ( response ) { *
> > *                                if ( ! response.success ) { *
> > *
> > *
> > *                                        alert( 'Failure!' ); *
> > *                                } *
> > *                                        *
> > * $button.closest("tr").hide();*
> > *                                *
> > *                        } *
> > *                ); *
> > *        }); *
> > *}); *
> > *
> > *
> > *
> > *
> > *
> > *
> > and my remove_row function would function like this?
> >
> > *function my_delete_row_action() {*
> > * global $wpdb;*
> > *
> > *
> > * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file
> )
> > ) {*
> > *    exit( 'Cheatin, huh?' );*
> > *}*
> > *
> > *
> > * $id = $_POST['id'];*
> > * $file = $_POST['file'];*
> >
> > seems to fail regardless if I change an item or not.
> >
> >
> > On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <nikolov.tmw at gmail.com
> > >wrote:
> >
> > > So something like this is what you should use instead:
> > >
> > > <button type="submit" name="deleteItem" value="<?php echo $row['id'];
> ?>"
> > > file="<?php echo $row['file']; ?>" data-nonce="<?php echo
> > wp_create_nonce(
> > > 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
> > class="delete-box"><span
> > > class="glyphicon glyphicon-remove"></span></button>
> > >
> > > You would have to add the value of the data-nonce attribute to your
> AJAX
> > > request(in the below example it's value is set to the 'nonce'
> parameter)
> > > and then on the PHP side of the request, you should do this:
> > >
> > > if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file
> )
> > )
> > > {
> > >     exit( 'Cheatin, huh?' );
> > > }
> > >
> > > This way if someone changes the value of the file OR "value"
> attributes,
> > > they won't be able to delete the item they were trying to delete.
> > >
> > >
> > > On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co>
> > wrote:
> > >
> > > > Yes, you should be using nonces -
> > > > http://codex.wordpress.org/WordPress_Nonces
> > > >
> > > > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> > > greglancaster71 at gmail.com>
> > > > wrote:
> > > >
> > > > > Yep, I had to add true.  So all this is executing based on the
> values
> > > of
> > > > > this button:
> > > > > <button type="submit" name="deleteItem" value="<?php echo
> $row['id'];
> > > ?>"
> > > > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > > > > class="glyphicon glyphicon-remove"></span></button>
> > > > >
> > > > > But couldnt someone just change the values of the fileid or rowid
> and
> > > > > delete other peoples content?
> > > > >
> > > > >
> > > > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co
> >
> > > > wrote:
> > > > >
> > > > >> Hey man, that's tough. I'm glad you've got the code working
> though.
> > > > >>
> > > > >>> I finally got JDs code working but I have to place this in my
> > > functions
> > > > >> for
> > > > >>> ajax to work:
> > > > >>>
> > > > >>> add_action('wp_head','custom_head');
> > > > >>>
> > > > >>> function custom_head()
> > > > >>> {
> > > > >>>      echo '';
> > > > >>> }
> > > > >>>
> > > > >>>
> > > > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> > > > >>
> > > > >> I'm not sure why this would have an effect? If you are using the
> > code
> > > on
> > > > >> the front end of your site, ajaxurl won't be defined - it is only
> > > > defined
> > > > >> by default in the administration panels. You would need to use
> > > > >> wp_localize_script().
> > > > >>
> > > > >>> Additionally, the json response works too! However one query
> always
> > > > >> fails.
> > > > >>>
> > > > >>> $file = $_POST['file'];
> > > > >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> > > > >>>
> > > > >>> I also tried this as an sql query:
> > > > >>>
> > > > >>> $file = $_POST['file'];
> > > > >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s",
> > > $file);
> > > > >>> $go_fileQry = $wpdb->query($fileQry);
> > > > >>>
> > > > >>> It still fails.  It IS possible to run multiple queries this way
> > > right?
> > > > >>
> > > > >> Is it completely failing? The wp_delete_attachment() call will
> only
> > > move
> > > > >> the attachment to the trash by default -if you want to delete it
> > > > >> permanently you need to set the second parameter to true.
> > > > >>
> > > > >> -J.D.
> > > > >> _______________________________________________
> > > > >> wp-hackers mailing list
> > > > >> wp-hackers at lists.automattic.com
> > > > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > > >>
> > > > > _______________________________________________
> > > > > wp-hackers mailing list
> > > > > wp-hackers at lists.automattic.com
> > > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sat Oct 19 20:37:38 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 13:37:38 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
Message-ID: <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>

Well it finally all works... and then I tested the user accounts and ajax
is not supported unless I register people as admins.   I know I can add a
user role, but is it possible to give them the ability to use ajax?


On Sat, Oct 19, 2013 at 11:32 AM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> like this?
>
> *jQuery( document ).ready( function( $ ) { *
> *        *
> *        // When a button is clicked within the table with id="mytable" *
> *        $( '#mytable button' ).click( function( event ) { *
> * *
> *                event.preventDefault(); *
> *
> *
> *                if ( ! confirm( 'Are you sure you want to continue' ) ) *
> *                        return; *
> *
> *
> * var $button = $(this);*
> * var nonce = $( this ).attr('data-nonce');*
> *                **                **var rowID = $( this ).attr('value');
> *
> * var file = $( this ).attr('file'); *
> * *
> * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> * *
> *
> *
> *                var data = { *
> *                        'action': 'my_delete_row_action', *
> *                        'id': rowID,*
> * 'file': file*
> *                } *
> *
> *
> *                $.post( *
> *                        ajaxurl, *
> *                        data,*
> *                        function ( response ) { *
> *                                if ( ! response.success ) { *
> *
> *
> *                                        alert( 'Failure!' ); *
> *                                } *
> *                                        *
> * $button.closest("tr").hide();*
> *                                *
> *                        } *
> *                ); *
> *        }); *
> *}); *
> *
> *
> *
> *
> *
> *
> and my remove_row function would function like this?
>
> *function my_delete_row_action() {*
> * global $wpdb;*
> *
> *
> * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file
> ) ) {*
> *    exit( 'Cheatin, huh?' );*
> *}*
> *
> *
> * $id = $_POST['id'];*
> * $file = $_POST['file'];*
>
> seems to fail regardless if I change an item or not.
>
>
> On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:
>
>> So something like this is what you should use instead:
>>
>> <button type="submit" name="deleteItem" value="<?php echo $row['id']; ?>"
>> file="<?php echo $row['file']; ?>" data-nonce="<?php echo wp_create_nonce(
>> 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
>> class="delete-box"><span
>> class="glyphicon glyphicon-remove"></span></button>
>>
>> You would have to add the value of the data-nonce attribute to your AJAX
>> request(in the below example it's value is set to the 'nonce' parameter)
>> and then on the PHP side of the request, you should do this:
>>
>> if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file )
>> ) {
>>     exit( 'Cheatin, huh?' );
>> }
>>
>> This way if someone changes the value of the file OR "value" attributes,
>> they won't be able to delete the item they were trying to delete.
>>
>>
>> On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>>
>> > Yes, you should be using nonces -
>> > http://codex.wordpress.org/WordPress_Nonces
>> >
>> > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>> > wrote:
>> >
>> > > Yep, I had to add true.  So all this is executing based on the values
>> of
>> > > this button:
>> > > <button type="submit" name="deleteItem" value="<?php echo $row['id'];
>> ?>"
>> > > file="<?php echo $row['file']; ?>" class="delete-box"><span
>> > > class="glyphicon glyphicon-remove"></span></button>
>> > >
>> > > But couldnt someone just change the values of the fileid or rowid and
>> > > delete other peoples content?
>> > >
>> > >
>> > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
>> > wrote:
>> > >
>> > >> Hey man, that's tough. I'm glad you've got the code working though.
>> > >>
>> > >>> I finally got JDs code working but I have to place this in my
>> functions
>> > >> for
>> > >>> ajax to work:
>> > >>>
>> > >>> add_action('wp_head','custom_head');
>> > >>>
>> > >>> function custom_head()
>> > >>> {
>> > >>>      echo '';
>> > >>> }
>> > >>>
>> > >>>
>> > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
>> > >>
>> > >> I'm not sure why this would have an effect? If you are using the
>> code on
>> > >> the front end of your site, ajaxurl won't be defined - it is only
>> > defined
>> > >> by default in the administration panels. You would need to use
>> > >> wp_localize_script().
>> > >>
>> > >>> Additionally, the json response works too! However one query always
>> > >> fails.
>> > >>>
>> > >>> $file = $_POST['file'];
>> > >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
>> > >>>
>> > >>> I also tried this as an sql query:
>> > >>>
>> > >>> $file = $_POST['file'];
>> > >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s",
>> $file);
>> > >>> $go_fileQry = $wpdb->query($fileQry);
>> > >>>
>> > >>> It still fails.  It IS possible to run multiple queries this way
>> right?
>> > >>
>> > >> Is it completely failing? The wp_delete_attachment() call will only
>> move
>> > >> the attachment to the trash by default -if you want to delete it
>> > >> permanently you need to set the second parameter to true.
>> > >>
>> > >> -J.D.
>> > >> _______________________________________________
>> > >> wp-hackers mailing list
>> > >> wp-hackers at lists.automattic.com
>> > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> > >>
>> > > _______________________________________________
>> > > wp-hackers mailing list
>> > > wp-hackers at lists.automattic.com
>> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

From nikolov.tmw at gmail.com  Sat Oct 19 20:54:19 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 19 Oct 2013 23:54:19 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
Message-ID: <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>

What do you mean by "ajax is not supported unless I register people as
admins"?

Does the AJAX never occur, or does the AJAX not trigger the deletion of the
rows?

If the AJAX doesn't occur - then you should look at the code that prints
the AJAX itself - you probably have some sort of a check there that decides
whether to print out the JS or not.

If the deletion of the rows doesn't happen, then it's the code that deletes
the rows that doesn't work.

Also - if you're going to let all kind of users delete data, you should
make sure that they actually have the right to delete that data or not(for
instance check if "is_super_admin()" and if that's true - allow them to
delete without further checks - if it's false, check if the record they're
trying to delete actually belongs to them).


On Sat, Oct 19, 2013 at 11:37 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> Well it finally all works... and then I tested the user accounts and ajax
> is not supported unless I register people as admins.   I know I can add a
> user role, but is it possible to give them the ability to use ajax?
>
>
> On Sat, Oct 19, 2013 at 11:32 AM, Gregory Lancaster <
> greglancaster71 at gmail.com> wrote:
>
> > like this?
> >
> > *jQuery( document ).ready( function( $ ) { *
> > *        *
> > *        // When a button is clicked within the table with id="mytable" *
> > *        $( '#mytable button' ).click( function( event ) { *
> > * *
> > *                event.preventDefault(); *
> > *
> > *
> > *                if ( ! confirm( 'Are you sure you want to continue' ) )
> *
> > *                        return; *
> > *
> > *
> > * var $button = $(this);*
> > * var nonce = $( this ).attr('data-nonce');*
> > *                **                **var rowID = $( this ).attr('value');
> > *
> > * var file = $( this ).attr('file'); *
> > * *
> > * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> > * *
> > *
> > *
> > *                var data = { *
> > *                        'action': 'my_delete_row_action', *
> > *                        'id': rowID,*
> > * 'file': file*
> > *                } *
> > *
> > *
> > *                $.post( *
> > *                        ajaxurl, *
> > *                        data,*
> > *                        function ( response ) { *
> > *                                if ( ! response.success ) { *
> > *
> > *
> > *                                        alert( 'Failure!' ); *
> > *                                } *
> > *                                        *
> > * $button.closest("tr").hide();*
> > *                                *
> > *                        } *
> > *                ); *
> > *        }); *
> > *}); *
> > *
> > *
> > *
> > *
> > *
> > *
> > and my remove_row function would function like this?
> >
> > *function my_delete_row_action() {*
> > * global $wpdb;*
> > *
> > *
> > * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file
> > ) ) {*
> > *    exit( 'Cheatin, huh?' );*
> > *}*
> > *
> > *
> > * $id = $_POST['id'];*
> > * $file = $_POST['file'];*
> >
> > seems to fail regardless if I change an item or not.
> >
> >
> > On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <nikolov.tmw at gmail.com
> >wrote:
> >
> >> So something like this is what you should use instead:
> >>
> >> <button type="submit" name="deleteItem" value="<?php echo $row['id'];
> ?>"
> >> file="<?php echo $row['file']; ?>" data-nonce="<?php echo
> wp_create_nonce(
> >> 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
> >> class="delete-box"><span
> >> class="glyphicon glyphicon-remove"></span></button>
> >>
> >> You would have to add the value of the data-nonce attribute to your AJAX
> >> request(in the below example it's value is set to the 'nonce' parameter)
> >> and then on the PHP side of the request, you should do this:
> >>
> >> if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file )
> >> ) {
> >>     exit( 'Cheatin, huh?' );
> >> }
> >>
> >> This way if someone changes the value of the file OR "value" attributes,
> >> they won't be able to delete the item they were trying to delete.
> >>
> >>
> >> On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >>
> >> > Yes, you should be using nonces -
> >> > http://codex.wordpress.org/WordPress_Nonces
> >> >
> >> > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >> > wrote:
> >> >
> >> > > Yep, I had to add true.  So all this is executing based on the
> values
> >> of
> >> > > this button:
> >> > > <button type="submit" name="deleteItem" value="<?php echo
> $row['id'];
> >> ?>"
> >> > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> >> > > class="glyphicon glyphicon-remove"></span></button>
> >> > >
> >> > > But couldnt someone just change the values of the fileid or rowid
> and
> >> > > delete other peoples content?
> >> > >
> >> > >
> >> > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <jdg at codesymphony.co>
> >> > wrote:
> >> > >
> >> > >> Hey man, that's tough. I'm glad you've got the code working though.
> >> > >>
> >> > >>> I finally got JDs code working but I have to place this in my
> >> functions
> >> > >> for
> >> > >>> ajax to work:
> >> > >>>
> >> > >>> add_action('wp_head','custom_head');
> >> > >>>
> >> > >>> function custom_head()
> >> > >>> {
> >> > >>>      echo '';
> >> > >>> }
> >> > >>>
> >> > >>>
> >> > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> >> > >>
> >> > >> I'm not sure why this would have an effect? If you are using the
> >> code on
> >> > >> the front end of your site, ajaxurl won't be defined - it is only
> >> > defined
> >> > >> by default in the administration panels. You would need to use
> >> > >> wp_localize_script().
> >> > >>
> >> > >>> Additionally, the json response works too! However one query
> always
> >> > >> fails.
> >> > >>>
> >> > >>> $file = $_POST['file'];
> >> > >>> $del_image = wp_delete_attachment( $row['file'] ); - fail
> >> > >>>
> >> > >>> I also tried this as an sql query:
> >> > >>>
> >> > >>> $file = $_POST['file'];
> >> > >>> $fileQry = $wpdb->prepare("DELETE FROM wp_posts WHERE id = %s",
> >> $file);
> >> > >>> $go_fileQry = $wpdb->query($fileQry);
> >> > >>>
> >> > >>> It still fails.  It IS possible to run multiple queries this way
> >> right?
> >> > >>
> >> > >> Is it completely failing? The wp_delete_attachment() call will only
> >> move
> >> > >> the attachment to the trash by default -if you want to delete it
> >> > >> permanently you need to set the second parameter to true.
> >> > >>
> >> > >> -J.D.
> >> > >> _______________________________________________
> >> > >> wp-hackers mailing list
> >> > >> wp-hackers at lists.automattic.com
> >> > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >> > >>
> >> > > _______________________________________________
> >> > > wp-hackers mailing list
> >> > > wp-hackers at lists.automattic.com
> >> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >> >
> >> > _______________________________________________
> >> > wp-hackers mailing list
> >> > wp-hackers at lists.automattic.com
> >> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >> >
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sun Oct 20 00:53:59 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Sat, 19 Oct 2013 17:53:59 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
Message-ID: <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>

The ajax delete fails on non admin accounts.  The form inserts an entry
into a custom table so I think $wpdb access is restricted to admins- which
I do not want to change.  However these people need the ability to enter
data.  I apologize for my lazy post before by the way, frustration was
setting in.

As for the right to delete or post, I currently am matching the
current_member against the current_user->ID.  That seems to control who can
delete what on what users page.  Maybe there is a better way? That is the
only connection to the profile page owner I have though.

I feel dumb asking but, maybe you would tell me what part of the codex I
need to read to modify the user roles for posting?  This is a little
confusing because the form is unattached to wordpress other than it posts
withinthe wpdb.  For that reason the ability to delete and add entries
(seems) as though it would not be controlled by a user role.

I do not want to grant all subscribers the ability to create and delete
posts for the sake of this form.

On Saturday, October 19, 2013, Nikola Nikolov wrote:

> What do you mean by "ajax is not supported unless I register people as
> admins"?
>
> Does the AJAX never occur, or does the AJAX not trigger the deletion of the
> rows?
>
> If the AJAX doesn't occur - then you should look at the code that prints
> the AJAX itself - you probably have some sort of a check there that decides
> whether to print out the JS or not.
>
> If the deletion of the rows doesn't happen, then it's the code that deletes
> the rows that doesn't work.
>
> Also - if you're going to let all kind of users delete data, you should
> make sure that they actually have the right to delete that data or not(for
> instance check if "is_super_admin()" and if that's true - allow them to
> delete without further checks - if it's false, check if the record they're
> trying to delete actually belongs to them).
>
>
> On Sat, Oct 19, 2013 at 11:37 PM, Gregory Lancaster <
> greglancaster71 at gmail.com <javascript:;>> wrote:
>
> > Well it finally all works... and then I tested the user accounts and ajax
> > is not supported unless I register people as admins.   I know I can add a
> > user role, but is it possible to give them the ability to use ajax?
> >
> >
> > On Sat, Oct 19, 2013 at 11:32 AM, Gregory Lancaster <
> > greglancaster71 at gmail.com <javascript:;>> wrote:
> >
> > > like this?
> > >
> > > *jQuery( document ).ready( function( $ ) { *
> > > *        *
> > > *        // When a button is clicked within the table with
> id="mytable" *
> > > *        $( '#mytable button' ).click( function( event ) { *
> > > * *
> > > *                event.preventDefault(); *
> > > *
> > > *
> > > *                if ( ! confirm( 'Are you sure you want to continue' )
> )
> > *
> > > *                        return; *
> > > *
> > > *
> > > * var $button = $(this);*
> > > * var nonce = $( this ).attr('data-nonce');*
> > > *                **                **var rowID = $( this
> ).attr('value');
> > > *
> > > * var file = $( this ).attr('file'); *
> > > * *
> > > * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> > > * *
> > > *
> > > *
> > > *                var data = { *
> > > *                        'action': 'my_delete_row_action', *
> > > *                        'id': rowID,*
> > > * 'file': file*
> > > *                } *
> > > *
> > > *
> > > *                $.post( *
> > > *                        ajaxurl, *
> > > *                        data,*
> > > *                        function ( response ) { *
> > > *                                if ( ! response.success ) { *
> > > *
> > > *
> > > *                                        alert( 'Failure!' ); *
> > > *                                } *
> > > *                                        *
> > > * $button.closest("tr").hide();*
> > > *                                *
> > > *                        } *
> > > *                ); *
> > > *        }); *
> > > *}); *
> > > *
> > > *
> > > *
> > > *
> > > *
> > > *
> > > and my remove_row function would function like this?
> > >
> > > *function my_delete_row_action() {*
> > > * global $wpdb;*
> > > *
> > > *
> > > * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' .
> $file
> > > ) ) {*
> > > *    exit( 'Cheatin, huh?' );*
> > > *}*
> > > *
> > > *
> > > * $id = $_POST['id'];*
> > > * $file = $_POST['file'];*
> > >
> > > seems to fail regardless if I change an item or not.
> > >
> > >
> > > On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <
> nikolov.tmw at gmail.com
> > >wrote:
> > >
> > >> So something like this is what you should use instead:
> > >>
> > >> <button type="submit" name="deleteItem" value="<?php echo $row['id'];
> > ?>"
> > >> file="<?php echo $row['file']; ?>" data-nonce="<?php echo
> > wp_create_nonce(
> > >> 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
> > >> class="delete-box"><span
> > >> class="glyphicon glyphicon-remove"></span></button>
> > >>
> > >> You would have to add the value of the data-nonce attribute to your
> AJAX
> > >> request(in the below example it's value is set to the 'nonce'
> parameter)
> > >> and then on the PHP side of the request, you should do this:
> > >>
> > >> if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' .
> $file )
> > >> ) {
> > >>     exit( 'Cheatin, huh?' );
> > >> }
> > >>
> > >> This way if someone changes the value of the file OR "value"
> attributes,
> > >> they won't be able to delete the item they were trying to delete.
> > >>
> > >>
> > >> On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co>
> > wrote:
> > >>
> > >> > Yes, you should be using nonces -
> > >> > http://codex.wordpress.org/WordPress_Nonces
> > >> >
> > >> > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> > >> greglancaster71 at gmail.com>
> > >> > wrote:
> > >> >
> > >> > > Yep, I had to add true.  So all this is executing based on the
> > values
> > >> of
> > >> > > this button:
> > >> > > <button type="submit" name="deleteItem" value="<?php echo
> > $row['id'];
> > >> ?>"
> > >> > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > >> > > class="glyphicon glyphicon-remove"></span></button>
> > >> > >
> > >> > > But couldnt someone just change the values of the fileid or rowid
> > and
> > >> > > delete other peoples content?
> > >> > >
> > >> > >
> > >> > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <
> jdg at codesymphony.co>
> > >> > wrote:
> > >> > >
> > >> > >> Hey man, that's tough. I'm glad you've got the code working
> though.
> > >> > >>
> > >> > >>> I finally got JDs code working but I have to place this in my
> > >> functions
> > >> > >> for
> > >> > >>> ajax to work:
> > >> > >>>
> > >> > >>> add_action('wp_head','custom_head');
> > >> > >>>
> > >> > >>> function custom_head()
> > >> > >>> {
> > >> > >>>      echo '';
> > >> > >>> }
> > >> > >>>
> > >> > >>>
> > >> > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> > >> > >>
> > >> > >> I'm not sure why this would have an effect? If you are using the
> > >> code on
> > >> > >> the front end of your site, ajaxurl won't be defined - it is only
> > >> > defined
> > >> > >> by default in the administration panels. You would need to use
> > >> > >> wp_localize_script().
> > >> > >>
> > >> > >>> Additionally, the json response works too! However one query
> > always
> > >> > >> fails.
> > >> > >>>
> > >> > >>> $file = $_POST['file'];
>

From nikolov.tmw at gmail.com  Sun Oct 20 09:55:34 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sun, 20 Oct 2013 12:55:34 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
References: <1380128635691-42393.post@n5.nabble.com>
 <3A1D4879-D022-42F5-9907-0BEB55AAF31C@codesymphony.co>
 <1380136169376-42401.post@n5.nabble.com>
 <ED828C0A-E6D3-4EB4-ACDC-A738DE23BB15@codesymphony.co>
 <1380136961060-42403.post@n5.nabble.com>
 <A7D77C84-3E1E-4B5E-AA1D-6199E0CC3A9A@codesymphony.co>
 <CAD-FghxZ654vLTDfkgkxMvOG6RYdUhiXyQ9g+KwWfTK8QUpC4w@mail.gmail.com>
 <CAOwx47e5PydnHSWKrdbTqVGJDPiGajU9UcH_p-v2Cidh=J=wMw@mail.gmail.com>
 <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
Message-ID: <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>

I don't think the problem is in the wpdb class. If you take a look at the
source code for the query() method (
http://core.trac.wordpress.org/browser/tags/3.6.1/wp-includes/wp-db.php#L1170
),
you will see that all that the class does is

$this->result = @mysql_query( $query, $this->dbh );

and it will only return false if

if ( ! $this->ready )
return false;

Which on the other hand would happen only if the database connection fails,
or if you call the query() method, before $wpdb->db_connect() is
called(which happens when the $wpdb object is created).

So I would suggest to enable WP_DEBUG and also before you do your query, do

$wpdb->show_errors();

Then look at the AJAX response(you can do that in the "Network" tab of
Google Chrome's developer tools) and see if it says something.


On Sun, Oct 20, 2013 at 3:53 AM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> The ajax delete fails on non admin accounts.  The form inserts an entry
> into a custom table so I think $wpdb access is restricted to admins- which
> I do not want to change.  However these people need the ability to enter
> data.  I apologize for my lazy post before by the way, frustration was
> setting in.
>
> As for the right to delete or post, I currently am matching the
> current_member against the current_user->ID.  That seems to control who can
> delete what on what users page.  Maybe there is a better way? That is the
> only connection to the profile page owner I have though.
>
> I feel dumb asking but, maybe you would tell me what part of the codex I
> need to read to modify the user roles for posting?  This is a little
> confusing because the form is unattached to wordpress other than it posts
> withinthe wpdb.  For that reason the ability to delete and add entries
> (seems) as though it would not be controlled by a user role.
>
> I do not want to grant all subscribers the ability to create and delete
> posts for the sake of this form.
>
> On Saturday, October 19, 2013, Nikola Nikolov wrote:
>
> > What do you mean by "ajax is not supported unless I register people as
> > admins"?
> >
> > Does the AJAX never occur, or does the AJAX not trigger the deletion of
> the
> > rows?
> >
> > If the AJAX doesn't occur - then you should look at the code that prints
> > the AJAX itself - you probably have some sort of a check there that
> decides
> > whether to print out the JS or not.
> >
> > If the deletion of the rows doesn't happen, then it's the code that
> deletes
> > the rows that doesn't work.
> >
> > Also - if you're going to let all kind of users delete data, you should
> > make sure that they actually have the right to delete that data or
> not(for
> > instance check if "is_super_admin()" and if that's true - allow them to
> > delete without further checks - if it's false, check if the record
> they're
> > trying to delete actually belongs to them).
> >
> >
> > On Sat, Oct 19, 2013 at 11:37 PM, Gregory Lancaster <
> > greglancaster71 at gmail.com <javascript:;>> wrote:
> >
> > > Well it finally all works... and then I tested the user accounts and
> ajax
> > > is not supported unless I register people as admins.   I know I can
> add a
> > > user role, but is it possible to give them the ability to use ajax?
> > >
> > >
> > > On Sat, Oct 19, 2013 at 11:32 AM, Gregory Lancaster <
> > > greglancaster71 at gmail.com <javascript:;>> wrote:
> > >
> > > > like this?
> > > >
> > > > *jQuery( document ).ready( function( $ ) { *
> > > > *        *
> > > > *        // When a button is clicked within the table with
> > id="mytable" *
> > > > *        $( '#mytable button' ).click( function( event ) { *
> > > > * *
> > > > *                event.preventDefault(); *
> > > > *
> > > > *
> > > > *                if ( ! confirm( 'Are you sure you want to continue'
> )
> > )
> > > *
> > > > *                        return; *
> > > > *
> > > > *
> > > > * var $button = $(this);*
> > > > * var nonce = $( this ).attr('data-nonce');*
> > > > *                **                **var rowID = $( this
> > ).attr('value');
> > > > *
> > > > * var file = $( this ).attr('file'); *
> > > > * *
> > > > * $button.closest("tr").css('background-color', '#C60').fadeIn();*
> > > > * *
> > > > *
> > > > *
> > > > *                var data = { *
> > > > *                        'action': 'my_delete_row_action', *
> > > > *                        'id': rowID,*
> > > > * 'file': file*
> > > > *                } *
> > > > *
> > > > *
> > > > *                $.post( *
> > > > *                        ajaxurl, *
> > > > *                        data,*
> > > > *                        function ( response ) { *
> > > > *                                if ( ! response.success ) { *
> > > > *
> > > > *
> > > > *                                        alert( 'Failure!' ); *
> > > > *                                } *
> > > > *                                        *
> > > > * $button.closest("tr").hide();*
> > > > *                                *
> > > > *                        } *
> > > > *                ); *
> > > > *        }); *
> > > > *}); *
> > > > *
> > > > *
> > > > *
> > > > *
> > > > *
> > > > *
> > > > and my remove_row function would function like this?
> > > >
> > > > *function my_delete_row_action() {*
> > > > * global $wpdb;*
> > > > *
> > > > *
> > > > * if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' .
> > $file
> > > > ) ) {*
> > > > *    exit( 'Cheatin, huh?' );*
> > > > *}*
> > > > *
> > > > *
> > > > * $id = $_POST['id'];*
> > > > * $file = $_POST['file'];*
> > > >
> > > > seems to fail regardless if I change an item or not.
> > > >
> > > >
> > > > On Sat, Oct 19, 2013 at 11:16 AM, Nikola Nikolov <
> > nikolov.tmw at gmail.com
> > > >wrote:
> > > >
> > > >> So something like this is what you should use instead:
> > > >>
> > > >> <button type="submit" name="deleteItem" value="<?php echo
> $row['id'];
> > > ?>"
> > > >> file="<?php echo $row['file']; ?>" data-nonce="<?php echo
> > > wp_create_nonce(
> > > >> 'delete_' . $row['id'] . '_' . $row['file'] ); ?>"
> > > >> class="delete-box"><span
> > > >> class="glyphicon glyphicon-remove"></span></button>
> > > >>
> > > >> You would have to add the value of the data-nonce attribute to your
> > AJAX
> > > >> request(in the below example it's value is set to the 'nonce'
> > parameter)
> > > >> and then on the PHP side of the request, you should do this:
> > > >>
> > > >> if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' .
> > $file )
> > > >> ) {
> > > >>     exit( 'Cheatin, huh?' );
> > > >> }
> > > >>
> > > >> This way if someone changes the value of the file OR "value"
> > attributes,
> > > >> they won't be able to delete the item they were trying to delete.
> > > >>
> > > >>
> > > >> On Sat, Oct 19, 2013 at 8:56 PM, J.D. Grimes <jdg at codesymphony.co>
> > > wrote:
> > > >>
> > > >> > Yes, you should be using nonces -
> > > >> > http://codex.wordpress.org/WordPress_Nonces
> > > >> >
> > > >> > On Oct 19, 2013, at 1:53 PM, Gregory Lancaster <
> > > >> greglancaster71 at gmail.com>
> > > >> > wrote:
> > > >> >
> > > >> > > Yep, I had to add true.  So all this is executing based on the
> > > values
> > > >> of
> > > >> > > this button:
> > > >> > > <button type="submit" name="deleteItem" value="<?php echo
> > > $row['id'];
> > > >> ?>"
> > > >> > > file="<?php echo $row['file']; ?>" class="delete-box"><span
> > > >> > > class="glyphicon glyphicon-remove"></span></button>
> > > >> > >
> > > >> > > But couldnt someone just change the values of the fileid or
> rowid
> > > and
> > > >> > > delete other peoples content?
> > > >> > >
> > > >> > >
> > > >> > > On Sat, Oct 19, 2013 at 10:40 AM, J.D. Grimes <
> > jdg at codesymphony.co>
> > > >> > wrote:
> > > >> > >
> > > >> > >> Hey man, that's tough. I'm glad you've got the code working
> > though.
> > > >> > >>
> > > >> > >>> I finally got JDs code working but I have to place this in my
> > > >> functions
> > > >> > >> for
> > > >> > >>> ajax to work:
> > > >> > >>>
> > > >> > >>> add_action('wp_head','custom_head');
> > > >> > >>>
> > > >> > >>> function custom_head()
> > > >> > >>> {
> > > >> > >>>      echo '';
> > > >> > >>> }
> > > >> > >>>
> > > >> > >>>
> > > >> > >>> Is that alright?  Otherwise I get ajaxurl undefined error.
> > > >> > >>
> > > >> > >> I'm not sure why this would have an effect? If you are using
> the
> > > >> code on
> > > >> > >> the front end of your site, ajaxurl won't be defined - it is
> only
> > > >> > defined
> > > >> > >> by default in the administration panels. You would need to use
> > > >> > >> wp_localize_script().
> > > >> > >>
> > > >> > >>> Additionally, the json response works too! However one query
> > > always
> > > >> > >> fails.
> > > >> > >>>
> > > >> > >>> $file = $_POST['file'];
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sun Oct 20 11:26:43 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sun, 20 Oct 2013 04:26:43 -0700 (PDT)
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
Message-ID: <1382268403944-42580.post@n5.nabble.com>

I enabled the error log, and I have a local error log as well.  No new errors
are being generated.  Its weird for sure.  I am pretty sure this is because
subscribers are not able to delete posts and I am using;

$del_image = wp_delete_attachment( $file, true  );

I think it would be smarter to convert that to an sql query (maybe wordpress
wont catch it as a delete post function in sql?) 

What do you think?  No errors being generated other than a failure alert.  



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42580.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nikolov.tmw at gmail.com  Sun Oct 20 15:44:28 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sun, 20 Oct 2013 18:44:28 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1382268403944-42580.post@n5.nabble.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
Message-ID: <CAOwx47c9V4-4N55SKJNLb_fR3wJt8sw-5kx18zYCRBjKOPyOSA@mail.gmail.com>

Well the thing is that WordPress takes care of some extra stuff when an
attachment is deleted - usually if it's an image, WordPress will also
delete all of the sizes for that image, etc.

I'm looking into the core code for wp_delete_attachment and I can't seem to
find anything that would not let an attachment to be deleted, based on the
current user's role(it also doesn't make a lot of sense to have such a
restriction for a core method - usually restrictions occur before a core
method is ran - at the time of parsing a request for instance).

What is the failure alert that you're getting? Does wp_delete_attachment
just return false?


On Sun, Oct 20, 2013 at 2:26 PM, BenderisGreat <greglancaster71 at gmail.com>wrote:

> I enabled the error log, and I have a local error log as well.  No new
> errors
> are being generated.  Its weird for sure.  I am pretty sure this is because
> subscribers are not able to delete posts and I am using;
>
> $del_image = wp_delete_attachment( $file, true  );
>
> I think it would be smarter to convert that to an sql query (maybe
> wordpress
> wont catch it as a delete post function in sql?)
>
> What do you think?  No errors being generated other than a failure alert.
>
>
>
> --
> View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/Delete-Row-Refreshes-Page-but-not-DB-tp42393p42580.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Sun Oct 20 17:02:00 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sun, 20 Oct 2013 13:02:00 -0400
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <1382268403944-42580.post@n5.nabble.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
Message-ID: <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>

> $del_image = wp_delete_attachment( $file, true  );
> 
> I think it would be smarter to convert that to an sql query (maybe wordpress
> wont catch it as a delete post function in sql?) 

You want to use wp_delete_attachment(), not a custom query. The function does a lot more than a single query, it cleans out all of the attachment's data from the data base, and delete's the image files if there are any.

Are you sure that wp_delete_attachment() is actually being called? Are you sure it isn't failing before then somewhere?

From mirepup at gmail.com  Mon Oct 21 18:36:52 2013
From: mirepup at gmail.com (Jeff Rose)
Date: Mon, 21 Oct 2013 11:36:52 -0700
Subject: [wp-hackers] Lots of user meta
Message-ID: <CABWVAyWDWiAWS=-ZKUkK9zQh78ZGU8L69AB+kt1pAPGLpU-L8A@mail.gmail.com>

Hoping for someone to tell me there's a better way to handle user data.

Let's suppose that I have a bunch of "contacts" or users of different
types. Clients and Employees for example. Each has different meta-data
needs. For example, employees would have Next of kin and clients would have
birthday (imagine way more complicated scenario) just to keep things
simple. But each type would have about 10 unique fields and a bunch of
common fields.

I know that the WordPress user form can be appended to in limited ways.
What's the best way to handle some large amounts of custom user information
in forms that various other users will have access to, at least in part?

I'm leaning toward a custom post type linked to the user - so I get the
form. But feel I may be overlooking something easy/obvious.

-- 
Jeff Rose
------------------
http://www.jeffrose.ca/twitter
http://www.jeffrose.ca/facebook
http://www.linkedin.com/in/JeffeRose

From bmay at alyte.com.au  Mon Oct 21 19:32:24 2013
From: bmay at alyte.com.au (Ben May)
Date: Tue, 22 Oct 2013 06:32:24 +1100
Subject: [wp-hackers] Lots of user meta
In-Reply-To: <CABWVAyWDWiAWS=-ZKUkK9zQh78ZGU8L69AB+kt1pAPGLpU-L8A@mail.gmail.com>
References: <CABWVAyWDWiAWS=-ZKUkK9zQh78ZGU8L69AB+kt1pAPGLpU-L8A@mail.gmail.com>
Message-ID: <CAOdX+r8ii47nvZr+yhncP+1SxNNzAfZ3Ucyr_-_D9CHYsMNjJg@mail.gmail.com>

If you're doing wp-admin only work, Advanced Custom Fields may be helpful -
using Conditional Logic and setup on the user page.


On 22 October 2013 05:36, Jeff Rose <mirepup at gmail.com> wrote:

> Hoping for someone to tell me there's a better way to handle user data.
>
> Let's suppose that I have a bunch of "contacts" or users of different
> types. Clients and Employees for example. Each has different meta-data
> needs. For example, employees would have Next of kin and clients would have
> birthday (imagine way more complicated scenario) just to keep things
> simple. But each type would have about 10 unique fields and a bunch of
> common fields.
>
> I know that the WordPress user form can be appended to in limited ways.
> What's the best way to handle some large amounts of custom user information
> in forms that various other users will have access to, at least in part?
>
> I'm leaning toward a custom post type linked to the user - so I get the
> form. But feel I may be overlooking something easy/obvious.
>
> --
> Jeff Rose
> ------------------
> http://www.jeffrose.ca/twitter
> http://www.jeffrose.ca/facebook
> http://www.linkedin.com/in/JeffeRose
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jamie at wunderdojo.com  Mon Oct 21 19:38:29 2013
From: jamie at wunderdojo.com (Jamie Currie)
Date: Mon, 21 Oct 2013 19:38:29 +0000
Subject: [wp-hackers] Lots of user meta
In-Reply-To: <CAOdX+r8ii47nvZr+yhncP+1SxNNzAfZ3Ucyr_-_D9CHYsMNjJg@mail.gmail.com>
Message-ID: <emc897730f-f69e-4def-abef-9381dc801f04@laguna>

Gravity Forms has a users plugin that lets you create user accounts from 
a custom form. Would be easy to set up several user types and use 
Gravity Forms conditional fields to show the appropriate ones. I'm sure 
you can do it with other form plugins and I've written custom solutions 
for this type of thing but GF is a pretty simple way to go.

Jamie Currie
Founder / CEO
wunderdojo
wunderdojo.com <http://www.wunderdojo.com> | twitter.com/wunderdojo 
<http://twitter.com/#!/wunderdojo>
tel: 949-734-0758
1840 Park Newport, #409
Newport Beach, CA 92660
Master web & app developers




------ Original Message ------
From: "Ben May" <bmay at alyte.com.au>
To: wp-hackers at lists.automattic.com
Sent: 10/21/2013 12:32:24 PM
Subject: Re: [wp-hackers] Lots of user meta
>If you're doing wp-admin only work, Advanced Custom Fields may be 
>helpful -
>using Conditional Logic and setup on the user page.
>
>
>On 22 October 2013 05:36, Jeff Rose <mirepup at gmail.com> wrote:
>
>>  Hoping for someone to tell me there's a better way to handle user 
>>data.
>>
>>  Let's suppose that I have a bunch of "contacts" or users of different
>>  types. Clients and Employees for example. Each has different 
>>meta-data
>>  needs. For example, employees would have Next of kin and clients 
>>would have
>>  birthday (imagine way more complicated scenario) just to keep things
>>  simple. But each type would have about 10 unique fields and a bunch 
>>of
>>  common fields.
>>
>>  I know that the WordPress user form can be appended to in limited 
>>ways.
>>  What's the best way to handle some large amounts of custom user 
>>information
>>  in forms that various other users will have access to, at least in 
>>part?
>>
>>  I'm leaning toward a custom post type linked to the user - so I get 
>>the
>>  form. But feel I may be overlooking something easy/obvious.
>>
>>  --
>>  Jeff Rose
>>  ------------------
>>  http://www.jeffrose.ca/twitter
>>  http://www.jeffrose.ca/facebook
>>  http://www.linkedin.com/in/JeffeRose
>>  _______________________________________________
>>  wp-hackers mailing list
>>  wp-hackers at lists.automattic.com
>>  http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>_______________________________________________
>wp-hackers mailing list
>wp-hackers at lists.automattic.com
>http://lists.automattic.com/mailman/listinfo/wp-hackers

From greglancaster71 at gmail.com  Mon Oct 21 20:53:04 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 21 Oct 2013 13:53:04 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
Message-ID: <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>

Its JSON that is refurning the failure message.  I checked the error log
after clearing it and this is the response:

[Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not configured
[hint: SSLSessionCache]
[Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for digest
authentication ...
[Mon Oct 21 13:49:12 2013] [notice] Digest: done
[Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
configured -- resuming normal operations

That relevant?


On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> > $del_image = wp_delete_attachment( $file, true  );
> >
> > I think it would be smarter to convert that to an sql query (maybe
> wordpress
> > wont catch it as a delete post function in sql?)
>
> You want to use wp_delete_attachment(), not a custom query. The function
> does a lot more than a single query, it cleans out all of the attachment's
> data from the data base, and delete's the image files if there are any.
>
> Are you sure that wp_delete_attachment() is actually being called? Are you
> sure it isn't failing before then somewhere?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct 21 20:55:21 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 21 Oct 2013 13:55:21 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
 <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
Message-ID: <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>

Also- I teste other user roles, and only Authors and higher can delete the
form entries.  But anyone can add new.


On Mon, Oct 21, 2013 at 1:53 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> Its JSON that is refurning the failure message.  I checked the error log
> after clearing it and this is the response:
>
> [Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not configured
> [hint: SSLSessionCache]
> [Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for digest
> authentication ...
> [Mon Oct 21 13:49:12 2013] [notice] Digest: done
> [Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
> mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
> configured -- resuming normal operations
>
> That relevant?
>
>
> On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
>> > $del_image = wp_delete_attachment( $file, true  );
>> >
>> > I think it would be smarter to convert that to an sql query (maybe
>> wordpress
>> > wont catch it as a delete post function in sql?)
>>
>> You want to use wp_delete_attachment(), not a custom query. The function
>> does a lot more than a single query, it cleans out all of the attachment's
>> data from the data base, and delete's the image files if there are any.
>>
>> Are you sure that wp_delete_attachment() is actually being called? Are
>> you sure it isn't failing before then somewhere?
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

From nikolov.tmw at gmail.com  Mon Oct 21 20:58:39 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Mon, 21 Oct 2013 23:58:39 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
 <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
 <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>
Message-ID: <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>

Ok - so to recap:

 - You are using an AJAX call targeted to /wp-admin/admin-ajax.php with an
"action" attribute set to your custom key
 - You are using add_action( 'wp_ajax_*action*', 'action_callback' ); where
"*action*" is the "action" from above and "action_callback" is your
callback function
 - In your action_callback function you are checking whether the input is
valid and then just call wp_delete_attachment() for the corresponding image

Is that correct?


On Mon, Oct 21, 2013 at 11:55 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> Also- I teste other user roles, and only Authors and higher can delete the
> form entries.  But anyone can add new.
>
>
> On Mon, Oct 21, 2013 at 1:53 PM, Gregory Lancaster <
> greglancaster71 at gmail.com> wrote:
>
> > Its JSON that is refurning the failure message.  I checked the error log
> > after clearing it and this is the response:
> >
> > [Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not configured
> > [hint: SSLSessionCache]
> > [Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for digest
> > authentication ...
> > [Mon Oct 21 13:49:12 2013] [notice] Digest: done
> > [Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
> > mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
> > configured -- resuming normal operations
> >
> > That relevant?
> >
> >
> > On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> > $del_image = wp_delete_attachment( $file, true  );
> >> >
> >> > I think it would be smarter to convert that to an sql query (maybe
> >> wordpress
> >> > wont catch it as a delete post function in sql?)
> >>
> >> You want to use wp_delete_attachment(), not a custom query. The function
> >> does a lot more than a single query, it cleans out all of the
> attachment's
> >> data from the data base, and delete's the image files if there are any.
> >>
> >> Are you sure that wp_delete_attachment() is actually being called? Are
> >> you sure it isn't failing before then somewhere?
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct 21 21:05:15 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 21 Oct 2013 14:05:15 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
 <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
 <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>
 <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>
Message-ID: <CAPN-N+YVb+=QS9twg3D1+NsRniF6by7k6-rxu6GACq0b7=K+uQ@mail.gmail.com>

Yea :

// enqueue ajax code recommended by JD
function my_enqueue_scripts() {
    wp_localize_script(
        'load_post',
        'wp_ajax',
        array(
            'url' => admin_url( 'admin-ajax.php' ),
        )
    );
}
add_action( 'wp_enqueue_scripts', 'my_enqueue_scripts' );



// ajax post code and nonce recommended by Nikola
add_action('wp_ajax_my_delete_row_action', 'my_delete_row_action');
add_action('wp_ajax_nopriv_my_delete_row_action', 'my_delete_row_action');
function my_delete_row_action() {
global $wpdb;
$id = $_POST['id'];
$file = $_POST['file'];
 if ( ! wp_verify_nonce( $_POST['nonce'], 'delete_' . $id . '_' . $file ) )
{
    exit( 'Cheatin, huh?' ); }

$del_image = wp_delete_attachment( $file, false  );
$qry = $wpdb->prepare("DELETE FROM wp_jo_plugin_options WHERE id = %s",
$id);
$go_qry1 = $wpdb->show_errors(); $wpdb->query($qry);
 $response = array( 'success' => true );
 wp_send_json_success($response);

die();
}





On Mon, Oct 21, 2013 at 1:58 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Ok - so to recap:
>
>  - You are using an AJAX call targeted to /wp-admin/admin-ajax.php with an
> "action" attribute set to your custom key
>  - You are using add_action( 'wp_ajax_*action*', 'action_callback' ); where
> "*action*" is the "action" from above and "action_callback" is your
> callback function
>  - In your action_callback function you are checking whether the input is
> valid and then just call wp_delete_attachment() for the corresponding image
>
> Is that correct?
>
>
> On Mon, Oct 21, 2013 at 11:55 PM, Gregory Lancaster <
> greglancaster71 at gmail.com> wrote:
>
> > Also- I teste other user roles, and only Authors and higher can delete
> the
> > form entries.  But anyone can add new.
> >
> >
> > On Mon, Oct 21, 2013 at 1:53 PM, Gregory Lancaster <
> > greglancaster71 at gmail.com> wrote:
> >
> > > Its JSON that is refurning the failure message.  I checked the error
> log
> > > after clearing it and this is the response:
> > >
> > > [Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not configured
> > > [hint: SSLSessionCache]
> > > [Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for
> digest
> > > authentication ...
> > > [Mon Oct 21 13:49:12 2013] [notice] Digest: done
> > > [Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
> > > mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
> > > configured -- resuming normal operations
> > >
> > > That relevant?
> > >
> > >
> > > On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co>
> > wrote:
> > >
> > >> > $del_image = wp_delete_attachment( $file, true  );
> > >> >
> > >> > I think it would be smarter to convert that to an sql query (maybe
> > >> wordpress
> > >> > wont catch it as a delete post function in sql?)
> > >>
> > >> You want to use wp_delete_attachment(), not a custom query. The
> function
> > >> does a lot more than a single query, it cleans out all of the
> > attachment's
> > >> data from the data base, and delete's the image files if there are
> any.
> > >>
> > >> Are you sure that wp_delete_attachment() is actually being called? Are
> > >> you sure it isn't failing before then somewhere?
> > >> _______________________________________________
> > >> wp-hackers mailing list
> > >> wp-hackers at lists.automattic.com
> > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >>
> > >
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Mon Oct 21 21:07:01 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 21 Oct 2013 14:07:01 -0700
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
 <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
 <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>
 <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>
Message-ID: <CAPN-N+akAWk3Dmgi-gfH1HUnEakhxUz4b9LnqEC1qfibkx=W2Q@mail.gmail.com>

AND I just realized what the problem was.   This bit of code I wrote to
block subscribers from reaching wp-admin:


function themeblvd_redirect_admin(){
if ( ! current_user_can( 'edit_posts' ) ){
wp_redirect( site_url() );
exit;
}
}
add_action( 'admin_init', 'themeblvd_redirect_admin' );

Disabling that fixes the problem.  So dumb of me I totally forgot I added
that.  Another way to block subs from wp-admin?


On Mon, Oct 21, 2013 at 1:58 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Ok - so to recap:
>
>  - You are using an AJAX call targeted to /wp-admin/admin-ajax.php with an
> "action" attribute set to your custom key
>  - You are using add_action( 'wp_ajax_*action*', 'action_callback' ); where
> "*action*" is the "action" from above and "action_callback" is your
> callback function
>  - In your action_callback function you are checking whether the input is
> valid and then just call wp_delete_attachment() for the corresponding image
>
> Is that correct?
>
>
> On Mon, Oct 21, 2013 at 11:55 PM, Gregory Lancaster <
> greglancaster71 at gmail.com> wrote:
>
> > Also- I teste other user roles, and only Authors and higher can delete
> the
> > form entries.  But anyone can add new.
> >
> >
> > On Mon, Oct 21, 2013 at 1:53 PM, Gregory Lancaster <
> > greglancaster71 at gmail.com> wrote:
> >
> > > Its JSON that is refurning the failure message.  I checked the error
> log
> > > after clearing it and this is the response:
> > >
> > > [Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not configured
> > > [hint: SSLSessionCache]
> > > [Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for
> digest
> > > authentication ...
> > > [Mon Oct 21 13:49:12 2013] [notice] Digest: done
> > > [Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
> > > mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
> > > configured -- resuming normal operations
> > >
> > > That relevant?
> > >
> > >
> > > On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co>
> > wrote:
> > >
> > >> > $del_image = wp_delete_attachment( $file, true  );
> > >> >
> > >> > I think it would be smarter to convert that to an sql query (maybe
> > >> wordpress
> > >> > wont catch it as a delete post function in sql?)
> > >>
> > >> You want to use wp_delete_attachment(), not a custom query. The
> function
> > >> does a lot more than a single query, it cleans out all of the
> > attachment's
> > >> data from the data base, and delete's the image files if there are
> any.
> > >>
> > >> Are you sure that wp_delete_attachment() is actually being called? Are
> > >> you sure it isn't failing before then somewhere?
> > >> _______________________________________________
> > >> wp-hackers mailing list
> > >> wp-hackers at lists.automattic.com
> > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >>
> > >
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Mon Oct 21 21:09:04 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Tue, 22 Oct 2013 00:09:04 +0300
Subject: [wp-hackers] Delete Row - Refreshes Page but not DB
In-Reply-To: <CAPN-N+akAWk3Dmgi-gfH1HUnEakhxUz4b9LnqEC1qfibkx=W2Q@mail.gmail.com>
References: <1382203525770-42566.post@n5.nabble.com>
 <28874D7C-688F-4F50-A515-79802A39DCF7@codesymphony.co>
 <CAPN-N+adQ5gnVruD3Em6QLUEDGAqoh9zk0QiJcw+=PX14cuDXQ@mail.gmail.com>
 <1D086ADE-A8AF-4562-879D-2B7F9D97DB65@codesymphony.co>
 <CAOwx47embm8ZiAxgH-c=BV4QQWiOz_-n_csxfaoijWLdAQGhww@mail.gmail.com>
 <CAPN-N+ZZ-y2JOG8OjV46Q2Uz+MsKgYnjNo6SDh3AG_saPcmhDw@mail.gmail.com>
 <CAPN-N+bAXF0hnw6hG6R3Sf-usY_xg7Cu1fkU7rPYd2OQqr7Ubw@mail.gmail.com>
 <CAOwx47dbFGVU5T6WwYVweytuREVavoEcUDy2-nqCJXzfWsJQPQ@mail.gmail.com>
 <CAPN-N+ZyEXwO-hD-Nw7wm1bYqjeXt_Fo0XUP82idLgd2O_-yLQ@mail.gmail.com>
 <CAOwx47fdmsrFBry=-1LMUGnej0nPkT2OkQnyA1jdzF684oqshw@mail.gmail.com>
 <1382268403944-42580.post@n5.nabble.com>
 <6B158DC5-7170-4033-A4E4-BEA0CB67A385@codesymphony.co>
 <CAPN-N+YgS+JUrSZOyy3nssDv5p9oY_tbHJhLsSVkeKuJqzQ+bA@mail.gmail.com>
 <CAPN-N+aScrxVGmnGm5-fPgrq=Hyk_Z9WcQY9S63hNYV_gSztBw@mail.gmail.com>
 <CAOwx47fk=xmUUxf4zjzJ75dHx=TeEpwoVoOk7AbRpW4ptc3LAg@mail.gmail.com>
 <CAPN-N+akAWk3Dmgi-gfH1HUnEakhxUz4b9LnqEC1qfibkx=W2Q@mail.gmail.com>
Message-ID: <CAOwx47cdSL2vxedvRMN-vJpALCEuWS5qLLf=Qn94qSbHTWL7=A@mail.gmail.com>

Now that explains the problem :)

Well just change your code to this:

if ( ! current_user_can( 'edit_posts' ) && ( ! defined( 'DOING_AJAX' )
|| ! DOING_AJAX
) ){

This way you will not redirect the users when the request an AJAX one.


On Tue, Oct 22, 2013 at 12:07 AM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> AND I just realized what the problem was.   This bit of code I wrote to
> block subscribers from reaching wp-admin:
>
>
> function themeblvd_redirect_admin(){
> if ( ! current_user_can( 'edit_posts' ) ){
> wp_redirect( site_url() );
> exit;
> }
> }
> add_action( 'admin_init', 'themeblvd_redirect_admin' );
>
> Disabling that fixes the problem.  So dumb of me I totally forgot I added
> that.  Another way to block subs from wp-admin?
>
>
> On Mon, Oct 21, 2013 at 1:58 PM, Nikola Nikolov <nikolov.tmw at gmail.com
> >wrote:
>
> > Ok - so to recap:
> >
> >  - You are using an AJAX call targeted to /wp-admin/admin-ajax.php with
> an
> > "action" attribute set to your custom key
> >  - You are using add_action( 'wp_ajax_*action*', 'action_callback' );
> where
> > "*action*" is the "action" from above and "action_callback" is your
> > callback function
> >  - In your action_callback function you are checking whether the input is
> > valid and then just call wp_delete_attachment() for the corresponding
> image
> >
> > Is that correct?
> >
> >
> > On Mon, Oct 21, 2013 at 11:55 PM, Gregory Lancaster <
> > greglancaster71 at gmail.com> wrote:
> >
> > > Also- I teste other user roles, and only Authors and higher can delete
> > the
> > > form entries.  But anyone can add new.
> > >
> > >
> > > On Mon, Oct 21, 2013 at 1:53 PM, Gregory Lancaster <
> > > greglancaster71 at gmail.com> wrote:
> > >
> > > > Its JSON that is refurning the failure message.  I checked the error
> > log
> > > > after clearing it and this is the response:
> > > >
> > > > [Mon Oct 21 13:49:11 2013] [warn] Init: Session Cache is not
> configured
> > > > [hint: SSLSessionCache]
> > > > [Mon Oct 21 13:49:12 2013] [notice] Digest: generating secret for
> > digest
> > > > authentication ...
> > > > [Mon Oct 21 13:49:12 2013] [notice] Digest: done
> > > > [Mon Oct 21 13:49:12 2013] [notice] Apache/2.2.14 (Unix) DAV/2
> > > > mod_ssl/2.2.14 OpenSSL/0.9.8l PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
> > > > configured -- resuming normal operations
> > > >
> > > > That relevant?
> > > >
> > > >
> > > > On Sun, Oct 20, 2013 at 10:02 AM, J.D. Grimes <jdg at codesymphony.co>
> > > wrote:
> > > >
> > > >> > $del_image = wp_delete_attachment( $file, true  );
> > > >> >
> > > >> > I think it would be smarter to convert that to an sql query (maybe
> > > >> wordpress
> > > >> > wont catch it as a delete post function in sql?)
> > > >>
> > > >> You want to use wp_delete_attachment(), not a custom query. The
> > function
> > > >> does a lot more than a single query, it cleans out all of the
> > > attachment's
> > > >> data from the data base, and delete's the image files if there are
> > any.
> > > >>
> > > >> Are you sure that wp_delete_attachment() is actually being called?
> Are
> > > >> you sure it isn't failing before then somewhere?
> > > >> _______________________________________________
> > > >> wp-hackers mailing list
> > > >> wp-hackers at lists.automattic.com
> > > >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >>
> > > >
> > > >
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From me at jes.se.com  Tue Oct 22 15:49:11 2013
From: me at jes.se.com (Jesse Friedman)
Date: Tue, 22 Oct 2013 11:49:11 -0400
Subject: [wp-hackers] Rewrite rules after unknown url structure
Message-ID: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>

Hi Everyone

Thanks in advance for any help.

We have a plugin that turns all of our pages and CPT's into SEM landing
pages simply by appending ?sem=true to the end of the url.  Google has
recently decided to start declining our campaigns because of this
parameter.

So right now I have
domain.com/coverage/vehicle/?sem=true

I need it to be
domain.com/coverage/vehicle/sem

I have the following code, which works well to a point.

function add_query_vars($aVars) {
    $aVars[] = "sid";    // represents the name of the product category as
shown in the URL
    return $aVars;
}

add_filter('query_vars', 'add_query_vars');

function add_rewrite_rules($aRules) {
    $aNewRules = array('sample-page/([^/]+)/?$' =>
'index.php?pagename=sample-page&sid=$matches[1]');
    $aRules = $aNewRules + $aRules;
    return $aRules;
}

add_filter('rewrite_rules_array', 'add_rewrite_rules');

The problem is that, this code assumes this parameter is only going to be
used on pages where pagename=='sample-page'

I need to be able to get the var on any page, post, cpt, etc...

I'm find with doing

domain.com/sem/sample-page


Can someone point me in the right direction?


-- 
thanks

*jesse friedman*
jes.se.com *
*
Book: Web Designers Guide to WordPress -
http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
Twitter: @professor <http://twitter.com/professor>
Facebook: Like<https://www.facebook.com/pages/Jesse-Friedman/204793299545174>

From whsatterwhite at gmail.com  Tue Oct 22 15:54:14 2013
From: whsatterwhite at gmail.com (William Satterwhite)
Date: Tue, 22 Oct 2013 11:54:14 -0400
Subject: [wp-hackers] Rewrite rules after unknown url structure
In-Reply-To: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
References: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
Message-ID: <CAGbA+aaVeQ6ZuFbX5w92qtCeES=ycLDz0HCskJxPxRLeGYbiLA@mail.gmail.com>

Are your SEM landing pages actual pages or another custom post type? If
they're another custom post type you could add an additional parameter
specifying the post type in your add_rewrite_rules function.

 $aNewRules = array('sample-page/([^/]+)/?$' =>
'index.php?*post_type=sem_pages*&pagename=sample-page&sid=$matches[1]');


On Tue, Oct 22, 2013 at 11:49 AM, Jesse Friedman <me at jes.se.com> wrote:

> Hi Everyone
>
> Thanks in advance for any help.
>
> We have a plugin that turns all of our pages and CPT's into SEM landing
> pages simply by appending ?sem=true to the end of the url.  Google has
> recently decided to start declining our campaigns because of this
> parameter.
>
> So right now I have
> domain.com/coverage/vehicle/?sem=true
>
> I need it to be
> domain.com/coverage/vehicle/sem
>
> I have the following code, which works well to a point.
>
> function add_query_vars($aVars) {
>     $aVars[] = "sid";    // represents the name of the product category as
> shown in the URL
>     return $aVars;
> }
>
> add_filter('query_vars', 'add_query_vars');
>
> function add_rewrite_rules($aRules) {
>     $aNewRules = array('sample-page/([^/]+)/?$' =>
> 'index.php?pagename=sample-page&sid=$matches[1]');
>     $aRules = $aNewRules + $aRules;
>     return $aRules;
> }
>
> add_filter('rewrite_rules_array', 'add_rewrite_rules');
>
> The problem is that, this code assumes this parameter is only going to be
> used on pages where pagename=='sample-page'
>
> I need to be able to get the var on any page, post, cpt, etc...
>
> I'm find with doing
>
> domain.com/sem/sample-page
>
>
> Can someone point me in the right direction?
>
>
> --
> thanks
>
> *jesse friedman*
> jes.se.com *
> *
> Book: Web Designers Guide to WordPress -
> http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> Twitter: @professor <http://twitter.com/professor>
> Facebook: Like<
> https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Hunter Satterwhite
http://linkedin.com/in/hsatterwhite
(252) 762-5177

From johnbillion+wp at gmail.com  Tue Oct 22 15:58:43 2013
From: johnbillion+wp at gmail.com (John Blackbourn)
Date: Tue, 22 Oct 2013 16:58:43 +0100
Subject: [wp-hackers] Rewrite rules after unknown url structure
In-Reply-To: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
References: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
Message-ID: <CAOqAKWC_B5WUeZXQ7YREoXVv6WzR66iHrnO5hS26ZrO3_rDB3Q@mail.gmail.com>

You should look at rewrite endpoints.
http://codex.wordpress.org/Rewrite_API/add_rewrite_endpoint


On 22 October 2013 16:49, Jesse Friedman <me at jes.se.com> wrote:

> Hi Everyone
>
> Thanks in advance for any help.
>
> We have a plugin that turns all of our pages and CPT's into SEM landing
> pages simply by appending ?sem=true to the end of the url.  Google has
> recently decided to start declining our campaigns because of this
> parameter.
>
> So right now I have
> domain.com/coverage/vehicle/?sem=true
>
> I need it to be
> domain.com/coverage/vehicle/sem
>
> I have the following code, which works well to a point.
>
> function add_query_vars($aVars) {
>     $aVars[] = "sid";    // represents the name of the product category as
> shown in the URL
>     return $aVars;
> }
>
> add_filter('query_vars', 'add_query_vars');
>
> function add_rewrite_rules($aRules) {
>     $aNewRules = array('sample-page/([^/]+)/?$' =>
> 'index.php?pagename=sample-page&sid=$matches[1]');
>     $aRules = $aNewRules + $aRules;
>     return $aRules;
> }
>
> add_filter('rewrite_rules_array', 'add_rewrite_rules');
>
> The problem is that, this code assumes this parameter is only going to be
> used on pages where pagename=='sample-page'
>
> I need to be able to get the var on any page, post, cpt, etc...
>
> I'm find with doing
>
> domain.com/sem/sample-page
>
>
> Can someone point me in the right direction?
>
>
> --
> thanks
>
> *jesse friedman*
> jes.se.com *
> *
> Book: Web Designers Guide to WordPress -
> http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> Twitter: @professor <http://twitter.com/professor>
> Facebook: Like<
> https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From me at jes.se.com  Tue Oct 22 15:58:20 2013
From: me at jes.se.com (Jesse Friedman)
Date: Tue, 22 Oct 2013 11:58:20 -0400
Subject: [wp-hackers] Rewrite rules after unknown url structure
In-Reply-To: <CAGbA+aaVeQ6ZuFbX5w92qtCeES=ycLDz0HCskJxPxRLeGYbiLA@mail.gmail.com>
References: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
 <CAGbA+aaVeQ6ZuFbX5w92qtCeES=ycLDz0HCskJxPxRLeGYbiLA@mail.gmail.com>
Message-ID: <CAGtTZ+ZxnEK+GeKztYde1RQTecQ68in-epj76vBa4yi+ZsEf8g@mail.gmail.com>

Hey Hunter

The SEM landing pages don't really exist. Basically if that parameter is
set to True it just strips out the nav, sidebar, and footer and replaces it
with other markup. So every post, page, cpt can potentially be an SEM
landing page.

Jesse


On Tue, Oct 22, 2013 at 11:54 AM, William Satterwhite <
whsatterwhite at gmail.com> wrote:

> Are your SEM landing pages actual pages or another custom post type? If
> they're another custom post type you could add an additional parameter
> specifying the post type in your add_rewrite_rules function.
>
>  $aNewRules = array('sample-page/([^/]+)/?$' =>
> 'index.php?*post_type=sem_pages*&pagename=sample-page&sid=$matches[1]');
>
>
> On Tue, Oct 22, 2013 at 11:49 AM, Jesse Friedman <me at jes.se.com> wrote:
>
> > Hi Everyone
> >
> > Thanks in advance for any help.
> >
> > We have a plugin that turns all of our pages and CPT's into SEM landing
> > pages simply by appending ?sem=true to the end of the url.  Google has
> > recently decided to start declining our campaigns because of this
> > parameter.
> >
> > So right now I have
> > domain.com/coverage/vehicle/?sem=true
> >
> > I need it to be
> > domain.com/coverage/vehicle/sem
> >
> > I have the following code, which works well to a point.
> >
> > function add_query_vars($aVars) {
> >     $aVars[] = "sid";    // represents the name of the product category
> as
> > shown in the URL
> >     return $aVars;
> > }
> >
> > add_filter('query_vars', 'add_query_vars');
> >
> > function add_rewrite_rules($aRules) {
> >     $aNewRules = array('sample-page/([^/]+)/?$' =>
> > 'index.php?pagename=sample-page&sid=$matches[1]');
> >     $aRules = $aNewRules + $aRules;
> >     return $aRules;
> > }
> >
> > add_filter('rewrite_rules_array', 'add_rewrite_rules');
> >
> > The problem is that, this code assumes this parameter is only going to be
> > used on pages where pagename=='sample-page'
> >
> > I need to be able to get the var on any page, post, cpt, etc...
> >
> > I'm find with doing
> >
> > domain.com/sem/sample-page
> >
> >
> > Can someone point me in the right direction?
> >
> >
> > --
> > thanks
> >
> > *jesse friedman*
> > jes.se.com *
> > *
> > Book: Web Designers Guide to WordPress -
> > http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> > Twitter: @professor <http://twitter.com/professor>
> > Facebook: Like<
> > https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> Hunter Satterwhite
> http://linkedin.com/in/hsatterwhite
> (252) 762-5177
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
thanks

*jesse friedman*
jes.se.com *
*
Book: Web Designers Guide to WordPress -
http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
Twitter: @professor <http://twitter.com/professor>
Facebook: Like<https://www.facebook.com/pages/Jesse-Friedman/204793299545174>

From whsatterwhite at gmail.com  Tue Oct 22 16:07:43 2013
From: whsatterwhite at gmail.com (William Satterwhite)
Date: Tue, 22 Oct 2013 12:07:43 -0400
Subject: [wp-hackers] Rewrite rules after unknown url structure
In-Reply-To: <CAGtTZ+ZxnEK+GeKztYde1RQTecQ68in-epj76vBa4yi+ZsEf8g@mail.gmail.com>
References: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
 <CAGbA+aaVeQ6ZuFbX5w92qtCeES=ycLDz0HCskJxPxRLeGYbiLA@mail.gmail.com>
 <CAGtTZ+ZxnEK+GeKztYde1RQTecQ68in-epj76vBa4yi+ZsEf8g@mail.gmail.com>
Message-ID: <CAGbA+aYeC1zNLkncgc8MoA6AJMon8z9E_=hhZX0m8Sr_u+0b5w@mail.gmail.com>

Ah I see. I've done something similar, but I was actually querying for a
custom post type, but the requested URL utilized the existing page URL
structure. And FWIW I was using a custom query_var as well.

This being the live example that I'm referring to:
http://michiganfireworks.com/by-date/2013-11-01/

The ISO date is the custom query var, but the by-date portion is using your
normal page URL structure.

I agree with John; look in to endpoints.


On Tue, Oct 22, 2013 at 11:58 AM, Jesse Friedman <me at jes.se.com> wrote:

> Hey Hunter
>
> The SEM landing pages don't really exist. Basically if that parameter is
> set to True it just strips out the nav, sidebar, and footer and replaces it
> with other markup. So every post, page, cpt can potentially be an SEM
> landing page.
>
> Jesse
>
>
> On Tue, Oct 22, 2013 at 11:54 AM, William Satterwhite <
> whsatterwhite at gmail.com> wrote:
>
> > Are your SEM landing pages actual pages or another custom post type? If
> > they're another custom post type you could add an additional parameter
> > specifying the post type in your add_rewrite_rules function.
> >
> >  $aNewRules = array('sample-page/([^/]+)/?$' =>
> > 'index.php?*post_type=sem_pages*&pagename=sample-page&sid=$matches[1]');
> >
> >
> > On Tue, Oct 22, 2013 at 11:49 AM, Jesse Friedman <me at jes.se.com> wrote:
> >
> > > Hi Everyone
> > >
> > > Thanks in advance for any help.
> > >
> > > We have a plugin that turns all of our pages and CPT's into SEM landing
> > > pages simply by appending ?sem=true to the end of the url.  Google has
> > > recently decided to start declining our campaigns because of this
> > > parameter.
> > >
> > > So right now I have
> > > domain.com/coverage/vehicle/?sem=true
> > >
> > > I need it to be
> > > domain.com/coverage/vehicle/sem
> > >
> > > I have the following code, which works well to a point.
> > >
> > > function add_query_vars($aVars) {
> > >     $aVars[] = "sid";    // represents the name of the product category
> > as
> > > shown in the URL
> > >     return $aVars;
> > > }
> > >
> > > add_filter('query_vars', 'add_query_vars');
> > >
> > > function add_rewrite_rules($aRules) {
> > >     $aNewRules = array('sample-page/([^/]+)/?$' =>
> > > 'index.php?pagename=sample-page&sid=$matches[1]');
> > >     $aRules = $aNewRules + $aRules;
> > >     return $aRules;
> > > }
> > >
> > > add_filter('rewrite_rules_array', 'add_rewrite_rules');
> > >
> > > The problem is that, this code assumes this parameter is only going to
> be
> > > used on pages where pagename=='sample-page'
> > >
> > > I need to be able to get the var on any page, post, cpt, etc...
> > >
> > > I'm find with doing
> > >
> > > domain.com/sem/sample-page
> > >
> > >
> > > Can someone point me in the right direction?
> > >
> > >
> > > --
> > > thanks
> > >
> > > *jesse friedman*
> > > jes.se.com *
> > > *
> > > Book: Web Designers Guide to WordPress -
> > > http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> > > Twitter: @professor <http://twitter.com/professor>
> > > Facebook: Like<
> > > https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> >
> >
> >
> > --
> > Hunter Satterwhite
> > http://linkedin.com/in/hsatterwhite
> > (252) 762-5177
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> thanks
>
> *jesse friedman*
> jes.se.com *
> *
> Book: Web Designers Guide to WordPress -
> http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> Twitter: @professor <http://twitter.com/professor>
> Facebook: Like<
> https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Hunter Satterwhite
http://linkedin.com/in/hsatterwhite
(252) 762-5177

From highfive at jesserfriedman.com  Tue Oct 22 16:20:14 2013
From: highfive at jesserfriedman.com (Jesse Friedman)
Date: Tue, 22 Oct 2013 12:20:14 -0400
Subject: [wp-hackers] Rewrite rules after unknown url structure
In-Reply-To: <CAGbA+aYeC1zNLkncgc8MoA6AJMon8z9E_=hhZX0m8Sr_u+0b5w@mail.gmail.com>
References: <CAGtTZ+Ztm9pgBXu2r+uSeFkh451oaj_Ah=N2HWc8Yk9e-5paaA@mail.gmail.com>
 <CAGbA+aaVeQ6ZuFbX5w92qtCeES=ycLDz0HCskJxPxRLeGYbiLA@mail.gmail.com>
 <CAGtTZ+ZxnEK+GeKztYde1RQTecQ68in-epj76vBa4yi+ZsEf8g@mail.gmail.com>
 <CAGbA+aYeC1zNLkncgc8MoA6AJMon8z9E_=hhZX0m8Sr_u+0b5w@mail.gmail.com>
Message-ID: <CAGtTZ+aBPdQYHoY7u-6DRUx6Ez9OvFuEiB8F3wgZhRqzAVT9yA@mail.gmail.com>

John and Hunter

Thanks for the help. The endpoints did it.

3 line of code

public function custom_sem_rewrite_rule(){

 add_rewrite_endpoint( 'sem', EP_PERMALINK | EP_PAGES );
 }


On Tue, Oct 22, 2013 at 12:07 PM, William Satterwhite <
whsatterwhite at gmail.com> wrote:

> Ah I see. I've done something similar, but I was actually querying for a
> custom post type, but the requested URL utilized the existing page URL
> structure. And FWIW I was using a custom query_var as well.
>
> This being the live example that I'm referring to:
> http://michiganfireworks.com/by-date/2013-11-01/
>
> The ISO date is the custom query var, but the by-date portion is using your
> normal page URL structure.
>
> I agree with John; look in to endpoints.
>
>
> On Tue, Oct 22, 2013 at 11:58 AM, Jesse Friedman <me at jes.se.com> wrote:
>
> > Hey Hunter
> >
> > The SEM landing pages don't really exist. Basically if that parameter is
> > set to True it just strips out the nav, sidebar, and footer and replaces
> it
> > with other markup. So every post, page, cpt can potentially be an SEM
> > landing page.
> >
> > Jesse
> >
> >
> > On Tue, Oct 22, 2013 at 11:54 AM, William Satterwhite <
> > whsatterwhite at gmail.com> wrote:
> >
> > > Are your SEM landing pages actual pages or another custom post type? If
> > > they're another custom post type you could add an additional parameter
> > > specifying the post type in your add_rewrite_rules function.
> > >
> > >  $aNewRules = array('sample-page/([^/]+)/?$' =>
> > >
> 'index.php?*post_type=sem_pages*&pagename=sample-page&sid=$matches[1]');
> > >
> > >
> > > On Tue, Oct 22, 2013 at 11:49 AM, Jesse Friedman <me at jes.se.com>
> wrote:
> > >
> > > > Hi Everyone
> > > >
> > > > Thanks in advance for any help.
> > > >
> > > > We have a plugin that turns all of our pages and CPT's into SEM
> landing
> > > > pages simply by appending ?sem=true to the end of the url.  Google
> has
> > > > recently decided to start declining our campaigns because of this
> > > > parameter.
> > > >
> > > > So right now I have
> > > > domain.com/coverage/vehicle/?sem=true
> > > >
> > > > I need it to be
> > > > domain.com/coverage/vehicle/sem
> > > >
> > > > I have the following code, which works well to a point.
> > > >
> > > > function add_query_vars($aVars) {
> > > >     $aVars[] = "sid";    // represents the name of the product
> category
> > > as
> > > > shown in the URL
> > > >     return $aVars;
> > > > }
> > > >
> > > > add_filter('query_vars', 'add_query_vars');
> > > >
> > > > function add_rewrite_rules($aRules) {
> > > >     $aNewRules = array('sample-page/([^/]+)/?$' =>
> > > > 'index.php?pagename=sample-page&sid=$matches[1]');
> > > >     $aRules = $aNewRules + $aRules;
> > > >     return $aRules;
> > > > }
> > > >
> > > > add_filter('rewrite_rules_array', 'add_rewrite_rules');
> > > >
> > > > The problem is that, this code assumes this parameter is only going
> to
> > be
> > > > used on pages where pagename=='sample-page'
> > > >
> > > > I need to be able to get the var on any page, post, cpt, etc...
> > > >
> > > > I'm find with doing
> > > >
> > > > domain.com/sem/sample-page
> > > >
> > > >
> > > > Can someone point me in the right direction?
> > > >
> > > >
> > > > --
> > > > thanks
> > > >
> > > > *jesse friedman*
> > > > jes.se.com *
> > > > *
> > > > Book: Web Designers Guide to WordPress -
> > > > http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> > > > Twitter: @professor <http://twitter.com/professor>
> > > > Facebook: Like<
> > > > https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >
> > >
> > >
> > >
> > > --
> > > Hunter Satterwhite
> > > http://linkedin.com/in/hsatterwhite
> > > (252) 762-5177
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> >
> >
> >
> > --
> > thanks
> >
> > *jesse friedman*
> > jes.se.com *
> > *
> > Book: Web Designers Guide to WordPress -
> > http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
> > Twitter: @professor <http://twitter.com/professor>
> > Facebook: Like<
> > https://www.facebook.com/pages/Jesse-Friedman/204793299545174>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> Hunter Satterwhite
> http://linkedin.com/in/hsatterwhite
> (252) 762-5177
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
thanks
*
*
*jesse friedman*
jes.se.com *
*
Book: Web Designers Guide to WordPress -
http://wdgwp.com/onamazon<http://wdgwp.com/onamazon>
Twitter: @professor <http://twitter.com/professor>
Facebook: Like<https://www.facebook.com/pages/Jesse-Friedman/204793299545174>

From ajmorris2002 at gmail.com  Tue Oct 22 17:06:45 2013
From: ajmorris2002 at gmail.com (AJ Morris)
Date: Tue, 22 Oct 2013 13:06:45 -0400
Subject: [wp-hackers] Custom Post Type URL Rewrite
Message-ID: <4EA8C8EB6EB24920BCC77BE36E490345@gmail.com>

Hey all, 

I have a CPT that we use for press releases and I'd like the archive page to live under a page, eg. example.com/about-us/pressreleases.

The problem I'm encountering is that the menu is just wp_list_pages(). I thought I'd be able to do something with 'rewrite' => array( 'slug' => 'about-us/pressreleases', 'with_front' => true)) like I did for single press releases, but that doesn't seem to work. It seems the only way I could get this to work is to create a page, and assign it a special template in which I have a custom query on it.

Does that make sense? Is there a better way to go about it?

Thanks in advance! 

-- 
AJ Morris


From hendronix at gmail.com  Tue Oct 22 18:04:50 2013
From: hendronix at gmail.com (Eric Hendrix)
Date: Tue, 22 Oct 2013 11:04:50 -0700 (PDT)
Subject: [wp-hackers] Custom Post Type URL Rewrite
In-Reply-To: <4EA8C8EB6EB24920BCC77BE36E490345@gmail.com>
References: <4EA8C8EB6EB24920BCC77BE36E490345@gmail.com>
Message-ID: <1382465089806.13fcc545@Nodemailer>

I had to use the same setup for our Press Releases too. I don't know enough to figure out a better way around it. It works pretty cleanly though.




Eric

Eric A. Hendrix
308 McFadyen Drive
Fayetteville, NC
28314
910.644.8940
Hendronix at gmail.com
www.hendronix.com

On Tue, Oct 22, 2013 at 1:06 PM, AJ Morris <ajmorris2002 at gmail.com> wrote:

> Hey all, 
> I have a CPT that we use for press releases and I'd like the archive page to live under a page, eg. example.com/about-us/pressreleases.
> The problem I'm encountering is that the menu is just wp_list_pages(). I thought I'd be able to do something with 'rewrite' => array( 'slug' => 'about-us/pressreleases', 'with_front' => true)) like I did for single press releases, but that doesn't seem to work. It seems the only way I could get this to work is to create a page, and assign it a special template in which I have a custom query on it.
> Does that make sense? Is there a better way to go about it?
> Thanks in advance! 
> -- 
> AJ Morris
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From mickyhulse.lists at gmail.com  Tue Oct 22 23:23:16 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Tue, 22 Oct 2013 16:23:16 -0700
Subject: [wp-hackers] iOS WP app: Featured image size problems
Message-ID: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>

Hi,

Details: Wordpress 3.6.1, iOS WP app 3.8.3.

I'm hoping someone can help me figure this one out. I can't seem to
find an answer on Google.

Scenario:

Create/publish post from the WP iOS app that has a featured image
(uploaded as "original" size).

Problem:

Functions that get the post's thumbnail only return original size.

What I see:

When looking at FTP upload location, all of the image sizes (I've got
several custom sizes) are there.

When I run:

print_r(wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px'));

... I get:

Array
(
    [0] => http://foo.com/blog/files/2013/10/20131022-160759.jpg
    [1] => 0
    [2] => 0
    [3] =>
)

I'm not sure how to trouble shoot this.

At first I thought that maybe the WP app did not obey the custom
images sizes ... But they are generated and sitting there in my
uploads folder.

It's almost like something, image related, isn't getting logged to the
database when the WP app makes a post.

I'd love some help. I'm hoping it's something I overlooked and is easy
to fix. :)

Thanks!
M

From jdg at codesymphony.co  Wed Oct 23 12:25:43 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Wed, 23 Oct 2013 08:25:43 -0400
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
Message-ID: <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>

I don't think that wp_get_attachment_image_src() accepts parameters of the format you are using ('300px'). http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src

The $size can either be a keyword (thumbnail, medium, large or full) or an array (array(300,300)).

-J.D.

On Oct 22, 2013, at 7:23 PM, Micky Hulse <mickyhulse.lists at gmail.com> wrote:

> Hi,
> 
> Details: Wordpress 3.6.1, iOS WP app 3.8.3.
> 
> I'm hoping someone can help me figure this one out. I can't seem to
> find an answer on Google.
> 
> Scenario:
> 
> Create/publish post from the WP iOS app that has a featured image
> (uploaded as "original" size).
> 
> Problem:
> 
> Functions that get the post's thumbnail only return original size.
> 
> What I see:
> 
> When looking at FTP upload location, all of the image sizes (I've got
> several custom sizes) are there.
> 
> When I run:
> 
> print_r(wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px'));
> 
> ... I get:
> 
> Array
> (
>    [0] => http://foo.com/blog/files/2013/10/20131022-160759.jpg
>    [1] => 0
>    [2] => 0
>    [3] =>
> )
> 
> I'm not sure how to trouble shoot this.
> 
> At first I thought that maybe the WP app did not obey the custom
> images sizes ... But they are generated and sitting there in my
> uploads folder.
> 
> It's almost like something, image related, isn't getting logged to the
> database when the WP app makes a post.
> 
> I'd love some help. I'm hoping it's something I overlooked and is easy
> to fix. :)
> 
> Thanks!
> M
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From simon.vart at exigences.biz  Wed Oct 23 14:57:35 2013
From: simon.vart at exigences.biz (Simon Vart)
Date: Wed, 23 Oct 2013 16:57:35 +0200
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
Message-ID: <5267E3DF.6080204@exigences.biz>

I think you could also add a new image size in functions.php :

add_image_size( '300px', 300, 300, true );

and then your call to wp_get_attachment_image_src() will be understood. 
When you upload an image, WP will create a image of this size with the 
keyword '300px'


-- 
---------------------
Simon Vart
d?veloppement web / informatique
----
02.98.67.92.70
06.09.97.82.91
www.exigences.biz
linkedin : http://www.linkedin.com/profile/view?id=87258047
twitter : @simonvart
skype: carantecinfo
---------------------

Le 23/10/2013 14:25, J.D. Grimes a ?crit :
> I don't think that wp_get_attachment_image_src() accepts parameters of the format you are using ('300px'). http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src
>
> The $size can either be a keyword (thumbnail, medium, large or full) or an array (array(300,300)).
>
> -J.D.
>
> On Oct 22, 2013, at 7:23 PM, Micky Hulse <mickyhulse.lists at gmail.com> wrote:
>
>> Hi,
>>
>> Details: Wordpress 3.6.1, iOS WP app 3.8.3.
>>
>> I'm hoping someone can help me figure this one out. I can't seem to
>> find an answer on Google.
>>
>> Scenario:
>>
>> Create/publish post from the WP iOS app that has a featured image
>> (uploaded as "original" size).
>>
>> Problem:
>>
>> Functions that get the post's thumbnail only return original size.
>>
>> What I see:
>>
>> When looking at FTP upload location, all of the image sizes (I've got
>> several custom sizes) are there.
>>
>> When I run:
>>
>> print_r(wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px'));
>>
>> ... I get:
>>
>> Array
>> (
>>     [0] => http://foo.com/blog/files/2013/10/20131022-160759.jpg
>>     [1] => 0
>>     [2] => 0
>>     [3] =>
>> )
>>
>> I'm not sure how to trouble shoot this.
>>
>> At first I thought that maybe the WP app did not obey the custom
>> images sizes ... But they are generated and sitting there in my
>> uploads folder.
>>
>> It's almost like something, image related, isn't getting logged to the
>> database when the WP app makes a post.
>>
>> I'd love some help. I'm hoping it's something I overlooked and is easy
>> to fix. :)
>>
>> Thanks!
>> M
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From mickyhulse.lists at gmail.com  Wed Oct 23 18:58:23 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Wed, 23 Oct 2013 11:58:23 -0700
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <5267E3DF.6080204@exigences.biz>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
 <5267E3DF.6080204@exigences.biz>
Message-ID: <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>

Hello,

Thanks so much for the replies J.D. and Simon, I really appreciate your help.

On Wed, Oct 23, 2013 at 5:25 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> I don't think that wp_get_attachment_image_src() accepts parameters of the format you are using ('300px'). http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src
> The $size can either be a keyword (thumbnail, medium, large or full) or an array (array(300,300)).

My bad. I apologize that I did not mention the rest of my setup.

In my functions file, I have:

function mytheme_setup() {
add_theme_support('post-thumbnails');
set_post_thumbnail_size(150, 150);
}
add_action('after_setup_theme', 'mytheme_setup');
// ... and later on in this file:
# Add new image sizes:
add_image_size('130px', 130); // Thumbnail size: 130 x 130
add_image_size('300px', 300); // Medium size: 300 x 300
add_image_size('470px', 470);
add_image_size('640px', 640);
add_image_size('810px', 810);
add_image_size('980px', 980); // Large size: 980 x 980
add_image_size('1320px', 1320);
add_image_size('1620px', 1620);
add_image_size('1960px', 1960);

The new image size names are based on another system we use ... I
wanted to keep the "XXXpx" naming conventions the same across systems.

With that said, the use of (for example):

wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px')
wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '640px')

... work for all images, except for images uploaded as a featured
image using the WP iOS app.

Other image getting functions also work, but it's the iOS images that
just return the original source image size.

On Wed, Oct 23, 2013 at 7:57 AM, Simon Vart <simon.vart at exigences.biz> wrote:
> I think you could also add a new image size in functions.php :
> add_image_size( '300px', 300, 300, true );
> and then your call to wp_get_attachment_image_src() will be understood. When
> you upload an image, WP will create a image of this size with the keyword
> '300px'

Sorry again, that I did not detail my setup. Thank you for the help,
and thankfully I do have that setup in my functions.php file. I
should've made that clear in my first message. :(

Question(s):

When you folks use the iOS WP app, and set a featured image, are you
able to get at the different sizes on your templates?

For some reason, my setup isn't allowing me to access the custom image
sizes (only for iOS-uploaded featured images), even though they are
generated and sitting there in my uploads folder.

Maybe I'm not setup properly in my functions.php file? I have all of
my add_image_size() calls just sitting out in the open. Do I need to
have these inside of an action? Should they go inside the
"after_setup_theme" action along side my
add_theme_support('post-thumbnails') call?

Please let me know if I can provide more information.

Thank you!

M

From nikolov.tmw at gmail.com  Wed Oct 23 19:39:13 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Wed, 23 Oct 2013 22:39:13 +0300
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
 <5267E3DF.6080204@exigences.biz>
 <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
Message-ID: <CAOwx47fAdsNy+PtirWWQDV6rr1w6kD6qOKxGf__vpqFkR+epyg@mail.gmail.com>

Can you try doing

print_r( wp_get_attachment_metadata( get_post_thumbnail_id( $post->ID ) ) );

And see what the "sizes" key of the returned array contains? In theory all
of your custom sizes data should be right there(see the function in the
codex -
http://codex.wordpress.org/Function_Reference/wp_get_attachment_metadata ).

If there are no sizes(or only the default ones are there), try the
following:

$uploads_dir = wp_upload_dir();
$thumbnail_id = get_post_thumbnail_id( $post->ID );
$file_name = wp_get_attachment_metadata( $thumbnail_id );
$file_name = $file_name && isset( $file_name['file'] ) ? $file_name['file']
: false;
if ( $file_name ) {
    include_once( ABSPATH . 'wp-admin/includes/image.php' );
    echo "Generating attachment metadata for attachment with ID {$
thumbnail_id}:\n";
    print_r( wp_generate_attachment_metadata( $thumbnail_id, $file_name ) );
} else {
    echo 'No file found';
}

This should in theory generate the attachment metadata - if you have your
sizes in the "sizes" array key, then the problem is either in your
set-up(theme/plugins), or the iOS app.

To investigate further, set-up a default install(no plugins, the default
theme - maybe add in a custom size in there) and use the iOS app to upload
a featured image for a post. Then see if the Featured image comes in your
size - if it does, then it's either your theme, or one of your plugins. If
it doesn't - it's a bug in the iOS app which you should file here -
https://github.com/wordpress-mobile/WordPress-iOS/issues

I hope some of that helps,
Nikola


On Wed, Oct 23, 2013 at 9:58 PM, Micky Hulse <mickyhulse.lists at gmail.com>wrote:

> Hello,
>
> Thanks so much for the replies J.D. and Simon, I really appreciate your
> help.
>
> On Wed, Oct 23, 2013 at 5:25 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> > I don't think that wp_get_attachment_image_src() accepts parameters of
> the format you are using ('300px').
> http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src
> > The $size can either be a keyword (thumbnail, medium, large or full) or
> an array (array(300,300)).
>
> My bad. I apologize that I did not mention the rest of my setup.
>
> In my functions file, I have:
>
> function mytheme_setup() {
> add_theme_support('post-thumbnails');
> set_post_thumbnail_size(150, 150);
> }
> add_action('after_setup_theme', 'mytheme_setup');
> // ... and later on in this file:
> # Add new image sizes:
> add_image_size('130px', 130); // Thumbnail size: 130 x 130
> add_image_size('300px', 300); // Medium size: 300 x 300
> add_image_size('470px', 470);
> add_image_size('640px', 640);
> add_image_size('810px', 810);
> add_image_size('980px', 980); // Large size: 980 x 980
> add_image_size('1320px', 1320);
> add_image_size('1620px', 1620);
> add_image_size('1960px', 1960);
>
> The new image size names are based on another system we use ... I
> wanted to keep the "XXXpx" naming conventions the same across systems.
>
> With that said, the use of (for example):
>
> wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px')
> wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '640px')
>
> ... work for all images, except for images uploaded as a featured
> image using the WP iOS app.
>
> Other image getting functions also work, but it's the iOS images that
> just return the original source image size.
>
> On Wed, Oct 23, 2013 at 7:57 AM, Simon Vart <simon.vart at exigences.biz>
> wrote:
> > I think you could also add a new image size in functions.php :
> > add_image_size( '300px', 300, 300, true );
> > and then your call to wp_get_attachment_image_src() will be understood.
> When
> > you upload an image, WP will create a image of this size with the keyword
> > '300px'
>
> Sorry again, that I did not detail my setup. Thank you for the help,
> and thankfully I do have that setup in my functions.php file. I
> should've made that clear in my first message. :(
>
> Question(s):
>
> When you folks use the iOS WP app, and set a featured image, are you
> able to get at the different sizes on your templates?
>
> For some reason, my setup isn't allowing me to access the custom image
> sizes (only for iOS-uploaded featured images), even though they are
> generated and sitting there in my uploads folder.
>
> Maybe I'm not setup properly in my functions.php file? I have all of
> my add_image_size() calls just sitting out in the open. Do I need to
> have these inside of an action? Should they go inside the
> "after_setup_theme" action along side my
> add_theme_support('post-thumbnails') call?
>
> Please let me know if I can provide more information.
>
> Thank you!
>
> M
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From mickyhulse.lists at gmail.com  Wed Oct 23 19:50:38 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Wed, 23 Oct 2013 12:50:38 -0700
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <CAOwx47fAdsNy+PtirWWQDV6rr1w6kD6qOKxGf__vpqFkR+epyg@mail.gmail.com>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
 <5267E3DF.6080204@exigences.biz>
 <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
 <CAOwx47fAdsNy+PtirWWQDV6rr1w6kD6qOKxGf__vpqFkR+epyg@mail.gmail.com>
Message-ID: <CALri7Mn6q_zPOnfwdE-aRcm4X1rrmQkGQjY=vN015_Q3u1p1YA@mail.gmail.com>

Hi Nikola! Thank you for the quick reply and in-depth help. I greatly
appreciate it. :)

On Wed, Oct 23, 2013 at 12:39 PM, Nikola Nikolov <nikolov.tmw at gmail.com> wrote:
> I hope some of that helps,

Very much so!

I will follow your tests today and report back my findings. I'm
guessing it's my theme (the only plugins I'm running are "New blog
defaults" and a simple MU plugin for subheads).

With that said, most of the code used other than plugins is all mine,
so there's a high possibility that I introduced a bug somewhere along
the process of building a theme from ground up.

Thanks again! I'll be back with my findings.

Cheers,
Micky

From nl at thoughtrefinery.com  Thu Oct 24 12:06:07 2013
From: nl at thoughtrefinery.com (Nicholas Ciske)
Date: Thu, 24 Oct 2013 07:06:07 -0500
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
 <5267E3DF.6080204@exigences.biz>
 <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
Message-ID: <263C2CB4-F724-44A8-8ACD-250B35F26842@thoughtrefinery.com>

Not a true solution, but a viable workaround: you could install WP Thumb which will create missing image sizes on the fly (and then cache them for future use).

http://wordpress.org/plugins/wp-thumb/

_________________________
Nick Ciske
http://thoughtrefinery.com/
@nciske	

On Oct 23, 2013, at 1:58 PM, Micky Hulse wrote:

> Hello,
> 
> Thanks so much for the replies J.D. and Simon, I really appreciate your help.
> 
> On Wed, Oct 23, 2013 at 5:25 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
>> I don't think that wp_get_attachment_image_src() accepts parameters of the format you are using ('300px'). http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src
>> The $size can either be a keyword (thumbnail, medium, large or full) or an array (array(300,300)).
> 
> My bad. I apologize that I did not mention the rest of my setup.
> 
> In my functions file, I have:
> 
> function mytheme_setup() {
> add_theme_support('post-thumbnails');
> set_post_thumbnail_size(150, 150);
> }
> add_action('after_setup_theme', 'mytheme_setup');
> // ... and later on in this file:
> # Add new image sizes:
> add_image_size('130px', 130); // Thumbnail size: 130 x 130
> add_image_size('300px', 300); // Medium size: 300 x 300
> add_image_size('470px', 470);
> add_image_size('640px', 640);
> add_image_size('810px', 810);
> add_image_size('980px', 980); // Large size: 980 x 980
> add_image_size('1320px', 1320);
> add_image_size('1620px', 1620);
> add_image_size('1960px', 1960);
> 
> The new image size names are based on another system we use ... I
> wanted to keep the "XXXpx" naming conventions the same across systems.
> 
> With that said, the use of (for example):
> 
> wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px')
> wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '640px')
> 
> ... work for all images, except for images uploaded as a featured
> image using the WP iOS app.
> 
> Other image getting functions also work, but it's the iOS images that
> just return the original source image size.
> 
> On Wed, Oct 23, 2013 at 7:57 AM, Simon Vart <simon.vart at exigences.biz> wrote:
>> I think you could also add a new image size in functions.php :
>> add_image_size( '300px', 300, 300, true );
>> and then your call to wp_get_attachment_image_src() will be understood. When
>> you upload an image, WP will create a image of this size with the keyword
>> '300px'
> 
> Sorry again, that I did not detail my setup. Thank you for the help,
> and thankfully I do have that setup in my functions.php file. I
> should've made that clear in my first message. :(
> 
> Question(s):
> 
> When you folks use the iOS WP app, and set a featured image, are you
> able to get at the different sizes on your templates?
> 
> For some reason, my setup isn't allowing me to access the custom image
> sizes (only for iOS-uploaded featured images), even though they are
> generated and sitting there in my uploads folder.
> 
> Maybe I'm not setup properly in my functions.php file? I have all of
> my add_image_size() calls just sitting out in the open. Do I need to
> have these inside of an action? Should they go inside the
> "after_setup_theme" action along side my
> add_theme_support('post-thumbnails') call?
> 
> Please let me know if I can provide more information.
> 
> Thank you!
> 
> M
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From halukkaramete at gmail.com  Thu Oct 24 12:45:55 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 24 Oct 2013 05:45:55 -0700
Subject: [wp-hackers] php.net site got malware??
Message-ID: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>

This morning, chrome warned me with this message:

The Website Ahead Contains Malware!
Google Chrome has blocked access to php.net for now.
I needed to visit the site for a function look up. But I had to stop.
Just sharing for what it's worth...

What do we do? proceed or wait?

From wp at andrewnacin.com  Thu Oct 24 12:54:54 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Thu, 24 Oct 2013 08:54:54 -0400
Subject: [wp-hackers] php.net site got malware??
In-Reply-To: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>
References: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>
Message-ID: <CAP29PvhpcYHCOa-ZjN+5M8rviWGAFh5M0o-vL1yu49kKyr5s8Q@mail.gmail.com>

See https://twitter.com/rasmus/status/393258147025932288 and generally
@rasmus's last few dozen tweets. It appears to be either nothing, or a
problem with a mirror.


On Thu, Oct 24, 2013 at 8:45 AM, Haluk Karamete <halukkaramete at gmail.com>wrote:

> This morning, chrome warned me with this message:
>
> The Website Ahead Contains Malware!
> Google Chrome has blocked access to php.net for now.
> I needed to visit the site for a function look up. But I had to stop.
> Just sharing for what it's worth...
>
> What do we do? proceed or wait?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Thu Oct 24 12:56:34 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Thu, 24 Oct 2013 15:56:34 +0300
Subject: [wp-hackers] php.net site got malware??
In-Reply-To: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>
References: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>
Message-ID: <CAOwx47dkxSWtwFkwOh6VAS-78Nm-btCZ7i_LnGA_bbc_Gr-Uqw@mail.gmail.com>

I got a message on the WordFence list stating that it got flagged as
malware(I was experiencing some un-availability of the site at some point
in the last couple of days). Here's their guess on the issue:

The report Google is issuing for php.net is available
here<http://www.google.com/safebrowsing/diagnostic?site=php.net> .
We haven't been able to verify if php.net has been hacked, but Google
states they crawled the site yesterday and found 4 trojans hosted on 4
domains. If you're a WordPress developer and need to visit php.net to
access PHP documentation, please take care until this is resolved. It is
quite likely a false positive or due to simple backlinks to malicious
domains appearing on php.net, but the worst case scenario is that the site
has been hacked and malware is hosted on the site itself.

So - I'd suggest to wait for now. It seems that they've already filed a
Request for Review according to this thread -
http://productforums.google.com/forum/#!topic/webmasters/puLmvjtK0m8%5B1-25-false%5D


On Thu, Oct 24, 2013 at 3:45 PM, Haluk Karamete <halukkaramete at gmail.com>wrote:

> This morning, chrome warned me with this message:
>
> The Website Ahead Contains Malware!
> Google Chrome has blocked access to php.net for now.
> I needed to visit the site for a function look up. But I had to stop.
> Just sharing for what it's worth...
>
> What do we do? proceed or wait?
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From peter at avirtualhome.com  Thu Oct 24 13:08:46 2013
From: peter at avirtualhome.com (Peter van der Does)
Date: Thu, 24 Oct 2013 09:08:46 -0400
Subject: [wp-hackers] php.net site got malware??
In-Reply-To: <CAP29PvhpcYHCOa-ZjN+5M8rviWGAFh5M0o-vL1yu49kKyr5s8Q@mail.gmail.com>
References: <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=SggpTnbA@mail.gmail.com>
 <CAP29PvhpcYHCOa-ZjN+5M8rviWGAFh5M0o-vL1yu49kKyr5s8Q@mail.gmail.com>
Message-ID: <20131024090846.28ac3201@Indy>

On Thu, 24 Oct 2013 08:54:54 -0400
Andrew Nacin <wp at andrewnacin.com> wrote:

> See https://twitter.com/rasmus/status/393258147025932288 and generally
> @rasmus's last few dozen tweets. It appears to be either nothing, or a
> problem with a mirror.
> 
> 

Not so much false, just no longer an issue, but their userprefs.js file
seems to be compromised at one point:

https://news.ycombinator.com/item?id=6604251

-- 
Peter van der Does

GPG key: CB317D6E

Site: http://avirtualhome.com
GitHub: https://github.com/petervanderdoes
Twitter: @petervanderdoes


From mickyhulse.lists at gmail.com  Thu Oct 24 18:23:47 2013
From: mickyhulse.lists at gmail.com (Micky Hulse)
Date: Thu, 24 Oct 2013 11:23:47 -0700
Subject: [wp-hackers] iOS WP app: Featured image size problems
In-Reply-To: <263C2CB4-F724-44A8-8ACD-250B35F26842@thoughtrefinery.com>
References: <CALri7MkqOcrzdjOzguFcEG7wTjLChiE6=pD3_BZHqeTQECiB4Q@mail.gmail.com>
 <998E86D2-53D6-4702-8684-7A76508CBCF6@codesymphony.co>
 <5267E3DF.6080204@exigences.biz>
 <CALri7MmLD9ST=07eBxBzT3Kep=9UWjU2QSc49pVWycfZrT4CHg@mail.gmail.com>
 <263C2CB4-F724-44A8-8ACD-250B35F26842@thoughtrefinery.com>
Message-ID: <CALri7MnpEb5cSrrVrwOUJNtw-TpvmzbeEK5n-yF3VZNT1kj+tw@mail.gmail.com>

Hi Nicholas, thanks for the reply!

On Thu, Oct 24, 2013 at 5:06 AM, Nicholas Ciske <nl at thoughtrefinery.com> wrote:
> Not a true solution, but a viable workaround: you could install WP Thumb which will create missing image sizes on the fly (and then cache them for future use).
> http://wordpress.org/plugins/wp-thumb/

That's actually an approach I'm familiar with. :)

Back when I used EE, that's how we handled images. I do the same thing
for Django apps. It's kinda nice having the freedom to resize images
on the template level.

I still have yet to test Nikola's suggestions, but I'm hoping to get
to that today as I would like to know if there's something setup wrong
with my theme.

Anyway, I'll give wp-thumb a go. Thanks for tip!

Have a nice day.

Cheers,
Micky

From james at easilyamusedinc.com  Thu Oct 24 19:24:43 2013
From: james at easilyamusedinc.com (James Tryon)
Date: Thu, 24 Oct 2013 15:24:43 -0400
Subject: [wp-hackers] SSL loading unsecured content Headache
Message-ID: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>

Hi Everyone,

Not sure if I should be posting this here or not.
I'm also looking for help in the linode forums.

We are currently running 6 servers, but I think only 4 of them are set up as a cluster.
The Cluster is running as our hosting environment for our clients.
We are only hosting WordPress Sites. It's a Gentoo Base System release 2.1.

When ever I try to get SSL to work I get endless redirects or none of the css or JavaScript will load securely. 
I have the sites url set to https in the settings file and checked the database, all https:
When you look at the page source most of the links are http:// still.

Now things get weird. I changed wp_home and wp_siteurl to https://test.com and reloaded the login page.
This only Worked b/c i was on the login page. If you tryed to go to a different link, It would take you to test.com.
Then I looked at the page source. Check out this screenshot: 
https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
Some links are http others are https and all set from the same value in the config file.... 

This is what is there now.
define('WP_HOME', 'https://skopospublishing.com');
define('WP_SITEURL', 'https://skopospublishing.com'); 

I have spent almost 20 hours chasing rabbits. I get the same problems with the default theme and no plugins. 
The Contractor that has been working on the server swears its WordPress. 
I think it has something to do with the server configuration and how he is serving the SSL's

Same problem on https://studentlaunchpad.com/ 

He also told he that "it's behind a proxy/SSL accelerator, home and siteurl contents are set up, and what we saw testing url generation"

I'm not sure what he means. I do know that no matter what I change the site urls in the config or database, or what I change in the .htaccess files
Something else is serving http:// in from of all the links...

I'm lost and looking for more insight. I'm happy to provide more information please let me know what you need.
If this is the wrong place for this type of question, please advise where to ask.

- James Tryon

Thank you for your time,
James Tryon, Creative Director

Easily Amused, Inc.
http://easilyamusedinc.com
P: (407) 278-5498 C: (407) 733-6473 T: easilyamused


From nikolov.tmw at gmail.com  Thu Oct 24 19:30:43 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Thu, 24 Oct 2013 22:30:43 +0300
Subject: [wp-hackers] SSL loading unsecured content Headache
In-Reply-To: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
References: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
Message-ID: <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>

Hi James,

Have you tried using a plugin like
http://wordpress.org/plugins/wordpress-https/ or
http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?

By the way - the link to the screenshot seems broken - so I can't really
see what's still getting http instead.

Nikola


On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <james at easilyamusedinc.com>wrote:

> Hi Everyone,
>
> Not sure if I should be posting this here or not.
> I'm also looking for help in the linode forums.
>
> We are currently running 6 servers, but I think only 4 of them are set up
> as a cluster.
> The Cluster is running as our hosting environment for our clients.
> We are only hosting WordPress Sites. It's a Gentoo Base System release 2.1.
>
> When ever I try to get SSL to work I get endless redirects or none of the
> css or JavaScript will load securely.
> I have the sites url set to https in the settings file and checked the
> database, all https:
> When you look at the page source most of the links are http:// still.
>
> Now things get weird. I changed wp_home and wp_siteurl to https://test.comand reloaded the login page.
> This only Worked b/c i was on the login page. If you tryed to go to a
> different link, It would take you to test.com.
> Then I looked at the page source. Check out this screenshot:
> https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
> Some links are http others are https and all set from the same value in
> the config file....
>
> This is what is there now.
> define('WP_HOME', 'https://skopospublishing.com');
> define('WP_SITEURL', 'https://skopospublishing.com');
>
> I have spent almost 20 hours chasing rabbits. I get the same problems with
> the default theme and no plugins.
> The Contractor that has been working on the server swears its WordPress.
> I think it has something to do with the server configuration and how he is
> serving the SSL's
>
> Same problem on https://studentlaunchpad.com/
>
> He also told he that "it's behind a proxy/SSL accelerator, home and
> siteurl contents are set up, and what we saw testing url generation"
>
> I'm not sure what he means. I do know that no matter what I change the
> site urls in the config or database, or what I change in the .htaccess files
> Something else is serving http:// in from of all the links...
>
> I'm lost and looking for more insight. I'm happy to provide more
> information please let me know what you need.
> If this is the wrong place for this type of question, please advise where
> to ask.
>
> - James Tryon
>
> Thank you for your time,
> James Tryon, Creative Director
>
> Easily Amused, Inc.
> http://easilyamusedinc.com
> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From zamoose at gmail.com  Thu Oct 24 19:35:42 2013
From: zamoose at gmail.com (Doug Stewart)
Date: Thu, 24 Oct 2013 15:35:42 -0400
Subject: [wp-hackers] SSL loading unsecured content Headache
In-Reply-To: <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
References: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
 <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
Message-ID: <CANFh3d6uXQz_C6P0-3pKTx1pcjhAAaRpaGG9C8e2qtBSAOB=FA@mail.gmail.com>

Nikola is right -- you'll need to trick WordPress into using https
correctly.


On Thu, Oct 24, 2013 at 3:30 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Hi James,
>
> Have you tried using a plugin like
> http://wordpress.org/plugins/wordpress-https/ or
> http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?
>
> By the way - the link to the screenshot seems broken - so I can't really
> see what's still getting http instead.
>
> Nikola
>
>
> On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <james at easilyamusedinc.com
> >wrote:
>
> > Hi Everyone,
> >
> > Not sure if I should be posting this here or not.
> > I'm also looking for help in the linode forums.
> >
> > We are currently running 6 servers, but I think only 4 of them are set up
> > as a cluster.
> > The Cluster is running as our hosting environment for our clients.
> > We are only hosting WordPress Sites. It's a Gentoo Base System release
> 2.1.
> >
> > When ever I try to get SSL to work I get endless redirects or none of the
> > css or JavaScript will load securely.
> > I have the sites url set to https in the settings file and checked the
> > database, all https:
> > When you look at the page source most of the links are http:// still.
> >
> > Now things get weird. I changed wp_home and wp_siteurl to
> https://test.comand reloaded the login page.
> > This only Worked b/c i was on the login page. If you tryed to go to a
> > different link, It would take you to test.com.
> > Then I looked at the page source. Check out this screenshot:
> > https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
> > Some links are http others are https and all set from the same value in
> > the config file....
> >
> > This is what is there now.
> > define('WP_HOME', 'https://skopospublishing.com');
> > define('WP_SITEURL', 'https://skopospublishing.com');
> >
> > I have spent almost 20 hours chasing rabbits. I get the same problems
> with
> > the default theme and no plugins.
> > The Contractor that has been working on the server swears its WordPress.
> > I think it has something to do with the server configuration and how he
> is
> > serving the SSL's
> >
> > Same problem on https://studentlaunchpad.com/
> >
> > He also told he that "it's behind a proxy/SSL accelerator, home and
> > siteurl contents are set up, and what we saw testing url generation"
> >
> > I'm not sure what he means. I do know that no matter what I change the
> > site urls in the config or database, or what I change in the .htaccess
> files
> > Something else is serving http:// in from of all the links...
> >
> > I'm lost and looking for more insight. I'm happy to provide more
> > information please let me know what you need.
> > If this is the wrong place for this type of question, please advise where
> > to ask.
> >
> > - James Tryon
> >
> > Thank you for your time,
> > James Tryon, Creative Director
> >
> > Easily Amused, Inc.
> > http://easilyamusedinc.com
> > P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
-Doug

From bristond at gmail.com  Thu Oct 24 19:39:19 2013
From: bristond at gmail.com (Briston Davidge)
Date: Thu, 24 Oct 2013 14:39:19 -0500
Subject: [wp-hackers] wp-hackers Digest, Vol 105, Issue 37
In-Reply-To: <mailman.4789.1382643045.2509.wp-hackers@lists.automattic.com>
References: <mailman.4789.1382643045.2509.wp-hackers@lists.automattic.com>
Message-ID: <CAOY6yXbc+LwPio7LbcJpFOGbUVVU_Ugn6f_hVe4-5BcYZn1w9g@mail.gmail.com>

Whilst PHP.NET is down here is a great cheat sheet for php (and others).

http://overapi.com/php/


On Thu, Oct 24, 2013 at 2:30 PM, <wp-hackers-request at lists.automattic.com>wrote:

> Send wp-hackers mailing list submissions to
>         wp-hackers at lists.automattic.com
>
> To subscribe or unsubscribe via the World Wide Web, visit
>         http://lists.automattic.com/mailman/listinfo/wp-hackers
> or, via email, send a message with subject or body 'help' to
>         wp-hackers-request at lists.automattic.com
>
> You can reach the person managing the list at
>         wp-hackers-owner at lists.automattic.com
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of wp-hackers digest..."
>
>
> Today's Topics:
>
>    1. Re: iOS WP app: Featured image size problems (Nicholas Ciske)
>    2. php.net site got malware?? (Haluk Karamete)
>    3. Re: php.net site got malware?? (Andrew Nacin)
>    4. Re: php.net site got malware?? (Nikola Nikolov)
>    5. Re: php.net site got malware?? (Peter van der Does)
>    6. Re: iOS WP app: Featured image size problems (Micky Hulse)
>    7. SSL loading unsecured content Headache (James Tryon)
>    8. Re: SSL loading unsecured content Headache (Nikola Nikolov)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Thu, 24 Oct 2013 07:06:07 -0500
> From: Nicholas Ciske <nl at thoughtrefinery.com>
> To: wp-hackers at lists.automattic.com
> Subject: Re: [wp-hackers] iOS WP app: Featured image size problems
> Message-ID: <263C2CB4-F724-44A8-8ACD-250B35F26842 at thoughtrefinery.com>
> Content-Type: text/plain;       charset=us-ascii
>
> Not a true solution, but a viable workaround: you could install WP Thumb
> which will create missing image sizes on the fly (and then cache them for
> future use).
>
> http://wordpress.org/plugins/wp-thumb/
>
> _________________________
> Nick Ciske
> http://thoughtrefinery.com/
> @nciske
>
> On Oct 23, 2013, at 1:58 PM, Micky Hulse wrote:
>
> > Hello,
> >
> > Thanks so much for the replies J.D. and Simon, I really appreciate your
> help.
> >
> > On Wed, Oct 23, 2013 at 5:25 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >> I don't think that wp_get_attachment_image_src() accepts parameters of
> the format you are using ('300px').
> http://codex.wordpress.org/Function_Reference/wp_get_attachment_image_src
> >> The $size can either be a keyword (thumbnail, medium, large or full) or
> an array (array(300,300)).
> >
> > My bad. I apologize that I did not mention the rest of my setup.
> >
> > In my functions file, I have:
> >
> > function mytheme_setup() {
> > add_theme_support('post-thumbnails');
> > set_post_thumbnail_size(150, 150);
> > }
> > add_action('after_setup_theme', 'mytheme_setup');
> > // ... and later on in this file:
> > # Add new image sizes:
> > add_image_size('130px', 130); // Thumbnail size: 130 x 130
> > add_image_size('300px', 300); // Medium size: 300 x 300
> > add_image_size('470px', 470);
> > add_image_size('640px', 640);
> > add_image_size('810px', 810);
> > add_image_size('980px', 980); // Large size: 980 x 980
> > add_image_size('1320px', 1320);
> > add_image_size('1620px', 1620);
> > add_image_size('1960px', 1960);
> >
> > The new image size names are based on another system we use ... I
> > wanted to keep the "XXXpx" naming conventions the same across systems.
> >
> > With that said, the use of (for example):
> >
> > wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '300px')
> > wp_get_attachment_image_src(get_post_thumbnail_id($post->ID), '640px')
> >
> > ... work for all images, except for images uploaded as a featured
> > image using the WP iOS app.
> >
> > Other image getting functions also work, but it's the iOS images that
> > just return the original source image size.
> >
> > On Wed, Oct 23, 2013 at 7:57 AM, Simon Vart <simon.vart at exigences.biz>
> wrote:
> >> I think you could also add a new image size in functions.php :
> >> add_image_size( '300px', 300, 300, true );
> >> and then your call to wp_get_attachment_image_src() will be understood.
> When
> >> you upload an image, WP will create a image of this size with the
> keyword
> >> '300px'
> >
> > Sorry again, that I did not detail my setup. Thank you for the help,
> > and thankfully I do have that setup in my functions.php file. I
> > should've made that clear in my first message. :(
> >
> > Question(s):
> >
> > When you folks use the iOS WP app, and set a featured image, are you
> > able to get at the different sizes on your templates?
> >
> > For some reason, my setup isn't allowing me to access the custom image
> > sizes (only for iOS-uploaded featured images), even though they are
> > generated and sitting there in my uploads folder.
> >
> > Maybe I'm not setup properly in my functions.php file? I have all of
> > my add_image_size() calls just sitting out in the open. Do I need to
> > have these inside of an action? Should they go inside the
> > "after_setup_theme" action along side my
> > add_theme_support('post-thumbnails') call?
> >
> > Please let me know if I can provide more information.
> >
> > Thank you!
> >
> > M
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
>
>
> ------------------------------
>
> Message: 2
> Date: Thu, 24 Oct 2013 05:45:55 -0700
> From: Haluk Karamete <halukkaramete at gmail.com>
> To: wp-hackers at lists.automattic.com
> Subject: [wp-hackers] php.net site got malware??
> Message-ID:
>         <CAHERW=0hP+k_bFbDD7sfw_gqdCcMaowdEG+4sJ6QL=
> SggpTnbA at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> This morning, chrome warned me with this message:
>
> The Website Ahead Contains Malware!
> Google Chrome has blocked access to php.net for now.
> I needed to visit the site for a function look up. But I had to stop.
> Just sharing for what it's worth...
>
> What do we do? proceed or wait?
>
>
> ------------------------------
>
> Message: 3
> Date: Thu, 24 Oct 2013 08:54:54 -0400
> From: Andrew Nacin <wp at andrewnacin.com>
> To: "Discussion list for WordPress developers."
>         <wp-hackers at lists.automattic.com>
> Subject: Re: [wp-hackers] php.net site got malware??
> Message-ID:
>         <
> CAP29PvhpcYHCOa-ZjN+5M8rviWGAFh5M0o-vL1yu49kKyr5s8Q at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> See https://twitter.com/rasmus/status/393258147025932288 and generally
> @rasmus's last few dozen tweets. It appears to be either nothing, or a
> problem with a mirror.
>
>
> On Thu, Oct 24, 2013 at 8:45 AM, Haluk Karamete <halukkaramete at gmail.com
> >wrote:
>
> > This morning, chrome warned me with this message:
> >
> > The Website Ahead Contains Malware!
> > Google Chrome has blocked access to php.net for now.
> > I needed to visit the site for a function look up. But I had to stop.
> > Just sharing for what it's worth...
> >
> > What do we do? proceed or wait?
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
> ------------------------------
>
> Message: 4
> Date: Thu, 24 Oct 2013 15:56:34 +0300
> From: Nikola Nikolov <nikolov.tmw at gmail.com>
> To: wp-hackers at lists.automattic.com
> Subject: Re: [wp-hackers] php.net site got malware??
> Message-ID:
>         <
> CAOwx47dkxSWtwFkwOh6VAS-78Nm-btCZ7i_LnGA_bbc_Gr-Uqw at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> I got a message on the WordFence list stating that it got flagged as
> malware(I was experiencing some un-availability of the site at some point
> in the last couple of days). Here's their guess on the issue:
>
> The report Google is issuing for php.net is available
> here<http://www.google.com/safebrowsing/diagnostic?site=php.net> .
> We haven't been able to verify if php.net has been hacked, but Google
> states they crawled the site yesterday and found 4 trojans hosted on 4
> domains. If you're a WordPress developer and need to visit php.net to
> access PHP documentation, please take care until this is resolved. It is
> quite likely a false positive or due to simple backlinks to malicious
> domains appearing on php.net, but the worst case scenario is that the site
> has been hacked and malware is hosted on the site itself.
>
> So - I'd suggest to wait for now. It seems that they've already filed a
> Request for Review according to this thread -
>
> http://productforums.google.com/forum/#!topic/webmasters/puLmvjtK0m8%5B1-25-false%5D
>
>
> On Thu, Oct 24, 2013 at 3:45 PM, Haluk Karamete <halukkaramete at gmail.com
> >wrote:
>
> > This morning, chrome warned me with this message:
> >
> > The Website Ahead Contains Malware!
> > Google Chrome has blocked access to php.net for now.
> > I needed to visit the site for a function look up. But I had to stop.
> > Just sharing for what it's worth...
> >
> > What do we do? proceed or wait?
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
> ------------------------------
>
> Message: 5
> Date: Thu, 24 Oct 2013 09:08:46 -0400
> From: Peter van der Does <peter at avirtualhome.com>
> To: wp-hackers at lists.automattic.com
> Subject: Re: [wp-hackers] php.net site got malware??
> Message-ID: <20131024090846.28ac3201 at Indy>
> Content-Type: text/plain; charset=US-ASCII
>
> On Thu, 24 Oct 2013 08:54:54 -0400
> Andrew Nacin <wp at andrewnacin.com> wrote:
>
> > See https://twitter.com/rasmus/status/393258147025932288 and generally
> > @rasmus's last few dozen tweets. It appears to be either nothing, or a
> > problem with a mirror.
> >
> >
>
> Not so much false, just no longer an issue, but their userprefs.js file
> seems to be compromised at one point:
>
> https://news.ycombinator.com/item?id=6604251
>
> --
> Peter van der Does
>
> GPG key: CB317D6E
>
> Site: http://avirtualhome.com
> GitHub: https://github.com/petervanderdoes
> Twitter: @petervanderdoes
>
>
>
> ------------------------------
>
> Message: 6
> Date: Thu, 24 Oct 2013 11:23:47 -0700
> From: Micky Hulse <mickyhulse.lists at gmail.com>
> To: wp-hackers at lists.automattic.com
> Subject: Re: [wp-hackers] iOS WP app: Featured image size problems
> Message-ID:
>         <
> CALri7MnpEb5cSrrVrwOUJNtw-TpvmzbeEK5n-yF3VZNT1kj+tw at mail.gmail.com>
> Content-Type: text/plain; charset=UTF-8
>
> Hi Nicholas, thanks for the reply!
>
> On Thu, Oct 24, 2013 at 5:06 AM, Nicholas Ciske <nl at thoughtrefinery.com>
> wrote:
> > Not a true solution, but a viable workaround: you could install WP Thumb
> which will create missing image sizes on the fly (and then cache them for
> future use).
> > http://wordpress.org/plugins/wp-thumb/
>
> That's actually an approach I'm familiar with. :)
>
> Back when I used EE, that's how we handled images. I do the same thing
> for Django apps. It's kinda nice having the freedom to resize images
> on the template level.
>
> I still have yet to test Nikola's suggestions, but I'm hoping to get
> to that today as I would like to know if there's something setup wrong
> with my theme.
>
> Anyway, I'll give wp-thumb a go. Thanks for tip!
>
> Have a nice day.
>
> Cheers,
> Micky
>
>
> ------------------------------
>
> Message: 7
> Date: Thu, 24 Oct 2013 15:24:43 -0400
> From: James Tryon <james at easilyamusedinc.com>
> To: wp-hackers at lists.automattic.com
> Subject: [wp-hackers] SSL loading unsecured content Headache
> Message-ID: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25 at easilyamusedinc.com>
> Content-Type: text/plain;       charset=us-ascii
>
> Hi Everyone,
>
> Not sure if I should be posting this here or not.
> I'm also looking for help in the linode forums.
>
> We are currently running 6 servers, but I think only 4 of them are set up
> as a cluster.
> The Cluster is running as our hosting environment for our clients.
> We are only hosting WordPress Sites. It's a Gentoo Base System release 2.1.
>
> When ever I try to get SSL to work I get endless redirects or none of the
> css or JavaScript will load securely.
> I have the sites url set to https in the settings file and checked the
> database, all https:
> When you look at the page source most of the links are http:// still.
>
> Now things get weird. I changed wp_home and wp_siteurl to https://test.comand reloaded the login page.
> This only Worked b/c i was on the login page. If you tryed to go to a
> different link, It would take you to test.com.
> Then I looked at the page source. Check out this screenshot:
> https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
> Some links are http others are https and all set from the same value in
> the config file....
>
> This is what is there now.
> define('WP_HOME', 'https://skopospublishing.com');
> define('WP_SITEURL', 'https://skopospublishing.com');
>
> I have spent almost 20 hours chasing rabbits. I get the same problems with
> the default theme and no plugins.
> The Contractor that has been working on the server swears its WordPress.
> I think it has something to do with the server configuration and how he is
> serving the SSL's
>
> Same problem on https://studentlaunchpad.com/
>
> He also told he that "it's behind a proxy/SSL accelerator, home and
> siteurl contents are set up, and what we saw testing url generation"
>
> I'm not sure what he means. I do know that no matter what I change the
> site urls in the config or database, or what I change in the .htaccess files
> Something else is serving http:// in from of all the links...
>
> I'm lost and looking for more insight. I'm happy to provide more
> information please let me know what you need.
> If this is the wrong place for this type of question, please advise where
> to ask.
>
> - James Tryon
>
> Thank you for your time,
> James Tryon, Creative Director
>
> Easily Amused, Inc.
> http://easilyamusedinc.com
> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
>
>
>
> ------------------------------
>
> Message: 8
> Date: Thu, 24 Oct 2013 22:30:43 +0300
> From: Nikola Nikolov <nikolov.tmw at gmail.com>
> To: wp-hackers at lists.automattic.com
> Subject: Re: [wp-hackers] SSL loading unsecured content Headache
> Message-ID:
>         <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=
> 4oppdT+jzxpQMLA at mail.gmail.com>
> Content-Type: text/plain; charset=ISO-8859-1
>
> Hi James,
>
> Have you tried using a plugin like
> http://wordpress.org/plugins/wordpress-https/ or
> http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?
>
> By the way - the link to the screenshot seems broken - so I can't really
> see what's still getting http instead.
>
> Nikola
>
>
> On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <james at easilyamusedinc.com
> >wrote:
>
> > Hi Everyone,
> >
> > Not sure if I should be posting this here or not.
> > I'm also looking for help in the linode forums.
> >
> > We are currently running 6 servers, but I think only 4 of them are set up
> > as a cluster.
> > The Cluster is running as our hosting environment for our clients.
> > We are only hosting WordPress Sites. It's a Gentoo Base System release
> 2.1.
> >
> > When ever I try to get SSL to work I get endless redirects or none of the
> > css or JavaScript will load securely.
> > I have the sites url set to https in the settings file and checked the
> > database, all https:
> > When you look at the page source most of the links are http:// still.
> >
> > Now things get weird. I changed wp_home and wp_siteurl to
> https://test.comand reloaded the login page.
> > This only Worked b/c i was on the login page. If you tryed to go to a
> > different link, It would take you to test.com.
> > Then I looked at the page source. Check out this screenshot:
> > https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
> > Some links are http others are https and all set from the same value in
> > the config file....
> >
> > This is what is there now.
> > define('WP_HOME', 'https://skopospublishing.com');
> > define('WP_SITEURL', 'https://skopospublishing.com');
> >
> > I have spent almost 20 hours chasing rabbits. I get the same problems
> with
> > the default theme and no plugins.
> > The Contractor that has been working on the server swears its WordPress.
> > I think it has something to do with the server configuration and how he
> is
> > serving the SSL's
> >
> > Same problem on https://studentlaunchpad.com/
> >
> > He also told he that "it's behind a proxy/SSL accelerator, home and
> > siteurl contents are set up, and what we saw testing url generation"
> >
> > I'm not sure what he means. I do know that no matter what I change the
> > site urls in the config or database, or what I change in the .htaccess
> files
> > Something else is serving http:// in from of all the links...
> >
> > I'm lost and looking for more insight. I'm happy to provide more
> > information please let me know what you need.
> > If this is the wrong place for this type of question, please advise where
> > to ask.
> >
> > - James Tryon
> >
> > Thank you for your time,
> > James Tryon, Creative Director
> >
> > Easily Amused, Inc.
> > http://easilyamusedinc.com
> > P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
> ------------------------------
>
> Subject: Digest Footer
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>
>
> ------------------------------
>
> End of wp-hackers Digest, Vol 105, Issue 37
> *******************************************
>



-- 


*Briston Davidge*
e briston at luminopolis.com
c 816 812 7245
o 888 HEY LUMI

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- - - - - - - - - -
 *Luminopolis** - Online Solutions for Enlightened Communities.*
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- - - - - - - - - - -

From james at easilyamusedinc.com  Thu Oct 24 19:44:19 2013
From: james at easilyamusedinc.com (James Tryon)
Date: Thu, 24 Oct 2013 15:44:19 -0400
Subject: [wp-hackers] SSL loading unsecured content Headache
In-Reply-To: <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
References: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
 <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
Message-ID: <32D74AF3-2C1D-4006-8C78-725F307A4FD5@easilyamusedinc.com>

Hi Nikola, 

I did try the two plugins you listed below with no luck.
I uploaded a copy of the screen shoot to a new location:
http://easilyamusedinc.com/wp-content/uploads/2013/10/Screenshot-2013-10-23-16.28.53.png

It's very weird, no matter what i set the URL's to, something keeps swapping https of http...

I have used SSL and WordPress may times over the years on different server setups and never had this problem before.

Thank you for your time,
James Tryon, Creative Director

Easily Amused, Inc.
http://easilyamusedinc.com
P: (407) 278-5498 C: (407) 733-6473 T: easilyamused

On Oct 24, 2013, at 3:30 PM, Nikola Nikolov <nikolov.tmw at gmail.com> wrote:

> Hi James,
> 
> Have you tried using a plugin like
> http://wordpress.org/plugins/wordpress-https/ or
> http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?
> 
> By the way - the link to the screenshot seems broken - so I can't really
> see what's still getting http instead.
> 
> Nikola
> 
> 
> On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <james at easilyamusedinc.com>wrote:
> 
>> Hi Everyone,
>> 
>> Not sure if I should be posting this here or not.
>> I'm also looking for help in the linode forums.
>> 
>> We are currently running 6 servers, but I think only 4 of them are set up
>> as a cluster.
>> The Cluster is running as our hosting environment for our clients.
>> We are only hosting WordPress Sites. It's a Gentoo Base System release 2.1.
>> 
>> When ever I try to get SSL to work I get endless redirects or none of the
>> css or JavaScript will load securely.
>> I have the sites url set to https in the settings file and checked the
>> database, all https:
>> When you look at the page source most of the links are http:// still.
>> 
>> Now things get weird. I changed wp_home and wp_siteurl to https://test.comand reloaded the login page.
>> This only Worked b/c i was on the login page. If you tryed to go to a
>> different link, It would take you to test.com.
>> Then I looked at the page source. Check out this screenshot:
>> https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
>> Some links are http others are https and all set from the same value in
>> the config file....
>> 
>> This is what is there now.
>> define('WP_HOME', 'https://skopospublishing.com');
>> define('WP_SITEURL', 'https://skopospublishing.com');
>> 
>> I have spent almost 20 hours chasing rabbits. I get the same problems with
>> the default theme and no plugins.
>> The Contractor that has been working on the server swears its WordPress.
>> I think it has something to do with the server configuration and how he is
>> serving the SSL's
>> 
>> Same problem on https://studentlaunchpad.com/
>> 
>> He also told he that "it's behind a proxy/SSL accelerator, home and
>> siteurl contents are set up, and what we saw testing url generation"
>> 
>> I'm not sure what he means. I do know that no matter what I change the
>> site urls in the config or database, or what I change in the .htaccess files
>> Something else is serving http:// in from of all the links...
>> 
>> I'm lost and looking for more insight. I'm happy to provide more
>> information please let me know what you need.
>> If this is the wrong place for this type of question, please advise where
>> to ask.
>> 
>> - James Tryon
>> 
>> Thank you for your time,
>> James Tryon, Creative Director
>> 
>> Easily Amused, Inc.
>> http://easilyamusedinc.com
>> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From james at easilyamusedinc.com  Thu Oct 24 20:13:02 2013
From: james at easilyamusedinc.com (James Tryon)
Date: Thu, 24 Oct 2013 16:13:02 -0400
Subject: [wp-hackers] SSL loading unsecured content Headache
In-Reply-To: <CANFh3d6uXQz_C6P0-3pKTx1pcjhAAaRpaGG9C8e2qtBSAOB=FA@mail.gmail.com>
References: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
 <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
 <CANFh3d6uXQz_C6P0-3pKTx1pcjhAAaRpaGG9C8e2qtBSAOB=FA@mail.gmail.com>
Message-ID: <C65C4F96-6159-458E-B564-A791A2649C0E@easilyamusedinc.com>

Thanks your your help everyone.

And its fixed thank to this wonderful blog post.
http://snippets.webaware.com.au/snippets/wordpress-is_ssl-doesnt-work-behind-some-load-balancers/
https://gist.github.com/webaware/4688802
 
Thank you for your time,
James Tryon, Creative Director

Easily Amused, Inc.
http://easilyamusedinc.com
P: (407) 278-5498 C: (407) 733-6473 T: easilyamused

On Oct 24, 2013, at 3:35 PM, Doug Stewart <zamoose at gmail.com> wrote:

> Nikola is right -- you'll need to trick WordPress into using https
> correctly.
> 
> 
> On Thu, Oct 24, 2013 at 3:30 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:
> 
>> Hi James,
>> 
>> Have you tried using a plugin like
>> http://wordpress.org/plugins/wordpress-https/ or
>> http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?
>> 
>> By the way - the link to the screenshot seems broken - so I can't really
>> see what's still getting http instead.
>> 
>> Nikola
>> 
>> 
>> On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <james at easilyamusedinc.com
>>> wrote:
>> 
>>> Hi Everyone,
>>> 
>>> Not sure if I should be posting this here or not.
>>> I'm also looking for help in the linode forums.
>>> 
>>> We are currently running 6 servers, but I think only 4 of them are set up
>>> as a cluster.
>>> The Cluster is running as our hosting environment for our clients.
>>> We are only hosting WordPress Sites. It's a Gentoo Base System release
>> 2.1.
>>> 
>>> When ever I try to get SSL to work I get endless redirects or none of the
>>> css or JavaScript will load securely.
>>> I have the sites url set to https in the settings file and checked the
>>> database, all https:
>>> When you look at the page source most of the links are http:// still.
>>> 
>>> Now things get weird. I changed wp_home and wp_siteurl to
>> https://test.comand reloaded the login page.
>>> This only Worked b/c i was on the login page. If you tryed to go to a
>>> different link, It would take you to test.com.
>>> Then I looked at the page source. Check out this screenshot:
>>> https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
>>> Some links are http others are https and all set from the same value in
>>> the config file....
>>> 
>>> This is what is there now.
>>> define('WP_HOME', 'https://skopospublishing.com');
>>> define('WP_SITEURL', 'https://skopospublishing.com');
>>> 
>>> I have spent almost 20 hours chasing rabbits. I get the same problems
>> with
>>> the default theme and no plugins.
>>> The Contractor that has been working on the server swears its WordPress.
>>> I think it has something to do with the server configuration and how he
>> is
>>> serving the SSL's
>>> 
>>> Same problem on https://studentlaunchpad.com/
>>> 
>>> He also told he that "it's behind a proxy/SSL accelerator, home and
>>> siteurl contents are set up, and what we saw testing url generation"
>>> 
>>> I'm not sure what he means. I do know that no matter what I change the
>>> site urls in the config or database, or what I change in the .htaccess
>> files
>>> Something else is serving http:// in from of all the links...
>>> 
>>> I'm lost and looking for more insight. I'm happy to provide more
>>> information please let me know what you need.
>>> If this is the wrong place for this type of question, please advise where
>>> to ask.
>>> 
>>> - James Tryon
>>> 
>>> Thank you for your time,
>>> James Tryon, Creative Director
>>> 
>>> Easily Amused, Inc.
>>> http://easilyamusedinc.com
>>> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> 
> 
> 
> -- 
> -Doug
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From nikolov.tmw at gmail.com  Thu Oct 24 20:21:01 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Thu, 24 Oct 2013 23:21:01 +0300
Subject: [wp-hackers] SSL loading unsecured content Headache
In-Reply-To: <C65C4F96-6159-458E-B564-A791A2649C0E@easilyamusedinc.com>
References: <3DDE715D-99C6-469D-BBA5-1FA05F2F7A25@easilyamusedinc.com>
 <CAOwx47dYDx+Pz05TAFX6=4nAnNe0iqAqVx=4oppdT+jzxpQMLA@mail.gmail.com>
 <CANFh3d6uXQz_C6P0-3pKTx1pcjhAAaRpaGG9C8e2qtBSAOB=FA@mail.gmail.com>
 <C65C4F96-6159-458E-B564-A791A2649C0E@easilyamusedinc.com>
Message-ID: <CAOwx47eJtSHhn17ZjAMsxw=8bPHEEV2evBSU4vxWBAiYd9Ux3g@mail.gmail.com>

Congratulations on figuring it out. And thanks for sharing the article -
it's good to keep that in mind!


On Thu, Oct 24, 2013 at 11:13 PM, James Tryon <james at easilyamusedinc.com>wrote:

> Thanks your your help everyone.
>
> And its fixed thank to this wonderful blog post.
>
> http://snippets.webaware.com.au/snippets/wordpress-is_ssl-doesnt-work-behind-some-load-balancers/
> https://gist.github.com/webaware/4688802
>
> Thank you for your time,
> James Tryon, Creative Director
>
> Easily Amused, Inc.
> http://easilyamusedinc.com
> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
>
> On Oct 24, 2013, at 3:35 PM, Doug Stewart <zamoose at gmail.com> wrote:
>
> > Nikola is right -- you'll need to trick WordPress into using https
> > correctly.
> >
> >
> > On Thu, Oct 24, 2013 at 3:30 PM, Nikola Nikolov <nikolov.tmw at gmail.com
> >wrote:
> >
> >> Hi James,
> >>
> >> Have you tried using a plugin like
> >> http://wordpress.org/plugins/wordpress-https/ or
> >> http://wordpress.org/plugins/ssl-insecure-content-fixer/ for instance?
> >>
> >> By the way - the link to the screenshot seems broken - so I can't really
> >> see what's still getting http instead.
> >>
> >> Nikola
> >>
> >>
> >> On Thu, Oct 24, 2013 at 10:24 PM, James Tryon <
> james at easilyamusedinc.com
> >>> wrote:
> >>
> >>> Hi Everyone,
> >>>
> >>> Not sure if I should be posting this here or not.
> >>> I'm also looking for help in the linode forums.
> >>>
> >>> We are currently running 6 servers, but I think only 4 of them are set
> up
> >>> as a cluster.
> >>> The Cluster is running as our hosting environment for our clients.
> >>> We are only hosting WordPress Sites. It's a Gentoo Base System release
> >> 2.1.
> >>>
> >>> When ever I try to get SSL to work I get endless redirects or none of
> the
> >>> css or JavaScript will load securely.
> >>> I have the sites url set to https in the settings file and checked the
> >>> database, all https:
> >>> When you look at the page source most of the links are http:// still.
> >>>
> >>> Now things get weird. I changed wp_home and wp_siteurl to
> >> https://test.comand reloaded the login page.
> >>> This only Worked b/c i was on the login page. If you tryed to go to a
> >>> different link, It would take you to test.com.
> >>> Then I looked at the page source. Check out this screenshot:
> >>> https://www.dropbox.com/s/b367bnc7nttiz ... .28.53.png
> >>> Some links are http others are https and all set from the same value in
> >>> the config file....
> >>>
> >>> This is what is there now.
> >>> define('WP_HOME', 'https://skopospublishing.com');
> >>> define('WP_SITEURL', 'https://skopospublishing.com');
> >>>
> >>> I have spent almost 20 hours chasing rabbits. I get the same problems
> >> with
> >>> the default theme and no plugins.
> >>> The Contractor that has been working on the server swears its
> WordPress.
> >>> I think it has something to do with the server configuration and how he
> >> is
> >>> serving the SSL's
> >>>
> >>> Same problem on https://studentlaunchpad.com/
> >>>
> >>> He also told he that "it's behind a proxy/SSL accelerator, home and
> >>> siteurl contents are set up, and what we saw testing url generation"
> >>>
> >>> I'm not sure what he means. I do know that no matter what I change the
> >>> site urls in the config or database, or what I change in the .htaccess
> >> files
> >>> Something else is serving http:// in from of all the links...
> >>>
> >>> I'm lost and looking for more insight. I'm happy to provide more
> >>> information please let me know what you need.
> >>> If this is the wrong place for this type of question, please advise
> where
> >>> to ask.
> >>>
> >>> - James Tryon
> >>>
> >>> Thank you for your time,
> >>> James Tryon, Creative Director
> >>>
> >>> Easily Amused, Inc.
> >>> http://easilyamusedinc.com
> >>> P: (407) 278-5498 C: (407) 733-6473 T: easilyamused
> >>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >
> >
> >
> > --
> > -Doug
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From lukebryan at sharefaith.com  Fri Oct 25 16:20:11 2013
From: lukebryan at sharefaith.com (Luke Bryan)
Date: Fri, 25 Oct 2013 09:20:11 -0700
Subject: [wp-hackers] wp 3.7
Message-ID: <CAFnKAk0PQR=C8pRjLxqt7x_zE7hG86ZHNUeRtMY42_HnWMmvmw@mail.gmail.com>

Greetings all,

3.7 is nice, but I was noticing an intermittent problem, happening even on
make.wordpress.org blog. (https://make.wordpress.org/core/wp-login.php) The
first login attempt says you don't have cookies enabled - second login
works fine though. (I'm using Firefox).

I was also wondering what happened to the search-relevance functionality,
since it isn't mentioned here (http://wordpress.org/news/2013/10/basie/) -
was this feature dropped for 3.7?

Best regards,
Luke

From nicola.peluchetti at gmail.com  Fri Oct 25 17:18:21 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Fri, 25 Oct 2013 19:18:21 +0200
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from our
 plugin thus breaking a lot's of sites
Message-ID: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>

Hi,

we received lot's of reports that our plugin is not compatible with 3.7 and
many site where brought down. The problem seems to be that wordpress 3.7
upgrade deletes ( in some occasions ) a file in a folder we create in
wp-content.
http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8

The file name is event.min.js and we create the folder themes-ai1ec under
wp-content. Any idea why this might be happening?This doesn't seem to be
under our control but user are blaming us. If we need to change something
to be compatible, we will, but i have no guess now on what to do.

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235

From ipstenu at ipstenu.org  Fri Oct 25 17:26:40 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Fri, 25 Oct 2013 13:26:40 -0400
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
Message-ID: <526AA9D0.2070002@ipstenu.org>

"Our Plugin" is http://wordpress.org/plugins/all-in-one-event-calendar/

I haven't heard of any other plugin having it's content in wp-content 
whacked by the update. I added this to the master list though.

In general, it SHOULD be impossible for WP to delete anything like that. 
It has a very specific list in wp-admin/includes/update-core.php of what 
it deletes. Look for the _old_files array.

Nicola Peluchetti wrote:
>
> Hi,
>
> we received lot's of reports that our plugin is not compatible with 
> 3.7 and
> many site where brought down. The problem seems to be that wordpress 3.7
> upgrade deletes ( in some occasions ) a file in a folder we create in
> wp-content.
> http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
>
> The file name is event.min.js and we create the folder themes-ai1ec under
> wp-content. Any idea why this might be happening?This doesn't seem to be
> under our control but user are blaming us. If we need to change something
> to be compatible, we will, but i have no guess now on what to do.
>
> * *
> *Nicola Peluchetti - Senior PHP Developer @ Timely**
> *
> Twitter: @nik_peluchetti<https://twitter.com/#!/nik_peluchetti>
> Facebook: nicola.peluchetti<https://www.facebook.com/nicola.peluchetti>
> Stackoverflow: 
> Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
> Mobile: +39 339 7507235
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From nicola.peluchetti at gmail.com  Fri Oct 25 17:31:37 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Fri, 25 Oct 2013 19:31:37 +0200
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <526AA9D0.2070002@ipstenu.org>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <526AA9D0.2070002@ipstenu.org>
Message-ID: <CAJ7gacrwZq9bE0CbmXMwMY4QXaEL63W=aSK5egC34nKaMW3HzQ@mail.gmail.com>

Hi,

yes it's that plugin. As you can see on the support page
http://wordpress.org/support/plugin/all-in-one-event-calendar there are
lot's of complaints about this. Personally i updated my local install with
no problems.

If you have any suggestion on how this might be happening on our side we
could investigate, but i can't think of a way where an upgrade on wordpress
triggers the deletion of a file from our plugin.

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235


On Fri, Oct 25, 2013 at 7:26 PM, Mika A Epstein <ipstenu at ipstenu.org> wrote:

> "Our Plugin" is http://wordpress.org/plugins/**all-in-one-event-calendar/<http://wordpress.org/plugins/all-in-one-event-calendar/>
>
> I haven't heard of any other plugin having it's content in wp-content
> whacked by the update. I added this to the master list though.
>
> In general, it SHOULD be impossible for WP to delete anything like that.
> It has a very specific list in wp-admin/includes/update-core.**php of
> what it deletes. Look for the _old_files array.
>
> Nicola Peluchetti wrote:
>
>>
>> Hi,
>>
>> we received lot's of reports that our plugin is not compatible with 3.7
>> and
>> many site where brought down. The problem seems to be that wordpress 3.7
>> upgrade deletes ( in some occasions ) a file in a folder we create in
>> wp-content.
>> http://wordpress.org/support/**topic/not-compatible-with-wp-**
>> 37?replies=8<http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8>
>>
>> The file name is event.min.js and we create the folder themes-ai1ec under
>> wp-content. Any idea why this might be happening?This doesn't seem to be
>> under our control but user are blaming us. If we need to change something
>> to be compatible, we will, but i have no guess now on what to do.
>>
>> * *
>> *Nicola Peluchetti - Senior PHP Developer @ Timely**
>> *
>> Twitter: @nik_peluchetti<https://**twitter.com/#!/nik_peluchetti<https://twitter.com/#!/nik_peluchetti>
>> >
>> Facebook: nicola.peluchetti<https://www.**facebook.com/nicola.peluchetti<https://www.facebook.com/nicola.peluchetti>
>> **>
>> Stackoverflow: Stackoverflow<http://**stackoverflow.com/users/**
>> 397861/nicola-peluchetti<http://stackoverflow.com/users/397861/nicola-peluchetti>
>> >
>> Mobile: +39 339 7507235
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
> ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From ipstenu at ipstenu.org  Fri Oct 25 17:32:51 2013
From: ipstenu at ipstenu.org (Mika A Epstein)
Date: Fri, 25 Oct 2013 13:32:51 -0400
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gacrwZq9bE0CbmXMwMY4QXaEL63W=aSK5egC34nKaMW3HzQ@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <526AA9D0.2070002@ipstenu.org>
 <CAJ7gacrwZq9bE0CbmXMwMY4QXaEL63W=aSK5egC34nKaMW3HzQ@mail.gmail.com>
Message-ID: <526AAB43.1090706@ipstenu.org>

Just the usual, really.

Get the list of plugins and themes, try to see if anything common is 
there. Ask HOW they upgraded (clicked on the link, their host did it, what?)

Nicola Peluchetti wrote:
>
> Hi,
>
> yes it's that plugin. As you can see on the support page
> http://wordpress.org/support/plugin/all-in-one-event-calendar there are
> lot's of complaints about this. Personally i updated my local install with
> no problems.
>
> If you have any suggestion on how this might be happening on our side we
> could investigate, but i can't think of a way where an upgrade on 
> wordpress
> triggers the deletion of a file from our plugin.
>
> * *
> *Nicola Peluchetti - Senior PHP Developer @ Timely**
> *
> Twitter: @nik_peluchetti<https://twitter.com/#!/nik_peluchetti>
> Facebook: nicola.peluchetti<https://www.facebook.com/nicola.peluchetti>
> Stackoverflow: 
> Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
> Mobile: +39 339 7507235
>
>
> On Fri, Oct 25, 2013 at 7:26 PM, Mika A Epstein<ipstenu at ipstenu.org> 
> wrote:
>
>>
>> "Our Plugin" is 
>> http://wordpress.org/plugins/**all-in-one-event-calendar/<http://wordpress.org/plugins/all-in-one-event-calendar/>
>>
>> I haven't heard of any other plugin having it's content in wp-content
>> whacked by the update. I added this to the master list though.
>>
>> In general, it SHOULD be impossible for WP to delete anything like that.
>> It has a very specific list in wp-admin/includes/update-core.**php of
>> what it deletes. Look for the _old_files array.
>>
>> Nicola Peluchetti wrote:
>>
>>>
>>> Hi,
>>>
>>> we received lot's of reports that our plugin is not compatible with 3.7
>>> and
>>> many site where brought down. The problem seems to be that wordpress 3.7
>>> upgrade deletes ( in some occasions ) a file in a folder we create in
>>> wp-content.
>>> http://wordpress.org/support/**topic/not-compatible-with-wp-**
>>> 37?replies=8<http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8>
>>>
>>> The file name is event.min.js and we create the folder themes-ai1ec 
>>> under
>>> wp-content. Any idea why this might be happening?This doesn't seem to be
>>> under our control but user are blaming us. If we need to change 
>>> something
>>> to be compatible, we will, but i have no guess now on what to do.
>>>
>>> * *
>>> *Nicola Peluchetti - Senior PHP Developer @ Timely**
>>> *
>>> Twitter: 
>>> @nik_peluchetti<https://**twitter.com/#!/nik_peluchetti<https://twitter.com/#!/nik_peluchetti>
>>> Facebook: 
>>> nicola.peluchetti<https://www.**facebook.com/nicola.peluchetti<https://www.facebook.com/nicola.peluchetti>
>>> **>
>>> Stackoverflow: Stackoverflow<http://**stackoverflow.com/users/**
>>> 397861/nicola-peluchetti<http://stackoverflow.com/users/397861/nicola-peluchetti>
>>> Mobile: +39 339 7507235
>>> ______________________________**_________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.**com<wp-hackers at lists.automattic.com>
>>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>>
>>
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com<wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From otto at ottodestruct.com  Fri Oct 25 18:41:03 2013
From: otto at ottodestruct.com (Otto)
Date: Fri, 25 Oct 2013 13:41:03 -0500
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
Message-ID: <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>

On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
<nicola.peluchetti at gmail.com> wrote:
> Hi,
>
> we received lot's of reports that our plugin is not compatible with 3.7 and
> many site where brought down. The problem seems to be that wordpress 3.7
> upgrade deletes ( in some occasions ) a file in a folder we create in
> wp-content.
> http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
>
> The file name is event.min.js and we create the folder themes-ai1ec under
> wp-content. Any idea why this might be happening?This doesn't seem to be
> under our control but user are blaming us. If we need to change something
> to be compatible, we will, but i have no guess now on what to do.

While I can't see any particular reason for a file like that to be
deleted on an update, this error is coming entirely from your plugin.

Examine the error message posted in this thread:
http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8

If you examine that code, you have this:

if( $file_found === false ) {
throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
doesn't exist." );
}

That is a pretty horrible thing to do on a production site *if* you're
not catching the exception higher up and handling it gracefully. An
uncaught exception is a fatal error = Instantly broken site.

I would look at all the places you're calling functions that can throw
Ai1ec_File_Not_Found and putting catches around them, to handle the
situation better.

-Otto

From nikolov.tmw at gmail.com  Fri Oct 25 19:05:12 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Fri, 25 Oct 2013 22:05:12 +0300
Subject: [wp-hackers] wp 3.7
In-Reply-To: <CAFnKAk0PQR=C8pRjLxqt7x_zE7hG86ZHNUeRtMY42_HnWMmvmw@mail.gmail.com>
References: <CAFnKAk0PQR=C8pRjLxqt7x_zE7hG86ZHNUeRtMY42_HnWMmvmw@mail.gmail.com>
Message-ID: <CAOwx47eiSRkLK00cLkFLnb5s7ow-bBVFMqN5dKe9_p_Vub+k1g@mail.gmail.com>

Hi Luke,

I couldn't replicate the issue on the make.wordpress site - I tried with
both normal and incognito views and I didn't get any messages about
cookies(just the normal login form).

About the search-relevance - as far as I read in the updated page(when the
update to 3.7 finishes and you see the big nice screen with all the good
stuff in 3.7) it is there and should be working.

Nikola


On Fri, Oct 25, 2013 at 7:20 PM, Luke Bryan <lukebryan at sharefaith.com>wrote:

> Greetings all,
>
> 3.7 is nice, but I was noticing an intermittent problem, happening even on
> make.wordpress.org blog. (https://make.wordpress.org/core/wp-login.php)
> The
> first login attempt says you don't have cookies enabled - second login
> works fine though. (I'm using Firefox).
>
> I was also wondering what happened to the search-relevance functionality,
> since it isn't mentioned here (http://wordpress.org/news/2013/10/basie/) -
> was this feature dropped for 3.7?
>
> Best regards,
> Luke
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From lukebryan at sharefaith.com  Fri Oct 25 21:02:57 2013
From: lukebryan at sharefaith.com (Luke Bryan)
Date: Fri, 25 Oct 2013 14:02:57 -0700
Subject: [wp-hackers] wp 3.7
Message-ID: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>

Here are the steps to reproduce the problem:

Go to https://make.wordpress.org/core/wp-login.php, click on the icon by
the url and go to more information.

View cookies, remove all cookies.

Now when you log in it will first give you the message "*ERROR*: Cookies
are blocked or not supported by your browser. You must enable
cookies<http://www.google.com/cookies.html>to use WordPress."

Should happen in Firefox 24,25, but I tested in Chrome and it didn't give
the message. Maybe a bug in either Firefox or Chrome's cookie setup?

Thanks
Luke

------------------------------

Hi Luke,

I couldn't replicate the issue on the make.wordpress site - I tried with
both normal and incognito views and I didn't get any messages about
cookies(just the normal login form).

About the search-relevance - as far as I read in the updated page(when the
update to 3.7 finishes and you see the big nice screen with all the good
stuff in 3.7) it is there and should be working.

Nikola


On Fri, Oct 25, 2013 at 7:20 PM, Luke Bryan <lukebryan at
sharefaith.com <http://lists.automattic.com/mailman/listinfo/wp-hackers>>wrote:

>* Greetings all,*>**>* 3.7 is nice, but I was noticing an intermittent problem, happening even on*>* make.wordpress.org blog. (https://make.wordpress.org/core/wp-login.php)*>* The*>* first login attempt says you don't have cookies enabled - second login*>* works fine though. (I'm using Firefox).*>**>* I was also wondering what happened to the search-relevance functionality,*>* since it isn't mentioned here (http://wordpress.org/news/2013/10/basie/) -*>* was this feature dropped for 3.7?*>**>* Best regards,*>* Luke*>* _______________________________________________*>* wp-hackers mailing list*>* wp-hackers at lists.automattic.com <http://lists.automattic.com/mailman/listinfo/wp-hackers>*>* http://lists.automattic.com/mailman/listinfo/wp-hackers*>**

From nikolov.tmw at gmail.com  Fri Oct 25 21:05:10 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Sat, 26 Oct 2013 00:05:10 +0300
Subject: [wp-hackers] wp 3.7
In-Reply-To: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>
References: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>
Message-ID: <CAOwx47e=WLxs9VUNSj+OGu1PUmYEKEFQ6yFP=X5shYy+zkpxVQ@mail.gmail.com>

Hmmm... Can you try to replicate this in a 3.6 install with Firefox?


On Sat, Oct 26, 2013 at 12:02 AM, Luke Bryan <lukebryan at sharefaith.com>wrote:

> Here are the steps to reproduce the problem:
>
> Go to https://make.wordpress.org/core/wp-login.php, click on the icon by
> the url and go to more information.
>
> View cookies, remove all cookies.
>
> Now when you log in it will first give you the message "*ERROR*: Cookies
> are blocked or not supported by your browser. You must enable
> cookies<http://www.google.com/cookies.html>to use WordPress."
>
> Should happen in Firefox 24,25, but I tested in Chrome and it didn't give
> the message. Maybe a bug in either Firefox or Chrome's cookie setup?
>
> Thanks
> Luke
>
> ------------------------------
>
> Hi Luke,
>
> I couldn't replicate the issue on the make.wordpress site - I tried with
> both normal and incognito views and I didn't get any messages about
> cookies(just the normal login form).
>
> About the search-relevance - as far as I read in the updated page(when the
> update to 3.7 finishes and you see the big nice screen with all the good
> stuff in 3.7) it is there and should be working.
>
> Nikola
>
>
> On Fri, Oct 25, 2013 at 7:20 PM, Luke Bryan <lukebryan at
> sharefaith.com <http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>wrote:
>
> >* Greetings all,*>**>* 3.7 is nice, but I was noticing an intermittent
> problem, happening even on*>* make.wordpress.org blog. (
> https://make.wordpress.org/core/wp-login.php)*>* The*>* first login
> attempt says you don't have cookies enabled - second login*>* works fine
> though. (I'm using Firefox).*>**>* I was also wondering what happened to
> the search-relevance functionality,*>* since it isn't mentioned here (
> http://wordpress.org/news/2013/10/basie/) -*>* was this feature dropped
> for 3.7?*>**>* Best regards,*>* Luke*>*
> _______________________________________________*>* wp-hackers mailing
> list*>* wp-hackers at lists.automattic.com <
> http://lists.automattic.com/mailman/listinfo/wp-hackers>*>*
> http://lists.automattic.com/mailman/listinfo/wp-hackers*>**
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From gaarai at gaarai.com  Fri Oct 25 21:14:25 2013
From: gaarai at gaarai.com (Chris Jean)
Date: Fri, 25 Oct 2013 16:14:25 -0500
Subject: [wp-hackers] wp 3.7
In-Reply-To: <CAOwx47e=WLxs9VUNSj+OGu1PUmYEKEFQ6yFP=X5shYy+zkpxVQ@mail.gmail.com>
References: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>
 <CAOwx47e=WLxs9VUNSj+OGu1PUmYEKEFQ6yFP=X5shYy+zkpxVQ@mail.gmail.com>
Message-ID: <526ADF31.80900@gaarai.com>

It's due to this line that was added to wp-login.php in 3.7:

if ( isset($_POST['testcookie']) && empty($_COOKIE[TEST_COOKIE]) )

This didn't exist before.

Since the cookie is set on page load, triggering this issue would seem 
to require clearing cookies just before logging in, having cookies 
disabled until already on the page, or some other type of process on the 
browser that is blocking cookies.

Luke, do you have anything on your browser that blocks, disables, or 
otherwise modifies cookies?

Chris Jean (AKA gaarai & chrisbliss18)
Coder for ithemes.com
chrisjean.com
@chrisjean

On 10/25/2013 04:05 PM, Nikola Nikolov wrote:
> Hmmm... Can you try to replicate this in a 3.6 install with Firefox?
>
>
> On Sat, Oct 26, 2013 at 12:02 AM, Luke Bryan <lukebryan at sharefaith.com>wrote:
>
>> Here are the steps to reproduce the problem:
>>
>> Go to https://make.wordpress.org/core/wp-login.php, click on the icon by
>> the url and go to more information.
>>
>> View cookies, remove all cookies.
>>
>> Now when you log in it will first give you the message "*ERROR*: Cookies
>> are blocked or not supported by your browser. You must enable
>> cookies<http://www.google.com/cookies.html>to use WordPress."
>>
>> Should happen in Firefox 24,25, but I tested in Chrome and it didn't give
>> the message. Maybe a bug in either Firefox or Chrome's cookie setup?
>>
>> Thanks
>> Luke
>>
>> ------------------------------
>>
>> Hi Luke,
>>
>> I couldn't replicate the issue on the make.wordpress site - I tried with
>> both normal and incognito views and I didn't get any messages about
>> cookies(just the normal login form).
>>
>> About the search-relevance - as far as I read in the updated page(when the
>> update to 3.7 finishes and you see the big nice screen with all the good
>> stuff in 3.7) it is there and should be working.
>>
>> Nikola
>>
>>
>> On Fri, Oct 25, 2013 at 7:20 PM, Luke Bryan <lukebryan at
>> sharefaith.com <http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> wrote:
>>> * Greetings all,*>**>* 3.7 is nice, but I was noticing an intermittent
>> problem, happening even on*>* make.wordpress.org blog. (
>> https://make.wordpress.org/core/wp-login.php)*>* The*>* first login
>> attempt says you don't have cookies enabled - second login*>* works fine
>> though. (I'm using Firefox).*>**>* I was also wondering what happened to
>> the search-relevance functionality,*>* since it isn't mentioned here (
>> http://wordpress.org/news/2013/10/basie/) -*>* was this feature dropped
>> for 3.7?*>**>* Best regards,*>* Luke*>*
>> _______________________________________________*>* wp-hackers mailing
>> list*>* wp-hackers at lists.automattic.com <
>> http://lists.automattic.com/mailman/listinfo/wp-hackers>*>*
>> http://lists.automattic.com/mailman/listinfo/wp-hackers*>**
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From otto at ottodestruct.com  Fri Oct 25 21:41:51 2013
From: otto at ottodestruct.com (Otto)
Date: Fri, 25 Oct 2013 16:41:51 -0500
Subject: [wp-hackers] wp 3.7
In-Reply-To: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>
References: <CAFnKAk1pN1+ybdNTmD8=JJiQSBx0MMgZDt-D+tUdD+Y9TgrdiQ@mail.gmail.com>
Message-ID: <CAD-Fghynu1b2rVQrRFB0CFQoU3nPcuKe0pyh4i8gOBgijeLn3A@mail.gmail.com>

On Fri, Oct 25, 2013 at 4:02 PM, Luke Bryan <lukebryan at sharefaith.com> wrote:
> Here are the steps to reproduce the problem:
>
> Go to https://make.wordpress.org/core/wp-login.php, click on the icon by
> the url and go to more information.
>
> View cookies, remove all cookies.
>
> Now when you log in it will first give you the message "*ERROR*: Cookies
> are blocked or not supported by your browser. You must enable
> cookies<http://www.google.com/cookies.html>to use WordPress."


That's actually intentional. The test cookie is set on the load of the
wp-login.php screen. When you log in, it checks for the existence of
that test cookie and won't log you in without it.

This is to give better feedback than before, for login attempts where
cookies were disabled, but the username and password given was
correct. See http://core.trac.wordpress.org/ticket/24961 .

Now, obviously, if you clear the cookies between loading the login
page and logging in, then you're going to have problems, because it's
testing for the existence of the cookie it just set on the login
screen.

-Otto

From gt at gtmanagement.com  Fri Oct 25 22:38:53 2013
From: gt at gtmanagement.com (Glenn Tate)
Date: Fri, 25 Oct 2013 18:38:53 -0400
Subject: [wp-hackers] http://wordpress.org/plugins/plugin-organizer/ Breaks
	3.7
Message-ID: <CAEMUtTTO0n6oyxsNtGrGbH1sYc-wtuNmTBcBfUKn54FUpro8Qg@mail.gmail.com>

White screens and throws this error:

Call to undefined function wp_get_current_user() in
/home/.../public_html/.../wordpress/wp-includes/user.php on line 215


>From the author:
"So the problem is that the developers have changed the WP_query object so
that the WP_query->get_posts function no longer uses a global variable for
the user id and it now calls the get_current_user_id function which calls
wp_get_current_user which only exists after pluggable.php has been
included. If I include pluggable.php its going to make the functions in
pluggable.php static and will no longer be able to be overridden."

This patches it.

You need to add this line to the top of your CAPABILITIES.PHP file -

require_once ('pluggable.php');

so it looks like this -

<?php

require_once ('pluggable.php');
/**
 * WordPress Roles and Capabilities.


Cheers,


Glenn S. Tate



GT Management Systems

From wordpress at dd32.id.au  Fri Oct 25 22:52:30 2013
From: wordpress at dd32.id.au (Dion Hulse (dd32))
Date: Sat, 26 Oct 2013 09:52:30 +1100
Subject: [wp-hackers] http://wordpress.org/plugins/plugin-organizer/
 Breaks 3.7
In-Reply-To: <CAEMUtTTO0n6oyxsNtGrGbH1sYc-wtuNmTBcBfUKn54FUpro8Qg@mail.gmail.com>
References: <CAEMUtTTO0n6oyxsNtGrGbH1sYc-wtuNmTBcBfUKn54FUpro8Qg@mail.gmail.com>
Message-ID: <CAL4EHfkNr2Xw1OUuTpfFtrzCVKBQkC1DCx_NAZmwDK5CxNOfRw@mail.gmail.com>

Unfortunately this is a pretty standard Plugin Developer error :(

No plugin should be executing code upon plugin inclusion (other than
add_action/add_filter/object instantiation), especially not get_posts().
We've got hooks available (plugins_loaded, init, template_redirect) where
plugins can run their on-inclusion code, and running it earlier will pretty
much guarantee breakage at some point in the future - As the error shows,
WordPress hasn't even fully set up it's environment when the plugin is
doing stuff.

The authors fix is a workaround, a bad one, and they should really delay
executing get_posts until plugins_loaded or preferably, init, if they
really have to run it on every page load.


On 26 October 2013 09:38, Glenn Tate <gt at gtmanagement.com> wrote:

> White screens and throws this error:
>
> Call to undefined function wp_get_current_user() in
> /home/.../public_html/.../wordpress/wp-includes/user.php on line 215
>
>
> From the author:
> "So the problem is that the developers have changed the WP_query object so
> that the WP_query->get_posts function no longer uses a global variable for
> the user id and it now calls the get_current_user_id function which calls
> wp_get_current_user which only exists after pluggable.php has been
> included. If I include pluggable.php its going to make the functions in
> pluggable.php static and will no longer be able to be overridden."
>
> This patches it.
>
> You need to add this line to the top of your CAPABILITIES.PHP file -
>
> require_once ('pluggable.php');
>
> so it looks like this -
>
> <?php
>
> require_once ('pluggable.php');
> /**
>  * WordPress Roles and Capabilities.
>
>
> Cheers,
>
>
> Glenn S. Tate
>
>
>
> GT Management Systems
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nicola.peluchetti at gmail.com  Sat Oct 26 14:29:21 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Sat, 26 Oct 2013 16:29:21 +0200
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
Message-ID: <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>

Hi,

sure that's horrible, we will fix that, but the real problem is that the
file is deleted. If we catch the exception still the js is not loaded and
the file was there before the upgrade.
During the upgrade process, is any plugin code executed?We already have 25
people reporting our plugin as not compatible with 3.7 for this and i
imagine people affected are many more. I can't replicate this locally, i
will add a check to load that file from our plugin dir and not wp-content i
can't think of any other way to handle this.

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235


On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:

> On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
> <nicola.peluchetti at gmail.com> wrote:
> > Hi,
> >
> > we received lot's of reports that our plugin is not compatible with 3.7
> and
> > many site where brought down. The problem seems to be that wordpress 3.7
> > upgrade deletes ( in some occasions ) a file in a folder we create in
> > wp-content.
> > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> >
> > The file name is event.min.js and we create the folder themes-ai1ec under
> > wp-content. Any idea why this might be happening?This doesn't seem to be
> > under our control but user are blaming us. If we need to change something
> > to be compatible, we will, but i have no guess now on what to do.
>
> While I can't see any particular reason for a file like that to be
> deleted on an update, this error is coming entirely from your plugin.
>
> Examine the error message posted in this thread:
> http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
>
> If you examine that code, you have this:
>
> if( $file_found === false ) {
> throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
> doesn't exist." );
> }
>
> That is a pretty horrible thing to do on a production site *if* you're
> not catching the exception higher up and handling it gracefully. An
> uncaught exception is a fatal error = Instantly broken site.
>
> I would look at all the places you're calling functions that can throw
> Ai1ec_File_Not_Found and putting catches around them, to handle the
> situation better.
>
> -Otto
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nicola.peluchetti at gmail.com  Sat Oct 26 14:48:09 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Sat, 26 Oct 2013 16:48:09 +0200
Subject: [wp-hackers] With wordpress 3.7 our function that prevented
 checking for upgrade on wordpress.org has broken, what has changed?
Message-ID: <CAJ7gacodgm9Jnxu7Ns_yaVA2HQpd0wV-ZF894aqjrs3LL4bW+A@mail.gmail.com>

Hi,

we have a premium version of our plugin which stops checking for updates
from wordpress.org. I guess 3.7 broke that. This is our function

 // ================================================

// = Disable updates checking for premium version =

// ================================================

function ai1ec_disable_updates( $r, $url ) {

if ( 0 !== strpos( $url, 'http://api.wordpress.org/plugins/update-check' ) )

 return $r; // Not a plugin update request.


 $plugins = unserialize( $r['body']['plugins'] );

unset( $plugins->plugins[ plugin_basename( __FILE__ ) ] );

unset( $plugins->active[ array_search( plugin_basename( __FILE__ ),
$plugins->active ) ] );

$r['body']['plugins'] = serialize( $plugins );


 return $r;

}

how can i change this to make it work with 3.7?
* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235

From lists at rotorised.com  Sat Oct 26 14:50:51 2013
From: lists at rotorised.com (Ryan McCue)
Date: Sun, 27 Oct 2013 00:50:51 +1000
Subject: [wp-hackers] With wordpress 3.7 our function that prevented
 checking for upgrade on wordpress.org has broken, what has changed?
In-Reply-To: <CAJ7gacodgm9Jnxu7Ns_yaVA2HQpd0wV-ZF894aqjrs3LL4bW+A@mail.gmail.com>
References: <CAJ7gacodgm9Jnxu7Ns_yaVA2HQpd0wV-ZF894aqjrs3LL4bW+A@mail.gmail.com>
Message-ID: <526BD6CB.6070406@rotorised.com>

Nicola Peluchetti wrote:
> Hi,
> 
> we have a premium version of our plugin which stops checking for updates
> from wordpress.org. I guess 3.7 broke that. This is our function

This broke because the API changed from serialized data to JSON. See
http://make.wordpress.org/core/2013/10/25/json-encoding-ssl-api-wordpress-3-7/

-- 
Ryan McCue
<http://ryanmccue.info/>

From nicola.peluchetti at gmail.com  Sat Oct 26 14:57:18 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Sat, 26 Oct 2013 16:57:18 +0200
Subject: [wp-hackers] With wordpress 3.7 our function that prevented
 checking for upgrade on wordpress.org has broken, what has changed?
In-Reply-To: <526BD6CB.6070406@rotorised.com>
References: <CAJ7gacodgm9Jnxu7Ns_yaVA2HQpd0wV-ZF894aqjrs3LL4bW+A@mail.gmail.com>
 <526BD6CB.6070406@rotorised.com>
Message-ID: <CAJ7gacreRwkpmRWQiesPc6WbubKOUTCvoyTTR=8EboL+P8vNMA@mail.gmail.com>

Thanks.

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235


On Sat, Oct 26, 2013 at 4:50 PM, Ryan McCue <lists at rotorised.com> wrote:

> Nicola Peluchetti wrote:
> > Hi,
> >
> > we have a premium version of our plugin which stops checking for updates
> > from wordpress.org. I guess 3.7 broke that. This is our function
>
> This broke because the API changed from serialized data to JSON. See
>
> http://make.wordpress.org/core/2013/10/25/json-encoding-ssl-api-wordpress-3-7/
>
> --
> Ryan McCue
> <http://ryanmccue.info/>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From johnbillion+wp at gmail.com  Sat Oct 26 15:08:06 2013
From: johnbillion+wp at gmail.com (John Blackbourn)
Date: Sat, 26 Oct 2013 16:08:06 +0100
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
 <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
Message-ID: <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>

This plugin's `uninstall.php` file deletes the WP_CONTENT_DIR/themes-ai1ec
directory when called. It sounds like this plugin's uninstall.php file is
being called during the upgrade.

Potential cause: People running a plugin which forces plugin uninstall
routines to run when plugins are disabled?

@Nicola: It would help hugely if you can get a list of active plugins on
affected sites from users who are experiencing the problem.


On 26 October 2013 15:29, Nicola Peluchetti <nicola.peluchetti at gmail.com>wrote:

> Hi,
>
> sure that's horrible, we will fix that, but the real problem is that the
> file is deleted. If we catch the exception still the js is not loaded and
> the file was there before the upgrade.
> During the upgrade process, is any plugin code executed?We already have 25
> people reporting our plugin as not compatible with 3.7 for this and i
> imagine people affected are many more. I can't replicate this locally, i
> will add a check to load that file from our plugin dir and not wp-content i
> can't think of any other way to handle this.
>
> * *
> *Nicola Peluchetti - Senior PHP Developer @ Timely**
> *
> Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
> Stackoverflow: Stackoverflow<
> http://stackoverflow.com/users/397861/nicola-peluchetti>
> Mobile: +39 339 7507235
>
>
> On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:
>
> > On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
> > <nicola.peluchetti at gmail.com> wrote:
> > > Hi,
> > >
> > > we received lot's of reports that our plugin is not compatible with 3.7
> > and
> > > many site where brought down. The problem seems to be that wordpress
> 3.7
> > > upgrade deletes ( in some occasions ) a file in a folder we create in
> > > wp-content.
> > > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > >
> > > The file name is event.min.js and we create the folder themes-ai1ec
> under
> > > wp-content. Any idea why this might be happening?This doesn't seem to
> be
> > > under our control but user are blaming us. If we need to change
> something
> > > to be compatible, we will, but i have no guess now on what to do.
> >
> > While I can't see any particular reason for a file like that to be
> > deleted on an update, this error is coming entirely from your plugin.
> >
> > Examine the error message posted in this thread:
> > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> >
> > If you examine that code, you have this:
> >
> > if( $file_found === false ) {
> > throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
> > doesn't exist." );
> > }
> >
> > That is a pretty horrible thing to do on a production site *if* you're
> > not catching the exception higher up and handling it gracefully. An
> > uncaught exception is a fatal error = Instantly broken site.
> >
> > I would look at all the places you're calling functions that can throw
> > Ai1ec_File_Not_Found and putting catches around them, to handle the
> > situation better.
> >
> > -Otto
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nicola.peluchetti at gmail.com  Sat Oct 26 15:33:10 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Sat, 26 Oct 2013 17:33:10 +0200
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
 <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
 <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>
Message-ID: <CAJ7gacpRXV03+NeK-6a=1FzvK3CeAUbgoim_bsaQNe9f0mHC+Q@mail.gmail.com>

The fact is that only the event.min.js file seems to be deleted. Not the
whole folder. I released 1.10.4 to address this, basically i fall back to
loading the file from our original folder if the file is missing from
wp-content. Still would like to understand why this is happening.
Version 2.0 will have a global exception/error handler to avoid bringing
down websites and wasting my weekends fixing things :D

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235


On Sat, Oct 26, 2013 at 5:08 PM, John Blackbourn
<johnbillion+wp at gmail.com>wrote:

> This plugin's `uninstall.php` file deletes the WP_CONTENT_DIR/themes-ai1ec
> directory when called. It sounds like this plugin's uninstall.php file is
> being called during the upgrade.
>
> Potential cause: People running a plugin which forces plugin uninstall
> routines to run when plugins are disabled?
>
> @Nicola: It would help hugely if you can get a list of active plugins on
> affected sites from users who are experiencing the problem.
>
>
> On 26 October 2013 15:29, Nicola Peluchetti <nicola.peluchetti at gmail.com
> >wrote:
>
> > Hi,
> >
> > sure that's horrible, we will fix that, but the real problem is that the
> > file is deleted. If we catch the exception still the js is not loaded and
> > the file was there before the upgrade.
> > During the upgrade process, is any plugin code executed?We already have
> 25
> > people reporting our plugin as not compatible with 3.7 for this and i
> > imagine people affected are many more. I can't replicate this locally, i
> > will add a check to load that file from our plugin dir and not
> wp-content i
> > can't think of any other way to handle this.
> >
> > * *
> > *Nicola Peluchetti - Senior PHP Developer @ Timely**
> > *
> > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> > Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
> > Stackoverflow: Stackoverflow<
> > http://stackoverflow.com/users/397861/nicola-peluchetti>
> > Mobile: +39 339 7507235
> >
> >
> > On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:
> >
> > > On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
> > > <nicola.peluchetti at gmail.com> wrote:
> > > > Hi,
> > > >
> > > > we received lot's of reports that our plugin is not compatible with
> 3.7
> > > and
> > > > many site where brought down. The problem seems to be that wordpress
> > 3.7
> > > > upgrade deletes ( in some occasions ) a file in a folder we create in
> > > > wp-content.
> > > >
> http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > > >
> > > > The file name is event.min.js and we create the folder themes-ai1ec
> > under
> > > > wp-content. Any idea why this might be happening?This doesn't seem to
> > be
> > > > under our control but user are blaming us. If we need to change
> > something
> > > > to be compatible, we will, but i have no guess now on what to do.
> > >
> > > While I can't see any particular reason for a file like that to be
> > > deleted on an update, this error is coming entirely from your plugin.
> > >
> > > Examine the error message posted in this thread:
> > > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > >
> > > If you examine that code, you have this:
> > >
> > > if( $file_found === false ) {
> > > throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
> > > doesn't exist." );
> > > }
> > >
> > > That is a pretty horrible thing to do on a production site *if* you're
> > > not catching the exception higher up and handling it gracefully. An
> > > uncaught exception is a fatal error = Instantly broken site.
> > >
> > > I would look at all the places you're calling functions that can throw
> > > Ai1ec_File_Not_Found and putting catches around them, to handle the
> > > situation better.
> > >
> > > -Otto
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From wp at andrewnacin.com  Sat Oct 26 15:59:05 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Sat, 26 Oct 2013 11:59:05 -0400
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gacpRXV03+NeK-6a=1FzvK3CeAUbgoim_bsaQNe9f0mHC+Q@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
 <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
 <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>
 <CAJ7gacpRXV03+NeK-6a=1FzvK3CeAUbgoim_bsaQNe9f0mHC+Q@mail.gmail.com>
Message-ID: <CAP29Pvh5Skv2FyYbiMXwpXZfmVgKo4Ro72ozk6nabAO4QOqbrw@mail.gmail.com>

An exception over a missing CSS file? Really? That also means you are
running unnecessary systems calls on every page, slowing down sites for no
good reason. Rather than wasting effort and CPU cycles on a global
exception handler, consider removing this.

WordPress doesn't touch wp-content during an update unless it is to copy
over a new default theme, so I don't really know what's going on here. I
can pretty safely say this is not WordPress core.

If you want to understand, start by responding to John. "Potential cause:
People running a plugin which forces plugin uninstall routines to run when
plugins are disabled? It would help hugely if you can get a list of active
plugins on affected sites from users who are experiencing the problem."

Nacin


On Sat, Oct 26, 2013 at 11:33 AM, Nicola Peluchetti <
nicola.peluchetti at gmail.com> wrote:

> The fact is that only the event.min.js file seems to be deleted. Not the
> whole folder. I released 1.10.4 to address this, basically i fall back to
> loading the file from our original folder if the file is missing from
> wp-content. Still would like to understand why this is happening.
> Version 2.0 will have a global exception/error handler to avoid bringing
> down websites and wasting my weekends fixing things :D
>
> * *
> *Nicola Peluchetti - Senior PHP Developer @ Timely**
> *
> Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
> Stackoverflow: Stackoverflow<
> http://stackoverflow.com/users/397861/nicola-peluchetti>
> Mobile: +39 339 7507235
>
>
> On Sat, Oct 26, 2013 at 5:08 PM, John Blackbourn
> <johnbillion+wp at gmail.com>wrote:
>
> > This plugin's `uninstall.php` file deletes the
> WP_CONTENT_DIR/themes-ai1ec
> > directory when called. It sounds like this plugin's uninstall.php file is
> > being called during the upgrade.
> >
> > Potential cause: People running a plugin which forces plugin uninstall
> > routines to run when plugins are disabled?
> >
> > @Nicola: It would help hugely if you can get a list of active plugins on
> > affected sites from users who are experiencing the problem.
> >
> >
> > On 26 October 2013 15:29, Nicola Peluchetti <nicola.peluchetti at gmail.com
> > >wrote:
> >
> > > Hi,
> > >
> > > sure that's horrible, we will fix that, but the real problem is that
> the
> > > file is deleted. If we catch the exception still the js is not loaded
> and
> > > the file was there before the upgrade.
> > > During the upgrade process, is any plugin code executed?We already have
> > 25
> > > people reporting our plugin as not compatible with 3.7 for this and i
> > > imagine people affected are many more. I can't replicate this locally,
> i
> > > will add a check to load that file from our plugin dir and not
> > wp-content i
> > > can't think of any other way to handle this.
> > >
> > > * *
> > > *Nicola Peluchetti - Senior PHP Developer @ Timely**
> > > *
> > > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> > > Facebook: nicola.peluchetti <
> https://www.facebook.com/nicola.peluchetti>
> > > Stackoverflow: Stackoverflow<
> > > http://stackoverflow.com/users/397861/nicola-peluchetti>
> > > Mobile: +39 339 7507235
> > >
> > >
> > > On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:
> > >
> > > > On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
> > > > <nicola.peluchetti at gmail.com> wrote:
> > > > > Hi,
> > > > >
> > > > > we received lot's of reports that our plugin is not compatible with
> > 3.7
> > > > and
> > > > > many site where brought down. The problem seems to be that
> wordpress
> > > 3.7
> > > > > upgrade deletes ( in some occasions ) a file in a folder we create
> in
> > > > > wp-content.
> > > > >
> > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > > > >
> > > > > The file name is event.min.js and we create the folder themes-ai1ec
> > > under
> > > > > wp-content. Any idea why this might be happening?This doesn't seem
> to
> > > be
> > > > > under our control but user are blaming us. If we need to change
> > > something
> > > > > to be compatible, we will, but i have no guess now on what to do.
> > > >
> > > > While I can't see any particular reason for a file like that to be
> > > > deleted on an update, this error is coming entirely from your plugin.
> > > >
> > > > Examine the error message posted in this thread:
> > > >
> http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > > >
> > > > If you examine that code, you have this:
> > > >
> > > > if( $file_found === false ) {
> > > > throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
> > > > doesn't exist." );
> > > > }
> > > >
> > > > That is a pretty horrible thing to do on a production site *if*
> you're
> > > > not catching the exception higher up and handling it gracefully. An
> > > > uncaught exception is a fatal error = Instantly broken site.
> > > >
> > > > I would look at all the places you're calling functions that can
> throw
> > > > Ai1ec_File_Not_Found and putting catches around them, to handle the
> > > > situation better.
> > > >
> > > > -Otto
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Sun Oct 27 02:22:55 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Sat, 26 Oct 2013 19:22:55 -0700 (PDT)
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
Message-ID: <1382840574969-42641.post@n5.nabble.com>

Looking to use this jQuery plugin with an update_user_meta option on a
profile page.  Ex. would be click your location, or mood and it allows for
inline editing and updating.  It uses a unique ajaxOptions setting that I
cant seem to get working with wordpress. 

http://vitalets.github.io/x-editable/index.html
<http://vitalets.github.io/x-editable/index.html>   - the x-editable plugin

http://jsfiddle.net/xBB5x/62/ <http://jsfiddle.net/xBB5x/62/>   - JSFiddle
of x-editable working outside wordpress - but unsure how it would work
within WP.

Mostly looking for someone to verify if this would work, and explain how the
data would be passed (for example the 'pk' field looks for a row in the DB,
maybe it would be possible to substiture that with something different? 
That or pk needs to be redefined I think? 



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From nicola.peluchetti at gmail.com  Sun Oct 27 17:42:12 2013
From: nicola.peluchetti at gmail.com (Nicola Peluchetti)
Date: Sun, 27 Oct 2013 18:42:12 +0100
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAP29Pvh5Skv2FyYbiMXwpXZfmVgKo4Ro72ozk6nabAO4QOqbrw@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
 <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
 <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>
 <CAJ7gacpRXV03+NeK-6a=1FzvK3CeAUbgoim_bsaQNe9f0mHC+Q@mail.gmail.com>
 <CAP29Pvh5Skv2FyYbiMXwpXZfmVgKo4Ro72ozk6nabAO4QOqbrw@mail.gmail.com>
Message-ID: <CAJ7gacrKwzh2JMnDijNz2H_LCgjxuHk6eSh=D8fYLbA9vLdyuQ@mail.gmail.com>

Yes it's insane throwing an exception (and not catching it) but we all
dealt with legacy code. We are rewriting/re-architecturing the pugin right
now. Looking at some sites i've also finally found where the issue was:
Wordpress 3.7 Broke our code which we used to prevent updating to
wordpress.org version.
So the user of our standard version where prompted to download the version
on wordpress.org which has a totally different way of serving resources. No
update of files in wp-content was triggered and for this reason the file
were not there.

Thanks for the help and the advice.

* *
*Nicola Peluchetti - Senior PHP Developer @ Timely**
*
Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
Mobile: +39 339 7507235


On Sat, Oct 26, 2013 at 5:59 PM, Andrew Nacin <wp at andrewnacin.com> wrote:

> An exception over a missing CSS file? Really? That also means you are
> running unnecessary systems calls on every page, slowing down sites for no
> good reason. Rather than wasting effort and CPU cycles on a global
> exception handler, consider removing this.
>
> WordPress doesn't touch wp-content during an update unless it is to copy
> over a new default theme, so I don't really know what's going on here. I
> can pretty safely say this is not WordPress core.
>
> If you want to understand, start by responding to John. "Potential cause:
> People running a plugin which forces plugin uninstall routines to run when
> plugins are disabled? It would help hugely if you can get a list of active
> plugins on affected sites from users who are experiencing the problem."
>
> Nacin
>
>
> On Sat, Oct 26, 2013 at 11:33 AM, Nicola Peluchetti <
> nicola.peluchetti at gmail.com> wrote:
>
> > The fact is that only the event.min.js file seems to be deleted. Not the
> > whole folder. I released 1.10.4 to address this, basically i fall back to
> > loading the file from our original folder if the file is missing from
> > wp-content. Still would like to understand why this is happening.
> > Version 2.0 will have a global exception/error handler to avoid bringing
> > down websites and wasting my weekends fixing things :D
> >
> > * *
> > *Nicola Peluchetti - Senior PHP Developer @ Timely**
> > *
> > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> > Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
> > Stackoverflow: Stackoverflow<
> > http://stackoverflow.com/users/397861/nicola-peluchetti>
> > Mobile: +39 339 7507235
> >
> >
> > On Sat, Oct 26, 2013 at 5:08 PM, John Blackbourn
> > <johnbillion+wp at gmail.com>wrote:
> >
> > > This plugin's `uninstall.php` file deletes the
> > WP_CONTENT_DIR/themes-ai1ec
> > > directory when called. It sounds like this plugin's uninstall.php file
> is
> > > being called during the upgrade.
> > >
> > > Potential cause: People running a plugin which forces plugin uninstall
> > > routines to run when plugins are disabled?
> > >
> > > @Nicola: It would help hugely if you can get a list of active plugins
> on
> > > affected sites from users who are experiencing the problem.
> > >
> > >
> > > On 26 October 2013 15:29, Nicola Peluchetti <
> nicola.peluchetti at gmail.com
> > > >wrote:
> > >
> > > > Hi,
> > > >
> > > > sure that's horrible, we will fix that, but the real problem is that
> > the
> > > > file is deleted. If we catch the exception still the js is not loaded
> > and
> > > > the file was there before the upgrade.
> > > > During the upgrade process, is any plugin code executed?We already
> have
> > > 25
> > > > people reporting our plugin as not compatible with 3.7 for this and i
> > > > imagine people affected are many more. I can't replicate this
> locally,
> > i
> > > > will add a check to load that file from our plugin dir and not
> > > wp-content i
> > > > can't think of any other way to handle this.
> > > >
> > > > * *
> > > > *Nicola Peluchetti - Senior PHP Developer @ Timely**
> > > > *
> > > > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> > > > Facebook: nicola.peluchetti <
> > https://www.facebook.com/nicola.peluchetti>
> > > > Stackoverflow: Stackoverflow<
> > > > http://stackoverflow.com/users/397861/nicola-peluchetti>
> > > > Mobile: +39 339 7507235
> > > >
> > > >
> > > > On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:
> > > >
> > > > > On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
> > > > > <nicola.peluchetti at gmail.com> wrote:
> > > > > > Hi,
> > > > > >
> > > > > > we received lot's of reports that our plugin is not compatible
> with
> > > 3.7
> > > > > and
> > > > > > many site where brought down. The problem seems to be that
> > wordpress
> > > > 3.7
> > > > > > upgrade deletes ( in some occasions ) a file in a folder we
> create
> > in
> > > > > > wp-content.
> > > > > >
> > > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > > > > >
> > > > > > The file name is event.min.js and we create the folder
> themes-ai1ec
> > > > under
> > > > > > wp-content. Any idea why this might be happening?This doesn't
> seem
> > to
> > > > be
> > > > > > under our control but user are blaming us. If we need to change
> > > > something
> > > > > > to be compatible, we will, but i have no guess now on what to do.
> > > > >
> > > > > While I can't see any particular reason for a file like that to be
> > > > > deleted on an update, this error is coming entirely from your
> plugin.
> > > > >
> > > > > Examine the error message posted in this thread:
> > > > >
> > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
> > > > >
> > > > > If you examine that code, you have this:
> > > > >
> > > > > if( $file_found === false ) {
> > > > > throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
> > > > > doesn't exist." );
> > > > > }
> > > > >
> > > > > That is a pretty horrible thing to do on a production site *if*
> > you're
> > > > > not catching the exception higher up and handling it gracefully. An
> > > > > uncaught exception is a fatal error = Instantly broken site.
> > > > >
> > > > > I would look at all the places you're calling functions that can
> > throw
> > > > > Ai1ec_File_Not_Found and putting catches around them, to handle the
> > > > > situation better.
> > > > >
> > > > > -Otto
> > > > > _______________________________________________
> > > > > wp-hackers mailing list
> > > > > wp-hackers at lists.automattic.com
> > > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > > >
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > >
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From otto at ottodestruct.com  Sun Oct 27 19:11:32 2013
From: otto at ottodestruct.com (Otto)
Date: Sun, 27 Oct 2013 14:11:32 -0500
Subject: [wp-hackers] Upgrading to Wordpress 3.7 is deleting a file from
 our plugin thus breaking a lot's of sites
In-Reply-To: <CAJ7gacrKwzh2JMnDijNz2H_LCgjxuHk6eSh=D8fYLbA9vLdyuQ@mail.gmail.com>
References: <CAJ7gacq1D6YdUmGiY-SQ-hfLqgcRkasJg5pFb2gZ_5PKbgyskw@mail.gmail.com>
 <CAD-Fghx2c6uOeGxQ7eb-is8VtGOwUXLhGPELnuEzPYV9N-X=cA@mail.gmail.com>
 <CAJ7gaco9qa+nL4dkmUyk7YgZVqZ7twrGD-CoiBETOby5=7z05w@mail.gmail.com>
 <CAOqAKWBdHGX80X3vwt3ySPz8An6m3OK0ZM+adJE84Ly5Mpid+w@mail.gmail.com>
 <CAJ7gacpRXV03+NeK-6a=1FzvK3CeAUbgoim_bsaQNe9f0mHC+Q@mail.gmail.com>
 <CAP29Pvh5Skv2FyYbiMXwpXZfmVgKo4Ro72ozk6nabAO4QOqbrw@mail.gmail.com>
 <CAJ7gacrKwzh2JMnDijNz2H_LCgjxuHk6eSh=D8fYLbA9vLdyuQ@mail.gmail.com>
Message-ID: <CAD-Fghw_p7CoZFLmx-XX1Hj7PntdutkrmQV3itKtwdjF_fc6MQ@mail.gmail.com>

You can avoid that entirely just by naming the for-pay plugin
something different and giving it a different Plugin URI. Tack on a
"premium" to the end or something.

Or, better yet, make the for-pay version simply use the free version
and add on the features and such. This is probably the best long-term
strategy. The free plugin can have do_action() and apply_filter()
calls in appropriate places, and the paid version can then be a
separate plugin which uses those hooks to expand and extend the free
code.

-Otto


On Sun, Oct 27, 2013 at 12:42 PM, Nicola Peluchetti
<nicola.peluchetti at gmail.com> wrote:
> Yes it's insane throwing an exception (and not catching it) but we all
> dealt with legacy code. We are rewriting/re-architecturing the pugin right
> now. Looking at some sites i've also finally found where the issue was:
> Wordpress 3.7 Broke our code which we used to prevent updating to
> wordpress.org version.
> So the user of our standard version where prompted to download the version
> on wordpress.org which has a totally different way of serving resources. No
> update of files in wp-content was triggered and for this reason the file
> were not there.
>
> Thanks for the help and the advice.
>
> * *
> *Nicola Peluchetti - Senior PHP Developer @ Timely**
> *
> Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
> Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
> Stackoverflow: Stackoverflow<http://stackoverflow.com/users/397861/nicola-peluchetti>
> Mobile: +39 339 7507235
>
>
> On Sat, Oct 26, 2013 at 5:59 PM, Andrew Nacin <wp at andrewnacin.com> wrote:
>
>> An exception over a missing CSS file? Really? That also means you are
>> running unnecessary systems calls on every page, slowing down sites for no
>> good reason. Rather than wasting effort and CPU cycles on a global
>> exception handler, consider removing this.
>>
>> WordPress doesn't touch wp-content during an update unless it is to copy
>> over a new default theme, so I don't really know what's going on here. I
>> can pretty safely say this is not WordPress core.
>>
>> If you want to understand, start by responding to John. "Potential cause:
>> People running a plugin which forces plugin uninstall routines to run when
>> plugins are disabled? It would help hugely if you can get a list of active
>> plugins on affected sites from users who are experiencing the problem."
>>
>> Nacin
>>
>>
>> On Sat, Oct 26, 2013 at 11:33 AM, Nicola Peluchetti <
>> nicola.peluchetti at gmail.com> wrote:
>>
>> > The fact is that only the event.min.js file seems to be deleted. Not the
>> > whole folder. I released 1.10.4 to address this, basically i fall back to
>> > loading the file from our original folder if the file is missing from
>> > wp-content. Still would like to understand why this is happening.
>> > Version 2.0 will have a global exception/error handler to avoid bringing
>> > down websites and wasting my weekends fixing things :D
>> >
>> > * *
>> > *Nicola Peluchetti - Senior PHP Developer @ Timely**
>> > *
>> > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
>> > Facebook: nicola.peluchetti <https://www.facebook.com/nicola.peluchetti>
>> > Stackoverflow: Stackoverflow<
>> > http://stackoverflow.com/users/397861/nicola-peluchetti>
>> > Mobile: +39 339 7507235
>> >
>> >
>> > On Sat, Oct 26, 2013 at 5:08 PM, John Blackbourn
>> > <johnbillion+wp at gmail.com>wrote:
>> >
>> > > This plugin's `uninstall.php` file deletes the
>> > WP_CONTENT_DIR/themes-ai1ec
>> > > directory when called. It sounds like this plugin's uninstall.php file
>> is
>> > > being called during the upgrade.
>> > >
>> > > Potential cause: People running a plugin which forces plugin uninstall
>> > > routines to run when plugins are disabled?
>> > >
>> > > @Nicola: It would help hugely if you can get a list of active plugins
>> on
>> > > affected sites from users who are experiencing the problem.
>> > >
>> > >
>> > > On 26 October 2013 15:29, Nicola Peluchetti <
>> nicola.peluchetti at gmail.com
>> > > >wrote:
>> > >
>> > > > Hi,
>> > > >
>> > > > sure that's horrible, we will fix that, but the real problem is that
>> > the
>> > > > file is deleted. If we catch the exception still the js is not loaded
>> > and
>> > > > the file was there before the upgrade.
>> > > > During the upgrade process, is any plugin code executed?We already
>> have
>> > > 25
>> > > > people reporting our plugin as not compatible with 3.7 for this and i
>> > > > imagine people affected are many more. I can't replicate this
>> locally,
>> > i
>> > > > will add a check to load that file from our plugin dir and not
>> > > wp-content i
>> > > > can't think of any other way to handle this.
>> > > >
>> > > > * *
>> > > > *Nicola Peluchetti - Senior PHP Developer @ Timely**
>> > > > *
>> > > > Twitter: @nik_peluchetti <https://twitter.com/#!/nik_peluchetti>
>> > > > Facebook: nicola.peluchetti <
>> > https://www.facebook.com/nicola.peluchetti>
>> > > > Stackoverflow: Stackoverflow<
>> > > > http://stackoverflow.com/users/397861/nicola-peluchetti>
>> > > > Mobile: +39 339 7507235
>> > > >
>> > > >
>> > > > On Fri, Oct 25, 2013 at 8:41 PM, Otto <otto at ottodestruct.com> wrote:
>> > > >
>> > > > > On Fri, Oct 25, 2013 at 12:18 PM, Nicola Peluchetti
>> > > > > <nicola.peluchetti at gmail.com> wrote:
>> > > > > > Hi,
>> > > > > >
>> > > > > > we received lot's of reports that our plugin is not compatible
>> with
>> > > 3.7
>> > > > > and
>> > > > > > many site where brought down. The problem seems to be that
>> > wordpress
>> > > > 3.7
>> > > > > > upgrade deletes ( in some occasions ) a file in a folder we
>> create
>> > in
>> > > > > > wp-content.
>> > > > > >
>> > > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
>> > > > > >
>> > > > > > The file name is event.min.js and we create the folder
>> themes-ai1ec
>> > > > under
>> > > > > > wp-content. Any idea why this might be happening?This doesn't
>> seem
>> > to
>> > > > be
>> > > > > > under our control but user are blaming us. If we need to change
>> > > > something
>> > > > > > to be compatible, we will, but i have no guess now on what to do.
>> > > > >
>> > > > > While I can't see any particular reason for a file like that to be
>> > > > > deleted on an update, this error is coming entirely from your
>> plugin.
>> > > > >
>> > > > > Examine the error message posted in this thread:
>> > > > >
>> > http://wordpress.org/support/topic/not-compatible-with-wp-37?replies=8
>> > > > >
>> > > > > If you examine that code, you have this:
>> > > > >
>> > > > > if( $file_found === false ) {
>> > > > > throw new Ai1ec_File_Not_Found( "The specified file '" . $file . "'
>> > > > > doesn't exist." );
>> > > > > }
>> > > > >
>> > > > > That is a pretty horrible thing to do on a production site *if*
>> > you're
>> > > > > not catching the exception higher up and handling it gracefully. An
>> > > > > uncaught exception is a fatal error = Instantly broken site.
>> > > > >
>> > > > > I would look at all the places you're calling functions that can
>> > throw
>> > > > > Ai1ec_File_Not_Found and putting catches around them, to handle the
>> > > > > situation better.
>> > > > >
>> > > > > -Otto
>> > > > > _______________________________________________
>> > > > > wp-hackers mailing list
>> > > > > wp-hackers at lists.automattic.com
>> > > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> > > > >
>> > > > _______________________________________________
>> > > > wp-hackers mailing list
>> > > > wp-hackers at lists.automattic.com
>> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> > > >
>> > > _______________________________________________
>> > > wp-hackers mailing list
>> > > wp-hackers at lists.automattic.com
>> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> > >
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From jdg at codesymphony.co  Sun Oct 27 19:32:38 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Sun, 27 Oct 2013 15:32:38 -0400
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <1382840574969-42641.post@n5.nabble.com>
References: <1382840574969-42641.post@n5.nabble.com>
Message-ID: <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>

Yes, this is possible. A very basic example of how you would handle the request with PHP is here https://github.com/vitalets/x-editable/blob/gh-pages/backend-samples/php/post.php

You will need to fill in the value for pk in your JS, which means you'll need to pull the ID from the database and use wp_localize_script() to pass it on to the JS. Here is an example function (based on this http://wpseek.com/blog/2010/how-to-get-the-meta-id-by-meta-key/80/) to pull the meta id from the database:

function get_user_mid_by_key( $user_id, $meta_key ) {
  global $wpdb;
  $mid = $wpdb->get_var( $wpdb->prepare("SELECT meta_id FROM $wpdb->usermeta WHERE user_id = %d AND meta_key = %s", $user_id, $meta_key) );
  if( $mid != '' )
    return (int)$mid;
 
  return false;
}

Then when the request comes in you can use update_metadata_by_mid() (http://wpseek.com/update_metadata_by_mid/) to update the value in the database.

-J.D.

On Oct 26, 2013, at 10:22 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> Looking to use this jQuery plugin with an update_user_meta option on a
> profile page.  Ex. would be click your location, or mood and it allows for
> inline editing and updating.  It uses a unique ajaxOptions setting that I
> cant seem to get working with wordpress. 
> 
> http://vitalets.github.io/x-editable/index.html
> <http://vitalets.github.io/x-editable/index.html>   - the x-editable plugin
> 
> http://jsfiddle.net/xBB5x/62/ <http://jsfiddle.net/xBB5x/62/>   - JSFiddle
> of x-editable working outside wordpress - but unsure how it would work
> within WP.
> 
> Mostly looking for someone to verify if this would work, and explain how the
> data would be passed (for example the 'pk' field looks for a row in the DB,
> maybe it would be possible to substiture that with something different? 
> That or pk needs to be redefined I think? 
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct 28 16:48:21 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Mon, 28 Oct 2013 09:48:21 -0700 (PDT)
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
Message-ID: <1382978900772-42645.post@n5.nabble.com>

Thanks JD!  with ajaxOptions though, it requests the url, 'ajaxurl' does not
work.  Should i dorectly specify my admin-ajax.php here?  Also there is no
option for action: which is required in WP to reach the function to handle
the ajax call right?  I tried adding that in as well, and it did not
function.  

I could just use a separate .php file for processing, and place the code in
that.  Would that be the best option?





--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42645.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From jdg at codesymphony.co  Mon Oct 28 18:40:47 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 28 Oct 2013 14:40:47 -0400
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <1382978900772-42645.post@n5.nabble.com>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
Message-ID: <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>

Use the ajaxurl as the value for the x-editable url:

jQuery( '#selector' ).editable({
	type: 'text',
	pk: pk,
	url: ajaxurl,
	// etc.
});

I don't know if it will let you pass the action through ajaxOptions.data, but if not you could try appending it to the ajaxurl as a GET query parameter.

-J.D.

On Oct 28, 2013, at 12:48 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> Thanks JD!  with ajaxOptions though, it requests the url, 'ajaxurl' does not
> work.  Should i dorectly specify my admin-ajax.php here?  Also there is no
> option for action: which is required in WP to reach the function to handle
> the ajax call right?  I tried adding that in as well, and it did not
> function.  
> 
> I could just use a separate .php file for processing, and place the code in
> that.  Would that be the best option?
> 
> 
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42645.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct 28 19:49:05 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 28 Oct 2013 12:49:05 -0700
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
Message-ID: <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>

I got the ajaxurl working, but for some reason clicking the <a> only
displays the popup if I am logged out now.  I think I will need to hire
help for this one.  Thank you for your assistance though J.D. you did help.



On Mon, Oct 28, 2013 at 11:40 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Use the ajaxurl as the value for the x-editable url:
>
> jQuery( '#selector' ).editable({
>         type: 'text',
>         pk: pk,
>         url: ajaxurl,
>         // etc.
> });
>
> I don't know if it will let you pass the action through ajaxOptions.data,
> but if not you could try appending it to the ajaxurl as a GET query
> parameter.
>
> -J.D.
>
> On Oct 28, 2013, at 12:48 PM, BenderisGreat <greglancaster71 at gmail.com>
> wrote:
>
> > Thanks JD!  with ajaxOptions though, it requests the url, 'ajaxurl' does
> not
> > work.  Should i dorectly specify my admin-ajax.php here?  Also there is
> no
> > option for action: which is required in WP to reach the function to
> handle
> > the ajax call right?  I tried adding that in as well, and it did not
> > function.
> >
> > I could just use a separate .php file for processing, and place the code
> in
> > that.  Would that be the best option?
> >
> >
> >
> >
> >
> > --
> > View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42645.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct 28 19:53:40 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 28 Oct 2013 15:53:40 -0400
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
Message-ID: <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>

That sounds like a JS conflict. Are you getting any errors in your browsers console?

-J.D.

On Oct 28, 2013, at 3:49 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I got the ajaxurl working, but for some reason clicking the <a> only
> displays the popup if I am logged out now.  I think I will need to hire
> help for this one.  Thank you for your assistance though J.D. you did help.
> 
> 
> 
> On Mon, Oct 28, 2013 at 11:40 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Use the ajaxurl as the value for the x-editable url:
>> 
>> jQuery( '#selector' ).editable({
>>        type: 'text',
>>        pk: pk,
>>        url: ajaxurl,
>>        // etc.
>> });
>> 
>> I don't know if it will let you pass the action through ajaxOptions.data,
>> but if not you could try appending it to the ajaxurl as a GET query
>> parameter.
>> 
>> -J.D.
>> 
>> On Oct 28, 2013, at 12:48 PM, BenderisGreat <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> Thanks JD!  with ajaxOptions though, it requests the url, 'ajaxurl' does
>> not
>>> work.  Should i dorectly specify my admin-ajax.php here?  Also there is
>> no
>>> option for action: which is required in WP to reach the function to
>> handle
>>> the ajax call right?  I tried adding that in as well, and it did not
>>> function.
>>> 
>>> I could just use a separate .php file for processing, and place the code
>> in
>>> that.  Would that be the best option?
>>> 
>>> 
>>> 
>>> 
>>> 
>>> --
>>> View this message in context:
>> http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42645.html
>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct 28 20:04:59 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Mon, 28 Oct 2013 13:04:59 -0700 (PDT)
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
Message-ID: <1382990698993-42649.post@n5.nabble.com>

I checked it with FireBug and got this :

ReferenceError: reference to undefined property x.event.triggered

<http://wordpress-hackers.1065353.n5.nabble.com/file/n42649/Screen_Shot_2013-10-28_at_1.04.12_PM.png> 



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42649.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From greglancaster71 at gmail.com  Mon Oct 28 21:20:55 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Mon, 28 Oct 2013 14:20:55 -0700 (PDT)
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <1382990698993-42649.post@n5.nabble.com>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
 <1382990698993-42649.post@n5.nabble.com>
Message-ID: <1382995255098-42650.post@n5.nabble.com>

I think I see the issue, when I am logged in the head.php gets loaded twice. 
Not sure why exactly though. Is there a way to show all files being loaded
in sequence as they are fired?



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42650.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From banago at gmail.com  Mon Oct 28 21:22:12 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Mon, 28 Oct 2013 22:22:12 +0100
Subject: [wp-hackers] Tax Query Possible Bug
Message-ID: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>

I'm running a tax query and I'm getting no results. From debugging I found
this rather interesting result:

> [request] => SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts  WHERE 1=1  AND 0 = 1 AND wp_posts.post_type ...
>
> Interestin Part => ... WHERE 1=1  AND 0 = 1 ...

Is this a normal behaviour?

PS: I use the same exact code somewhere else in the site and it works fine.
In this case I'm using this code inside a function in function.php.

Kindly,

Baki Goxhaj
about.me/banago

From jdg at codesymphony.co  Mon Oct 28 21:25:35 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 28 Oct 2013 17:25:35 -0400
Subject: [wp-hackers] Tax Query Possible Bug
In-Reply-To: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>
References: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>
Message-ID: <05639EA2-3407-4862-B9AA-E254CDECEF93@codesymphony.co>

Yes, I think this is normal, though it is confusing to lots of developers. The ?AND 0=1? is automatically added when a query shouldn?t return any results - at least that is what I remember Nacin saying somewhere, I think.

-J.D.

On Oct 28, 2013, at 5:22 PM, Baki Goxhaj <banago at gmail.com> wrote:

> I'm running a tax query and I'm getting no results. From debugging I found
> this rather interesting result:
> 
>> [request] => SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts  WHERE 1=1  AND 0 = 1 AND wp_posts.post_type ...
>> 
>> Interestin Part => ... WHERE 1=1  AND 0 = 1 ...
> 
> Is this a normal behaviour?
> 
> PS: I use the same exact code somewhere else in the site and it works fine.
> In this case I'm using this code inside a function in function.php.
> 
> Kindly,
> 
> Baki Goxhaj
> about.me/banago
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jdg at codesymphony.co  Mon Oct 28 21:26:46 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 28 Oct 2013 17:26:46 -0400
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <1382995255098-42650.post@n5.nabble.com>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
 <1382990698993-42649.post@n5.nabble.com>
 <1382995255098-42650.post@n5.nabble.com>
Message-ID: <B0FE663B-57A0-4293-9599-3336C6DC995F@codesymphony.co>

You could add a debug_print_backtrace() in head.php. That will print the stack for each inclusion.

-J.D.

On Oct 28, 2013, at 5:20 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> I think I see the issue, when I am logged in the head.php gets loaded twice. 
> Not sure why exactly though. Is there a way to show all files being loaded
> in sequence as they are fired?
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42650.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct 28 21:40:51 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 28 Oct 2013 14:40:51 -0700
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <B0FE663B-57A0-4293-9599-3336C6DC995F@codesymphony.co>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
 <1382990698993-42649.post@n5.nabble.com>
 <1382995255098-42650.post@n5.nabble.com>
 <B0FE663B-57A0-4293-9599-3336C6DC995F@codesymphony.co>
Message-ID: <CAPN-N+Z96zrSmEfL+Qmbpc1RBpMtvuqJnzvusK1ETRmNYXqmSA@mail.gmail.com>

Damn that was incredibily useful, thanks man.  I fixed the double headers
but unfortunately this still wont work unless I am logged out.  I found the
culprit though, the same block of code that was an issue previously:

 */
function themeblvd_redirect_admin(){
if ( ! current_user_can( 'edit_posts' ) && (! defined('DOING_AJAX') || !
DOING_AJAX ) ){
wp_redirect( site_url() );
exit;
}
}
add_action( 'admin_init', 'themeblvd_redirect_admin' );

commenting out that block fixed it.   What do I need to add to this so I
can still block wp-admin access but keep the ajax call working?  Add a
jQuery exception as well?


On Mon, Oct 28, 2013 at 2:26 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> You could add a debug_print_backtrace() in head.php. That will print the
> stack for each inclusion.
>
> -J.D.
>
> On Oct 28, 2013, at 5:20 PM, BenderisGreat <greglancaster71 at gmail.com>
> wrote:
>
> > I think I see the issue, when I am logged in the head.php gets loaded
> twice.
> > Not sure why exactly though. Is there a way to show all files being
> loaded
> > in sequence as they are fired?
> >
> >
> >
> > --
> > View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42650.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From nikolov.tmw at gmail.com  Mon Oct 28 21:57:30 2013
From: nikolov.tmw at gmail.com (Nikola Nikolov)
Date: Mon, 28 Oct 2013 23:57:30 +0200
Subject: [wp-hackers] Tax Query Possible Bug
In-Reply-To: <05639EA2-3407-4862-B9AA-E254CDECEF93@codesymphony.co>
References: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>
 <05639EA2-3407-4862-B9AA-E254CDECEF93@codesymphony.co>
Message-ID: <CAOwx47fP0VM2dW0RrFvoqqUJKXLVG+qo9PmFgNgCxxRwmwbpkw@mail.gmail.com>

Are you by any chance trying to run the query before the init hook(or on a
priority before the priority on which your taxonomies are registered) is
run?

That's usually the cause of taxonomy-related issues.


On Mon, Oct 28, 2013 at 11:25 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, I think this is normal, though it is confusing to lots of developers.
> The ?AND 0=1? is automatically added when a query shouldn?t return any
> results - at least that is what I remember Nacin saying somewhere, I think.
>
> -J.D.
>
> On Oct 28, 2013, at 5:22 PM, Baki Goxhaj <banago at gmail.com> wrote:
>
> > I'm running a tax query and I'm getting no results. From debugging I
> found
> > this rather interesting result:
> >
> >> [request] => SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts
>  WHERE 1=1  AND 0 = 1 AND wp_posts.post_type ...
> >>
> >> Interestin Part => ... WHERE 1=1  AND 0 = 1 ...
> >
> > Is this a normal behaviour?
> >
> > PS: I use the same exact code somewhere else in the site and it works
> fine.
> > In this case I'm using this code inside a function in function.php.
> >
> > Kindly,
> >
> > Baki Goxhaj
> > about.me/banago
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Mon Oct 28 21:57:21 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Mon, 28 Oct 2013 17:57:21 -0400
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <CAPN-N+Z96zrSmEfL+Qmbpc1RBpMtvuqJnzvusK1ETRmNYXqmSA@mail.gmail.com>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
 <1382990698993-42649.post@n5.nabble.com>
 <1382995255098-42650.post@n5.nabble.com>
 <B0FE663B-57A0-4293-9599-3336C6DC995F@codesymphony.co>
 <CAPN-N+Z96zrSmEfL+Qmbpc1RBpMtvuqJnzvusK1ETRmNYXqmSA@mail.gmail.com>
Message-ID: <3BA49FEF-711A-483A-9DC7-E186BBAEBF99@codesymphony.co>

That really doesn?t make sense. Is this code you pasted an exact copy of the code in your theme?

On Oct 28, 2013, at 5:40 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> Damn that was incredibily useful, thanks man.  I fixed the double headers
> but unfortunately this still wont work unless I am logged out.  I found the
> culprit though, the same block of code that was an issue previously:
> 
> */
> function themeblvd_redirect_admin(){
> if ( ! current_user_can( 'edit_posts' ) && (! defined('DOING_AJAX') || !
> DOING_AJAX ) ){
> wp_redirect( site_url() );
> exit;
> }
> }
> add_action( 'admin_init', 'themeblvd_redirect_admin' );
> 
> commenting out that block fixed it.   What do I need to add to this so I
> can still block wp-admin access but keep the ajax call working?  Add a
> jQuery exception as well?
> 
> 
> On Mon, Oct 28, 2013 at 2:26 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> You could add a debug_print_backtrace() in head.php. That will print the
>> stack for each inclusion.
>> 
>> -J.D.
>> 
>> On Oct 28, 2013, at 5:20 PM, BenderisGreat <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> I think I see the issue, when I am logged in the head.php gets loaded
>> twice.
>>> Not sure why exactly though. Is there a way to show all files being
>> loaded
>>> in sequence as they are fired?
>>> 
>>> 
>>> 
>>> --
>>> View this message in context:
>> http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42650.html
>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Mon Oct 28 22:45:19 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Mon, 28 Oct 2013 15:45:19 -0700
Subject: [wp-hackers] jQuery x-editable with update_user_meta?
In-Reply-To: <3BA49FEF-711A-483A-9DC7-E186BBAEBF99@codesymphony.co>
References: <1382840574969-42641.post@n5.nabble.com>
 <585A600C-D23D-4A74-A3D3-5D9164ABEB2C@codesymphony.co>
 <1382978900772-42645.post@n5.nabble.com>
 <33F20281-349D-4FC4-AAC1-9D19641A7628@codesymphony.co>
 <CAPN-N+ZxJjPW3Xq2QWFdq6wUXE8VamFrE9pEB3tH7Me-Z0f9Cg@mail.gmail.com>
 <ADDB37FD-167A-4BB6-8526-39E47D49B6C0@codesymphony.co>
 <1382990698993-42649.post@n5.nabble.com>
 <1382995255098-42650.post@n5.nabble.com>
 <B0FE663B-57A0-4293-9599-3336C6DC995F@codesymphony.co>
 <CAPN-N+Z96zrSmEfL+Qmbpc1RBpMtvuqJnzvusK1ETRmNYXqmSA@mail.gmail.com>
 <3BA49FEF-711A-483A-9DC7-E186BBAEBF99@codesymphony.co>
Message-ID: <CAPN-N+a94HurEtCcy788oSB-5zsExmJYm-fPxTVd09zrHMB=mg@mail.gmail.com>

Yea you're right, realized it right after I posted.  I logged out, which
fixed the issue.  I have no idea what is causing this.  :-/  Ill post on
github and maybe someone can target the issue.  Its def odd though, that it
only works when logged out.  I compared the loaded html side by side with a
coparison tool and they are nearly identical.


On Mon, Oct 28, 2013 at 2:57 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> That really doesn?t make sense. Is this code you pasted an exact copy of
> the code in your theme?
>
> On Oct 28, 2013, at 5:40 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > Damn that was incredibily useful, thanks man.  I fixed the double headers
> > but unfortunately this still wont work unless I am logged out.  I found
> the
> > culprit though, the same block of code that was an issue previously:
> >
> > */
> > function themeblvd_redirect_admin(){
> > if ( ! current_user_can( 'edit_posts' ) && (! defined('DOING_AJAX') || !
> > DOING_AJAX ) ){
> > wp_redirect( site_url() );
> > exit;
> > }
> > }
> > add_action( 'admin_init', 'themeblvd_redirect_admin' );
> >
> > commenting out that block fixed it.   What do I need to add to this so I
> > can still block wp-admin access but keep the ajax call working?  Add a
> > jQuery exception as well?
> >
> >
> > On Mon, Oct 28, 2013 at 2:26 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> You could add a debug_print_backtrace() in head.php. That will print the
> >> stack for each inclusion.
> >>
> >> -J.D.
> >>
> >> On Oct 28, 2013, at 5:20 PM, BenderisGreat <greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> I think I see the issue, when I am logged in the head.php gets loaded
> >> twice.
> >>> Not sure why exactly though. Is there a way to show all files being
> >> loaded
> >>> in sequence as they are fired?
> >>>
> >>>
> >>>
> >>> --
> >>> View this message in context:
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/jQuery-x-editable-with-update-user-meta-tp42641p42650.html
> >>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From gabo.acosta624 at gmail.com  Mon Oct 28 23:43:40 2013
From: gabo.acosta624 at gmail.com (Gabriel Acosta)
Date: Mon, 28 Oct 2013 16:43:40 -0700
Subject: [wp-hackers] XML-RPC add Category filter
Message-ID: <CA+69t5m6yc=Uy3gCGar+_cwiL3_2zcm=3kEw3ofghA-iokDWHg@mail.gmail.com>

Hello, I'm new to Wordpress development but experienced in PHP, I just made
a very tiny change to the Wordpress XML RPC server to fit my needs and I
think other people might benefit from it, so let me explain.

I intend to use wordpress' admin panel to create posts in a blog but I'm
displaying this posts in a site developed with Laravel Framework and
AngularJS since it fits the purpose of my client, so I'm setting a
wordpress in a subdomain and making RPC calls and that way I don't have to
interact with the site DataBase (My Boss' requirement fo course) anyway I
needed to filter the posts by category but I noticed that it is not
implemented so I made the following changes to Wordpress 3.7:

In the file: wordpress/wp-includes/class-wp-xmlrpc-server.php
On lines 1406 to 1420 it declares the filters to get a post, all I needed
to add was:

if ( isset( $filter['category'] ) )
            $query['category'] = $filter['category'];

And since it calls wp_get_recent_posts function which already supports that
key of the arguments list now I can filter my posts by category, I really
hope this helps anyone trying to solve this problem and maybe if it's ok
with the developers this change can be made to the official wordpress
source (hopefully that way I won't have to remember it either :P)

From banago at gmail.com  Mon Oct 28 23:48:57 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Tue, 29 Oct 2013 00:48:57 +0100
Subject: [wp-hackers] Tax Query Possible Bug
In-Reply-To: <CAOwx47fP0VM2dW0RrFvoqqUJKXLVG+qo9PmFgNgCxxRwmwbpkw@mail.gmail.com>
References: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>
 <05639EA2-3407-4862-B9AA-E254CDECEF93@codesymphony.co>
 <CAOwx47fP0VM2dW0RrFvoqqUJKXLVG+qo9PmFgNgCxxRwmwbpkw@mail.gmail.com>
Message-ID: <CAM_fM0qf_GvOjbCwTQjEhJE5O3BzubCZvK4g2kBg3YssSbOO1w@mail.gmail.com>

Nikola, that might be the issue. Will try tomorrow and update the thread.
Thanks for the heads up.

Kindly,

Baki Goxhaj
about.me/banago


On Mon, Oct 28, 2013 at 10:57 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:

> Are you by any chance trying to run the query before the init hook(or on a
> priority before the priority on which your taxonomies are registered) is
> run?
>
> That's usually the cause of taxonomy-related issues.
>
>
> On Mon, Oct 28, 2013 at 11:25 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
> > Yes, I think this is normal, though it is confusing to lots of
> developers.
> > The ?AND 0=1? is automatically added when a query shouldn?t return any
> > results - at least that is what I remember Nacin saying somewhere, I
> think.
> >
> > -J.D.
> >
> > On Oct 28, 2013, at 5:22 PM, Baki Goxhaj <banago at gmail.com> wrote:
> >
> > > I'm running a tax query and I'm getting no results. From debugging I
> > found
> > > this rather interesting result:
> > >
> > >> [request] => SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts
> >  WHERE 1=1  AND 0 = 1 AND wp_posts.post_type ...
> > >>
> > >> Interestin Part => ... WHERE 1=1  AND 0 = 1 ...
> > >
> > > Is this a normal behaviour?
> > >
> > > PS: I use the same exact code somewhere else in the site and it works
> > fine.
> > > In this case I'm using this code inside a function in function.php.
> > >
> > > Kindly,
> > >
> > > Baki Goxhaj
> > > about.me/banago
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From mailing at markoheijnen.nl  Tue Oct 29 00:05:28 2013
From: mailing at markoheijnen.nl (Marko Heijnen)
Date: Tue, 29 Oct 2013 01:05:28 +0100
Subject: [wp-hackers] XML-RPC add Category filter
In-Reply-To: <CA+69t5m6yc=Uy3gCGar+_cwiL3_2zcm=3kEw3ofghA-iokDWHg@mail.gmail.com>
References: <CA+69t5m6yc=Uy3gCGar+_cwiL3_2zcm=3kEw3ofghA-iokDWHg@mail.gmail.com>
Message-ID: <29943654-6AE8-4D63-B822-68D9E49CBC10@markoheijnen.nl>

Hey Gabriel,

There are a few tickets on http://core.trac.wordpress.org/query?status=accepted&status=assigned&status=new&status=reopened&status=reviewing&component=XML-RPC&col=id&col=summary&col=status&col=type&col=priority&col=milestone&col=component&order=priority about better filter option for wp.getPosts.
In this case http://core.trac.wordpress.org/ticket/22540 in particular.

I guess what you should have done is overwriting the method to have this or even better create a custom one from scratch that only returns the information you need.

Marko



Op 29 okt. 2013, om 00:43 heeft Gabriel Acosta <gabo.acosta624 at gmail.com> het volgende geschreven:

> Hello, I'm new to Wordpress development but experienced in PHP, I just made
> a very tiny change to the Wordpress XML RPC server to fit my needs and I
> think other people might benefit from it, so let me explain.
> 
> I intend to use wordpress' admin panel to create posts in a blog but I'm
> displaying this posts in a site developed with Laravel Framework and
> AngularJS since it fits the purpose of my client, so I'm setting a
> wordpress in a subdomain and making RPC calls and that way I don't have to
> interact with the site DataBase (My Boss' requirement fo course) anyway I
> needed to filter the posts by category but I noticed that it is not
> implemented so I made the following changes to Wordpress 3.7:
> 
> In the file: wordpress/wp-includes/class-wp-xmlrpc-server.php
> On lines 1406 to 1420 it declares the filters to get a post, all I needed
> to add was:
> 
> if ( isset( $filter['category'] ) )
>            $query['category'] = $filter['category'];
> 
> And since it calls wp_get_recent_posts function which already supports that
> key of the arguments list now I can filter my posts by category, I really
> hope this helps anyone trying to solve this problem and maybe if it's ok
> with the developers this change can be made to the official wordpress
> source (hopefully that way I won't have to remember it either :P)
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From banago at gmail.com  Tue Oct 29 09:54:16 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Tue, 29 Oct 2013 10:54:16 +0100
Subject: [wp-hackers] Tax Query Possible Bug
In-Reply-To: <CAM_fM0qf_GvOjbCwTQjEhJE5O3BzubCZvK4g2kBg3YssSbOO1w@mail.gmail.com>
References: <CAM_fM0rHGH=2-yMEQuU=Pd7FvFV5Uv7mpb=S22tRJ9x+beUEVQ@mail.gmail.com>
 <05639EA2-3407-4862-B9AA-E254CDECEF93@codesymphony.co>
 <CAOwx47fP0VM2dW0RrFvoqqUJKXLVG+qo9PmFgNgCxxRwmwbpkw@mail.gmail.com>
 <CAM_fM0qf_GvOjbCwTQjEhJE5O3BzubCZvK4g2kBg3YssSbOO1w@mail.gmail.com>
Message-ID: <CAM_fM0rTCDArsdmCjafdqJqn2VoPm-p1u9KOi6St_pRVxCGJRQ@mail.gmail.com>

Worked after running the function on the "init" hook. Thanks Nikola.

Kindly,

Baki Goxhaj
about.me/banago


On Tue, Oct 29, 2013 at 12:48 AM, Baki Goxhaj <banago at gmail.com> wrote:

> Nikola, that might be the issue. Will try tomorrow and update the thread.
> Thanks for the heads up.
>
> Kindly,
>
> Baki Goxhaj
> about.me/banago
>
>
> On Mon, Oct 28, 2013 at 10:57 PM, Nikola Nikolov <nikolov.tmw at gmail.com>wrote:
>
>> Are you by any chance trying to run the query before the init hook(or on a
>> priority before the priority on which your taxonomies are registered) is
>> run?
>>
>> That's usually the cause of taxonomy-related issues.
>>
>>
>> On Mon, Oct 28, 2013 at 11:25 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>
>> > Yes, I think this is normal, though it is confusing to lots of
>> developers.
>> > The ?AND 0=1? is automatically added when a query shouldn?t return any
>> > results - at least that is what I remember Nacin saying somewhere, I
>> think.
>> >
>> > -J.D.
>> >
>> > On Oct 28, 2013, at 5:22 PM, Baki Goxhaj <banago at gmail.com> wrote:
>> >
>> > > I'm running a tax query and I'm getting no results. From debugging I
>> > found
>> > > this rather interesting result:
>> > >
>> > >> [request] => SELECT SQL_CALC_FOUND_ROWS  wp_posts.ID FROM wp_posts
>> >  WHERE 1=1  AND 0 = 1 AND wp_posts.post_type ...
>> > >>
>> > >> Interestin Part => ... WHERE 1=1  AND 0 = 1 ...
>> > >
>> > > Is this a normal behaviour?
>> > >
>> > > PS: I use the same exact code somewhere else in the site and it works
>> > fine.
>> > > In this case I'm using this code inside a function in function.php.
>> > >
>> > > Kindly,
>> > >
>> > > Baki Goxhaj
>> > > about.me/banago
>> > > _______________________________________________
>> > > wp-hackers mailing list
>> > > wp-hackers at lists.automattic.com
>> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

From greglancaster71 at gmail.com  Tue Oct 29 11:32:20 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Tue, 29 Oct 2013 04:32:20 -0700 (PDT)
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
Message-ID: <1383046340546-42662.post@n5.nabble.com>

Creating a basic activity feed for users. First wrote a simple function that
takes args as user_id, activity_type, and source_page.  Here is the
function:

/function activity_tracker($user_id, $activity_type, $source_id ) {
global $wpdb, $current_user;
      get_currentuserinfo();

	$time = current_time('mysql');

	$wpdb->insert( 'wp_jo_activity_feed', array( 
	'user_id' => $current_user->ID, 
	'activity_type' => $activity_type, 
	'source_id' => $source_id, 
	'time' => $time
	));
	/

Simple enough, then I drop this function call all over the place: 

/	$runme = activity_tracker($_current_member->ID, 'update_info', 'prof');/

So everytime someone submits a form, or deletes an entry, or changes profile
information, friends another user, likes a post, etc... they each have a
specific activity name (that I enter manually) and is logged this way.

Then, I query the DB to show the most recent 10-50 activities, on the
activity feed page, like so:

/        <?php //activity call
	$activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id ASC');
		$i = 0;
	$limit = 15;
	$count = count($activity_calls);
	while ($i < $limit && $i < $count) 
	{
	$row = $activity_calls[$i];
	$get_row_user_id = $row->user_id;
	$convert_name = get_userdata( $get_row_user_id ); 
	$time = $row->time;
	
	if ($row->activity_type == 'new_record') {
		
		$message = ' created a new log entry at '; 
		$points = '+10';} elseif 
		
		( $row->activity_type == 'deleted_record') {
		
		$message = ' deleted an existing log entry at ';
		$points = 0; } else {
		
		$message = ' updated his profile information at ';
		$points = 5; }
	
	echo '<li class="list-group-item">'.$points.''.$convert_name->user_login.
$message .$time. '</li>';
		++$i; }
		?>
        </ul>
};/

You get the idea, it's obviously very simple - but it's also VERY DB
intensive (is that the correct terminology?).  I am making a ton of DB
calls, which isnt a problem yet, but I would like to know if anyone has a
more efficient method to achieve the same result.  

Additionally, for the message being returned in the activity feed, I am
using if, elseif, and else statements, which limits me.  I would prefer to
have a more streamlined way to return the message.  If I were to write a
function that selected the response based on the activity_type entered- what
would something like that look like?  

Before it's recommended, I am aware buddypress is an option for activity
feeds.  I want to do this so I can learn more, and create something unique
for myself.  



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/A-Basic-Activity-Feed-Is-This-Efficient-tp42662.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From abdussamad at abdussamad.com  Tue Oct 29 11:53:49 2013
From: abdussamad at abdussamad.com (Abdussamad Abdurrazzaq)
Date: Tue, 29 Oct 2013 16:53:49 +0500
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <1383046340546-42662.post@n5.nabble.com>
References: <1383046340546-42662.post@n5.nabble.com>
Message-ID: <526FA1CD.2090207@abdussamad.com>

Use $wpdb->prefix in activity_tracker as well

I hope you've sanitized authorid in that select query. You should stick 
author id in quotes.

A function to return message based on activity would look like this:

function activity_message( $activity_id ) {
	//map activity ids to messages here.
	$activity_messages = array( 	'update_something' => __( 'Updated 
something' ),	
							'deleted_something' => __( 'Deleted something' )
					);
	if( array_key_exists( $activity_id, $activity_messages ) ){
		return $activity_messages[ $activity_id ];
	} else {
		return __( 'Unknown activity' );
	}
}


On 10/29/2013 04:32 PM, BenderisGreat wrote:
> Creating a basic activity feed for users. First wrote a simple function that
> takes args as user_id, activity_type, and source_page.  Here is the
> function:
>
> /function activity_tracker($user_id, $activity_type, $source_id ) {
> global $wpdb, $current_user;
>        get_currentuserinfo();
>
> 	$time = current_time('mysql');
>
> 	$wpdb->insert( 'wp_jo_activity_feed', array(
> 	'user_id' => $current_user->ID,
> 	'activity_type' => $activity_type,
> 	'source_id' => $source_id,
> 	'time' => $time
> 	));
> 	/
>
> Simple enough, then I drop this function call all over the place:
>
> /	$runme = activity_tracker($_current_member->ID, 'update_info', 'prof');/
>
> So everytime someone submits a form, or deletes an entry, or changes profile
> information, friends another user, likes a post, etc... they each have a
> specific activity name (that I enter manually) and is logged this way.
>
> Then, I query the DB to show the most recent 10-50 activities, on the
> activity feed page, like so:
>
> /        <?php //activity call
> 	$activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id ASC');
> 		$i = 0;
> 	$limit = 15;
> 	$count = count($activity_calls);
> 	while ($i < $limit && $i < $count)
> 	{
> 	$row = $activity_calls[$i];
> 	$get_row_user_id = $row->user_id;
> 	$convert_name = get_userdata( $get_row_user_id );
> 	$time = $row->time;
> 	
> 	if ($row->activity_type == 'new_record') {
> 		
> 		$message = ' created a new log entry at ';
> 		$points = '+10';} elseif
> 		
> 		( $row->activity_type == 'deleted_record') {
> 		
> 		$message = ' deleted an existing log entry at ';
> 		$points = 0; } else {
> 		
> 		$message = ' updated his profile information at ';
> 		$points = 5; }
> 	
> 	echo '<li class="list-group-item">'.$points.''.$convert_name->user_login.
> $message .$time. '</li>';
> 		++$i; }
> 		?>
>          </ul>
> };/
>
> You get the idea, it's obviously very simple - but it's also VERY DB
> intensive (is that the correct terminology?).  I am making a ton of DB
> calls, which isnt a problem yet, but I would like to know if anyone has a
> more efficient method to achieve the same result.
>
> Additionally, for the message being returned in the activity feed, I am
> using if, elseif, and else statements, which limits me.  I would prefer to
> have a more streamlined way to return the message.  If I were to write a
> function that selected the response based on the activity_type entered- what
> would something like that look like?
>
> Before it's recommended, I am aware buddypress is an option for activity
> feeds.  I want to do this so I can learn more, and create something unique
> for myself.
>
>
>
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/A-Basic-Activity-Feed-Is-This-Efficient-tp42662.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Tue Oct 29 12:34:23 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Tue, 29 Oct 2013 08:34:23 -0400
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <1383046340546-42662.post@n5.nabble.com>
References: <1383046340546-42662.post@n5.nabble.com>
Message-ID: <4264B50E-3D7B-48D3-ABD8-CB69F13F085C@codesymphony.co>

This right here is open to sql injection, as Abdussamad pointed out:

> $activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id ASC');

You should be using $wpdb->prepare():

$activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' . $wpdb->prefix .
'jo_activity_feed WHERE user_id = %d ORDER BY id ASC', $author_id ) );

-J.D.

From jdg at codesymphony.co  Tue Oct 29 12:54:11 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Tue, 29 Oct 2013 08:54:11 -0400
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <4264B50E-3D7B-48D3-ABD8-CB69F13F085C@codesymphony.co>
References: <1383046340546-42662.post@n5.nabble.com>
 <4264B50E-3D7B-48D3-ABD8-CB69F13F085C@codesymphony.co>
Message-ID: <4A86C38E-365D-44E4-9BDB-02C50E17D793@codesymphony.co>

Any activity feed will require a lot of database queries, and yours probably requires less than BuddyPress?s. I would suggest that you put the limit directly in the SQL query. Right now you are pulling more entries from the DB than you need. So:

$activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' . $wpdb->prefix .
'jo_activity_feed WHERE user_id = %d ORDER BY id ASC LIMIT %d', $author_id, $limit ) );

Abdussamad?s solution for the activity message is good. Just FYI, you could also have used a switch statement:

	switch ( $row->activity_type ) {

		case ?new_record?:
			$message = //?
			$points = //?
		break;

		case ?deleted_record?:
			//...
	}

But his solution is better.

-J.D.

On Oct 29, 2013, at 8:34 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> This right here is open to sql injection, as Abdussamad pointed out:
> 
>> $activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
>> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id ASC');
> 
> You should be using $wpdb->prepare():
> 
> $activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' . $wpdb->prefix .
> 'jo_activity_feed WHERE user_id = %d ORDER BY id ASC', $author_id ) );
> 
> -J.D.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jer at simianuprising.com  Tue Oct 29 14:04:06 2013
From: jer at simianuprising.com (Jeremy Clarke)
Date: Tue, 29 Oct 2013 10:04:06 -0400
Subject: [wp-hackers] Custom Post Type URL Rewrite
In-Reply-To: <4EA8C8EB6EB24920BCC77BE36E490345@gmail.com>
References: <4EA8C8EB6EB24920BCC77BE36E490345@gmail.com>
Message-ID: <CAAHgzDPMw2-evbbo06K_RQrv-EwttbsJKU-LWfA=Gm6sEb8rmA@mail.gmail.com>

On Tuesday, October 22, 2013, AJ Morris wrote:

> It seems the only way I could get this to work is to create a page, and
> assign it a special template in which I have a custom query on it.
> Does that make sense? Is there a better way to go about it?
>
>
I've found that almost all instances where page templates seem needed can
be solved much more effectively with a custom shortcode:

 http://codex.wordpress.org/Shortcode_API

Shortcodes are theme independent (put it in a tiny plugin with your other
related code) and you don't have to worry about duplicating templates.

Jeremy Clarke | jeremyclarke.org


-- 
Jeremy Clarke
Code and Design ? globalvoicesonline.org

From banago at gmail.com  Tue Oct 29 17:41:22 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Tue, 29 Oct 2013 18:41:22 +0100
Subject: [wp-hackers] WordPress & Composer
Message-ID: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>

Hi guys,

Any plan where WordPress meets Composer?

I found a WordPress fork that puts the whole WordPress a single package:
https://github.com/cesarhdz/ixa-wordpress-core

Kindly,

Baki Goxhaj
about.me/banago

From sabreuse at gmail.com  Tue Oct 29 17:44:25 2013
From: sabreuse at gmail.com (Amy Hendrix)
Date: Tue, 29 Oct 2013 13:44:25 -0400
Subject: [wp-hackers] WordPress & Composer
In-Reply-To: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>
References: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>
Message-ID: <CAKnJ9+xUVCwO+H2gMTU+f1qwgw6-iL=+PR8FcsONNuqN7a58WQ@mail.gmail.com>

You can find the discussion about integrating Composer with core here:
http://core.trac.wordpress.org/ticket/23912


On Tue, Oct 29, 2013 at 1:41 PM, Baki Goxhaj <banago at gmail.com> wrote:
> Hi guys,
>
> Any plan where WordPress meets Composer?
>
> I found a WordPress fork that puts the whole WordPress a single package:
> https://github.com/cesarhdz/ixa-wordpress-core
>
> Kindly,
>
> Baki Goxhaj
> about.me/banago
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers

From banago at gmail.com  Tue Oct 29 17:52:58 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Tue, 29 Oct 2013 18:52:58 +0100
Subject: [wp-hackers] WordPress & Composer
In-Reply-To: <CAKnJ9+xUVCwO+H2gMTU+f1qwgw6-iL=+PR8FcsONNuqN7a58WQ@mail.gmail.com>
References: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>
 <CAKnJ9+xUVCwO+H2gMTU+f1qwgw6-iL=+PR8FcsONNuqN7a58WQ@mail.gmail.com>
Message-ID: <CAM_fM0pvh4Y82vF+O4Ri+qY9ZvF3NmA_Sc+xrBAhKs6zqkPy6Q@mail.gmail.com>

Thanks Amy.

Kindly,

Baki Goxhaj
about.me/banago


On Tue, Oct 29, 2013 at 6:44 PM, Amy Hendrix <sabreuse at gmail.com> wrote:

> You can find the discussion about integrating Composer with core here:
> http://core.trac.wordpress.org/ticket/23912
>
>
> On Tue, Oct 29, 2013 at 1:41 PM, Baki Goxhaj <banago at gmail.com> wrote:
> > Hi guys,
> >
> > Any plan where WordPress meets Composer?
> >
> > I found a WordPress fork that puts the whole WordPress a single package:
> > https://github.com/cesarhdz/ixa-wordpress-core
> >
> > Kindly,
> >
> > Baki Goxhaj
> > about.me/banago
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Tue Oct 29 18:57:18 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Tue, 29 Oct 2013 11:57:18 -0700
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <526FA1CD.2090207@abdussamad.com>
References: <1383046340546-42662.post@n5.nabble.com>
 <526FA1CD.2090207@abdussamad.com>
Message-ID: <CAPN-N+Yc+ynVPqSLE2F8S37YpL4JQzSZsKt7pfy0FUNbpLe2Lw@mail.gmail.com>

Abdussamad - thank you for the array message idea, I didnt think of that.
:)  I also added sanitation.   So I guess this is how activity feeds are
done?  I thought I this was the poorrmans activity feed.


On Tue, Oct 29, 2013 at 4:53 AM, Abdussamad Abdurrazzaq <
abdussamad at abdussamad.com> wrote:

> Use $wpdb->prefix in activity_tracker as well
>
> I hope you've sanitized authorid in that select query. You should stick
> author id in quotes.
>
> A function to return message based on activity would look like this:
>
> function activity_message( $activity_id ) {
>         //map activity ids to messages here.
>         $activity_messages = array(     'update_something' => __( 'Updated
> something' ),
>
> 'deleted_something' => __( 'Deleted something' )
>                                         );
>         if( array_key_exists( $activity_id, $activity_messages ) ){
>                 return $activity_messages[ $activity_id ];
>         } else {
>                 return __( 'Unknown activity' );
>
>         }
> }
>
>
> On 10/29/2013 04:32 PM, BenderisGreat wrote:
>
>> Creating a basic activity feed for users. First wrote a simple function
>> that
>> takes args as user_id, activity_type, and source_page.  Here is the
>> function:
>>
>> /function activity_tracker($user_id, $activity_type, $source_id ) {
>> global $wpdb, $current_user;
>>        get_currentuserinfo();
>>
>>         $time = current_time('mysql');
>>
>>         $wpdb->insert( 'wp_jo_activity_feed', array(
>>         'user_id' => $current_user->ID,
>>         'activity_type' => $activity_type,
>>         'source_id' => $source_id,
>>         'time' => $time
>>         ));
>>         /
>>
>> Simple enough, then I drop this function call all over the place:
>>
>> /       $runme = activity_tracker($_current_**member->ID, 'update_info',
>> 'prof');/
>>
>> So everytime someone submits a form, or deletes an entry, or changes
>> profile
>> information, friends another user, likes a post, etc... they each have a
>> specific activity name (that I enter manually) and is logged this way.
>>
>> Then, I query the DB to show the most recent 10-50 activities, on the
>> activity feed page, like so:
>>
>> /        <?php //activity call
>>         $activity_calls = $wpdb->get_results('SELECT * FROM ' .
>> $wpdb->prefix .
>> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id ASC');
>>                 $i = 0;
>>         $limit = 15;
>>         $count = count($activity_calls);
>>         while ($i < $limit && $i < $count)
>>         {
>>         $row = $activity_calls[$i];
>>         $get_row_user_id = $row->user_id;
>>         $convert_name = get_userdata( $get_row_user_id );
>>         $time = $row->time;
>>
>>         if ($row->activity_type == 'new_record') {
>>
>>                 $message = ' created a new log entry at ';
>>                 $points = '+10';} elseif
>>
>>                 ( $row->activity_type == 'deleted_record') {
>>
>>                 $message = ' deleted an existing log entry at ';
>>                 $points = 0; } else {
>>
>>                 $message = ' updated his profile information at ';
>>                 $points = 5; }
>>
>>         echo '<li class="list-group-item">'.$**
>> points.''.$convert_name->user_**login.
>> $message .$time. '</li>';
>>                 ++$i; }
>>                 ?>
>>          </ul>
>> };/
>>
>> You get the idea, it's obviously very simple - but it's also VERY DB
>> intensive (is that the correct terminology?).  I am making a ton of DB
>> calls, which isnt a problem yet, but I would like to know if anyone has a
>> more efficient method to achieve the same result.
>>
>> Additionally, for the message being returned in the activity feed, I am
>> using if, elseif, and else statements, which limits me.  I would prefer to
>> have a more streamlined way to return the message.  If I were to write a
>> function that selected the response based on the activity_type entered-
>> what
>> would something like that look like?
>>
>> Before it's recommended, I am aware buddypress is an option for activity
>> feeds.  I want to do this so I can learn more, and create something unique
>> for myself.
>>
>>
>>
>> --
>> View this message in context: http://wordpress-hackers.**
>> 1065353.n5.nabble.com/A-Basic-**Activity-Feed-Is-This-**
>> Efficient-tp42662.html<http://wordpress-hackers.1065353.n5.nabble.com/A-Basic-Activity-Feed-Is-This-Efficient-tp42662.html>
>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>> ______________________________**_________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
>> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>>
>>  ______________________________**_________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.**com <wp-hackers at lists.automattic.com>
> http://lists.automattic.com/**mailman/listinfo/wp-hackers<http://lists.automattic.com/mailman/listinfo/wp-hackers>
>

From greglancaster71 at gmail.com  Tue Oct 29 19:11:18 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Tue, 29 Oct 2013 12:11:18 -0700
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <4A86C38E-365D-44E4-9BDB-02C50E17D793@codesymphony.co>
References: <1383046340546-42662.post@n5.nabble.com>
 <4264B50E-3D7B-48D3-ABD8-CB69F13F085C@codesymphony.co>
 <4A86C38E-365D-44E4-9BDB-02C50E17D793@codesymphony.co>
Message-ID: <CAPN-N+ZBxaJ38r-_t=7zxQR4-UeRTX5+Kt56g6N6+An=HGJM7g@mail.gmail.com>

oh JD- If I limit the pull to say 10 rows, how would I allow the user to
pull 10 more at s time?  So show 10 and on click load the next 10 previous,
etc...

On Tuesday, October 29, 2013, J.D. Grimes wrote:

> Any activity feed will require a lot of database queries, and yours
> probably requires less than BuddyPress?s. I would suggest that you put the
> limit directly in the SQL query. Right now you are pulling more entries
> from the DB than you need. So:
>
> $activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' .
> $wpdb->prefix .
> 'jo_activity_feed WHERE user_id = %d ORDER BY id ASC LIMIT %d',
> $author_id, $limit ) );
>
> Abdussamad?s solution for the activity message is good. Just FYI, you
> could also have used a switch statement:
>
>         switch ( $row->activity_type ) {
>
>                 case ?new_record?:
>                         $message = //?
>                         $points = //?
>                 break;
>
>                 case ?deleted_record?:
>                         //...
>         }
>
> But his solution is better.
>
> -J.D.
>
> On Oct 29, 2013, at 8:34 AM, J.D. Grimes <jdg at codesymphony.co<javascript:;>>
> wrote:
>
> > This right here is open to sql injection, as Abdussamad pointed out:
> >
> >> $activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
> >> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id
> ASC');
> >
> > You should be using $wpdb->prepare():
> >
> > $activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' .
> $wpdb->prefix .
> > 'jo_activity_feed WHERE user_id = %d ORDER BY id ASC', $author_id ) );
> >
> > -J.D.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com <javascript:;>
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com <javascript:;>
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Tue Oct 29 19:32:29 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Tue, 29 Oct 2013 15:32:29 -0400
Subject: [wp-hackers] A Basic Activity Feed - Is This Efficient?
In-Reply-To: <CAPN-N+ZBxaJ38r-_t=7zxQR4-UeRTX5+Kt56g6N6+An=HGJM7g@mail.gmail.com>
References: <1383046340546-42662.post@n5.nabble.com>
 <4264B50E-3D7B-48D3-ABD8-CB69F13F085C@codesymphony.co>
 <4A86C38E-365D-44E4-9BDB-02C50E17D793@codesymphony.co>
 <CAPN-N+ZBxaJ38r-_t=7zxQR4-UeRTX5+Kt56g6N6+An=HGJM7g@mail.gmail.com>
Message-ID: <E9BC5D8C-939C-43B3-9EB9-F3EED740EB94@codesymphony.co>

Oh, if you want to paginate it, then you will want to look at some tutorials on pagination. You would reload the page or update the page via AJAX, and that request would load the next/previous 10 rows for the user. You can output all rows an paginate them with JS, but depending on the number of rows of activity, that will probably be a waste.

On Oct 29, 2013, at 3:11 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> oh JD- If I limit the pull to say 10 rows, how would I allow the user to
> pull 10 more at s time?  So show 10 and on click load the next 10 previous,
> etc...
> 
> On Tuesday, October 29, 2013, J.D. Grimes wrote:
> 
>> Any activity feed will require a lot of database queries, and yours
>> probably requires less than BuddyPress?s. I would suggest that you put the
>> limit directly in the SQL query. Right now you are pulling more entries
>> from the DB than you need. So:
>> 
>> $activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' .
>> $wpdb->prefix .
>> 'jo_activity_feed WHERE user_id = %d ORDER BY id ASC LIMIT %d',
>> $author_id, $limit ) );
>> 
>> Abdussamad?s solution for the activity message is good. Just FYI, you
>> could also have used a switch statement:
>> 
>>        switch ( $row->activity_type ) {
>> 
>>                case ?new_record?:
>>                        $message = //?
>>                        $points = //?
>>                break;
>> 
>>                case ?deleted_record?:
>>                        //...
>>        }
>> 
>> But his solution is better.
>> 
>> -J.D.
>> 
>> On Oct 29, 2013, at 8:34 AM, J.D. Grimes <jdg at codesymphony.co<javascript:;>>
>> wrote:
>> 
>>> This right here is open to sql injection, as Abdussamad pointed out:
>>> 
>>>> $activity_calls = $wpdb->get_results('SELECT * FROM ' . $wpdb->prefix .
>>>> 'jo_activity_feed' .' WHERE user_id = '. $author_id .' ORDER BY id
>> ASC');
>>> 
>>> You should be using $wpdb->prepare():
>>> 
>>> $activity_calls = $wpdb->get_results( $wpdb->prepare( 'SELECT * FROM ' .
>> $wpdb->prefix .
>>> 'jo_activity_feed WHERE user_id = %d ORDER BY id ASC', $author_id ) );
>>> 
>>> -J.D.
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com <javascript:;>
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com <javascript:;>
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From info at bungeshea.com  Tue Oct 29 21:57:11 2013
From: info at bungeshea.com (Shea Bunge)
Date: Wed, 30 Oct 2013 08:57:11 +1100
Subject: [wp-hackers] WordPress & Composer
In-Reply-To: <CAM_fM0pvh4Y82vF+O4Ri+qY9ZvF3NmA_Sc+xrBAhKs6zqkPy6Q@mail.gmail.com>
References: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>
 <CAKnJ9+xUVCwO+H2gMTU+f1qwgw6-iL=+PR8FcsONNuqN7a58WQ@mail.gmail.com>
 <CAM_fM0pvh4Y82vF+O4Ri+qY9ZvF3NmA_Sc+xrBAhKs6zqkPy6Q@mail.gmail.com>
Message-ID: <CAJLbkRbTaV3f=dfVraTSX9_gPhS_jk-rfXcN3eMW=j0YfZMsUA@mail.gmail.com>

Have a look a Rarst's Composer in WordPress <http://cwp.rarst.net> site for
some good guides and implementation examples.

I think that the ticket Amy mentioned has been dumped due to different
opinions of what the JSON file should look like.


On Wed, Oct 30, 2013 at 4:52 AM, Baki Goxhaj <banago at gmail.com> wrote:

> Thanks Amy.
>
> Kindly,
>
> Baki Goxhaj
> about.me/banago
>
>
> On Tue, Oct 29, 2013 at 6:44 PM, Amy Hendrix <sabreuse at gmail.com> wrote:
>
> > You can find the discussion about integrating Composer with core here:
> > http://core.trac.wordpress.org/ticket/23912
> >
> >
> > On Tue, Oct 29, 2013 at 1:41 PM, Baki Goxhaj <banago at gmail.com> wrote:
> > > Hi guys,
> > >
> > > Any plan where WordPress meets Composer?
> > >
> > > I found a WordPress fork that puts the whole WordPress a single
> package:
> > > https://github.com/cesarhdz/ixa-wordpress-core
> > >
> > > Kindly,
> > >
> > > Baki Goxhaj
> > > about.me/banago
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>



-- 
Regards,

Shea Bunge
http://bungeshea.com

From kadamwhite at gmail.com  Wed Oct 30 15:59:03 2013
From: kadamwhite at gmail.com (K.Adam White)
Date: Wed, 30 Oct 2013 11:59:03 -0400
Subject: [wp-hackers] WordPress & Composer
In-Reply-To: <CAJLbkRbTaV3f=dfVraTSX9_gPhS_jk-rfXcN3eMW=j0YfZMsUA@mail.gmail.com>
References: <CAM_fM0pbQWxApumjF3j_a_9=fovgdXOKys5GKy9K8Z4n8CyCrg@mail.gmail.com>
 <CAKnJ9+xUVCwO+H2gMTU+f1qwgw6-iL=+PR8FcsONNuqN7a58WQ@mail.gmail.com>
 <CAM_fM0pvh4Y82vF+O4Ri+qY9ZvF3NmA_Sc+xrBAhKs6zqkPy6Q@mail.gmail.com>
 <CAJLbkRbTaV3f=dfVraTSX9_gPhS_jk-rfXcN3eMW=j0YfZMsUA@mail.gmail.com>
Message-ID: <CACYBCrqC6kk5CDpRLEHQNeo4pNvczS_pxTuJTdEE8t7eqGNapw@mail.gmail.com>

There was also a good talk about Composer at WordCamp Boston this past
weekend?presenter Bradley Jacobs touched on the debate Amy mentioned, and
presented a few ways to leverage composer in your own projects
independently of any decision for Core. The video won't be up for a while,
but his slides are here:
http://fightingreality.com/presentations/wordcamp-boston-2013-composer/#/Might
be useful to you!

K. Adam White
kadamwhite at gmail.com
401.575.7829


On Tue, Oct 29, 2013 at 5:57 PM, Shea Bunge <info at bungeshea.com> wrote:

> Have a look a Rarst's Composer in WordPress <http://cwp.rarst.net> site
> for
> some good guides and implementation examples.
>
> I think that the ticket Amy mentioned has been dumped due to different
> opinions of what the JSON file should look like.
>
>
> On Wed, Oct 30, 2013 at 4:52 AM, Baki Goxhaj <banago at gmail.com> wrote:
>
> > Thanks Amy.
> >
> > Kindly,
> >
> > Baki Goxhaj
> > about.me/banago
> >
> >
> > On Tue, Oct 29, 2013 at 6:44 PM, Amy Hendrix <sabreuse at gmail.com> wrote:
> >
> > > You can find the discussion about integrating Composer with core here:
> > > http://core.trac.wordpress.org/ticket/23912
> > >
> > >
> > > On Tue, Oct 29, 2013 at 1:41 PM, Baki Goxhaj <banago at gmail.com> wrote:
> > > > Hi guys,
> > > >
> > > > Any plan where WordPress meets Composer?
> > > >
> > > > I found a WordPress fork that puts the whole WordPress a single
> > package:
> > > > https://github.com/cesarhdz/ixa-wordpress-core
> > > >
> > > > Kindly,
> > > >
> > > > Baki Goxhaj
> > > > about.me/banago
> > > > _______________________________________________
> > > > wp-hackers mailing list
> > > > wp-hackers at lists.automattic.com
> > > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > > _______________________________________________
> > > wp-hackers mailing list
> > > wp-hackers at lists.automattic.com
> > > http://lists.automattic.com/mailman/listinfo/wp-hackers
> > >
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
>
>
>
> --
> Regards,
>
> Shea Bunge
> http://bungeshea.com
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From halukkaramete at gmail.com  Thu Oct 31 08:38:47 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 31 Oct 2013 01:38:47 -0700
Subject: [wp-hackers] WordPress extended.
Message-ID: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>

Hi guys..

I'm just curious as to what the part "extended" in the "Upgrading WordPress
Extended" means.

I happened to see it here;
http://codex.wordpress.org/Upgrading_WordPress_Extended

There is also the "Updating Wordpress" which is here;
http://codex.wordpress.org/Updating_WordPress

I know Matt talked about Chrome like updates ( seemless updates ) in the SF
WordCamp. Is that the difference here?  Or are these two instructions ( and
pages and captions ) different ways of explaining the same thing?

Help me clear out please.

Thank you

From wp at andrewnacin.com  Thu Oct 31 08:42:26 2013
From: wp at andrewnacin.com (Andrew Nacin)
Date: Thu, 31 Oct 2013 04:42:26 -0400
Subject: [wp-hackers] WordPress extended.
In-Reply-To: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
References: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
Message-ID: <CAP29Pvjin7K-c2HGUuK=7yucj8SCvj_b7_mCRKpBf3zb3vA4CQ@mail.gmail.com>

Automatic background updates are listed on the main page:
http://codex.wordpress.org/Upgrading_WordPress#Automatic_Background_Updates.
I've never heard of the Extended page. It seems it is just a more detailed
(and fairly old) set of instructions for a manual update.


On Thu, Oct 31, 2013 at 4:38 AM, Haluk Karamete <halukkaramete at gmail.com>wrote:

> Hi guys..
>
> I'm just curious as to what the part "extended" in the "Upgrading WordPress
> Extended" means.
>
> I happened to see it here;
> http://codex.wordpress.org/Upgrading_WordPress_Extended
>
> There is also the "Updating Wordpress" which is here;
> http://codex.wordpress.org/Updating_WordPress
>
> I know Matt talked about Chrome like updates ( seemless updates ) in the SF
> WordCamp. Is that the difference here?  Or are these two instructions ( and
> pages and captions ) different ways of explaining the same thing?
>
> Help me clear out please.
>
> Thank you
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From banago at gmail.com  Thu Oct 31 08:44:37 2013
From: banago at gmail.com (Baki Goxhaj)
Date: Thu, 31 Oct 2013 09:44:37 +0100
Subject: [wp-hackers] WordPress extended.
In-Reply-To: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
References: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
Message-ID: <CAM_fM0pwM1v38-_7=kMpy5aHPv-w=3H7gON88mrPSqRKQ5f0jQ@mail.gmail.com>

It means it has more detailed information that the original one.

Kindly,

Baki Goxhaj
about.me/banago


On Thu, Oct 31, 2013 at 9:38 AM, Haluk Karamete <halukkaramete at gmail.com>wrote:

> Hi guys..
>
> I'm just curious as to what the part "extended" in the "Upgrading WordPress
> Extended" means.
>
> I happened to see it here;
> http://codex.wordpress.org/Upgrading_WordPress_Extended
>
> There is also the "Updating Wordpress" which is here;
> http://codex.wordpress.org/Updating_WordPress
>
> I know Matt talked about Chrome like updates ( seemless updates ) in the SF
> WordCamp. Is that the difference here?  Or are these two instructions ( and
> pages and captions ) different ways of explaining the same thing?
>
> Help me clear out please.
>
> Thank you
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From halukkaramete at gmail.com  Thu Oct 31 09:15:54 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 31 Oct 2013 02:15:54 -0700
Subject: [wp-hackers] WordPress Search
Message-ID: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>

Hi Guys...

I have a question  that has two parts...

One philosophical and the other is practical... before I get into that, let
me set the context of this question.

This question does not apply to small business or blogs.
It applies to huge sites that have thousands of posts, perhaps over 100,000.

Search is a key feature to me, like to many other people.

I know there are a ton of great plugins out there specializing on search.
There are great minds & work behind those plugins & I respect the work
highly.

But when it comes to search, I don't think Google is beatable.

I think no matter how dedicated a group might be, they won't be able to
come up with something that does better than what Google can. I'm including
in this statement Yahoo & Bing, let alone the plugins that I've talked
about.

There are 2 kinds of searches to me.

the kind that is super accurate ( accurate to the dot ) and this kind of
search usually comes with no wisdom. They are handy for certain
implementations such as searching a code base.. you can go really accurate
with all kinds of  and's &  or's & contains etc...  like an editor's search

and there is the other kind of search..  this one comes with wisdom.
it won't match to certain results because it *somehow* factors in some
wisdom, and it simply avoids some results that the first type of search
mentality I've referred above. For example, a query on "Ramadan" won't
match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches "Five
Pillars". Well, that's google.

I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
there could be some solutions that come somewhat close to Google's way of
doing it. But honestly, I'm almost 100% sure, that there is no better way.

Until you convince me otherwise, I would think that if you are in charge of
a site like TechCrunch, New York Times or NPR etc, the search must be based
on Google.

Second part of my question is if you agree with this point of view of mine,
would you please give me a few leads as to which plugins or solutions that
you may recommend that would integrate Google search into a WordPress site.

And BTW, I just did a search on wordpress.org just to see how Wordpress.org
was handling the search ( cause honestly, I did not know how the codex
handled the search aspect & I was going to compare wordpress.org's search
results to google with site:wordpress.org - but it turned out that
WordPress.org too adapted Google when it comes to search. :)

In that case, I could ask now if there is a recommended practice in setting
up the custom google seathe way Wordpress.org did.

THank you

From halukkaramete at gmail.com  Thu Oct 31 09:24:41 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 31 Oct 2013 02:24:41 -0700
Subject: [wp-hackers] WordPress extended.
In-Reply-To: <CAM_fM0pwM1v38-_7=kMpy5aHPv-w=3H7gON88mrPSqRKQ5f0jQ@mail.gmail.com>
References: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
 <CAM_fM0pwM1v38-_7=kMpy5aHPv-w=3H7gON88mrPSqRKQ5f0jQ@mail.gmail.com>
Message-ID: <CAHERW=2S_dRzKEf8MkHzD6CEW6X9sK4jp7huYuP+PAJmPoOsmQ@mail.gmail.com>

Nacin, thanks for the feedback.

I ended up that extended page in really two clicks.

On the wordpress dashboard, I see the message - which is totally
cannot-be-missed, and that is

WordPress 3.7.1 <http://codex.wordpress.org/Version_3.7.1> is available! Please
update now <http://localhost/ic/wp-admin/update-core.php>.

Then, I click on "wordpress 3.7.1" link and that brings me to  the "
http://codex.wordpress.org/Version_3.7.1"
and right there, and right above the fold, I see this;

If you are new to WordPress, we recommend that you begin with the following:
>
>    - New To WordPress - Where to Start<http://codex.wordpress.org/New_To_WordPress_-_Where_to_Start>
>
>
>    - First Steps With WordPress<http://codex.wordpress.org/First_Steps_With_WordPress>
>     or Upgrading WordPress Extended<http://codex.wordpress.org/Upgrading_WordPress_Extended>
>
>
>    - WordPress Lessons <http://codex.wordpress.org/WordPress_Lessons>
>
> But anyway, I understand that they are the same thing.

As Baki responded the "extended" one is simply more detailed than the
other. That's all there is to it.

But my 2 cents is that "WordPress Extended" comes across as if it were to
be something different than "WordPress".



On Thu, Oct 31, 2013 at 1:44 AM, Baki Goxhaj <banago at gmail.com> wrote:

> It means it has more detailed information that the original one.
>
> Kindly,
>
> Baki Goxhaj
> about.me/banago
>
>
> On Thu, Oct 31, 2013 at 9:38 AM, Haluk Karamete <halukkaramete at gmail.com
> >wrote:
>
> > Hi guys..
> >
> > I'm just curious as to what the part "extended" in the "Upgrading
> WordPress
> > Extended" means.
> >
> > I happened to see it here;
> > http://codex.wordpress.org/Upgrading_WordPress_Extended
> >
> > There is also the "Updating Wordpress" which is here;
> > http://codex.wordpress.org/Updating_WordPress
> >
> > I know Matt talked about Chrome like updates ( seemless updates ) in the
> SF
> > WordCamp. Is that the difference here?  Or are these two instructions (
> and
> > pages and captions ) different ways of explaining the same thing?
> >
> > Help me clear out please.
> >
> > Thank you
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
> >
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From simon at wpsites.co.uk  Thu Oct 31 10:38:40 2013
From: simon at wpsites.co.uk (Simon Dunton - WP Sites)
Date: Thu, 31 Oct 2013 10:38:40 +0000
Subject: [wp-hackers] WordPress Search
In-Reply-To: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
Message-ID: <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>

Hi,

WordPress.org must be using https://www.google.co.uk/cse/

In my opinion Google custom search engines are useless. Yes you can specify which sites you want to index and tweak some settings but in my experience the results aren't as good as a normal Google search (I used it years ago so might have improved since then) and besides, do you really want Google to decide which factors are most relevant when it comes to searching on your website?

I think the best way is get your self an elasticsearch instance/cluster have all your post content automatically feed into elasticsearch to be indexed and you're totally in control.

Simon


On 31 Oct 2013, at 09:15, Haluk Karamete wrote:

> Hi Guys...
> 
> I have a question  that has two parts...
> 
> One philosophical and the other is practical... before I get into that, let
> me set the context of this question.
> 
> This question does not apply to small business or blogs.
> It applies to huge sites that have thousands of posts, perhaps over 100,000.
> 
> Search is a key feature to me, like to many other people.
> 
> I know there are a ton of great plugins out there specializing on search.
> There are great minds & work behind those plugins & I respect the work
> highly.
> 
> But when it comes to search, I don't think Google is beatable.
> 
> I think no matter how dedicated a group might be, they won't be able to
> come up with something that does better than what Google can. I'm including
> in this statement Yahoo & Bing, let alone the plugins that I've talked
> about.
> 
> There are 2 kinds of searches to me.
> 
> the kind that is super accurate ( accurate to the dot ) and this kind of
> search usually comes with no wisdom. They are handy for certain
> implementations such as searching a code base.. you can go really accurate
> with all kinds of  and's &  or's & contains etc...  like an editor's search
> 
> and there is the other kind of search..  this one comes with wisdom.
> it won't match to certain results because it *somehow* factors in some
> wisdom, and it simply avoids some results that the first type of search
> mentality I've referred above. For example, a query on "Ramadan" won't
> match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches "Five
> Pillars". Well, that's google.
> 
> I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
> there could be some solutions that come somewhat close to Google's way of
> doing it. But honestly, I'm almost 100% sure, that there is no better way.
> 
> Until you convince me otherwise, I would think that if you are in charge of
> a site like TechCrunch, New York Times or NPR etc, the search must be based
> on Google.
> 
> Second part of my question is if you agree with this point of view of mine,
> would you please give me a few leads as to which plugins or solutions that
> you may recommend that would integrate Google search into a WordPress site.
> 
> And BTW, I just did a search on wordpress.org just to see how Wordpress.org
> was handling the search ( cause honestly, I did not know how the codex
> handled the search aspect & I was going to compare wordpress.org's search
> results to google with site:wordpress.org - but it turned out that
> WordPress.org too adapted Google when it comes to search. :)
> 
> In that case, I could ask now if there is a recommended practice in setting
> up the custom google seathe way Wordpress.org did.
> 
> THank you
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From halukkaramete at gmail.com  Thu Oct 31 11:18:16 2013
From: halukkaramete at gmail.com (Haluk Karamete)
Date: Thu, 31 Oct 2013 04:18:16 -0700
Subject: [wp-hackers] WordPress Search
In-Reply-To: <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
 <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
Message-ID: <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>

Thank you for your feedback Simon.

After you pointing out that a custom Google search is not as good as Google
search, I compared these two;

this one searches  "advanced taxonomy posts" on wordpress.org web site
http://wordpress.org/search/advanced%20taxonomy%20posts

and this one searches "advanced taxonomy posts" on google.com with a search
operator attached (site:wordpress.org)
https://www.google.com/search?num=100&q=site%3Awordpress.org+advanced+taxonomy+posts&oq=site%3Awordpress.org+advanced+taxonomy+posts&gs_l=serp.3...68176.72806.0.76162.23.23.0.0.0.0.117.1552.22j1.23.0.cprnk%2Caddre%3Dcollection...0...1.1.30.serp..23.0.0.mY8gd8FhLtc

Obviously results are pretty close but not identical. Both are good and
share a lot in common.
I have done some other searches but I feel like Google search results are a
little better, more mature. But it makes me think why there is a
difference?

I guess there are some settings internally set somewhere and that modifies
the way the results are served. ( PS. I'm *not* referring here how the
search results are displayed format wise, I mean the actual order and the
result set... ) They are definitely not identical.

As to the elasticsearch you refer to, from an earlier look, it looks like a
complicated route to me.

Does the elasticsearch be able to handle "5 Pillars" and the "Tariq
Ramadan" examples I gave you in my earlier post?
Can it handle 5+5 type search? ( Not that I need this but... )
Could elasticsearch leverage Google search with all of its intelligence, or
is it a complete "DIY" situation here?

I'm just curious.


On Thu, Oct 31, 2013 at 3:38 AM, Simon Dunton - WP Sites <
simon at wpsites.co.uk> wrote:

> Hi,
>
> WordPress.org must be using https://www.google.co.uk/cse/
>
> In my opinion Google custom search engines are useless. Yes you can
> specify which sites you want to index and tweak some settings but in my
> experience the results aren't as good as a normal Google search (I used it
> years ago so might have improved since then) and besides, do you really
> want Google to decide which factors are most relevant when it comes to
> searching on your website?
>
> I think the best way is get your self an elasticsearch instance/cluster
> have all your post content automatically feed into elasticsearch to be
> indexed and you're totally in control.
>
> Simon
>
>
> On 31 Oct 2013, at 09:15, Haluk Karamete wrote:
>
> > Hi Guys...
> >
> > I have a question  that has two parts...
> >
> > One philosophical and the other is practical... before I get into that,
> let
> > me set the context of this question.
> >
> > This question does not apply to small business or blogs.
> > It applies to huge sites that have thousands of posts, perhaps over
> 100,000.
> >
> > Search is a key feature to me, like to many other people.
> >
> > I know there are a ton of great plugins out there specializing on search.
> > There are great minds & work behind those plugins & I respect the work
> > highly.
> >
> > But when it comes to search, I don't think Google is beatable.
> >
> > I think no matter how dedicated a group might be, they won't be able to
> > come up with something that does better than what Google can. I'm
> including
> > in this statement Yahoo & Bing, let alone the plugins that I've talked
> > about.
> >
> > There are 2 kinds of searches to me.
> >
> > the kind that is super accurate ( accurate to the dot ) and this kind of
> > search usually comes with no wisdom. They are handy for certain
> > implementations such as searching a code base.. you can go really
> accurate
> > with all kinds of  and's &  or's & contains etc...  like an editor's
> search
> >
> > and there is the other kind of search..  this one comes with wisdom.
> > it won't match to certain results because it *somehow* factors in some
> > wisdom, and it simply avoids some results that the first type of search
> > mentality I've referred above. For example, a query on "Ramadan" won't
> > match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches "Five
> > Pillars". Well, that's google.
> >
> > I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
> > there could be some solutions that come somewhat close to Google's way of
> > doing it. But honestly, I'm almost 100% sure, that there is no better
> way.
> >
> > Until you convince me otherwise, I would think that if you are in charge
> of
> > a site like TechCrunch, New York Times or NPR etc, the search must be
> based
> > on Google.
> >
> > Second part of my question is if you agree with this point of view of
> mine,
> > would you please give me a few leads as to which plugins or solutions
> that
> > you may recommend that would integrate Google search into a WordPress
> site.
> >
> > And BTW, I just did a search on wordpress.org just to see how
> Wordpress.org
> > was handling the search ( cause honestly, I did not know how the codex
> > handled the search aspect & I was going to compare wordpress.org's
> search
> > results to google with site:wordpress.org - but it turned out that
> > WordPress.org too adapted Google when it comes to search. :)
> >
> > In that case, I could ask now if there is a recommended practice in
> setting
> > up the custom google seathe way Wordpress.org did.
> >
> > THank you
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From simon at wpsites.co.uk  Thu Oct 31 12:33:16 2013
From: simon at wpsites.co.uk (Simon Dunton - WP Sites)
Date: Thu, 31 Oct 2013 12:33:16 +0000
Subject: [wp-hackers] WordPress Search
In-Reply-To: <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
 <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
 <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>
Message-ID: <F5A0AE4B-78FD-476C-9CAB-8059B9F30578@wpsites.co.uk>

Hi,

Elasticsearch is a more complicated route but if search is important to you and you want total control then it's a good option.

Elasticsearch has a number of analyzers that can be used to break up the query and index tokens http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html so you could for instance pretty easily replace textual representations of numbers in the query; so "5 Pillars" could be automatically converted to "(5 OR five) Pillars". 

It's probably an impossible task to create your own version of Google but in many cases for your own data especially if it's a bit more specialised I think a custom Elasticsearch solution is going to be more relevant than Google could ever be. Google doesn't know what is important on your website as well as you do, Google just takes a generic approach, but you can tailor it to your content. Just for generic text i.e. if your site is a blog about general stuff your not going to have too much to work with but if your site was the WordPress codex/forums then you're going to know a whole load more about your sites data and structure than Google and you can use that edge to create a better search experience for your users than you could ever get from Google Custom Search.

Sorry if I waffled a bit there, in a bit of a rush with work!

Simon

On 31 Oct 2013, at 11:18, Haluk Karamete wrote:

> Thank you for your feedback Simon.
> 
> After you pointing out that a custom Google search is not as good as Google
> search, I compared these two;
> 
> this one searches  "advanced taxonomy posts" on wordpress.org web site
> http://wordpress.org/search/advanced%20taxonomy%20posts
> 
> and this one searches "advanced taxonomy posts" on google.com with a search
> operator attached (site:wordpress.org)
> https://www.google.com/search?num=100&q=site%3Awordpress.org+advanced+taxonomy+posts&oq=site%3Awordpress.org+advanced+taxonomy+posts&gs_l=serp.3...68176.72806.0.76162.23.23.0.0.0.0.117.1552.22j1.23.0.cprnk%2Caddre%3Dcollection...0...1.1.30.serp..23.0.0.mY8gd8FhLtc
> 
> Obviously results are pretty close but not identical. Both are good and
> share a lot in common.
> I have done some other searches but I feel like Google search results are a
> little better, more mature. But it makes me think why there is a
> difference?
> 
> I guess there are some settings internally set somewhere and that modifies
> the way the results are served. ( PS. I'm *not* referring here how the
> search results are displayed format wise, I mean the actual order and the
> result set... ) They are definitely not identical.
> 
> As to the elasticsearch you refer to, from an earlier look, it looks like a
> complicated route to me.
> 
> Does the elasticsearch be able to handle "5 Pillars" and the "Tariq
> Ramadan" examples I gave you in my earlier post?
> Can it handle 5+5 type search? ( Not that I need this but... )
> Could elasticsearch leverage Google search with all of its intelligence, or
> is it a complete "DIY" situation here?
> 
> I'm just curious.
> 
> 
> On Thu, Oct 31, 2013 at 3:38 AM, Simon Dunton - WP Sites <
> simon at wpsites.co.uk> wrote:
> 
>> Hi,
>> 
>> WordPress.org must be using https://www.google.co.uk/cse/
>> 
>> In my opinion Google custom search engines are useless. Yes you can
>> specify which sites you want to index and tweak some settings but in my
>> experience the results aren't as good as a normal Google search (I used it
>> years ago so might have improved since then) and besides, do you really
>> want Google to decide which factors are most relevant when it comes to
>> searching on your website?
>> 
>> I think the best way is get your self an elasticsearch instance/cluster
>> have all your post content automatically feed into elasticsearch to be
>> indexed and you're totally in control.
>> 
>> Simon
>> 
>> 
>> On 31 Oct 2013, at 09:15, Haluk Karamete wrote:
>> 
>>> Hi Guys...
>>> 
>>> I have a question  that has two parts...
>>> 
>>> One philosophical and the other is practical... before I get into that,
>> let
>>> me set the context of this question.
>>> 
>>> This question does not apply to small business or blogs.
>>> It applies to huge sites that have thousands of posts, perhaps over
>> 100,000.
>>> 
>>> Search is a key feature to me, like to many other people.
>>> 
>>> I know there are a ton of great plugins out there specializing on search.
>>> There are great minds & work behind those plugins & I respect the work
>>> highly.
>>> 
>>> But when it comes to search, I don't think Google is beatable.
>>> 
>>> I think no matter how dedicated a group might be, they won't be able to
>>> come up with something that does better than what Google can. I'm
>> including
>>> in this statement Yahoo & Bing, let alone the plugins that I've talked
>>> about.
>>> 
>>> There are 2 kinds of searches to me.
>>> 
>>> the kind that is super accurate ( accurate to the dot ) and this kind of
>>> search usually comes with no wisdom. They are handy for certain
>>> implementations such as searching a code base.. you can go really
>> accurate
>>> with all kinds of  and's &  or's & contains etc...  like an editor's
>> search
>>> 
>>> and there is the other kind of search..  this one comes with wisdom.
>>> it won't match to certain results because it *somehow* factors in some
>>> wisdom, and it simply avoids some results that the first type of search
>>> mentality I've referred above. For example, a query on "Ramadan" won't
>>> match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches "Five
>>> Pillars". Well, that's google.
>>> 
>>> I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
>>> there could be some solutions that come somewhat close to Google's way of
>>> doing it. But honestly, I'm almost 100% sure, that there is no better
>> way.
>>> 
>>> Until you convince me otherwise, I would think that if you are in charge
>> of
>>> a site like TechCrunch, New York Times or NPR etc, the search must be
>> based
>>> on Google.
>>> 
>>> Second part of my question is if you agree with this point of view of
>> mine,
>>> would you please give me a few leads as to which plugins or solutions
>> that
>>> you may recommend that would integrate Google search into a WordPress
>> site.
>>> 
>>> And BTW, I just did a search on wordpress.org just to see how
>> Wordpress.org
>>> was handling the search ( cause honestly, I did not know how the codex
>>> handled the search aspect & I was going to compare wordpress.org's
>> search
>>> results to google with site:wordpress.org - but it turned out that
>>> WordPress.org too adapted Google when it comes to search. :)
>>> 
>>> In that case, I could ask now if there is a recommended practice in
>> setting
>>> up the custom google seathe way Wordpress.org did.
>>> 
>>> THank you
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From david at ernsts.us  Thu Oct 31 13:17:19 2013
From: david at ernsts.us (David Ernst)
Date: Thu, 31 Oct 2013 09:17:19 -0400
Subject: [wp-hackers] WordPress Search
In-Reply-To: <F5A0AE4B-78FD-476C-9CAB-8059B9F30578@wpsites.co.uk>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
 <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
 <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>
 <F5A0AE4B-78FD-476C-9CAB-8059B9F30578@wpsites.co.uk>
Message-ID: <CANmL2P-OBs3GuHewmwVqfZoWE98mBpC6ZUaGg=Zn6abL8R6XeA@mail.gmail.com>

>
> Google doesn't know what is important on your website as well as you do,
> Google just takes a generic approach, but you can tailor it to your content.


Simon, are you suggesting that Google Custom Search ignores PageRank? Did I
understand you correctly?


On Thu, Oct 31, 2013 at 8:33 AM, Simon Dunton - WP Sites <
simon at wpsites.co.uk> wrote:

> Hi,
>
> Elasticsearch is a more complicated route but if search is important to
> you and you want total control then it's a good option.
>
> Elasticsearch has a number of analyzers that can be used to break up the
> query and index tokens
> http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.htmlso you could for instance pretty easily replace textual representations of
> numbers in the query; so "5 Pillars" could be automatically converted to
> "(5 OR five) Pillars".
>
> It's probably an impossible task to create your own version of Google but
> in many cases for your own data especially if it's a bit more specialised I
> think a custom Elasticsearch solution is going to be more relevant than
> Google could ever be. Google doesn't know what is important on your website
> as well as you do, Google just takes a generic approach, but you can tailor
> it to your content. Just for generic text i.e. if your site is a blog about
> general stuff your not going to have too much to work with but if your site
> was the WordPress codex/forums then you're going to know a whole load more
> about your sites data and structure than Google and you can use that edge
> to create a better search experience for your users than you could ever get
> from Google Custom Search.
>
> Sorry if I waffled a bit there, in a bit of a rush with work!
>
> Simon
>
> On 31 Oct 2013, at 11:18, Haluk Karamete wrote:
>
> > Thank you for your feedback Simon.
> >
> > After you pointing out that a custom Google search is not as good as
> Google
> > search, I compared these two;
> >
> > this one searches  "advanced taxonomy posts" on wordpress.org web site
> > http://wordpress.org/search/advanced%20taxonomy%20posts
> >
> > and this one searches "advanced taxonomy posts" on google.com with a
> search
> > operator attached (site:wordpress.org)
> >
> https://www.google.com/search?num=100&q=site%3Awordpress.org+advanced+taxonomy+posts&oq=site%3Awordpress.org+advanced+taxonomy+posts&gs_l=serp.3...68176.72806.0.76162.23.23.0.0.0.0.117.1552.22j1.23.0.cprnk%2Caddre%3Dcollection...0...1.1.30.serp..23.0.0.mY8gd8FhLtc
> >
> > Obviously results are pretty close but not identical. Both are good and
> > share a lot in common.
> > I have done some other searches but I feel like Google search results
> are a
> > little better, more mature. But it makes me think why there is a
> > difference?
> >
> > I guess there are some settings internally set somewhere and that
> modifies
> > the way the results are served. ( PS. I'm *not* referring here how the
> > search results are displayed format wise, I mean the actual order and the
> > result set... ) They are definitely not identical.
> >
> > As to the elasticsearch you refer to, from an earlier look, it looks
> like a
> > complicated route to me.
> >
> > Does the elasticsearch be able to handle "5 Pillars" and the "Tariq
> > Ramadan" examples I gave you in my earlier post?
> > Can it handle 5+5 type search? ( Not that I need this but... )
> > Could elasticsearch leverage Google search with all of its intelligence,
> or
> > is it a complete "DIY" situation here?
> >
> > I'm just curious.
> >
> >
> > On Thu, Oct 31, 2013 at 3:38 AM, Simon Dunton - WP Sites <
> > simon at wpsites.co.uk> wrote:
> >
> >> Hi,
> >>
> >> WordPress.org must be using https://www.google.co.uk/cse/
> >>
> >> In my opinion Google custom search engines are useless. Yes you can
> >> specify which sites you want to index and tweak some settings but in my
> >> experience the results aren't as good as a normal Google search (I used
> it
> >> years ago so might have improved since then) and besides, do you really
> >> want Google to decide which factors are most relevant when it comes to
> >> searching on your website?
> >>
> >> I think the best way is get your self an elasticsearch instance/cluster
> >> have all your post content automatically feed into elasticsearch to be
> >> indexed and you're totally in control.
> >>
> >> Simon
> >>
> >>
> >> On 31 Oct 2013, at 09:15, Haluk Karamete wrote:
> >>
> >>> Hi Guys...
> >>>
> >>> I have a question  that has two parts...
> >>>
> >>> One philosophical and the other is practical... before I get into that,
> >> let
> >>> me set the context of this question.
> >>>
> >>> This question does not apply to small business or blogs.
> >>> It applies to huge sites that have thousands of posts, perhaps over
> >> 100,000.
> >>>
> >>> Search is a key feature to me, like to many other people.
> >>>
> >>> I know there are a ton of great plugins out there specializing on
> search.
> >>> There are great minds & work behind those plugins & I respect the work
> >>> highly.
> >>>
> >>> But when it comes to search, I don't think Google is beatable.
> >>>
> >>> I think no matter how dedicated a group might be, they won't be able to
> >>> come up with something that does better than what Google can. I'm
> >> including
> >>> in this statement Yahoo & Bing, let alone the plugins that I've talked
> >>> about.
> >>>
> >>> There are 2 kinds of searches to me.
> >>>
> >>> the kind that is super accurate ( accurate to the dot ) and this kind
> of
> >>> search usually comes with no wisdom. They are handy for certain
> >>> implementations such as searching a code base.. you can go really
> >> accurate
> >>> with all kinds of  and's &  or's & contains etc...  like an editor's
> >> search
> >>>
> >>> and there is the other kind of search..  this one comes with wisdom.
> >>> it won't match to certain results because it *somehow* factors in some
> >>> wisdom, and it simply avoids some results that the first type of search
> >>> mentality I've referred above. For example, a query on "Ramadan" won't
> >>> match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches
> "Five
> >>> Pillars". Well, that's google.
> >>>
> >>> I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
> >>> there could be some solutions that come somewhat close to Google's way
> of
> >>> doing it. But honestly, I'm almost 100% sure, that there is no better
> >> way.
> >>>
> >>> Until you convince me otherwise, I would think that if you are in
> charge
> >> of
> >>> a site like TechCrunch, New York Times or NPR etc, the search must be
> >> based
> >>> on Google.
> >>>
> >>> Second part of my question is if you agree with this point of view of
> >> mine,
> >>> would you please give me a few leads as to which plugins or solutions
> >> that
> >>> you may recommend that would integrate Google search into a WordPress
> >> site.
> >>>
> >>> And BTW, I just did a search on wordpress.org just to see how
> >> Wordpress.org
> >>> was handling the search ( cause honestly, I did not know how the codex
> >>> handled the search aspect & I was going to compare wordpress.org's
> >> search
> >>> results to google with site:wordpress.org - but it turned out that
> >>> WordPress.org too adapted Google when it comes to search. :)
> >>>
> >>> In that case, I could ask now if there is a recommended practice in
> >> setting
> >>> up the custom google seathe way Wordpress.org did.
> >>>
> >>> THank you
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From simon at wpsites.co.uk  Thu Oct 31 13:29:08 2013
From: simon at wpsites.co.uk (Simon Dunton - WP Sites)
Date: Thu, 31 Oct 2013 13:29:08 +0000
Subject: [wp-hackers] WordPress Search
In-Reply-To: <CANmL2P-OBs3GuHewmwVqfZoWE98mBpC6ZUaGg=Zn6abL8R6XeA@mail.gmail.com>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
 <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
 <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>
 <F5A0AE4B-78FD-476C-9CAB-8059B9F30578@wpsites.co.uk>
 <CANmL2P-OBs3GuHewmwVqfZoWE98mBpC6ZUaGg=Zn6abL8R6XeA@mail.gmail.com>
Message-ID: <18DAC506-E9B6-4F66-8C5D-0F71BA8DFE6D@wpsites.co.uk>

No, Google Custom Search is Google so probably does use page rank when ranking results but if you set up Google Custom Search to only list your website and a couple of others then the page rank algorithm probably doesn't come in to it much, maybe not at all, I'm not sure.

I didn't even factor in page rank when I was thinking about Elasticsearch. With Elasticsearch you index your posts content and title, links don't come into it but if you think inbound links are a really good indicator of how important a page of content is then you could spider links and create an index of inbound link data like Google does but for most cases it probably overkill. Saying that I'm sure it wouldn't be too hard to index the links within your own content and throw that into the mix. With a custom Elasticsearch setup you can index what you think is relevant and decide on your own importance/relevancy indicators.


On 31 Oct 2013, at 13:17, David Ernst wrote:

>> 
>> Google doesn't know what is important on your website as well as you do,
>> Google just takes a generic approach, but you can tailor it to your content.
> 
> 
> Simon, are you suggesting that Google Custom Search ignores PageRank? Did I
> understand you correctly?
> 
> 
> On Thu, Oct 31, 2013 at 8:33 AM, Simon Dunton - WP Sites <
> simon at wpsites.co.uk> wrote:
> 
>> Hi,
>> 
>> Elasticsearch is a more complicated route but if search is important to
>> you and you want total control then it's a good option.
>> 
>> Elasticsearch has a number of analyzers that can be used to break up the
>> query and index tokens
>> http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.htmlso you could for instance pretty easily replace textual representations of
>> numbers in the query; so "5 Pillars" could be automatically converted to
>> "(5 OR five) Pillars".
>> 
>> It's probably an impossible task to create your own version of Google but
>> in many cases for your own data especially if it's a bit more specialised I
>> think a custom Elasticsearch solution is going to be more relevant than
>> Google could ever be. Google doesn't know what is important on your website
>> as well as you do, Google just takes a generic approach, but you can tailor
>> it to your content. Just for generic text i.e. if your site is a blog about
>> general stuff your not going to have too much to work with but if your site
>> was the WordPress codex/forums then you're going to know a whole load more
>> about your sites data and structure than Google and you can use that edge
>> to create a better search experience for your users than you could ever get
>> from Google Custom Search.
>> 
>> Sorry if I waffled a bit there, in a bit of a rush with work!
>> 
>> Simon
>> 
>> On 31 Oct 2013, at 11:18, Haluk Karamete wrote:
>> 
>>> Thank you for your feedback Simon.
>>> 
>>> After you pointing out that a custom Google search is not as good as
>> Google
>>> search, I compared these two;
>>> 
>>> this one searches  "advanced taxonomy posts" on wordpress.org web site
>>> http://wordpress.org/search/advanced%20taxonomy%20posts
>>> 
>>> and this one searches "advanced taxonomy posts" on google.com with a
>> search
>>> operator attached (site:wordpress.org)
>>> 
>> https://www.google.com/search?num=100&q=site%3Awordpress.org+advanced+taxonomy+posts&oq=site%3Awordpress.org+advanced+taxonomy+posts&gs_l=serp.3...68176.72806.0.76162.23.23.0.0.0.0.117.1552.22j1.23.0.cprnk%2Caddre%3Dcollection...0...1.1.30.serp..23.0.0.mY8gd8FhLtc
>>> 
>>> Obviously results are pretty close but not identical. Both are good and
>>> share a lot in common.
>>> I have done some other searches but I feel like Google search results
>> are a
>>> little better, more mature. But it makes me think why there is a
>>> difference?
>>> 
>>> I guess there are some settings internally set somewhere and that
>> modifies
>>> the way the results are served. ( PS. I'm *not* referring here how the
>>> search results are displayed format wise, I mean the actual order and the
>>> result set... ) They are definitely not identical.
>>> 
>>> As to the elasticsearch you refer to, from an earlier look, it looks
>> like a
>>> complicated route to me.
>>> 
>>> Does the elasticsearch be able to handle "5 Pillars" and the "Tariq
>>> Ramadan" examples I gave you in my earlier post?
>>> Can it handle 5+5 type search? ( Not that I need this but... )
>>> Could elasticsearch leverage Google search with all of its intelligence,
>> or
>>> is it a complete "DIY" situation here?
>>> 
>>> I'm just curious.
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 3:38 AM, Simon Dunton - WP Sites <
>>> simon at wpsites.co.uk> wrote:
>>> 
>>>> Hi,
>>>> 
>>>> WordPress.org must be using https://www.google.co.uk/cse/
>>>> 
>>>> In my opinion Google custom search engines are useless. Yes you can
>>>> specify which sites you want to index and tweak some settings but in my
>>>> experience the results aren't as good as a normal Google search (I used
>> it
>>>> years ago so might have improved since then) and besides, do you really
>>>> want Google to decide which factors are most relevant when it comes to
>>>> searching on your website?
>>>> 
>>>> I think the best way is get your self an elasticsearch instance/cluster
>>>> have all your post content automatically feed into elasticsearch to be
>>>> indexed and you're totally in control.
>>>> 
>>>> Simon
>>>> 
>>>> 
>>>> On 31 Oct 2013, at 09:15, Haluk Karamete wrote:
>>>> 
>>>>> Hi Guys...
>>>>> 
>>>>> I have a question  that has two parts...
>>>>> 
>>>>> One philosophical and the other is practical... before I get into that,
>>>> let
>>>>> me set the context of this question.
>>>>> 
>>>>> This question does not apply to small business or blogs.
>>>>> It applies to huge sites that have thousands of posts, perhaps over
>>>> 100,000.
>>>>> 
>>>>> Search is a key feature to me, like to many other people.
>>>>> 
>>>>> I know there are a ton of great plugins out there specializing on
>> search.
>>>>> There are great minds & work behind those plugins & I respect the work
>>>>> highly.
>>>>> 
>>>>> But when it comes to search, I don't think Google is beatable.
>>>>> 
>>>>> I think no matter how dedicated a group might be, they won't be able to
>>>>> come up with something that does better than what Google can. I'm
>>>> including
>>>>> in this statement Yahoo & Bing, let alone the plugins that I've talked
>>>>> about.
>>>>> 
>>>>> There are 2 kinds of searches to me.
>>>>> 
>>>>> the kind that is super accurate ( accurate to the dot ) and this kind
>> of
>>>>> search usually comes with no wisdom. They are handy for certain
>>>>> implementations such as searching a code base.. you can go really
>>>> accurate
>>>>> with all kinds of  and's &  or's & contains etc...  like an editor's
>>>> search
>>>>> 
>>>>> and there is the other kind of search..  this one comes with wisdom.
>>>>> it won't match to certain results because it *somehow* factors in some
>>>>> wisdom, and it simply avoids some results that the first type of search
>>>>> mentality I've referred above. For example, a query on "Ramadan" won't
>>>>> match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches
>> "Five
>>>>> Pillars". Well, that's google.
>>>>> 
>>>>> I'd like to hear your opinions on this. Cause I maybe seeing it wrong,
>>>>> there could be some solutions that come somewhat close to Google's way
>> of
>>>>> doing it. But honestly, I'm almost 100% sure, that there is no better
>>>> way.
>>>>> 
>>>>> Until you convince me otherwise, I would think that if you are in
>> charge
>>>> of
>>>>> a site like TechCrunch, New York Times or NPR etc, the search must be
>>>> based
>>>>> on Google.
>>>>> 
>>>>> Second part of my question is if you agree with this point of view of
>>>> mine,
>>>>> would you please give me a few leads as to which plugins or solutions
>>>> that
>>>>> you may recommend that would integrate Google search into a WordPress
>>>> site.
>>>>> 
>>>>> And BTW, I just did a search on wordpress.org just to see how
>>>> Wordpress.org
>>>>> was handling the search ( cause honestly, I did not know how the codex
>>>>> handled the search aspect & I was going to compare wordpress.org's
>>>> search
>>>>> results to google with site:wordpress.org - but it turned out that
>>>>> WordPress.org too adapted Google when it comes to search. :)
>>>>> 
>>>>> In that case, I could ask now if there is a recommended practice in
>>>> setting
>>>>> up the custom google seathe way Wordpress.org did.
>>>>> 
>>>>> THank you
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From david at ernsts.us  Thu Oct 31 13:36:35 2013
From: david at ernsts.us (David Ernst)
Date: Thu, 31 Oct 2013 09:36:35 -0400
Subject: [wp-hackers] WordPress Search
In-Reply-To: <18DAC506-E9B6-4F66-8C5D-0F71BA8DFE6D@wpsites.co.uk>
References: <CAHERW=0vEV5po+jQCewTds13tQaOg9s32fk7ttJ+NCqJuKVgRA@mail.gmail.com>
 <1D8818C3-62BA-4B8A-923E-D56503703E0C@wpsites.co.uk>
 <CAHERW=1-ak6fFubGPzXprc2168OH5=+VHwODv4qTNGTKbm99Dw@mail.gmail.com>
 <F5A0AE4B-78FD-476C-9CAB-8059B9F30578@wpsites.co.uk>
 <CANmL2P-OBs3GuHewmwVqfZoWE98mBpC6ZUaGg=Zn6abL8R6XeA@mail.gmail.com>
 <18DAC506-E9B6-4F66-8C5D-0F71BA8DFE6D@wpsites.co.uk>
Message-ID: <CANmL2P_gRoW5E9GpW6d+Up4DX4nKDjeivyx99=SHu0EFj6EqiQ@mail.gmail.com>

Google *does* offers this documentation page about influencing Custom
Search results: Custom
Ranking<https://developers.google.com/custom-search/docs/ranking>. But
as you say, Simon, this approach could probably never be as finely tuned as
Elasticsearch.


On Thu, Oct 31, 2013 at 9:29 AM, Simon Dunton - WP Sites <
simon at wpsites.co.uk> wrote:

> No, Google Custom Search is Google so probably does use page rank when
> ranking results but if you set up Google Custom Search to only list your
> website and a couple of others then the page rank algorithm probably
> doesn't come in to it much, maybe not at all, I'm not sure.
>
> I didn't even factor in page rank when I was thinking about Elasticsearch.
> With Elasticsearch you index your posts content and title, links don't come
> into it but if you think inbound links are a really good indicator of how
> important a page of content is then you could spider links and create an
> index of inbound link data like Google does but for most cases it probably
> overkill. Saying that I'm sure it wouldn't be too hard to index the links
> within your own content and throw that into the mix. With a custom
> Elasticsearch setup you can index what you think is relevant and decide on
> your own importance/relevancy indicators.
>
>
> On 31 Oct 2013, at 13:17, David Ernst wrote:
>
> >>
> >> Google doesn't know what is important on your website as well as you do,
> >> Google just takes a generic approach, but you can tailor it to your
> content.
> >
> >
> > Simon, are you suggesting that Google Custom Search ignores PageRank?
> Did I
> > understand you correctly?
> >
> >
> > On Thu, Oct 31, 2013 at 8:33 AM, Simon Dunton - WP Sites <
> > simon at wpsites.co.uk> wrote:
> >
> >> Hi,
> >>
> >> Elasticsearch is a more complicated route but if search is important to
> >> you and you want total control then it's a good option.
> >>
> >> Elasticsearch has a number of analyzers that can be used to break up the
> >> query and index tokens
> >>
> http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.htmlsoyou could for instance pretty easily replace textual representations of
> >> numbers in the query; so "5 Pillars" could be automatically converted to
> >> "(5 OR five) Pillars".
> >>
> >> It's probably an impossible task to create your own version of Google
> but
> >> in many cases for your own data especially if it's a bit more
> specialised I
> >> think a custom Elasticsearch solution is going to be more relevant than
> >> Google could ever be. Google doesn't know what is important on your
> website
> >> as well as you do, Google just takes a generic approach, but you can
> tailor
> >> it to your content. Just for generic text i.e. if your site is a blog
> about
> >> general stuff your not going to have too much to work with but if your
> site
> >> was the WordPress codex/forums then you're going to know a whole load
> more
> >> about your sites data and structure than Google and you can use that
> edge
> >> to create a better search experience for your users than you could ever
> get
> >> from Google Custom Search.
> >>
> >> Sorry if I waffled a bit there, in a bit of a rush with work!
> >>
> >> Simon
> >>
> >> On 31 Oct 2013, at 11:18, Haluk Karamete wrote:
> >>
> >>> Thank you for your feedback Simon.
> >>>
> >>> After you pointing out that a custom Google search is not as good as
> >> Google
> >>> search, I compared these two;
> >>>
> >>> this one searches  "advanced taxonomy posts" on wordpress.org web site
> >>> http://wordpress.org/search/advanced%20taxonomy%20posts
> >>>
> >>> and this one searches "advanced taxonomy posts" on google.com with a
> >> search
> >>> operator attached (site:wordpress.org)
> >>>
> >>
> https://www.google.com/search?num=100&q=site%3Awordpress.org+advanced+taxonomy+posts&oq=site%3Awordpress.org+advanced+taxonomy+posts&gs_l=serp.3...68176.72806.0.76162.23.23.0.0.0.0.117.1552.22j1.23.0.cprnk%2Caddre%3Dcollection...0...1.1.30.serp..23.0.0.mY8gd8FhLtc
> >>>
> >>> Obviously results are pretty close but not identical. Both are good and
> >>> share a lot in common.
> >>> I have done some other searches but I feel like Google search results
> >> are a
> >>> little better, more mature. But it makes me think why there is a
> >>> difference?
> >>>
> >>> I guess there are some settings internally set somewhere and that
> >> modifies
> >>> the way the results are served. ( PS. I'm *not* referring here how the
> >>> search results are displayed format wise, I mean the actual order and
> the
> >>> result set... ) They are definitely not identical.
> >>>
> >>> As to the elasticsearch you refer to, from an earlier look, it looks
> >> like a
> >>> complicated route to me.
> >>>
> >>> Does the elasticsearch be able to handle "5 Pillars" and the "Tariq
> >>> Ramadan" examples I gave you in my earlier post?
> >>> Can it handle 5+5 type search? ( Not that I need this but... )
> >>> Could elasticsearch leverage Google search with all of its
> intelligence,
> >> or
> >>> is it a complete "DIY" situation here?
> >>>
> >>> I'm just curious.
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 3:38 AM, Simon Dunton - WP Sites <
> >>> simon at wpsites.co.uk> wrote:
> >>>
> >>>> Hi,
> >>>>
> >>>> WordPress.org must be using https://www.google.co.uk/cse/
> >>>>
> >>>> In my opinion Google custom search engines are useless. Yes you can
> >>>> specify which sites you want to index and tweak some settings but in
> my
> >>>> experience the results aren't as good as a normal Google search (I
> used
> >> it
> >>>> years ago so might have improved since then) and besides, do you
> really
> >>>> want Google to decide which factors are most relevant when it comes to
> >>>> searching on your website?
> >>>>
> >>>> I think the best way is get your self an elasticsearch
> instance/cluster
> >>>> have all your post content automatically feed into elasticsearch to be
> >>>> indexed and you're totally in control.
> >>>>
> >>>> Simon
> >>>>
> >>>>
> >>>> On 31 Oct 2013, at 09:15, Haluk Karamete wrote:
> >>>>
> >>>>> Hi Guys...
> >>>>>
> >>>>> I have a question  that has two parts...
> >>>>>
> >>>>> One philosophical and the other is practical... before I get into
> that,
> >>>> let
> >>>>> me set the context of this question.
> >>>>>
> >>>>> This question does not apply to small business or blogs.
> >>>>> It applies to huge sites that have thousands of posts, perhaps over
> >>>> 100,000.
> >>>>>
> >>>>> Search is a key feature to me, like to many other people.
> >>>>>
> >>>>> I know there are a ton of great plugins out there specializing on
> >> search.
> >>>>> There are great minds & work behind those plugins & I respect the
> work
> >>>>> highly.
> >>>>>
> >>>>> But when it comes to search, I don't think Google is beatable.
> >>>>>
> >>>>> I think no matter how dedicated a group might be, they won't be able
> to
> >>>>> come up with something that does better than what Google can. I'm
> >>>> including
> >>>>> in this statement Yahoo & Bing, let alone the plugins that I've
> talked
> >>>>> about.
> >>>>>
> >>>>> There are 2 kinds of searches to me.
> >>>>>
> >>>>> the kind that is super accurate ( accurate to the dot ) and this kind
> >> of
> >>>>> search usually comes with no wisdom. They are handy for certain
> >>>>> implementations such as searching a code base.. you can go really
> >>>> accurate
> >>>>> with all kinds of  and's &  or's & contains etc...  like an editor's
> >>>> search
> >>>>>
> >>>>> and there is the other kind of search..  this one comes with wisdom.
> >>>>> it won't match to certain results because it *somehow* factors in
> some
> >>>>> wisdom, and it simply avoids some results that the first type of
> search
> >>>>> mentality I've referred above. For example, a query on "Ramadan"
> won't
> >>>>> match "Tariq Ramadan" here. But yet a query on "5 Pillars" matches
> >> "Five
> >>>>> Pillars". Well, that's google.
> >>>>>
> >>>>> I'd like to hear your opinions on this. Cause I maybe seeing it
> wrong,
> >>>>> there could be some solutions that come somewhat close to Google's
> way
> >> of
> >>>>> doing it. But honestly, I'm almost 100% sure, that there is no better
> >>>> way.
> >>>>>
> >>>>> Until you convince me otherwise, I would think that if you are in
> >> charge
> >>>> of
> >>>>> a site like TechCrunch, New York Times or NPR etc, the search must be
> >>>> based
> >>>>> on Google.
> >>>>>
> >>>>> Second part of my question is if you agree with this point of view of
> >>>> mine,
> >>>>> would you please give me a few leads as to which plugins or solutions
> >>>> that
> >>>>> you may recommend that would integrate Google search into a WordPress
> >>>> site.
> >>>>>
> >>>>> And BTW, I just did a search on wordpress.org just to see how
> >>>> Wordpress.org
> >>>>> was handling the search ( cause honestly, I did not know how the
> codex
> >>>>> handled the search aspect & I was going to compare wordpress.org's
> >>>> search
> >>>>> results to google with site:wordpress.org - but it turned out that
> >>>>> WordPress.org too adapted Google when it comes to search. :)
> >>>>>
> >>>>> In that case, I could ask now if there is a recommended practice in
> >>>> setting
> >>>>> up the custom google seathe way Wordpress.org did.
> >>>>>
> >>>>> THank you
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Thu Oct 31 17:10:10 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Thu, 31 Oct 2013 10:10:10 -0700 (PDT)
Subject: [wp-hackers] Add Friend - Ajax - Failing & Don't See Why...
Message-ID: <1383239408342-42686.post@n5.nabble.com>

Alright, A button that triggers an update_user_meta function, which adds the
user ID of profile user user to the meta field 'friends' belonging to the
user_meta of the currently active user.    I click add friend, and the
success action runs, but I get a "failed" alert.   I dont see any errors
popping up in the console.

Any ideas?  Also- Is there a way to view errors that occur off page, inside
funtions.php?  That would be an immense help.

<?php //friends
echo "<button id='add_friend' value=".$_current_member->ID.">Add
Friend</button>";
?>

<script type="text/javascript">
jQuery( document ).ready( function( $ ) { 
                $( '#add_friend').click( function( event ) { 
                var $button2 = $(this);
                var profileID = $(this).attr('value'); 
		var ajaxurl = '<?php echo admin_url('admin-ajax.php') ?>';

                var data = { 
                        'action': 'my_add_friend_action', 
                        'profileID': profileID  } 

                $.post( 
                        ajaxurl, 
                        data,
                        function ( response ) { 
                                if ( ! response.success ) { 
                                        alert( 'Failure!' ); } 
                                       						
		$button2.html("FRIEND ADDED");

                        } 
                ); 
        }); 
}); 

and the wordpress function that handles this:

add_action('wp_ajax_my_add_friend_actionn', 'my_add_friend_action');
add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
function my_add_friend_action() {
	global $wpdb, $current_user;
        get_currentuserinfo();
		
	$profileID = $_POST['profileID'];
	$userID = $_POST['userID'];
	
//	activity_tracker($current_user, 'added_friend', 'prof');
	update_user_meta( $user->ID, 'friends', $profileID );
	
	$response = array( 'success' => true ); 
		
	wp_send_json_success($response);

	die();
}



--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/Add-Friend-Ajax-Failing-Don-t-See-Why-tp42686.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From ian at iandunn.name  Thu Oct 31 17:11:00 2013
From: ian at iandunn.name (Ian Dunn)
Date: Thu, 31 Oct 2013 10:11:00 -0700
Subject: [wp-hackers] WordPress extended.
In-Reply-To: <CAHERW=2S_dRzKEf8MkHzD6CEW6X9sK4jp7huYuP+PAJmPoOsmQ@mail.gmail.com>
References: <CAHERW=0OfAFXF_fAY_o2+83jEVfR-BQ59niYqKoN0HNxzXi=gw@mail.gmail.com>
 <CAM_fM0pwM1v38-_7=kMpy5aHPv-w=3H7gON88mrPSqRKQ5f0jQ@mail.gmail.com>
 <CAHERW=2S_dRzKEf8MkHzD6CEW6X9sK4jp7huYuP+PAJmPoOsmQ@mail.gmail.com>
Message-ID: <52728F24.1010907@iandunn.name>

On 10/31/13 2:24 AM, Haluk Karamete wrote:
> But my 2 cents is that "WordPress Extended" comes across as if it were to
> be something different than "WordPress".

The Codex is a Wiki, so if you see something wrong with it, please fix it :)

From greglancaster71 at gmail.com  Thu Oct 31 17:32:34 2013
From: greglancaster71 at gmail.com (BenderisGreat)
Date: Thu, 31 Oct 2013 10:32:34 -0700 (PDT)
Subject: [wp-hackers] array_push on update_user_meta
Message-ID: <1383240754206-42688.post@n5.nabble.com>

I am not sure exactly how this would work because I start with an empty
meta_value field.  I dont think I can use array_push if there is not at
least one value in the field, correct?  

So maybe something like this:

$profileID = $_POST['profileID'];

$chkMetaValue = get_user_meta($userID,"friends");
	if (!empty($chkMetaValue))
		{
		array_push($profileID);
		} else {
		$profileID;
		}

update_user_meta( $userID, 'friends', $chkMetaValue );

Is that right?




--
View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
Sent from the Wordpress Hackers mailing list archive at Nabble.com.

From jdg at codesymphony.co  Thu Oct 31 18:29:51 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 14:29:51 -0400
Subject: [wp-hackers] Add Friend - Ajax - Failing & Don't See Why...
In-Reply-To: <1383239408342-42686.post@n5.nabble.com>
References: <1383239408342-42686.post@n5.nabble.com>
Message-ID: <1B2CC7C8-D5A3-4F3F-8E07-B318B8B09219@codesymphony.co>

>  Is there a way to view errors that occur off page, inside
> funtions.php?  That would be an immense help.

Are you using WP_DEBUG? https://codex.wordpress.org/WP_DEBUG

I think your error is a typo here:

> add_action('wp_ajax_my_add_friend_actionn', 'my_add_friend_action');

There's an extra 'n' at the end of the action name.

-J.D.

From jdg at codesymphony.co  Thu Oct 31 18:32:38 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 14:32:38 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <1383240754206-42688.post@n5.nabble.com>
References: <1383240754206-42688.post@n5.nabble.com>
Message-ID: <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>

I would do this:

$profileID = $_POST['profileID'];

$chkMetaValue = get_user_meta($userID,"friends");

if ( ! is_array($chkMetaValue) )
	$chkMetaValue = array();

$chkMetaValue[] = $profileID; // or use array_push()

update_user_meta( $userID, 'friends', $chkMetaValue );

-J.D.

On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com> wrote:

> I am not sure exactly how this would work because I start with an empty
> meta_value field.  I dont think I can use array_push if there is not at
> least one value in the field, correct?  
> 
> So maybe something like this:
> 
> $profileID = $_POST['profileID'];
> 
> $chkMetaValue = get_user_meta($userID,"friends");
> 	if (!empty($chkMetaValue))
> 		{
> 		array_push($profileID);
> 		} else {
> 		$profileID;
> 		}
> 
> update_user_meta( $userID, 'friends', $chkMetaValue );
> 
> Is that right?
> 
> 
> 
> 
> --
> View this message in context: http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 18:48:03 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 11:48:03 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
Message-ID: <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>

That works easier :)  Once someone is friended I have it set so an unfriend
button replaces the add friend button via ajax.  Is it necessary to write
another function for deleting a person?  Not sure exactly how to make the
new button function since the data being sent is not attached to the button
in any way.  maybe I could add a value to the button that says remove or
add, which would be passed to the function and determine what action to
take?


On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> I would do this:
>
> $profileID = $_POST['profileID'];
>
> $chkMetaValue = get_user_meta($userID,"friends");
>
> if ( ! is_array($chkMetaValue) )
>         $chkMetaValue = array();
>
> $chkMetaValue[] = $profileID; // or use array_push()
>
> update_user_meta( $userID, 'friends', $chkMetaValue );
>
> -J.D.
>
> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com>
> wrote:
>
> > I am not sure exactly how this would work because I start with an empty
> > meta_value field.  I dont think I can use array_push if there is not at
> > least one value in the field, correct?
> >
> > So maybe something like this:
> >
> > $profileID = $_POST['profileID'];
> >
> > $chkMetaValue = get_user_meta($userID,"friends");
> >       if (!empty($chkMetaValue))
> >               {
> >               array_push($profileID);
> >               } else {
> >               $profileID;
> >               }
> >
> > update_user_meta( $userID, 'friends', $chkMetaValue );
> >
> > Is that right?
> >
> >
> >
> >
> > --
> > View this message in context:
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> > Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 18:53:42 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 14:53:42 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
Message-ID: <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>

Yes, I would write a separate function for removal, and hook it to a different AJAX action for removal.

On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> That works easier :)  Once someone is friended I have it set so an unfriend
> button replaces the add friend button via ajax.  Is it necessary to write
> another function for deleting a person?  Not sure exactly how to make the
> new button function since the data being sent is not attached to the button
> in any way.  maybe I could add a value to the button that says remove or
> add, which would be passed to the function and determine what action to
> take?
> 
> 
> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> I would do this:
>> 
>> $profileID = $_POST['profileID'];
>> 
>> $chkMetaValue = get_user_meta($userID,"friends");
>> 
>> if ( ! is_array($chkMetaValue) )
>>        $chkMetaValue = array();
>> 
>> $chkMetaValue[] = $profileID; // or use array_push()
>> 
>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> 
>> -J.D.
>> 
>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> I am not sure exactly how this would work because I start with an empty
>>> meta_value field.  I dont think I can use array_push if there is not at
>>> least one value in the field, correct?
>>> 
>>> So maybe something like this:
>>> 
>>> $profileID = $_POST['profileID'];
>>> 
>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>      if (!empty($chkMetaValue))
>>>              {
>>>              array_push($profileID);
>>>              } else {
>>>              $profileID;
>>>              }
>>> 
>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>> 
>>> Is that right?
>>> 
>>> 
>>> 
>>> 
>>> --
>>> View this message in context:
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 19:14:23 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 12:14:23 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
Message-ID: <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>

I thought so.  One more question if you dont mind helping;

This is the function I wrote to determine what button to show on page load.
 But regardless if someone has been friended or not, it shows the add
friend option.  Is something wrong with this?


function friend_status($author_id) {
global $wpdb, $current_user;
      get_currentuserinfo();

  //authorID is the userID of the profile owner

  $active_user = $current_user->ID;
  $active_user_friends = get_user_meta($active_user, 'friends');

  if (in_array($author_id, $active_user_friends)) {
  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
  } else {
  $friend_status = "<button id='add_friend'>Add Friend</button>";
  }

 return $friend_status;
}

Then on page:  echo $friend_status;


On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, I would write a separate function for removal, and hook it to a
> different AJAX action for removal.
>
> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > That works easier :)  Once someone is friended I have it set so an
> unfriend
> > button replaces the add friend button via ajax.  Is it necessary to write
> > another function for deleting a person?  Not sure exactly how to make the
> > new button function since the data being sent is not attached to the
> button
> > in any way.  maybe I could add a value to the button that says remove or
> > add, which would be passed to the function and determine what action to
> > take?
> >
> >
> > On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> I would do this:
> >>
> >> $profileID = $_POST['profileID'];
> >>
> >> $chkMetaValue = get_user_meta($userID,"friends");
> >>
> >> if ( ! is_array($chkMetaValue) )
> >>        $chkMetaValue = array();
> >>
> >> $chkMetaValue[] = $profileID; // or use array_push()
> >>
> >> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>
> >> -J.D.
> >>
> >> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> I am not sure exactly how this would work because I start with an empty
> >>> meta_value field.  I dont think I can use array_push if there is not at
> >>> least one value in the field, correct?
> >>>
> >>> So maybe something like this:
> >>>
> >>> $profileID = $_POST['profileID'];
> >>>
> >>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>      if (!empty($chkMetaValue))
> >>>              {
> >>>              array_push($profileID);
> >>>              } else {
> >>>              $profileID;
> >>>              }
> >>>
> >>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>
> >>> Is that right?
> >>>
> >>>
> >>>
> >>>
> >>> --
> >>> View this message in context:
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 19:24:16 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 15:24:16 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
Message-ID: <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>

Yes, when you call get_user_meta() you need to set the third parameter ($single) to true:

$active_user_friends = get_user_meta( $active_user, ?friends?, true );

Otherwise it will return a nested array. Also, just FYI, alternatively you could leave the get_user_meta() call the way it is, and change it so that each friend is stored in a separate meta row (but with the same meta key - have a look at the *_user_meta functions on the codex).

-J.D.

On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I thought so.  One more question if you dont mind helping;
> 
> This is the function I wrote to determine what button to show on page load.
> But regardless if someone has been friended or not, it shows the add
> friend option.  Is something wrong with this?
> 
> 
> function friend_status($author_id) {
> global $wpdb, $current_user;
>      get_currentuserinfo();
> 
>  //authorID is the userID of the profile owner
> 
>  $active_user = $current_user->ID;
>  $active_user_friends = get_user_meta($active_user, 'friends');
> 
>  if (in_array($author_id, $active_user_friends)) {
>  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>  } else {
>  $friend_status = "<button id='add_friend'>Add Friend</button>";
>  }
> 
> return $friend_status;
> }
> 
> Then on page:  echo $friend_status;
> 
> 
> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Yes, I would write a separate function for removal, and hook it to a
>> different AJAX action for removal.
>> 
>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> That works easier :)  Once someone is friended I have it set so an
>> unfriend
>>> button replaces the add friend button via ajax.  Is it necessary to write
>>> another function for deleting a person?  Not sure exactly how to make the
>>> new button function since the data being sent is not attached to the
>> button
>>> in any way.  maybe I could add a value to the button that says remove or
>>> add, which would be passed to the function and determine what action to
>>> take?
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> I would do this:
>>>> 
>>>> $profileID = $_POST['profileID'];
>>>> 
>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>> 
>>>> if ( ! is_array($chkMetaValue) )
>>>>       $chkMetaValue = array();
>>>> 
>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>> 
>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>> 
>>>> -J.D.
>>>> 
>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> I am not sure exactly how this would work because I start with an empty
>>>>> meta_value field.  I dont think I can use array_push if there is not at
>>>>> least one value in the field, correct?
>>>>> 
>>>>> So maybe something like this:
>>>>> 
>>>>> $profileID = $_POST['profileID'];
>>>>> 
>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>     if (!empty($chkMetaValue))
>>>>>             {
>>>>>             array_push($profileID);
>>>>>             } else {
>>>>>             $profileID;
>>>>>             }
>>>>> 
>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>> 
>>>>> Is that right?
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> --
>>>>> View this message in context:
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 19:30:14 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 12:30:14 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
Message-ID: <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>

What would be the benefit of storing the friends in separate rows? I did
not know that was an option, but don't see any clear advantages either.
 Also, I did just search the codex but dont see anything about unique rows.
 (I checked get_user_meta, delete_user_meta, update_user_meta. )


On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, when you call get_user_meta() you need to set the third parameter
> ($single) to true:
>
> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
>
> Otherwise it will return a nested array. Also, just FYI, alternatively you
> could leave the get_user_meta() call the way it is, and change it so that
> each friend is stored in a separate meta row (but with the same meta key -
> have a look at the *_user_meta functions on the codex).
>
> -J.D.
>
> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > I thought so.  One more question if you dont mind helping;
> >
> > This is the function I wrote to determine what button to show on page
> load.
> > But regardless if someone has been friended or not, it shows the add
> > friend option.  Is something wrong with this?
> >
> >
> > function friend_status($author_id) {
> > global $wpdb, $current_user;
> >      get_currentuserinfo();
> >
> >  //authorID is the userID of the profile owner
> >
> >  $active_user = $current_user->ID;
> >  $active_user_friends = get_user_meta($active_user, 'friends');
> >
> >  if (in_array($author_id, $active_user_friends)) {
> >  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >  } else {
> >  $friend_status = "<button id='add_friend'>Add Friend</button>";
> >  }
> >
> > return $friend_status;
> > }
> >
> > Then on page:  echo $friend_status;
> >
> >
> > On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Yes, I would write a separate function for removal, and hook it to a
> >> different AJAX action for removal.
> >>
> >> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> That works easier :)  Once someone is friended I have it set so an
> >> unfriend
> >>> button replaces the add friend button via ajax.  Is it necessary to
> write
> >>> another function for deleting a person?  Not sure exactly how to make
> the
> >>> new button function since the data being sent is not attached to the
> >> button
> >>> in any way.  maybe I could add a value to the button that says remove
> or
> >>> add, which would be passed to the function and determine what action to
> >>> take?
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> I would do this:
> >>>>
> >>>> $profileID = $_POST['profileID'];
> >>>>
> >>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>
> >>>> if ( ! is_array($chkMetaValue) )
> >>>>       $chkMetaValue = array();
> >>>>
> >>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>
> >>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>
> >>>> -J.D.
> >>>>
> >>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com
> >
> >>>> wrote:
> >>>>
> >>>>> I am not sure exactly how this would work because I start with an
> empty
> >>>>> meta_value field.  I dont think I can use array_push if there is not
> at
> >>>>> least one value in the field, correct?
> >>>>>
> >>>>> So maybe something like this:
> >>>>>
> >>>>> $profileID = $_POST['profileID'];
> >>>>>
> >>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>     if (!empty($chkMetaValue))
> >>>>>             {
> >>>>>             array_push($profileID);
> >>>>>             } else {
> >>>>>             $profileID;
> >>>>>             }
> >>>>>
> >>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>
> >>>>> Is that right?
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> --
> >>>>> View this message in context:
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Thu Oct 31 19:38:15 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 12:38:15 -0700
Subject: [wp-hackers] Add Friend - Ajax - Failing & Don't See Why...
In-Reply-To: <1B2CC7C8-D5A3-4F3F-8E07-B318B8B09219@codesymphony.co>
References: <1383239408342-42686.post@n5.nabble.com>
 <1B2CC7C8-D5A3-4F3F-8E07-B318B8B09219@codesymphony.co>
Message-ID: <CAPN-N+YZ7XTzwA5YUuTv=Meh57=HCO8JZAVJnopGz2grs3ut=Q@mail.gmail.com>

I do have debug on, but that doesnt show me any errors going on inside a
plugin file.  Is there a way to var_dump variables inside a plugin file
like that?


On Thu, Oct 31, 2013 at 11:29 AM, J.D. Grimes <jdg at codesymphony.co> wrote:

> >  Is there a way to view errors that occur off page, inside
> > funtions.php?  That would be an immense help.
>
> Are you using WP_DEBUG? https://codex.wordpress.org/WP_DEBUG
>
> I think your error is a typo here:
>
> > add_action('wp_ajax_my_add_friend_actionn', 'my_add_friend_action');
>
> There's an extra 'n' at the end of the action name.
>
> -J.D.
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Thu Oct 31 19:44:23 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 12:44:23 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
Message-ID: <CAPN-N+YA8Aoup+MWRtdA8rdFk5qxm29zYYe6GbVh0hwShrk6UQ@mail.gmail.com>

I tried adding true but that only returns one at a time, so it only checks
if the last friend added is in the array.


On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, when you call get_user_meta() you need to set the third parameter
> ($single) to true:
>
> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
>
> Otherwise it will return a nested array. Also, just FYI, alternatively you
> could leave the get_user_meta() call the way it is, and change it so that
> each friend is stored in a separate meta row (but with the same meta key -
> have a look at the *_user_meta functions on the codex).
>
> -J.D.
>
> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > I thought so.  One more question if you dont mind helping;
> >
> > This is the function I wrote to determine what button to show on page
> load.
> > But regardless if someone has been friended or not, it shows the add
> > friend option.  Is something wrong with this?
> >
> >
> > function friend_status($author_id) {
> > global $wpdb, $current_user;
> >      get_currentuserinfo();
> >
> >  //authorID is the userID of the profile owner
> >
> >  $active_user = $current_user->ID;
> >  $active_user_friends = get_user_meta($active_user, 'friends');
> >
> >  if (in_array($author_id, $active_user_friends)) {
> >  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >  } else {
> >  $friend_status = "<button id='add_friend'>Add Friend</button>";
> >  }
> >
> > return $friend_status;
> > }
> >
> > Then on page:  echo $friend_status;
> >
> >
> > On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Yes, I would write a separate function for removal, and hook it to a
> >> different AJAX action for removal.
> >>
> >> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> That works easier :)  Once someone is friended I have it set so an
> >> unfriend
> >>> button replaces the add friend button via ajax.  Is it necessary to
> write
> >>> another function for deleting a person?  Not sure exactly how to make
> the
> >>> new button function since the data being sent is not attached to the
> >> button
> >>> in any way.  maybe I could add a value to the button that says remove
> or
> >>> add, which would be passed to the function and determine what action to
> >>> take?
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> I would do this:
> >>>>
> >>>> $profileID = $_POST['profileID'];
> >>>>
> >>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>
> >>>> if ( ! is_array($chkMetaValue) )
> >>>>       $chkMetaValue = array();
> >>>>
> >>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>
> >>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>
> >>>> -J.D.
> >>>>
> >>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com
> >
> >>>> wrote:
> >>>>
> >>>>> I am not sure exactly how this would work because I start with an
> empty
> >>>>> meta_value field.  I dont think I can use array_push if there is not
> at
> >>>>> least one value in the field, correct?
> >>>>>
> >>>>> So maybe something like this:
> >>>>>
> >>>>> $profileID = $_POST['profileID'];
> >>>>>
> >>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>     if (!empty($chkMetaValue))
> >>>>>             {
> >>>>>             array_push($profileID);
> >>>>>             } else {
> >>>>>             $profileID;
> >>>>>             }
> >>>>>
> >>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>
> >>>>> Is that right?
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> --
> >>>>> View this message in context:
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 19:54:10 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 15:54:10 -0400
Subject: [wp-hackers] Add Friend - Ajax - Failing & Don't See Why...
In-Reply-To: <CAPN-N+YZ7XTzwA5YUuTv=Meh57=HCO8JZAVJnopGz2grs3ut=Q@mail.gmail.com>
References: <1383239408342-42686.post@n5.nabble.com>
 <1B2CC7C8-D5A3-4F3F-8E07-B318B8B09219@codesymphony.co>
 <CAPN-N+YZ7XTzwA5YUuTv=Meh57=HCO8JZAVJnopGz2grs3ut=Q@mail.gmail.com>
Message-ID: <DFC3F615-C332-4665-8B3B-725B4A208808@codesymphony.co>

Debug does show/log errors inside plugin files. I guess maybe what you are asking is if there is a way to do a var_dump, but into the error log? Here is a function that I use for that:

/**
 * Dump a variable to the error log.
 *
 * You can pass as many variables as you want!
 *
 * @param mixed $var
 * @param mixed ...
 */
function var_log() {

	ob_start();
	call_user_func_array( 'var_dump', func_get_args() );
	error_log( ob_get_clean() );
}

Usage:

var_log( $var, $var_2 );

-J.D.

On Oct 31, 2013, at 3:38 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I do have debug on, but that doesnt show me any errors going on inside a
> plugin file.  Is there a way to var_dump variables inside a plugin file
> like that?
> 
> 
> On Thu, Oct 31, 2013 at 11:29 AM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>>> Is there a way to view errors that occur off page, inside
>>> funtions.php?  That would be an immense help.
>> 
>> Are you using WP_DEBUG? https://codex.wordpress.org/WP_DEBUG
>> 
>> I think your error is a typo here:
>> 
>>> add_action('wp_ajax_my_add_friend_actionn', 'my_add_friend_action');
>> 
>> There's an extra 'n' at the end of the action name.
>> 
>> -J.D.
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From jdg at codesymphony.co  Thu Oct 31 20:08:51 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 16:08:51 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
Message-ID: <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>

There are two ways to use the *_meta functions. The way it looks like you are doing it is that each user has a single entry in the usermeta table, with the key ?friends?. The value for this meta key will be stored in the database as a serialized array, and when it is pulled out (by get_user_meta()) it gets unserialized into a PHP array. 

Alternative is this: Each user has multiple ?friend? meta key rows in the usermeta table, each one?s meta_value the ID of a single user that the user has friended.

The benefit of the second option is that the values may be easier to search. Much easier. But that may not be important to you right now. (But then that could change later?) What if you want to show a list of users who have friended a user? You will be able to do that easily with this. With the first option, it is possible, but more complex and probably harder on the DB.

The downside is that there are many more rows in usermeta table.

So each of these functions let you target a single row (as in first case) or all rows with a key (as in the later case). Whichever way you go, you just need to be consistent through all of the code, obviously.

-J.D.

On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> What would be the benefit of storing the friends in separate rows? I did
> not know that was an option, but don't see any clear advantages either.
> Also, I did just search the codex but dont see anything about unique rows.
> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> 
> 
> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Yes, when you call get_user_meta() you need to set the third parameter
>> ($single) to true:
>> 
>> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
>> 
>> Otherwise it will return a nested array. Also, just FYI, alternatively you
>> could leave the get_user_meta() call the way it is, and change it so that
>> each friend is stored in a separate meta row (but with the same meta key -
>> have a look at the *_user_meta functions on the codex).
>> 
>> -J.D.
>> 
>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> I thought so.  One more question if you dont mind helping;
>>> 
>>> This is the function I wrote to determine what button to show on page
>> load.
>>> But regardless if someone has been friended or not, it shows the add
>>> friend option.  Is something wrong with this?
>>> 
>>> 
>>> function friend_status($author_id) {
>>> global $wpdb, $current_user;
>>>     get_currentuserinfo();
>>> 
>>> //authorID is the userID of the profile owner
>>> 
>>> $active_user = $current_user->ID;
>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>> 
>>> if (in_array($author_id, $active_user_friends)) {
>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>> } else {
>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>> }
>>> 
>>> return $friend_status;
>>> }
>>> 
>>> Then on page:  echo $friend_status;
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> Yes, I would write a separate function for removal, and hook it to a
>>>> different AJAX action for removal.
>>>> 
>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> That works easier :)  Once someone is friended I have it set so an
>>>> unfriend
>>>>> button replaces the add friend button via ajax.  Is it necessary to
>> write
>>>>> another function for deleting a person?  Not sure exactly how to make
>> the
>>>>> new button function since the data being sent is not attached to the
>>>> button
>>>>> in any way.  maybe I could add a value to the button that says remove
>> or
>>>>> add, which would be passed to the function and determine what action to
>>>>> take?
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> I would do this:
>>>>>> 
>>>>>> $profileID = $_POST['profileID'];
>>>>>> 
>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>> 
>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>      $chkMetaValue = array();
>>>>>> 
>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>> 
>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>> 
>>>>>> -J.D.
>>>>>> 
>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <greglancaster71 at gmail.com
>>> 
>>>>>> wrote:
>>>>>> 
>>>>>>> I am not sure exactly how this would work because I start with an
>> empty
>>>>>>> meta_value field.  I dont think I can use array_push if there is not
>> at
>>>>>>> least one value in the field, correct?
>>>>>>> 
>>>>>>> So maybe something like this:
>>>>>>> 
>>>>>>> $profileID = $_POST['profileID'];
>>>>>>> 
>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>    if (!empty($chkMetaValue))
>>>>>>>            {
>>>>>>>            array_push($profileID);
>>>>>>>            } else {
>>>>>>>            $profileID;
>>>>>>>            }
>>>>>>> 
>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>> 
>>>>>>> Is that right?
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> --
>>>>>>> View this message in context:
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 20:30:31 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 13:30:31 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
Message-ID: <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>

Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
option is to just create a separate table to store the friends list in.
 Trying to work with user_meta this way seems like a bad idea.

Quick question, should I be using unserialize to check the array values
using in_array?  Because right now this code isnt working.  Thats the only
thing that seems to be left out - but when I tried using $unserialize like
this:

 $unserialize = unserialize($active_user_friends);
  if (in_array($author_id, $unserialize)) {

it says this:


*Warning*: unserialize() expects parameter 1 to be string, array given
and
*Warning*: in_array() expects parameter 2 to be array, boolean given




--------



add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
function my_add_friend_action() {
global $wpdb;
 $profileID = $_POST['profileID'];
$userID = $_POST['userID'];

$chkMetaValue = get_user_meta($userID,"friends");
 if ( ! is_array($chkMetaValue) )
$chkMetaValue = array();
 $chkMetaValue[] = $profileID;

// activity_tracker($current_user, 'added_friend', 'prof');
update_user_meta( $userID, 'friends', $chkMetaValue );
 $response = array( 'success' => true );
 wp_send_json_success($response);

die();
}


function friend_status($author_id) {
global $wpdb, $current_user;
      get_currentuserinfo();

  //authorID is the userID of the profile owner

  $active_user = $current_user->ID;
  $active_user_friends = get_user_meta($active_user, 'friends');

  if (in_array($author_id, $active_user_friends, true)) {
  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
  } else {
  $friend_status = "<button id='add_friend'>Add Friend</button>";
  }

 return $friend_status;
}


That is basically the code I am using to insert the users id into their
user_meta table.


On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> There are two ways to use the *_meta functions. The way it looks like you
> are doing it is that each user has a single entry in the usermeta table,
> with the key ?friends?. The value for this meta key will be stored in the
> database as a serialized array, and when it is pulled out (by
> get_user_meta()) it gets unserialized into a PHP array.
>
> Alternative is this: Each user has multiple ?friend? meta key rows in the
> usermeta table, each one?s meta_value the ID of a single user that the user
> has friended.
>
> The benefit of the second option is that the values may be easier to
> search. Much easier. But that may not be important to you right now. (But
> then that could change later?) What if you want to show a list of users who
> have friended a user? You will be able to do that easily with this. With
> the first option, it is possible, but more complex and probably harder on
> the DB.
>
> The downside is that there are many more rows in usermeta table.
>
> So each of these functions let you target a single row (as in first case)
> or all rows with a key (as in the later case). Whichever way you go, you
> just need to be consistent through all of the code, obviously.
>
> -J.D.
>
> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > What would be the benefit of storing the friends in separate rows? I did
> > not know that was an option, but don't see any clear advantages either.
> > Also, I did just search the codex but dont see anything about unique
> rows.
> > (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >
> >
> > On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Yes, when you call get_user_meta() you need to set the third parameter
> >> ($single) to true:
> >>
> >> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
> >>
> >> Otherwise it will return a nested array. Also, just FYI, alternatively
> you
> >> could leave the get_user_meta() call the way it is, and change it so
> that
> >> each friend is stored in a separate meta row (but with the same meta
> key -
> >> have a look at the *_user_meta functions on the codex).
> >>
> >> -J.D.
> >>
> >> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> I thought so.  One more question if you dont mind helping;
> >>>
> >>> This is the function I wrote to determine what button to show on page
> >> load.
> >>> But regardless if someone has been friended or not, it shows the add
> >>> friend option.  Is something wrong with this?
> >>>
> >>>
> >>> function friend_status($author_id) {
> >>> global $wpdb, $current_user;
> >>>     get_currentuserinfo();
> >>>
> >>> //authorID is the userID of the profile owner
> >>>
> >>> $active_user = $current_user->ID;
> >>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>
> >>> if (in_array($author_id, $active_user_friends)) {
> >>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >>> } else {
> >>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>> }
> >>>
> >>> return $friend_status;
> >>> }
> >>>
> >>> Then on page:  echo $friend_status;
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> Yes, I would write a separate function for removal, and hook it to a
> >>>> different AJAX action for removal.
> >>>>
> >>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> That works easier :)  Once someone is friended I have it set so an
> >>>> unfriend
> >>>>> button replaces the add friend button via ajax.  Is it necessary to
> >> write
> >>>>> another function for deleting a person?  Not sure exactly how to make
> >> the
> >>>>> new button function since the data being sent is not attached to the
> >>>> button
> >>>>> in any way.  maybe I could add a value to the button that says remove
> >> or
> >>>>> add, which would be passed to the function and determine what action
> to
> >>>>> take?
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> I would do this:
> >>>>>>
> >>>>>> $profileID = $_POST['profileID'];
> >>>>>>
> >>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>
> >>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>      $chkMetaValue = array();
> >>>>>>
> >>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>
> >>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>
> >>>>>> -J.D.
> >>>>>>
> >>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> greglancaster71 at gmail.com
> >>>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> I am not sure exactly how this would work because I start with an
> >> empty
> >>>>>>> meta_value field.  I dont think I can use array_push if there is
> not
> >> at
> >>>>>>> least one value in the field, correct?
> >>>>>>>
> >>>>>>> So maybe something like this:
> >>>>>>>
> >>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>
> >>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>    if (!empty($chkMetaValue))
> >>>>>>>            {
> >>>>>>>            array_push($profileID);
> >>>>>>>            } else {
> >>>>>>>            $profileID;
> >>>>>>>            }
> >>>>>>>
> >>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>
> >>>>>>> Is that right?
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> --
> >>>>>>> View this message in context:
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 20:40:25 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 16:40:25 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
Message-ID: <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>

No, you don?t need to use unserialize, that is all done automatically by the WordPress functions. 

In the code you posted you still aren?t calling get_user_meta() with the third parameter set to true. You need to do that. Right now the array it is returning looks something like this:

array(
	0 => array( 3, 45, 6, 33 )
)

When you call in_array() it is checking if the user ID (say, 3 ) is in the outer array. But it isn?t, the only thing in it is another array. When you call get_user_meta() with the third parameter set to true, the returned value won?t be wrapped in the outer array like that, so it will work.


On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
> option is to just create a separate table to store the friends list in.
> Trying to work with user_meta this way seems like a bad idea.
> 
> Quick question, should I be using unserialize to check the array values
> using in_array?  Because right now this code isnt working.  Thats the only
> thing that seems to be left out - but when I tried using $unserialize like
> this:
> 
> $unserialize = unserialize($active_user_friends);
>  if (in_array($author_id, $unserialize)) {
> 
> it says this:
> 
> 
> *Warning*: unserialize() expects parameter 1 to be string, array given
> and
> *Warning*: in_array() expects parameter 2 to be array, boolean given
> 
> 
> 
> 
> --------
> 
> 
> 
> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
> function my_add_friend_action() {
> global $wpdb;
> $profileID = $_POST['profileID'];
> $userID = $_POST['userID'];
> 
> $chkMetaValue = get_user_meta($userID,"friends");
> if ( ! is_array($chkMetaValue) )
> $chkMetaValue = array();
> $chkMetaValue[] = $profileID;
> 
> // activity_tracker($current_user, 'added_friend', 'prof');
> update_user_meta( $userID, 'friends', $chkMetaValue );
> $response = array( 'success' => true );
> wp_send_json_success($response);
> 
> die();
> }
> 
> 
> function friend_status($author_id) {
> global $wpdb, $current_user;
>      get_currentuserinfo();
> 
>  //authorID is the userID of the profile owner
> 
>  $active_user = $current_user->ID;
>  $active_user_friends = get_user_meta($active_user, 'friends');
> 
>  if (in_array($author_id, $active_user_friends, true)) {
>  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>  } else {
>  $friend_status = "<button id='add_friend'>Add Friend</button>";
>  }
> 
> return $friend_status;
> }
> 
> 
> That is basically the code I am using to insert the users id into their
> user_meta table.
> 
> 
> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> There are two ways to use the *_meta functions. The way it looks like you
>> are doing it is that each user has a single entry in the usermeta table,
>> with the key ?friends?. The value for this meta key will be stored in the
>> database as a serialized array, and when it is pulled out (by
>> get_user_meta()) it gets unserialized into a PHP array.
>> 
>> Alternative is this: Each user has multiple ?friend? meta key rows in the
>> usermeta table, each one?s meta_value the ID of a single user that the user
>> has friended.
>> 
>> The benefit of the second option is that the values may be easier to
>> search. Much easier. But that may not be important to you right now. (But
>> then that could change later?) What if you want to show a list of users who
>> have friended a user? You will be able to do that easily with this. With
>> the first option, it is possible, but more complex and probably harder on
>> the DB.
>> 
>> The downside is that there are many more rows in usermeta table.
>> 
>> So each of these functions let you target a single row (as in first case)
>> or all rows with a key (as in the later case). Whichever way you go, you
>> just need to be consistent through all of the code, obviously.
>> 
>> -J.D.
>> 
>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> What would be the benefit of storing the friends in separate rows? I did
>>> not know that was an option, but don't see any clear advantages either.
>>> Also, I did just search the codex but dont see anything about unique
>> rows.
>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> Yes, when you call get_user_meta() you need to set the third parameter
>>>> ($single) to true:
>>>> 
>>>> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
>>>> 
>>>> Otherwise it will return a nested array. Also, just FYI, alternatively
>> you
>>>> could leave the get_user_meta() call the way it is, and change it so
>> that
>>>> each friend is stored in a separate meta row (but with the same meta
>> key -
>>>> have a look at the *_user_meta functions on the codex).
>>>> 
>>>> -J.D.
>>>> 
>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> I thought so.  One more question if you dont mind helping;
>>>>> 
>>>>> This is the function I wrote to determine what button to show on page
>>>> load.
>>>>> But regardless if someone has been friended or not, it shows the add
>>>>> friend option.  Is something wrong with this?
>>>>> 
>>>>> 
>>>>> function friend_status($author_id) {
>>>>> global $wpdb, $current_user;
>>>>>    get_currentuserinfo();
>>>>> 
>>>>> //authorID is the userID of the profile owner
>>>>> 
>>>>> $active_user = $current_user->ID;
>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>> 
>>>>> if (in_array($author_id, $active_user_friends)) {
>>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>>>> } else {
>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>> }
>>>>> 
>>>>> return $friend_status;
>>>>> }
>>>>> 
>>>>> Then on page:  echo $friend_status;
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> Yes, I would write a separate function for removal, and hook it to a
>>>>>> different AJAX action for removal.
>>>>>> 
>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>>>> greglancaster71 at gmail.com>
>>>>>> wrote:
>>>>>> 
>>>>>>> That works easier :)  Once someone is friended I have it set so an
>>>>>> unfriend
>>>>>>> button replaces the add friend button via ajax.  Is it necessary to
>>>> write
>>>>>>> another function for deleting a person?  Not sure exactly how to make
>>>> the
>>>>>>> new button function since the data being sent is not attached to the
>>>>>> button
>>>>>>> in any way.  maybe I could add a value to the button that says remove
>>>> or
>>>>>>> add, which would be passed to the function and determine what action
>> to
>>>>>>> take?
>>>>>>> 
>>>>>>> 
>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co>
>>>>>> wrote:
>>>>>>> 
>>>>>>>> I would do this:
>>>>>>>> 
>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>> 
>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>> 
>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>     $chkMetaValue = array();
>>>>>>>> 
>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>>>> 
>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>> 
>>>>>>>> -J.D.
>>>>>>>> 
>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>> greglancaster71 at gmail.com
>>>>> 
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> I am not sure exactly how this would work because I start with an
>>>> empty
>>>>>>>>> meta_value field.  I dont think I can use array_push if there is
>> not
>>>> at
>>>>>>>>> least one value in the field, correct?
>>>>>>>>> 
>>>>>>>>> So maybe something like this:
>>>>>>>>> 
>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>> 
>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>   if (!empty($chkMetaValue))
>>>>>>>>>           {
>>>>>>>>>           array_push($profileID);
>>>>>>>>>           } else {
>>>>>>>>>           $profileID;
>>>>>>>>>           }
>>>>>>>>> 
>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>> 
>>>>>>>>> Is that right?
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> --
>>>>>>>>> View this message in context:
>>>>>>>> 
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at Nabble.com.
>>>>>>>>> _______________________________________________
>>>>>>>>> wp-hackers mailing list
>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 20:49:00 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 13:49:00 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
Message-ID: <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>

I have it set to true:

  $active_user_friends = get_user_meta($active_user, 'friends', true);
But the issue is that it only shows the "friended" code for the last user I
added.  If I click add on one profile, and then to a second, the first no
longer shows friend added. Even if I have clearly added several to the
array:

a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}




On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> No, you don?t need to use unserialize, that is all done automatically by
> the WordPress functions.
>
> In the code you posted you still aren?t calling get_user_meta() with the
> third parameter set to true. You need to do that. Right now the array it is
> returning looks something like this:
>
> array(
>         0 => array( 3, 45, 6, 33 )
> )
>
> When you call in_array() it is checking if the user ID (say, 3 ) is in the
> outer array. But it isn?t, the only thing in it is another array. When you
> call get_user_meta() with the third parameter set to true, the returned
> value won?t be wrapped in the outer array like that, so it will work.
>
>
> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
> > option is to just create a separate table to store the friends list in.
> > Trying to work with user_meta this way seems like a bad idea.
> >
> > Quick question, should I be using unserialize to check the array values
> > using in_array?  Because right now this code isnt working.  Thats the
> only
> > thing that seems to be left out - but when I tried using $unserialize
> like
> > this:
> >
> > $unserialize = unserialize($active_user_friends);
> >  if (in_array($author_id, $unserialize)) {
> >
> > it says this:
> >
> >
> > *Warning*: unserialize() expects parameter 1 to be string, array given
> > and
> > *Warning*: in_array() expects parameter 2 to be array, boolean given
> >
> >
> >
> >
> > --------
> >
> >
> >
> > add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> > add_action('wp_ajax_nopriv_my_add_friend_action',
> 'my_add_friend_action');
> > function my_add_friend_action() {
> > global $wpdb;
> > $profileID = $_POST['profileID'];
> > $userID = $_POST['userID'];
> >
> > $chkMetaValue = get_user_meta($userID,"friends");
> > if ( ! is_array($chkMetaValue) )
> > $chkMetaValue = array();
> > $chkMetaValue[] = $profileID;
> >
> > // activity_tracker($current_user, 'added_friend', 'prof');
> > update_user_meta( $userID, 'friends', $chkMetaValue );
> > $response = array( 'success' => true );
> > wp_send_json_success($response);
> >
> > die();
> > }
> >
> >
> > function friend_status($author_id) {
> > global $wpdb, $current_user;
> >      get_currentuserinfo();
> >
> >  //authorID is the userID of the profile owner
> >
> >  $active_user = $current_user->ID;
> >  $active_user_friends = get_user_meta($active_user, 'friends');
> >
> >  if (in_array($author_id, $active_user_friends, true)) {
> >  $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >  } else {
> >  $friend_status = "<button id='add_friend'>Add Friend</button>";
> >  }
> >
> > return $friend_status;
> > }
> >
> >
> > That is basically the code I am using to insert the users id into their
> > user_meta table.
> >
> >
> > On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> There are two ways to use the *_meta functions. The way it looks like
> you
> >> are doing it is that each user has a single entry in the usermeta table,
> >> with the key ?friends?. The value for this meta key will be stored in
> the
> >> database as a serialized array, and when it is pulled out (by
> >> get_user_meta()) it gets unserialized into a PHP array.
> >>
> >> Alternative is this: Each user has multiple ?friend? meta key rows in
> the
> >> usermeta table, each one?s meta_value the ID of a single user that the
> user
> >> has friended.
> >>
> >> The benefit of the second option is that the values may be easier to
> >> search. Much easier. But that may not be important to you right now.
> (But
> >> then that could change later?) What if you want to show a list of users
> who
> >> have friended a user? You will be able to do that easily with this. With
> >> the first option, it is possible, but more complex and probably harder
> on
> >> the DB.
> >>
> >> The downside is that there are many more rows in usermeta table.
> >>
> >> So each of these functions let you target a single row (as in first
> case)
> >> or all rows with a key (as in the later case). Whichever way you go, you
> >> just need to be consistent through all of the code, obviously.
> >>
> >> -J.D.
> >>
> >> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> What would be the benefit of storing the friends in separate rows? I
> did
> >>> not know that was an option, but don't see any clear advantages either.
> >>> Also, I did just search the codex but dont see anything about unique
> >> rows.
> >>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> Yes, when you call get_user_meta() you need to set the third parameter
> >>>> ($single) to true:
> >>>>
> >>>> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
> >>>>
> >>>> Otherwise it will return a nested array. Also, just FYI, alternatively
> >> you
> >>>> could leave the get_user_meta() call the way it is, and change it so
> >> that
> >>>> each friend is stored in a separate meta row (but with the same meta
> >> key -
> >>>> have a look at the *_user_meta functions on the codex).
> >>>>
> >>>> -J.D.
> >>>>
> >>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> I thought so.  One more question if you dont mind helping;
> >>>>>
> >>>>> This is the function I wrote to determine what button to show on page
> >>>> load.
> >>>>> But regardless if someone has been friended or not, it shows the add
> >>>>> friend option.  Is something wrong with this?
> >>>>>
> >>>>>
> >>>>> function friend_status($author_id) {
> >>>>> global $wpdb, $current_user;
> >>>>>    get_currentuserinfo();
> >>>>>
> >>>>> //authorID is the userID of the profile owner
> >>>>>
> >>>>> $active_user = $current_user->ID;
> >>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>
> >>>>> if (in_array($author_id, $active_user_friends)) {
> >>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >>>>> } else {
> >>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>> }
> >>>>>
> >>>>> return $friend_status;
> >>>>> }
> >>>>>
> >>>>> Then on page:  echo $friend_status;
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> Yes, I would write a separate function for removal, and hook it to a
> >>>>>> different AJAX action for removal.
> >>>>>>
> >>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >>>> greglancaster71 at gmail.com>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> That works easier :)  Once someone is friended I have it set so an
> >>>>>> unfriend
> >>>>>>> button replaces the add friend button via ajax.  Is it necessary to
> >>>> write
> >>>>>>> another function for deleting a person?  Not sure exactly how to
> make
> >>>> the
> >>>>>>> new button function since the data being sent is not attached to
> the
> >>>>>> button
> >>>>>>> in any way.  maybe I could add a value to the button that says
> remove
> >>>> or
> >>>>>>> add, which would be passed to the function and determine what
> action
> >> to
> >>>>>>> take?
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co
> >
> >>>>>> wrote:
> >>>>>>>
> >>>>>>>> I would do this:
> >>>>>>>>
> >>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>
> >>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>
> >>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>     $chkMetaValue = array();
> >>>>>>>>
> >>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>>>
> >>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>
> >>>>>>>> -J.D.
> >>>>>>>>
> >>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> >> greglancaster71 at gmail.com
> >>>>>
> >>>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> I am not sure exactly how this would work because I start with an
> >>>> empty
> >>>>>>>>> meta_value field.  I dont think I can use array_push if there is
> >> not
> >>>> at
> >>>>>>>>> least one value in the field, correct?
> >>>>>>>>>
> >>>>>>>>> So maybe something like this:
> >>>>>>>>>
> >>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>
> >>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>   if (!empty($chkMetaValue))
> >>>>>>>>>           {
> >>>>>>>>>           array_push($profileID);
> >>>>>>>>>           } else {
> >>>>>>>>>           $profileID;
> >>>>>>>>>           }
> >>>>>>>>>
> >>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>
> >>>>>>>>> Is that right?
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> --
> >>>>>>>>> View this message in context:
> >>>>>>>>
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> Nabble.com.
> >>>>>>>>> _______________________________________________
> >>>>>>>>> wp-hackers mailing list
> >>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 20:52:51 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 16:52:51 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
Message-ID: <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>

OK, you need to just delete that meta row and start over. It is messed up from before. Do that and see if it works.

On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> I have it set to true:
> 
>  $active_user_friends = get_user_meta($active_user, 'friends', true);
> But the issue is that it only shows the "friended" code for the last user I
> added.  If I click add on one profile, and then to a second, the first no
> longer shows friend added. Even if I have clearly added several to the
> array:
> 
> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
> 
> 
> 
> 
> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> No, you don?t need to use unserialize, that is all done automatically by
>> the WordPress functions.
>> 
>> In the code you posted you still aren?t calling get_user_meta() with the
>> third parameter set to true. You need to do that. Right now the array it is
>> returning looks something like this:
>> 
>> array(
>>        0 => array( 3, 45, 6, 33 )
>> )
>> 
>> When you call in_array() it is checking if the user ID (say, 3 ) is in the
>> outer array. But it isn?t, the only thing in it is another array. When you
>> call get_user_meta() with the third parameter set to true, the returned
>> value won?t be wrapped in the outer array like that, so it will work.
>> 
>> 
>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
>>> option is to just create a separate table to store the friends list in.
>>> Trying to work with user_meta this way seems like a bad idea.
>>> 
>>> Quick question, should I be using unserialize to check the array values
>>> using in_array?  Because right now this code isnt working.  Thats the
>> only
>>> thing that seems to be left out - but when I tried using $unserialize
>> like
>>> this:
>>> 
>>> $unserialize = unserialize($active_user_friends);
>>> if (in_array($author_id, $unserialize)) {
>>> 
>>> it says this:
>>> 
>>> 
>>> *Warning*: unserialize() expects parameter 1 to be string, array given
>>> and
>>> *Warning*: in_array() expects parameter 2 to be array, boolean given
>>> 
>>> 
>>> 
>>> 
>>> --------
>>> 
>>> 
>>> 
>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>> 'my_add_friend_action');
>>> function my_add_friend_action() {
>>> global $wpdb;
>>> $profileID = $_POST['profileID'];
>>> $userID = $_POST['userID'];
>>> 
>>> $chkMetaValue = get_user_meta($userID,"friends");
>>> if ( ! is_array($chkMetaValue) )
>>> $chkMetaValue = array();
>>> $chkMetaValue[] = $profileID;
>>> 
>>> // activity_tracker($current_user, 'added_friend', 'prof');
>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>> $response = array( 'success' => true );
>>> wp_send_json_success($response);
>>> 
>>> die();
>>> }
>>> 
>>> 
>>> function friend_status($author_id) {
>>> global $wpdb, $current_user;
>>>     get_currentuserinfo();
>>> 
>>> //authorID is the userID of the profile owner
>>> 
>>> $active_user = $current_user->ID;
>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>> 
>>> if (in_array($author_id, $active_user_friends, true)) {
>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>> } else {
>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>> }
>>> 
>>> return $friend_status;
>>> }
>>> 
>>> 
>>> That is basically the code I am using to insert the users id into their
>>> user_meta table.
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> There are two ways to use the *_meta functions. The way it looks like
>> you
>>>> are doing it is that each user has a single entry in the usermeta table,
>>>> with the key ?friends?. The value for this meta key will be stored in
>> the
>>>> database as a serialized array, and when it is pulled out (by
>>>> get_user_meta()) it gets unserialized into a PHP array.
>>>> 
>>>> Alternative is this: Each user has multiple ?friend? meta key rows in
>> the
>>>> usermeta table, each one?s meta_value the ID of a single user that the
>> user
>>>> has friended.
>>>> 
>>>> The benefit of the second option is that the values may be easier to
>>>> search. Much easier. But that may not be important to you right now.
>> (But
>>>> then that could change later?) What if you want to show a list of users
>> who
>>>> have friended a user? You will be able to do that easily with this. With
>>>> the first option, it is possible, but more complex and probably harder
>> on
>>>> the DB.
>>>> 
>>>> The downside is that there are many more rows in usermeta table.
>>>> 
>>>> So each of these functions let you target a single row (as in first
>> case)
>>>> or all rows with a key (as in the later case). Whichever way you go, you
>>>> just need to be consistent through all of the code, obviously.
>>>> 
>>>> -J.D.
>>>> 
>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> What would be the benefit of storing the friends in separate rows? I
>> did
>>>>> not know that was an option, but don't see any clear advantages either.
>>>>> Also, I did just search the codex but dont see anything about unique
>>>> rows.
>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> Yes, when you call get_user_meta() you need to set the third parameter
>>>>>> ($single) to true:
>>>>>> 
>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?, true );
>>>>>> 
>>>>>> Otherwise it will return a nested array. Also, just FYI, alternatively
>>>> you
>>>>>> could leave the get_user_meta() call the way it is, and change it so
>>>> that
>>>>>> each friend is stored in a separate meta row (but with the same meta
>>>> key -
>>>>>> have a look at the *_user_meta functions on the codex).
>>>>>> 
>>>>>> -J.D.
>>>>>> 
>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>>>> greglancaster71 at gmail.com>
>>>>>> wrote:
>>>>>> 
>>>>>>> I thought so.  One more question if you dont mind helping;
>>>>>>> 
>>>>>>> This is the function I wrote to determine what button to show on page
>>>>>> load.
>>>>>>> But regardless if someone has been friended or not, it shows the add
>>>>>>> friend option.  Is something wrong with this?
>>>>>>> 
>>>>>>> 
>>>>>>> function friend_status($author_id) {
>>>>>>> global $wpdb, $current_user;
>>>>>>>   get_currentuserinfo();
>>>>>>> 
>>>>>>> //authorID is the userID of the profile owner
>>>>>>> 
>>>>>>> $active_user = $current_user->ID;
>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>> 
>>>>>>> if (in_array($author_id, $active_user_friends)) {
>>>>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>>>>>> } else {
>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>> }
>>>>>>> 
>>>>>>> return $friend_status;
>>>>>>> }
>>>>>>> 
>>>>>>> Then on page:  echo $friend_status;
>>>>>>> 
>>>>>>> 
>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co>
>>>>>> wrote:
>>>>>>> 
>>>>>>>> Yes, I would write a separate function for removal, and hook it to a
>>>>>>>> different AJAX action for removal.
>>>>>>>> 
>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>>>>>> greglancaster71 at gmail.com>
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> That works easier :)  Once someone is friended I have it set so an
>>>>>>>> unfriend
>>>>>>>>> button replaces the add friend button via ajax.  Is it necessary to
>>>>>> write
>>>>>>>>> another function for deleting a person?  Not sure exactly how to
>> make
>>>>>> the
>>>>>>>>> new button function since the data being sent is not attached to
>> the
>>>>>>>> button
>>>>>>>>> in any way.  maybe I could add a value to the button that says
>> remove
>>>>>> or
>>>>>>>>> add, which would be passed to the function and determine what
>> action
>>>> to
>>>>>>>>> take?
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <jdg at codesymphony.co
>>> 
>>>>>>>> wrote:
>>>>>>>>> 
>>>>>>>>>> I would do this:
>>>>>>>>>> 
>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>> 
>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>> 
>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>>>    $chkMetaValue = array();
>>>>>>>>>> 
>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>>>>>> 
>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>> 
>>>>>>>>>> -J.D.
>>>>>>>>>> 
>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>>>> greglancaster71 at gmail.com
>>>>>>> 
>>>>>>>>>> wrote:
>>>>>>>>>> 
>>>>>>>>>>> I am not sure exactly how this would work because I start with an
>>>>>> empty
>>>>>>>>>>> meta_value field.  I dont think I can use array_push if there is
>>>> not
>>>>>> at
>>>>>>>>>>> least one value in the field, correct?
>>>>>>>>>>> 
>>>>>>>>>>> So maybe something like this:
>>>>>>>>>>> 
>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>> 
>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>  if (!empty($chkMetaValue))
>>>>>>>>>>>          {
>>>>>>>>>>>          array_push($profileID);
>>>>>>>>>>>          } else {
>>>>>>>>>>>          $profileID;
>>>>>>>>>>>          }
>>>>>>>>>>> 
>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>> 
>>>>>>>>>>> Is that right?
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> --
>>>>>>>>>>> View this message in context:
>>>>>>>>>> 
>>>>>>>> 
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>> Nabble.com.
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>>> _______________________________________________
>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> wp-hackers mailing list
>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 21:08:28 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 14:08:28 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
Message-ID: <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>

No I must have screwed something up man, it only shows the last value.  I
searched for awhile before responding here, and I see some people say
in_array adds a line between items and sometimes other folks needed to
strip those.  But I have no idea if thats whats going on here.  It all
looks like it should function.  :-/  Maybe I need to get off the computer
for awhile.

I var_dump using the function you shared, and this is what the friend array
looks like from there:

array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n      [0]=>\n
     array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
   array(1) {\n            [0]=>\n            string(1) "1"\n          }\n
         [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
 string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
 [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n

I dont know if that assists in debugging.



On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> OK, you need to just delete that meta row and start over. It is messed up
> from before. Do that and see if it works.
>
> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > I have it set to true:
> >
> >  $active_user_friends = get_user_meta($active_user, 'friends', true);
> > But the issue is that it only shows the "friended" code for the last
> user I
> > added.  If I click add on one profile, and then to a second, the first no
> > longer shows friend added. Even if I have clearly added several to the
> > array:
> >
> >
> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
> >
> >
> >
> >
> > On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> No, you don?t need to use unserialize, that is all done automatically by
> >> the WordPress functions.
> >>
> >> In the code you posted you still aren?t calling get_user_meta() with the
> >> third parameter set to true. You need to do that. Right now the array
> it is
> >> returning looks something like this:
> >>
> >> array(
> >>        0 => array( 3, 45, 6, 33 )
> >> )
> >>
> >> When you call in_array() it is checking if the user ID (say, 3 ) is in
> the
> >> outer array. But it isn?t, the only thing in it is another array. When
> you
> >> call get_user_meta() with the third parameter set to true, the returned
> >> value won?t be wrapped in the outer array like that, so it will work.
> >>
> >>
> >> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
> >>> option is to just create a separate table to store the friends list in.
> >>> Trying to work with user_meta this way seems like a bad idea.
> >>>
> >>> Quick question, should I be using unserialize to check the array values
> >>> using in_array?  Because right now this code isnt working.  Thats the
> >> only
> >>> thing that seems to be left out - but when I tried using $unserialize
> >> like
> >>> this:
> >>>
> >>> $unserialize = unserialize($active_user_friends);
> >>> if (in_array($author_id, $unserialize)) {
> >>>
> >>> it says this:
> >>>
> >>>
> >>> *Warning*: unserialize() expects parameter 1 to be string, array given
> >>> and
> >>> *Warning*: in_array() expects parameter 2 to be array, boolean given
> >>>
> >>>
> >>>
> >>>
> >>> --------
> >>>
> >>>
> >>>
> >>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> >>> add_action('wp_ajax_nopriv_my_add_friend_action',
> >> 'my_add_friend_action');
> >>> function my_add_friend_action() {
> >>> global $wpdb;
> >>> $profileID = $_POST['profileID'];
> >>> $userID = $_POST['userID'];
> >>>
> >>> $chkMetaValue = get_user_meta($userID,"friends");
> >>> if ( ! is_array($chkMetaValue) )
> >>> $chkMetaValue = array();
> >>> $chkMetaValue[] = $profileID;
> >>>
> >>> // activity_tracker($current_user, 'added_friend', 'prof');
> >>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>> $response = array( 'success' => true );
> >>> wp_send_json_success($response);
> >>>
> >>> die();
> >>> }
> >>>
> >>>
> >>> function friend_status($author_id) {
> >>> global $wpdb, $current_user;
> >>>     get_currentuserinfo();
> >>>
> >>> //authorID is the userID of the profile owner
> >>>
> >>> $active_user = $current_user->ID;
> >>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>
> >>> if (in_array($author_id, $active_user_friends, true)) {
> >>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >>> } else {
> >>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>> }
> >>>
> >>> return $friend_status;
> >>> }
> >>>
> >>>
> >>> That is basically the code I am using to insert the users id into their
> >>> user_meta table.
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> There are two ways to use the *_meta functions. The way it looks like
> >> you
> >>>> are doing it is that each user has a single entry in the usermeta
> table,
> >>>> with the key ?friends?. The value for this meta key will be stored in
> >> the
> >>>> database as a serialized array, and when it is pulled out (by
> >>>> get_user_meta()) it gets unserialized into a PHP array.
> >>>>
> >>>> Alternative is this: Each user has multiple ?friend? meta key rows in
> >> the
> >>>> usermeta table, each one?s meta_value the ID of a single user that the
> >> user
> >>>> has friended.
> >>>>
> >>>> The benefit of the second option is that the values may be easier to
> >>>> search. Much easier. But that may not be important to you right now.
> >> (But
> >>>> then that could change later?) What if you want to show a list of
> users
> >> who
> >>>> have friended a user? You will be able to do that easily with this.
> With
> >>>> the first option, it is possible, but more complex and probably harder
> >> on
> >>>> the DB.
> >>>>
> >>>> The downside is that there are many more rows in usermeta table.
> >>>>
> >>>> So each of these functions let you target a single row (as in first
> >> case)
> >>>> or all rows with a key (as in the later case). Whichever way you go,
> you
> >>>> just need to be consistent through all of the code, obviously.
> >>>>
> >>>> -J.D.
> >>>>
> >>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> What would be the benefit of storing the friends in separate rows? I
> >> did
> >>>>> not know that was an option, but don't see any clear advantages
> either.
> >>>>> Also, I did just search the codex but dont see anything about unique
> >>>> rows.
> >>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> Yes, when you call get_user_meta() you need to set the third
> parameter
> >>>>>> ($single) to true:
> >>>>>>
> >>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?, true
> );
> >>>>>>
> >>>>>> Otherwise it will return a nested array. Also, just FYI,
> alternatively
> >>>> you
> >>>>>> could leave the get_user_meta() call the way it is, and change it so
> >>>> that
> >>>>>> each friend is stored in a separate meta row (but with the same meta
> >>>> key -
> >>>>>> have a look at the *_user_meta functions on the codex).
> >>>>>>
> >>>>>> -J.D.
> >>>>>>
> >>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> >>>> greglancaster71 at gmail.com>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> I thought so.  One more question if you dont mind helping;
> >>>>>>>
> >>>>>>> This is the function I wrote to determine what button to show on
> page
> >>>>>> load.
> >>>>>>> But regardless if someone has been friended or not, it shows the
> add
> >>>>>>> friend option.  Is something wrong with this?
> >>>>>>>
> >>>>>>>
> >>>>>>> function friend_status($author_id) {
> >>>>>>> global $wpdb, $current_user;
> >>>>>>>   get_currentuserinfo();
> >>>>>>>
> >>>>>>> //authorID is the userID of the profile owner
> >>>>>>>
> >>>>>>> $active_user = $current_user->ID;
> >>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>>>
> >>>>>>> if (in_array($author_id, $active_user_friends)) {
> >>>>>>> $friend_status = "<button id='remove_friend'>Remove
> Friend</button>";
> >>>>>>> } else {
> >>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>>>> }
> >>>>>>>
> >>>>>>> return $friend_status;
> >>>>>>> }
> >>>>>>>
> >>>>>>> Then on page:  echo $friend_status;
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co
> >
> >>>>>> wrote:
> >>>>>>>
> >>>>>>>> Yes, I would write a separate function for removal, and hook it
> to a
> >>>>>>>> different AJAX action for removal.
> >>>>>>>>
> >>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >>>>>> greglancaster71 at gmail.com>
> >>>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> That works easier :)  Once someone is friended I have it set so
> an
> >>>>>>>> unfriend
> >>>>>>>>> button replaces the add friend button via ajax.  Is it necessary
> to
> >>>>>> write
> >>>>>>>>> another function for deleting a person?  Not sure exactly how to
> >> make
> >>>>>> the
> >>>>>>>>> new button function since the data being sent is not attached to
> >> the
> >>>>>>>> button
> >>>>>>>>> in any way.  maybe I could add a value to the button that says
> >> remove
> >>>>>> or
> >>>>>>>>> add, which would be passed to the function and determine what
> >> action
> >>>> to
> >>>>>>>>> take?
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
> jdg at codesymphony.co
> >>>
> >>>>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> I would do this:
> >>>>>>>>>>
> >>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>
> >>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>
> >>>>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>>>    $chkMetaValue = array();
> >>>>>>>>>>
> >>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>>>>>
> >>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>
> >>>>>>>>>> -J.D.
> >>>>>>>>>>
> >>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> >>>> greglancaster71 at gmail.com
> >>>>>>>
> >>>>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> I am not sure exactly how this would work because I start with
> an
> >>>>>> empty
> >>>>>>>>>>> meta_value field.  I dont think I can use array_push if there
> is
> >>>> not
> >>>>>> at
> >>>>>>>>>>> least one value in the field, correct?
> >>>>>>>>>>>
> >>>>>>>>>>> So maybe something like this:
> >>>>>>>>>>>
> >>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>
> >>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>  if (!empty($chkMetaValue))
> >>>>>>>>>>>          {
> >>>>>>>>>>>          array_push($profileID);
> >>>>>>>>>>>          } else {
> >>>>>>>>>>>          $profileID;
> >>>>>>>>>>>          }
> >>>>>>>>>>>
> >>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>
> >>>>>>>>>>> Is that right?
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> --
> >>>>>>>>>>> View this message in context:
> >>>>>>>>>>
> >>>>>>>>
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> >> Nabble.com.
> >>>>>>>>>>> _______________________________________________
> >>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>>> _______________________________________________
> >>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>> _______________________________________________
> >>>>>>>>> wp-hackers mailing list
> >>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 21:16:13 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 17:16:13 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
Message-ID: <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>

Could you post your code again? Somewhere you are still getting the value wrapped in an extra array.


On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> No I must have screwed something up man, it only shows the last value.  I
> searched for awhile before responding here, and I see some people say
> in_array adds a line between items and sometimes other folks needed to
> strip those.  But I have no idea if thats whats going on here.  It all
> looks like it should function.  :-/  Maybe I need to get off the computer
> for awhile.
> 
> I var_dump using the function you shared, and this is what the friend array
> looks like from there:
> 
> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n      [0]=>\n
>     array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
>   array(1) {\n            [0]=>\n            string(1) "1"\n          }\n
>         [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
> 
> I dont know if that assists in debugging.
> 
> 
> 
> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> OK, you need to just delete that meta row and start over. It is messed up
>> from before. Do that and see if it works.
>> 
>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> I have it set to true:
>>> 
>>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>>> But the issue is that it only shows the "friended" code for the last
>> user I
>>> added.  If I click add on one profile, and then to a second, the first no
>>> longer shows friend added. Even if I have clearly added several to the
>>> array:
>>> 
>>> 
>> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
>>> 
>>> 
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> No, you don?t need to use unserialize, that is all done automatically by
>>>> the WordPress functions.
>>>> 
>>>> In the code you posted you still aren?t calling get_user_meta() with the
>>>> third parameter set to true. You need to do that. Right now the array
>> it is
>>>> returning looks something like this:
>>>> 
>>>> array(
>>>>       0 => array( 3, 45, 6, 33 )
>>>> )
>>>> 
>>>> When you call in_array() it is checking if the user ID (say, 3 ) is in
>> the
>>>> outer array. But it isn?t, the only thing in it is another array. When
>> you
>>>> call get_user_meta() with the third parameter set to true, the returned
>>>> value won?t be wrapped in the outer array like that, so it will work.
>>>> 
>>>> 
>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the easier
>>>>> option is to just create a separate table to store the friends list in.
>>>>> Trying to work with user_meta this way seems like a bad idea.
>>>>> 
>>>>> Quick question, should I be using unserialize to check the array values
>>>>> using in_array?  Because right now this code isnt working.  Thats the
>>>> only
>>>>> thing that seems to be left out - but when I tried using $unserialize
>>>> like
>>>>> this:
>>>>> 
>>>>> $unserialize = unserialize($active_user_friends);
>>>>> if (in_array($author_id, $unserialize)) {
>>>>> 
>>>>> it says this:
>>>>> 
>>>>> 
>>>>> *Warning*: unserialize() expects parameter 1 to be string, array given
>>>>> and
>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean given
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> --------
>>>>> 
>>>>> 
>>>>> 
>>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>>>> 'my_add_friend_action');
>>>>> function my_add_friend_action() {
>>>>> global $wpdb;
>>>>> $profileID = $_POST['profileID'];
>>>>> $userID = $_POST['userID'];
>>>>> 
>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>> if ( ! is_array($chkMetaValue) )
>>>>> $chkMetaValue = array();
>>>>> $chkMetaValue[] = $profileID;
>>>>> 
>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>> $response = array( 'success' => true );
>>>>> wp_send_json_success($response);
>>>>> 
>>>>> die();
>>>>> }
>>>>> 
>>>>> 
>>>>> function friend_status($author_id) {
>>>>> global $wpdb, $current_user;
>>>>>    get_currentuserinfo();
>>>>> 
>>>>> //authorID is the userID of the profile owner
>>>>> 
>>>>> $active_user = $current_user->ID;
>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>> 
>>>>> if (in_array($author_id, $active_user_friends, true)) {
>>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>>>> } else {
>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>> }
>>>>> 
>>>>> return $friend_status;
>>>>> }
>>>>> 
>>>>> 
>>>>> That is basically the code I am using to insert the users id into their
>>>>> user_meta table.
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> There are two ways to use the *_meta functions. The way it looks like
>>>> you
>>>>>> are doing it is that each user has a single entry in the usermeta
>> table,
>>>>>> with the key ?friends?. The value for this meta key will be stored in
>>>> the
>>>>>> database as a serialized array, and when it is pulled out (by
>>>>>> get_user_meta()) it gets unserialized into a PHP array.
>>>>>> 
>>>>>> Alternative is this: Each user has multiple ?friend? meta key rows in
>>>> the
>>>>>> usermeta table, each one?s meta_value the ID of a single user that the
>>>> user
>>>>>> has friended.
>>>>>> 
>>>>>> The benefit of the second option is that the values may be easier to
>>>>>> search. Much easier. But that may not be important to you right now.
>>>> (But
>>>>>> then that could change later?) What if you want to show a list of
>> users
>>>> who
>>>>>> have friended a user? You will be able to do that easily with this.
>> With
>>>>>> the first option, it is possible, but more complex and probably harder
>>>> on
>>>>>> the DB.
>>>>>> 
>>>>>> The downside is that there are many more rows in usermeta table.
>>>>>> 
>>>>>> So each of these functions let you target a single row (as in first
>>>> case)
>>>>>> or all rows with a key (as in the later case). Whichever way you go,
>> you
>>>>>> just need to be consistent through all of the code, obviously.
>>>>>> 
>>>>>> -J.D.
>>>>>> 
>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>>>> greglancaster71 at gmail.com>
>>>>>> wrote:
>>>>>> 
>>>>>>> What would be the benefit of storing the friends in separate rows? I
>>>> did
>>>>>>> not know that was an option, but don't see any clear advantages
>> either.
>>>>>>> Also, I did just search the codex but dont see anything about unique
>>>>>> rows.
>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>>>>>>> 
>>>>>>> 
>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co>
>>>>>> wrote:
>>>>>>> 
>>>>>>>> Yes, when you call get_user_meta() you need to set the third
>> parameter
>>>>>>>> ($single) to true:
>>>>>>>> 
>>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?, true
>> );
>>>>>>>> 
>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
>> alternatively
>>>>>> you
>>>>>>>> could leave the get_user_meta() call the way it is, and change it so
>>>>>> that
>>>>>>>> each friend is stored in a separate meta row (but with the same meta
>>>>>> key -
>>>>>>>> have a look at the *_user_meta functions on the codex).
>>>>>>>> 
>>>>>>>> -J.D.
>>>>>>>> 
>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>>>>>> greglancaster71 at gmail.com>
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> I thought so.  One more question if you dont mind helping;
>>>>>>>>> 
>>>>>>>>> This is the function I wrote to determine what button to show on
>> page
>>>>>>>> load.
>>>>>>>>> But regardless if someone has been friended or not, it shows the
>> add
>>>>>>>>> friend option.  Is something wrong with this?
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> function friend_status($author_id) {
>>>>>>>>> global $wpdb, $current_user;
>>>>>>>>>  get_currentuserinfo();
>>>>>>>>> 
>>>>>>>>> //authorID is the userID of the profile owner
>>>>>>>>> 
>>>>>>>>> $active_user = $current_user->ID;
>>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>>>> 
>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>> Friend</button>";
>>>>>>>>> } else {
>>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> return $friend_status;
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> Then on page:  echo $friend_status;
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <jdg at codesymphony.co
>>> 
>>>>>>>> wrote:
>>>>>>>>> 
>>>>>>>>>> Yes, I would write a separate function for removal, and hook it
>> to a
>>>>>>>>>> different AJAX action for removal.
>>>>>>>>>> 
>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>> wrote:
>>>>>>>>>> 
>>>>>>>>>>> That works easier :)  Once someone is friended I have it set so
>> an
>>>>>>>>>> unfriend
>>>>>>>>>>> button replaces the add friend button via ajax.  Is it necessary
>> to
>>>>>>>> write
>>>>>>>>>>> another function for deleting a person?  Not sure exactly how to
>>>> make
>>>>>>>> the
>>>>>>>>>>> new button function since the data being sent is not attached to
>>>> the
>>>>>>>>>> button
>>>>>>>>>>> in any way.  maybe I could add a value to the button that says
>>>> remove
>>>>>>>> or
>>>>>>>>>>> add, which would be passed to the function and determine what
>>>> action
>>>>>> to
>>>>>>>>>>> take?
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
>> jdg at codesymphony.co
>>>>> 
>>>>>>>>>> wrote:
>>>>>>>>>>> 
>>>>>>>>>>>> I would do this:
>>>>>>>>>>>> 
>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>> 
>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>> 
>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>>>>>   $chkMetaValue = array();
>>>>>>>>>>>> 
>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>>>>>>>> 
>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>> 
>>>>>>>>>>>> -J.D.
>>>>>>>>>>>> 
>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>>>>>> greglancaster71 at gmail.com
>>>>>>>>> 
>>>>>>>>>>>> wrote:
>>>>>>>>>>>> 
>>>>>>>>>>>>> I am not sure exactly how this would work because I start with
>> an
>>>>>>>> empty
>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if there
>> is
>>>>>> not
>>>>>>>> at
>>>>>>>>>>>>> least one value in the field, correct?
>>>>>>>>>>>>> 
>>>>>>>>>>>>> So maybe something like this:
>>>>>>>>>>>>> 
>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>>> 
>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>>> if (!empty($chkMetaValue))
>>>>>>>>>>>>>         {
>>>>>>>>>>>>>         array_push($profileID);
>>>>>>>>>>>>>         } else {
>>>>>>>>>>>>>         $profileID;
>>>>>>>>>>>>>         }
>>>>>>>>>>>>> 
>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Is that right?
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> --
>>>>>>>>>>>>> View this message in context:
>>>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>> 
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>>>> Nabble.com.
>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>>> _______________________________________________
>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> wp-hackers mailing list
>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 21:18:42 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 14:18:42 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
Message-ID: <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>

Sure;

add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
function my_add_friend_action() {
global $wpdb;
 $profileID = $_POST['profileID'];
$userID = $_POST['userID'];

$chkMetaValue = get_user_meta($userID,"friends");
 if ( ! is_array($chkMetaValue) )
$chkMetaValue = array();
 $chkMetaValue[] = $profileID;

// activity_tracker($current_user, 'added_friend', 'prof');
update_user_meta( $userID, 'friends', $chkMetaValue );
 $response = array( 'success' => true );
 wp_send_json_success($response);
die();
}

function follow_status($author_id) {
global $wpdb, $current_user;
get_currentuserinfo();

  //authorID is the userID of the profile owner

  $active_user = $current_user->ID;
  $active_user_friends = get_user_meta($active_user, 'friends', true);

  if (in_array($author_id, $active_user_friends)) {
  $follow_status = "<button id='remove_friend'>Remove Friend</button>";
  } else {
  $follow_status = "<button id='add_friend'>Add Friend</button>";
  }

 return $follow_status;
}

and calling in the profile page with:

 echo follow_status($author_id);



On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Could you post your code again? Somewhere you are still getting the value
> wrapped in an extra array.
>
>
> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > No I must have screwed something up man, it only shows the last value.  I
> > searched for awhile before responding here, and I see some people say
> > in_array adds a line between items and sometimes other folks needed to
> > strip those.  But I have no idea if thats whats going on here.  It all
> > looks like it should function.  :-/  Maybe I need to get off the computer
> > for awhile.
> >
> > I var_dump using the function you shared, and this is what the friend
> array
> > looks like from there:
> >
> > array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
>  [0]=>\n
> >     array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
> >   array(1) {\n            [0]=>\n            string(1) "1"\n          }\n
> >         [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
> > string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
> > [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
> >
> > I dont know if that assists in debugging.
> >
> >
> >
> > On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> OK, you need to just delete that meta row and start over. It is messed
> up
> >> from before. Do that and see if it works.
> >>
> >> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> I have it set to true:
> >>>
> >>> $active_user_friends = get_user_meta($active_user, 'friends', true);
> >>> But the issue is that it only shows the "friended" code for the last
> >> user I
> >>> added.  If I click add on one profile, and then to a second, the first
> no
> >>> longer shows friend added. Even if I have clearly added several to the
> >>> array:
> >>>
> >>>
> >>
> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
> >>>
> >>>
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> No, you don?t need to use unserialize, that is all done automatically
> by
> >>>> the WordPress functions.
> >>>>
> >>>> In the code you posted you still aren?t calling get_user_meta() with
> the
> >>>> third parameter set to true. You need to do that. Right now the array
> >> it is
> >>>> returning looks something like this:
> >>>>
> >>>> array(
> >>>>       0 => array( 3, 45, 6, 33 )
> >>>> )
> >>>>
> >>>> When you call in_array() it is checking if the user ID (say, 3 ) is in
> >> the
> >>>> outer array. But it isn?t, the only thing in it is another array. When
> >> you
> >>>> call get_user_meta() with the third parameter set to true, the
> returned
> >>>> value won?t be wrapped in the outer array like that, so it will work.
> >>>>
> >>>>
> >>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
> easier
> >>>>> option is to just create a separate table to store the friends list
> in.
> >>>>> Trying to work with user_meta this way seems like a bad idea.
> >>>>>
> >>>>> Quick question, should I be using unserialize to check the array
> values
> >>>>> using in_array?  Because right now this code isnt working.  Thats the
> >>>> only
> >>>>> thing that seems to be left out - but when I tried using $unserialize
> >>>> like
> >>>>> this:
> >>>>>
> >>>>> $unserialize = unserialize($active_user_friends);
> >>>>> if (in_array($author_id, $unserialize)) {
> >>>>>
> >>>>> it says this:
> >>>>>
> >>>>>
> >>>>> *Warning*: unserialize() expects parameter 1 to be string, array
> given
> >>>>> and
> >>>>> *Warning*: in_array() expects parameter 2 to be array, boolean given
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> --------
> >>>>>
> >>>>>
> >>>>>
> >>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> >>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
> >>>> 'my_add_friend_action');
> >>>>> function my_add_friend_action() {
> >>>>> global $wpdb;
> >>>>> $profileID = $_POST['profileID'];
> >>>>> $userID = $_POST['userID'];
> >>>>>
> >>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>> if ( ! is_array($chkMetaValue) )
> >>>>> $chkMetaValue = array();
> >>>>> $chkMetaValue[] = $profileID;
> >>>>>
> >>>>> // activity_tracker($current_user, 'added_friend', 'prof');
> >>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>> $response = array( 'success' => true );
> >>>>> wp_send_json_success($response);
> >>>>>
> >>>>> die();
> >>>>> }
> >>>>>
> >>>>>
> >>>>> function friend_status($author_id) {
> >>>>> global $wpdb, $current_user;
> >>>>>    get_currentuserinfo();
> >>>>>
> >>>>> //authorID is the userID of the profile owner
> >>>>>
> >>>>> $active_user = $current_user->ID;
> >>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>
> >>>>> if (in_array($author_id, $active_user_friends, true)) {
> >>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
> >>>>> } else {
> >>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>> }
> >>>>>
> >>>>> return $friend_status;
> >>>>> }
> >>>>>
> >>>>>
> >>>>> That is basically the code I am using to insert the users id into
> their
> >>>>> user_meta table.
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> There are two ways to use the *_meta functions. The way it looks
> like
> >>>> you
> >>>>>> are doing it is that each user has a single entry in the usermeta
> >> table,
> >>>>>> with the key ?friends?. The value for this meta key will be stored
> in
> >>>> the
> >>>>>> database as a serialized array, and when it is pulled out (by
> >>>>>> get_user_meta()) it gets unserialized into a PHP array.
> >>>>>>
> >>>>>> Alternative is this: Each user has multiple ?friend? meta key rows
> in
> >>>> the
> >>>>>> usermeta table, each one?s meta_value the ID of a single user that
> the
> >>>> user
> >>>>>> has friended.
> >>>>>>
> >>>>>> The benefit of the second option is that the values may be easier to
> >>>>>> search. Much easier. But that may not be important to you right now.
> >>>> (But
> >>>>>> then that could change later?) What if you want to show a list of
> >> users
> >>>> who
> >>>>>> have friended a user? You will be able to do that easily with this.
> >> With
> >>>>>> the first option, it is possible, but more complex and probably
> harder
> >>>> on
> >>>>>> the DB.
> >>>>>>
> >>>>>> The downside is that there are many more rows in usermeta table.
> >>>>>>
> >>>>>> So each of these functions let you target a single row (as in first
> >>>> case)
> >>>>>> or all rows with a key (as in the later case). Whichever way you go,
> >> you
> >>>>>> just need to be consistent through all of the code, obviously.
> >>>>>>
> >>>>>> -J.D.
> >>>>>>
> >>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
> >>>> greglancaster71 at gmail.com>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> What would be the benefit of storing the friends in separate rows?
> I
> >>>> did
> >>>>>>> not know that was an option, but don't see any clear advantages
> >> either.
> >>>>>>> Also, I did just search the codex but dont see anything about
> unique
> >>>>>> rows.
> >>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co
> >
> >>>>>> wrote:
> >>>>>>>
> >>>>>>>> Yes, when you call get_user_meta() you need to set the third
> >> parameter
> >>>>>>>> ($single) to true:
> >>>>>>>>
> >>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
> true
> >> );
> >>>>>>>>
> >>>>>>>> Otherwise it will return a nested array. Also, just FYI,
> >> alternatively
> >>>>>> you
> >>>>>>>> could leave the get_user_meta() call the way it is, and change it
> so
> >>>>>> that
> >>>>>>>> each friend is stored in a separate meta row (but with the same
> meta
> >>>>>> key -
> >>>>>>>> have a look at the *_user_meta functions on the codex).
> >>>>>>>>
> >>>>>>>> -J.D.
> >>>>>>>>
> >>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> >>>>>> greglancaster71 at gmail.com>
> >>>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> I thought so.  One more question if you dont mind helping;
> >>>>>>>>>
> >>>>>>>>> This is the function I wrote to determine what button to show on
> >> page
> >>>>>>>> load.
> >>>>>>>>> But regardless if someone has been friended or not, it shows the
> >> add
> >>>>>>>>> friend option.  Is something wrong with this?
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> function friend_status($author_id) {
> >>>>>>>>> global $wpdb, $current_user;
> >>>>>>>>>  get_currentuserinfo();
> >>>>>>>>>
> >>>>>>>>> //authorID is the userID of the profile owner
> >>>>>>>>>
> >>>>>>>>> $active_user = $current_user->ID;
> >>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>>>>>
> >>>>>>>>> if (in_array($author_id, $active_user_friends)) {
> >>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
> >> Friend</button>";
> >>>>>>>>> } else {
> >>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>> return $friend_status;
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>> Then on page:  echo $friend_status;
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
> jdg at codesymphony.co
> >>>
> >>>>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> Yes, I would write a separate function for removal, and hook it
> >> to a
> >>>>>>>>>> different AJAX action for removal.
> >>>>>>>>>>
> >>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> That works easier :)  Once someone is friended I have it set so
> >> an
> >>>>>>>>>> unfriend
> >>>>>>>>>>> button replaces the add friend button via ajax.  Is it
> necessary
> >> to
> >>>>>>>> write
> >>>>>>>>>>> another function for deleting a person?  Not sure exactly how
> to
> >>>> make
> >>>>>>>> the
> >>>>>>>>>>> new button function since the data being sent is not attached
> to
> >>>> the
> >>>>>>>>>> button
> >>>>>>>>>>> in any way.  maybe I could add a value to the button that says
> >>>> remove
> >>>>>>>> or
> >>>>>>>>>>> add, which would be passed to the function and determine what
> >>>> action
> >>>>>> to
> >>>>>>>>>>> take?
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
> >> jdg at codesymphony.co
> >>>>>
> >>>>>>>>>> wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>> I would do this:
> >>>>>>>>>>>>
> >>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>
> >>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>
> >>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>>>>>   $chkMetaValue = array();
> >>>>>>>>>>>>
> >>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>>>>>>>
> >>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>
> >>>>>>>>>>>> -J.D.
> >>>>>>>>>>>>
> >>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> >>>>>> greglancaster71 at gmail.com
> >>>>>>>>>
> >>>>>>>>>>>> wrote:
> >>>>>>>>>>>>
> >>>>>>>>>>>>> I am not sure exactly how this would work because I start
> with
> >> an
> >>>>>>>> empty
> >>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if there
> >> is
> >>>>>> not
> >>>>>>>> at
> >>>>>>>>>>>>> least one value in the field, correct?
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> So maybe something like this:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>> if (!empty($chkMetaValue))
> >>>>>>>>>>>>>         {
> >>>>>>>>>>>>>         array_push($profileID);
> >>>>>>>>>>>>>         } else {
> >>>>>>>>>>>>>         $profileID;
> >>>>>>>>>>>>>         }
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> Is that right?
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> --
> >>>>>>>>>>>>> View this message in context:
> >>>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> >>>> Nabble.com.
> >>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>> _______________________________________________
> >>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>>> _______________________________________________
> >>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>> _______________________________________________
> >>>>>>>>> wp-hackers mailing list
> >>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Thu Oct 31 21:20:47 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 14:20:47 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
Message-ID: <CAPN-N+Y39KiuvGUe59uPerGJt_FddV5ZQpGrGn+4xKxtBN1n-Q@mail.gmail.com>

Sorry for the naming by the way.  I decided after I did the first part,
that rather than a friending system it would be used to follow another
users activity.


On Thu, Oct 31, 2013 at 2:18 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> Sure;
>
> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
> function my_add_friend_action() {
> global $wpdb;
>  $profileID = $_POST['profileID'];
>  $userID = $_POST['userID'];
>
> $chkMetaValue = get_user_meta($userID,"friends");
>  if ( ! is_array($chkMetaValue) )
> $chkMetaValue = array();
>  $chkMetaValue[] = $profileID;
>
> // activity_tracker($current_user, 'added_friend', 'prof');
>  update_user_meta( $userID, 'friends', $chkMetaValue );
>  $response = array( 'success' => true );
>  wp_send_json_success($response);
> die();
> }
>
> function follow_status($author_id) {
> global $wpdb, $current_user;
> get_currentuserinfo();
>
>   //authorID is the userID of the profile owner
>
>   $active_user = $current_user->ID;
>   $active_user_friends = get_user_meta($active_user, 'friends', true);
>
>   if (in_array($author_id, $active_user_friends)) {
>   $follow_status = "<button id='remove_friend'>Remove Friend</button>";
>   } else {
>   $follow_status = "<button id='add_friend'>Add Friend</button>";
>   }
>
>  return $follow_status;
> }
>
> and calling in the profile page with:
>
>  echo follow_status($author_id);
>
>
>
> On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
>> Could you post your code again? Somewhere you are still getting the value
>> wrapped in an extra array.
>>
>>
>> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>>
>> > No I must have screwed something up man, it only shows the last value.
>>  I
>> > searched for awhile before responding here, and I see some people say
>> > in_array adds a line between items and sometimes other folks needed to
>> > strip those.  But I have no idea if thats whats going on here.  It all
>> > looks like it should function.  :-/  Maybe I need to get off the
>> computer
>> > for awhile.
>> >
>> > I var_dump using the function you shared, and this is what the friend
>> array
>> > looks like from there:
>> >
>> > array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
>>  [0]=>\n
>> >     array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
>> >   array(1) {\n            [0]=>\n            string(1) "1"\n
>>  }\n
>> >         [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
>> > string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
>> > [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
>> >
>> > I dont know if that assists in debugging.
>> >
>> >
>> >
>> > On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>> >
>> >> OK, you need to just delete that meta row and start over. It is messed
>> up
>> >> from before. Do that and see if it works.
>> >>
>> >> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>> >> wrote:
>> >>
>> >>> I have it set to true:
>> >>>
>> >>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>> >>> But the issue is that it only shows the "friended" code for the last
>> >> user I
>> >>> added.  If I click add on one profile, and then to a second, the
>> first no
>> >>> longer shows friend added. Even if I have clearly added several to the
>> >>> array:
>> >>>
>> >>>
>> >>
>> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
>> >>>
>> >>>
>> >>>
>> >>>
>> >>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
>> >> wrote:
>> >>>
>> >>>> No, you don?t need to use unserialize, that is all done
>> automatically by
>> >>>> the WordPress functions.
>> >>>>
>> >>>> In the code you posted you still aren?t calling get_user_meta() with
>> the
>> >>>> third parameter set to true. You need to do that. Right now the array
>> >> it is
>> >>>> returning looks something like this:
>> >>>>
>> >>>> array(
>> >>>>       0 => array( 3, 45, 6, 33 )
>> >>>> )
>> >>>>
>> >>>> When you call in_array() it is checking if the user ID (say, 3 ) is
>> in
>> >> the
>> >>>> outer array. But it isn?t, the only thing in it is another array.
>> When
>> >> you
>> >>>> call get_user_meta() with the third parameter set to true, the
>> returned
>> >>>> value won?t be wrapped in the outer array like that, so it will work.
>> >>>>
>> >>>>
>> >>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
>> >> greglancaster71 at gmail.com>
>> >>>> wrote:
>> >>>>
>> >>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
>> easier
>> >>>>> option is to just create a separate table to store the friends list
>> in.
>> >>>>> Trying to work with user_meta this way seems like a bad idea.
>> >>>>>
>> >>>>> Quick question, should I be using unserialize to check the array
>> values
>> >>>>> using in_array?  Because right now this code isnt working.  Thats
>> the
>> >>>> only
>> >>>>> thing that seems to be left out - but when I tried using
>> $unserialize
>> >>>> like
>> >>>>> this:
>> >>>>>
>> >>>>> $unserialize = unserialize($active_user_friends);
>> >>>>> if (in_array($author_id, $unserialize)) {
>> >>>>>
>> >>>>> it says this:
>> >>>>>
>> >>>>>
>> >>>>> *Warning*: unserialize() expects parameter 1 to be string, array
>> given
>> >>>>> and
>> >>>>> *Warning*: in_array() expects parameter 2 to be array, boolean given
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>> --------
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>> >>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>> >>>> 'my_add_friend_action');
>> >>>>> function my_add_friend_action() {
>> >>>>> global $wpdb;
>> >>>>> $profileID = $_POST['profileID'];
>> >>>>> $userID = $_POST['userID'];
>> >>>>>
>> >>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>> if ( ! is_array($chkMetaValue) )
>> >>>>> $chkMetaValue = array();
>> >>>>> $chkMetaValue[] = $profileID;
>> >>>>>
>> >>>>> // activity_tracker($current_user, 'added_friend', 'prof');
>> >>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>> $response = array( 'success' => true );
>> >>>>> wp_send_json_success($response);
>> >>>>>
>> >>>>> die();
>> >>>>> }
>> >>>>>
>> >>>>>
>> >>>>> function friend_status($author_id) {
>> >>>>> global $wpdb, $current_user;
>> >>>>>    get_currentuserinfo();
>> >>>>>
>> >>>>> //authorID is the userID of the profile owner
>> >>>>>
>> >>>>> $active_user = $current_user->ID;
>> >>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>> >>>>>
>> >>>>> if (in_array($author_id, $active_user_friends, true)) {
>> >>>>> $friend_status = "<button id='remove_friend'>Remove
>> Friend</button>";
>> >>>>> } else {
>> >>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>> >>>>> }
>> >>>>>
>> >>>>> return $friend_status;
>> >>>>> }
>> >>>>>
>> >>>>>
>> >>>>> That is basically the code I am using to insert the users id into
>> their
>> >>>>> user_meta table.
>> >>>>>
>> >>>>>
>> >>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
>> >>>> wrote:
>> >>>>>
>> >>>>>> There are two ways to use the *_meta functions. The way it looks
>> like
>> >>>> you
>> >>>>>> are doing it is that each user has a single entry in the usermeta
>> >> table,
>> >>>>>> with the key ?friends?. The value for this meta key will be stored
>> in
>> >>>> the
>> >>>>>> database as a serialized array, and when it is pulled out (by
>> >>>>>> get_user_meta()) it gets unserialized into a PHP array.
>> >>>>>>
>> >>>>>> Alternative is this: Each user has multiple ?friend? meta key rows
>> in
>> >>>> the
>> >>>>>> usermeta table, each one?s meta_value the ID of a single user that
>> the
>> >>>> user
>> >>>>>> has friended.
>> >>>>>>
>> >>>>>> The benefit of the second option is that the values may be easier
>> to
>> >>>>>> search. Much easier. But that may not be important to you right
>> now.
>> >>>> (But
>> >>>>>> then that could change later?) What if you want to show a list of
>> >> users
>> >>>> who
>> >>>>>> have friended a user? You will be able to do that easily with this.
>> >> With
>> >>>>>> the first option, it is possible, but more complex and probably
>> harder
>> >>>> on
>> >>>>>> the DB.
>> >>>>>>
>> >>>>>> The downside is that there are many more rows in usermeta table.
>> >>>>>>
>> >>>>>> So each of these functions let you target a single row (as in first
>> >>>> case)
>> >>>>>> or all rows with a key (as in the later case). Whichever way you
>> go,
>> >> you
>> >>>>>> just need to be consistent through all of the code, obviously.
>> >>>>>>
>> >>>>>> -J.D.
>> >>>>>>
>> >>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>> >>>> greglancaster71 at gmail.com>
>> >>>>>> wrote:
>> >>>>>>
>> >>>>>>> What would be the benefit of storing the friends in separate
>> rows? I
>> >>>> did
>> >>>>>>> not know that was an option, but don't see any clear advantages
>> >> either.
>> >>>>>>> Also, I did just search the codex but dont see anything about
>> unique
>> >>>>>> rows.
>> >>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <
>> jdg at codesymphony.co>
>> >>>>>> wrote:
>> >>>>>>>
>> >>>>>>>> Yes, when you call get_user_meta() you need to set the third
>> >> parameter
>> >>>>>>>> ($single) to true:
>> >>>>>>>>
>> >>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
>> true
>> >> );
>> >>>>>>>>
>> >>>>>>>> Otherwise it will return a nested array. Also, just FYI,
>> >> alternatively
>> >>>>>> you
>> >>>>>>>> could leave the get_user_meta() call the way it is, and change
>> it so
>> >>>>>> that
>> >>>>>>>> each friend is stored in a separate meta row (but with the same
>> meta
>> >>>>>> key -
>> >>>>>>>> have a look at the *_user_meta functions on the codex).
>> >>>>>>>>
>> >>>>>>>> -J.D.
>> >>>>>>>>
>> >>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>> >>>>>> greglancaster71 at gmail.com>
>> >>>>>>>> wrote:
>> >>>>>>>>
>> >>>>>>>>> I thought so.  One more question if you dont mind helping;
>> >>>>>>>>>
>> >>>>>>>>> This is the function I wrote to determine what button to show on
>> >> page
>> >>>>>>>> load.
>> >>>>>>>>> But regardless if someone has been friended or not, it shows the
>> >> add
>> >>>>>>>>> friend option.  Is something wrong with this?
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> function friend_status($author_id) {
>> >>>>>>>>> global $wpdb, $current_user;
>> >>>>>>>>>  get_currentuserinfo();
>> >>>>>>>>>
>> >>>>>>>>> //authorID is the userID of the profile owner
>> >>>>>>>>>
>> >>>>>>>>> $active_user = $current_user->ID;
>> >>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>> >>>>>>>>>
>> >>>>>>>>> if (in_array($author_id, $active_user_friends)) {
>> >>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>> >> Friend</button>";
>> >>>>>>>>> } else {
>> >>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>> >>>>>>>>> }
>> >>>>>>>>>
>> >>>>>>>>> return $friend_status;
>> >>>>>>>>> }
>> >>>>>>>>>
>> >>>>>>>>> Then on page:  echo $friend_status;
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
>> jdg at codesymphony.co
>> >>>
>> >>>>>>>> wrote:
>> >>>>>>>>>
>> >>>>>>>>>> Yes, I would write a separate function for removal, and hook it
>> >> to a
>> >>>>>>>>>> different AJAX action for removal.
>> >>>>>>>>>>
>> >>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>> >>>>>>>> greglancaster71 at gmail.com>
>> >>>>>>>>>> wrote:
>> >>>>>>>>>>
>> >>>>>>>>>>> That works easier :)  Once someone is friended I have it set
>> so
>> >> an
>> >>>>>>>>>> unfriend
>> >>>>>>>>>>> button replaces the add friend button via ajax.  Is it
>> necessary
>> >> to
>> >>>>>>>> write
>> >>>>>>>>>>> another function for deleting a person?  Not sure exactly how
>> to
>> >>>> make
>> >>>>>>>> the
>> >>>>>>>>>>> new button function since the data being sent is not attached
>> to
>> >>>> the
>> >>>>>>>>>> button
>> >>>>>>>>>>> in any way.  maybe I could add a value to the button that says
>> >>>> remove
>> >>>>>>>> or
>> >>>>>>>>>>> add, which would be passed to the function and determine what
>> >>>> action
>> >>>>>> to
>> >>>>>>>>>>> take?
>> >>>>>>>>>>>
>> >>>>>>>>>>>
>> >>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
>> >> jdg at codesymphony.co
>> >>>>>
>> >>>>>>>>>> wrote:
>> >>>>>>>>>>>
>> >>>>>>>>>>>> I would do this:
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> $profileID = $_POST['profileID'];
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>> >>>>>>>>>>>>   $chkMetaValue = array();
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> -J.D.
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>> >>>>>> greglancaster71 at gmail.com
>> >>>>>>>>>
>> >>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>
>> >>>>>>>>>>>>> I am not sure exactly how this would work because I start
>> with
>> >> an
>> >>>>>>>> empty
>> >>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if
>> there
>> >> is
>> >>>>>> not
>> >>>>>>>> at
>> >>>>>>>>>>>>> least one value in the field, correct?
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> So maybe something like this:
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> $profileID = $_POST['profileID'];
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>>>>>>>>>> if (!empty($chkMetaValue))
>> >>>>>>>>>>>>>         {
>> >>>>>>>>>>>>>         array_push($profileID);
>> >>>>>>>>>>>>>         } else {
>> >>>>>>>>>>>>>         $profileID;
>> >>>>>>>>>>>>>         }
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> Is that right?
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> --
>> >>>>>>>>>>>>> View this message in context:
>> >>>>>>>>>>>>
>> >>>>>>>>>>
>> >>>>>>>>
>> >>>>>>
>> >>>>
>> >>
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>> >>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>> >>>> Nabble.com.
>> >>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>
>> >>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>
>> >>>>>>>>>> _______________________________________________
>> >>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>
>> >>>>>>>>> _______________________________________________
>> >>>>>>>>> wp-hackers mailing list
>> >>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>
>> >>>>>>>> _______________________________________________
>> >>>>>>>> wp-hackers mailing list
>> >>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>
>> >>>>>>> _______________________________________________
>> >>>>>>> wp-hackers mailing list
>> >>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>
>> >>>>>> _______________________________________________
>> >>>>>> wp-hackers mailing list
>> >>>>>> wp-hackers at lists.automattic.com
>> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>
>> >>>>> _______________________________________________
>> >>>>> wp-hackers mailing list
>> >>>>> wp-hackers at lists.automattic.com
>> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>
>> >>>> _______________________________________________
>> >>>> wp-hackers mailing list
>> >>>> wp-hackers at lists.automattic.com
>> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>
>> >>> _______________________________________________
>> >>> wp-hackers mailing list
>> >>> wp-hackers at lists.automattic.com
>> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> >> _______________________________________________
>> >> wp-hackers mailing list
>> >> wp-hackers at lists.automattic.com
>> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

From jdg at codesymphony.co  Thu Oct 31 21:22:24 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 17:22:24 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
Message-ID: <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>

Ah.. We forgot to add true to the gat_user_meta() in my_add_friend_action(). Add that and you should be good to go.

On Oct 31, 2013, at 5:18 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> Sure;
> 
> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> add_action('wp_ajax_nopriv_my_add_friend_action', 'my_add_friend_action');
> function my_add_friend_action() {
> global $wpdb;
> $profileID = $_POST['profileID'];
> $userID = $_POST['userID'];
> 
> $chkMetaValue = get_user_meta($userID,"friends");
> if ( ! is_array($chkMetaValue) )
> $chkMetaValue = array();
> $chkMetaValue[] = $profileID;
> 
> // activity_tracker($current_user, 'added_friend', 'prof');
> update_user_meta( $userID, 'friends', $chkMetaValue );
> $response = array( 'success' => true );
> wp_send_json_success($response);
> die();
> }
> 
> function follow_status($author_id) {
> global $wpdb, $current_user;
> get_currentuserinfo();
> 
>  //authorID is the userID of the profile owner
> 
>  $active_user = $current_user->ID;
>  $active_user_friends = get_user_meta($active_user, 'friends', true);
> 
>  if (in_array($author_id, $active_user_friends)) {
>  $follow_status = "<button id='remove_friend'>Remove Friend</button>";
>  } else {
>  $follow_status = "<button id='add_friend'>Add Friend</button>";
>  }
> 
> return $follow_status;
> }
> 
> and calling in the profile page with:
> 
> echo follow_status($author_id);
> 
> 
> 
> On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Could you post your code again? Somewhere you are still getting the value
>> wrapped in an extra array.
>> 
>> 
>> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> No I must have screwed something up man, it only shows the last value.  I
>>> searched for awhile before responding here, and I see some people say
>>> in_array adds a line between items and sometimes other folks needed to
>>> strip those.  But I have no idea if thats whats going on here.  It all
>>> looks like it should function.  :-/  Maybe I need to get off the computer
>>> for awhile.
>>> 
>>> I var_dump using the function you shared, and this is what the friend
>> array
>>> looks like from there:
>>> 
>>> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
>> [0]=>\n
>>>    array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
>>>  array(1) {\n            [0]=>\n            string(1) "1"\n          }\n
>>>        [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
>>> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
>>> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
>>> 
>>> I dont know if that assists in debugging.
>>> 
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> OK, you need to just delete that meta row and start over. It is messed
>> up
>>>> from before. Do that and see if it works.
>>>> 
>>>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> I have it set to true:
>>>>> 
>>>>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>>>>> But the issue is that it only shows the "friended" code for the last
>>>> user I
>>>>> added.  If I click add on one profile, and then to a second, the first
>> no
>>>>> longer shows friend added. Even if I have clearly added several to the
>>>>> array:
>>>>> 
>>>>> 
>>>> 
>> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
>>>>> 
>>>>> 
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> No, you don?t need to use unserialize, that is all done automatically
>> by
>>>>>> the WordPress functions.
>>>>>> 
>>>>>> In the code you posted you still aren?t calling get_user_meta() with
>> the
>>>>>> third parameter set to true. You need to do that. Right now the array
>>>> it is
>>>>>> returning looks something like this:
>>>>>> 
>>>>>> array(
>>>>>>      0 => array( 3, 45, 6, 33 )
>>>>>> )
>>>>>> 
>>>>>> When you call in_array() it is checking if the user ID (say, 3 ) is in
>>>> the
>>>>>> outer array. But it isn?t, the only thing in it is another array. When
>>>> you
>>>>>> call get_user_meta() with the third parameter set to true, the
>> returned
>>>>>> value won?t be wrapped in the outer array like that, so it will work.
>>>>>> 
>>>>>> 
>>>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
>>>> greglancaster71 at gmail.com>
>>>>>> wrote:
>>>>>> 
>>>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
>> easier
>>>>>>> option is to just create a separate table to store the friends list
>> in.
>>>>>>> Trying to work with user_meta this way seems like a bad idea.
>>>>>>> 
>>>>>>> Quick question, should I be using unserialize to check the array
>> values
>>>>>>> using in_array?  Because right now this code isnt working.  Thats the
>>>>>> only
>>>>>>> thing that seems to be left out - but when I tried using $unserialize
>>>>>> like
>>>>>>> this:
>>>>>>> 
>>>>>>> $unserialize = unserialize($active_user_friends);
>>>>>>> if (in_array($author_id, $unserialize)) {
>>>>>>> 
>>>>>>> it says this:
>>>>>>> 
>>>>>>> 
>>>>>>> *Warning*: unserialize() expects parameter 1 to be string, array
>> given
>>>>>>> and
>>>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean given
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> --------
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>>>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>>>>>> 'my_add_friend_action');
>>>>>>> function my_add_friend_action() {
>>>>>>> global $wpdb;
>>>>>>> $profileID = $_POST['profileID'];
>>>>>>> $userID = $_POST['userID'];
>>>>>>> 
>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>> $chkMetaValue = array();
>>>>>>> $chkMetaValue[] = $profileID;
>>>>>>> 
>>>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>> $response = array( 'success' => true );
>>>>>>> wp_send_json_success($response);
>>>>>>> 
>>>>>>> die();
>>>>>>> }
>>>>>>> 
>>>>>>> 
>>>>>>> function friend_status($author_id) {
>>>>>>> global $wpdb, $current_user;
>>>>>>>   get_currentuserinfo();
>>>>>>> 
>>>>>>> //authorID is the userID of the profile owner
>>>>>>> 
>>>>>>> $active_user = $current_user->ID;
>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>> 
>>>>>>> if (in_array($author_id, $active_user_friends, true)) {
>>>>>>> $friend_status = "<button id='remove_friend'>Remove Friend</button>";
>>>>>>> } else {
>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>> }
>>>>>>> 
>>>>>>> return $friend_status;
>>>>>>> }
>>>>>>> 
>>>>>>> 
>>>>>>> That is basically the code I am using to insert the users id into
>> their
>>>>>>> user_meta table.
>>>>>>> 
>>>>>>> 
>>>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
>>>>>> wrote:
>>>>>>> 
>>>>>>>> There are two ways to use the *_meta functions. The way it looks
>> like
>>>>>> you
>>>>>>>> are doing it is that each user has a single entry in the usermeta
>>>> table,
>>>>>>>> with the key ?friends?. The value for this meta key will be stored
>> in
>>>>>> the
>>>>>>>> database as a serialized array, and when it is pulled out (by
>>>>>>>> get_user_meta()) it gets unserialized into a PHP array.
>>>>>>>> 
>>>>>>>> Alternative is this: Each user has multiple ?friend? meta key rows
>> in
>>>>>> the
>>>>>>>> usermeta table, each one?s meta_value the ID of a single user that
>> the
>>>>>> user
>>>>>>>> has friended.
>>>>>>>> 
>>>>>>>> The benefit of the second option is that the values may be easier to
>>>>>>>> search. Much easier. But that may not be important to you right now.
>>>>>> (But
>>>>>>>> then that could change later?) What if you want to show a list of
>>>> users
>>>>>> who
>>>>>>>> have friended a user? You will be able to do that easily with this.
>>>> With
>>>>>>>> the first option, it is possible, but more complex and probably
>> harder
>>>>>> on
>>>>>>>> the DB.
>>>>>>>> 
>>>>>>>> The downside is that there are many more rows in usermeta table.
>>>>>>>> 
>>>>>>>> So each of these functions let you target a single row (as in first
>>>>>> case)
>>>>>>>> or all rows with a key (as in the later case). Whichever way you go,
>>>> you
>>>>>>>> just need to be consistent through all of the code, obviously.
>>>>>>>> 
>>>>>>>> -J.D.
>>>>>>>> 
>>>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>>>>>> greglancaster71 at gmail.com>
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> What would be the benefit of storing the friends in separate rows?
>> I
>>>>>> did
>>>>>>>>> not know that was an option, but don't see any clear advantages
>>>> either.
>>>>>>>>> Also, I did just search the codex but dont see anything about
>> unique
>>>>>>>> rows.
>>>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <jdg at codesymphony.co
>>> 
>>>>>>>> wrote:
>>>>>>>>> 
>>>>>>>>>> Yes, when you call get_user_meta() you need to set the third
>>>> parameter
>>>>>>>>>> ($single) to true:
>>>>>>>>>> 
>>>>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
>> true
>>>> );
>>>>>>>>>> 
>>>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
>>>> alternatively
>>>>>>>> you
>>>>>>>>>> could leave the get_user_meta() call the way it is, and change it
>> so
>>>>>>>> that
>>>>>>>>>> each friend is stored in a separate meta row (but with the same
>> meta
>>>>>>>> key -
>>>>>>>>>> have a look at the *_user_meta functions on the codex).
>>>>>>>>>> 
>>>>>>>>>> -J.D.
>>>>>>>>>> 
>>>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>> wrote:
>>>>>>>>>> 
>>>>>>>>>>> I thought so.  One more question if you dont mind helping;
>>>>>>>>>>> 
>>>>>>>>>>> This is the function I wrote to determine what button to show on
>>>> page
>>>>>>>>>> load.
>>>>>>>>>>> But regardless if someone has been friended or not, it shows the
>>>> add
>>>>>>>>>>> friend option.  Is something wrong with this?
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> function friend_status($author_id) {
>>>>>>>>>>> global $wpdb, $current_user;
>>>>>>>>>>> get_currentuserinfo();
>>>>>>>>>>> 
>>>>>>>>>>> //authorID is the userID of the profile owner
>>>>>>>>>>> 
>>>>>>>>>>> $active_user = $current_user->ID;
>>>>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>>>>>> 
>>>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
>>>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>>>> Friend</button>";
>>>>>>>>>>> } else {
>>>>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>>>>>> }
>>>>>>>>>>> 
>>>>>>>>>>> return $friend_status;
>>>>>>>>>>> }
>>>>>>>>>>> 
>>>>>>>>>>> Then on page:  echo $friend_status;
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
>> jdg at codesymphony.co
>>>>> 
>>>>>>>>>> wrote:
>>>>>>>>>>> 
>>>>>>>>>>>> Yes, I would write a separate function for removal, and hook it
>>>> to a
>>>>>>>>>>>> different AJAX action for removal.
>>>>>>>>>>>> 
>>>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>>>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>>>> wrote:
>>>>>>>>>>>> 
>>>>>>>>>>>>> That works easier :)  Once someone is friended I have it set so
>>>> an
>>>>>>>>>>>> unfriend
>>>>>>>>>>>>> button replaces the add friend button via ajax.  Is it
>> necessary
>>>> to
>>>>>>>>>> write
>>>>>>>>>>>>> another function for deleting a person?  Not sure exactly how
>> to
>>>>>> make
>>>>>>>>>> the
>>>>>>>>>>>>> new button function since the data being sent is not attached
>> to
>>>>>> the
>>>>>>>>>>>> button
>>>>>>>>>>>>> in any way.  maybe I could add a value to the button that says
>>>>>> remove
>>>>>>>>>> or
>>>>>>>>>>>>> add, which would be passed to the function and determine what
>>>>>> action
>>>>>>>> to
>>>>>>>>>>>>> take?
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
>>>> jdg at codesymphony.co
>>>>>>> 
>>>>>>>>>>>> wrote:
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> I would do this:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>>>>>>>  $chkMetaValue = array();
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> -J.D.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>>>>>>>> greglancaster71 at gmail.com
>>>>>>>>>>> 
>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> I am not sure exactly how this would work because I start
>> with
>>>> an
>>>>>>>>>> empty
>>>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if there
>>>> is
>>>>>>>> not
>>>>>>>>>> at
>>>>>>>>>>>>>>> least one value in the field, correct?
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> So maybe something like this:
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>>>>> if (!empty($chkMetaValue))
>>>>>>>>>>>>>>>        {
>>>>>>>>>>>>>>>        array_push($profileID);
>>>>>>>>>>>>>>>        } else {
>>>>>>>>>>>>>>>        $profileID;
>>>>>>>>>>>>>>>        }
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> Is that right?
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> --
>>>>>>>>>>>>>>> View this message in context:
>>>>>>>>>>>>>> 
>>>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>> 
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>>>>>> Nabble.com.
>>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>> 
>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>>> _______________________________________________
>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> wp-hackers mailing list
>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 21:28:16 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 14:28:16 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
 <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>
Message-ID: <CAPN-N+Ztc1cxJ2q82++q98LNoNihw1SegzdJHO4gc8o_5k+P6Q@mail.gmail.com>

did I really spend a couple hours reading for a solution over the word
true.  Thank you JD.  Real quick, you said:

When you call in_array() it is checking if the user ID (say, 3 ) is in the
outer array. But it isn?t, the only thing in it is another array. When you
call get_user_meta() with the third parameter set to true, the returned
value won?t be wrapped in the outer array like that, so it will work.

Why are arrays stored so many tiers deep like that?  Is this a wordpress
only thing, or is this normal?  It looks like everytime a persons ID is
added, another instance of array(array(array( is added.  What is the
reasoning behind this?  Or do I understand it incorrectly?





On Thu, Oct 31, 2013 at 2:22 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Ah.. We forgot to add true to the gat_user_meta() in
> my_add_friend_action(). Add that and you should be good to go.
>
> On Oct 31, 2013, at 5:18 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > Sure;
> >
> > add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> > add_action('wp_ajax_nopriv_my_add_friend_action',
> 'my_add_friend_action');
> > function my_add_friend_action() {
> > global $wpdb;
> > $profileID = $_POST['profileID'];
> > $userID = $_POST['userID'];
> >
> > $chkMetaValue = get_user_meta($userID,"friends");
> > if ( ! is_array($chkMetaValue) )
> > $chkMetaValue = array();
> > $chkMetaValue[] = $profileID;
> >
> > // activity_tracker($current_user, 'added_friend', 'prof');
> > update_user_meta( $userID, 'friends', $chkMetaValue );
> > $response = array( 'success' => true );
> > wp_send_json_success($response);
> > die();
> > }
> >
> > function follow_status($author_id) {
> > global $wpdb, $current_user;
> > get_currentuserinfo();
> >
> >  //authorID is the userID of the profile owner
> >
> >  $active_user = $current_user->ID;
> >  $active_user_friends = get_user_meta($active_user, 'friends', true);
> >
> >  if (in_array($author_id, $active_user_friends)) {
> >  $follow_status = "<button id='remove_friend'>Remove Friend</button>";
> >  } else {
> >  $follow_status = "<button id='add_friend'>Add Friend</button>";
> >  }
> >
> > return $follow_status;
> > }
> >
> > and calling in the profile page with:
> >
> > echo follow_status($author_id);
> >
> >
> >
> > On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Could you post your code again? Somewhere you are still getting the
> value
> >> wrapped in an extra array.
> >>
> >>
> >> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> No I must have screwed something up man, it only shows the last value.
>  I
> >>> searched for awhile before responding here, and I see some people say
> >>> in_array adds a line between items and sometimes other folks needed to
> >>> strip those.  But I have no idea if thats whats going on here.  It all
> >>> looks like it should function.  :-/  Maybe I need to get off the
> computer
> >>> for awhile.
> >>>
> >>> I var_dump using the function you shared, and this is what the friend
> >> array
> >>> looks like from there:
> >>>
> >>> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
> >> [0]=>\n
> >>>    array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
> >>>  array(1) {\n            [0]=>\n            string(1) "1"\n
>  }\n
> >>>        [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
> >>> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
> >>> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
> >>>
> >>> I dont know if that assists in debugging.
> >>>
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> OK, you need to just delete that meta row and start over. It is messed
> >> up
> >>>> from before. Do that and see if it works.
> >>>>
> >>>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> I have it set to true:
> >>>>>
> >>>>> $active_user_friends = get_user_meta($active_user, 'friends', true);
> >>>>> But the issue is that it only shows the "friended" code for the last
> >>>> user I
> >>>>> added.  If I click add on one profile, and then to a second, the
> first
> >> no
> >>>>> longer shows friend added. Even if I have clearly added several to
> the
> >>>>> array:
> >>>>>
> >>>>>
> >>>>
> >>
> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> No, you don?t need to use unserialize, that is all done
> automatically
> >> by
> >>>>>> the WordPress functions.
> >>>>>>
> >>>>>> In the code you posted you still aren?t calling get_user_meta() with
> >> the
> >>>>>> third parameter set to true. You need to do that. Right now the
> array
> >>>> it is
> >>>>>> returning looks something like this:
> >>>>>>
> >>>>>> array(
> >>>>>>      0 => array( 3, 45, 6, 33 )
> >>>>>> )
> >>>>>>
> >>>>>> When you call in_array() it is checking if the user ID (say, 3 ) is
> in
> >>>> the
> >>>>>> outer array. But it isn?t, the only thing in it is another array.
> When
> >>>> you
> >>>>>> call get_user_meta() with the third parameter set to true, the
> >> returned
> >>>>>> value won?t be wrapped in the outer array like that, so it will
> work.
> >>>>>>
> >>>>>>
> >>>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
> >>>> greglancaster71 at gmail.com>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
> >> easier
> >>>>>>> option is to just create a separate table to store the friends list
> >> in.
> >>>>>>> Trying to work with user_meta this way seems like a bad idea.
> >>>>>>>
> >>>>>>> Quick question, should I be using unserialize to check the array
> >> values
> >>>>>>> using in_array?  Because right now this code isnt working.  Thats
> the
> >>>>>> only
> >>>>>>> thing that seems to be left out - but when I tried using
> $unserialize
> >>>>>> like
> >>>>>>> this:
> >>>>>>>
> >>>>>>> $unserialize = unserialize($active_user_friends);
> >>>>>>> if (in_array($author_id, $unserialize)) {
> >>>>>>>
> >>>>>>> it says this:
> >>>>>>>
> >>>>>>>
> >>>>>>> *Warning*: unserialize() expects parameter 1 to be string, array
> >> given
> >>>>>>> and
> >>>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean
> given
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> --------
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> >>>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
> >>>>>> 'my_add_friend_action');
> >>>>>>> function my_add_friend_action() {
> >>>>>>> global $wpdb;
> >>>>>>> $profileID = $_POST['profileID'];
> >>>>>>> $userID = $_POST['userID'];
> >>>>>>>
> >>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>> $chkMetaValue = array();
> >>>>>>> $chkMetaValue[] = $profileID;
> >>>>>>>
> >>>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
> >>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>> $response = array( 'success' => true );
> >>>>>>> wp_send_json_success($response);
> >>>>>>>
> >>>>>>> die();
> >>>>>>> }
> >>>>>>>
> >>>>>>>
> >>>>>>> function friend_status($author_id) {
> >>>>>>> global $wpdb, $current_user;
> >>>>>>>   get_currentuserinfo();
> >>>>>>>
> >>>>>>> //authorID is the userID of the profile owner
> >>>>>>>
> >>>>>>> $active_user = $current_user->ID;
> >>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>>>
> >>>>>>> if (in_array($author_id, $active_user_friends, true)) {
> >>>>>>> $friend_status = "<button id='remove_friend'>Remove
> Friend</button>";
> >>>>>>> } else {
> >>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>>>> }
> >>>>>>>
> >>>>>>> return $friend_status;
> >>>>>>> }
> >>>>>>>
> >>>>>>>
> >>>>>>> That is basically the code I am using to insert the users id into
> >> their
> >>>>>>> user_meta table.
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>>>> wrote:
> >>>>>>>
> >>>>>>>> There are two ways to use the *_meta functions. The way it looks
> >> like
> >>>>>> you
> >>>>>>>> are doing it is that each user has a single entry in the usermeta
> >>>> table,
> >>>>>>>> with the key ?friends?. The value for this meta key will be stored
> >> in
> >>>>>> the
> >>>>>>>> database as a serialized array, and when it is pulled out (by
> >>>>>>>> get_user_meta()) it gets unserialized into a PHP array.
> >>>>>>>>
> >>>>>>>> Alternative is this: Each user has multiple ?friend? meta key rows
> >> in
> >>>>>> the
> >>>>>>>> usermeta table, each one?s meta_value the ID of a single user that
> >> the
> >>>>>> user
> >>>>>>>> has friended.
> >>>>>>>>
> >>>>>>>> The benefit of the second option is that the values may be easier
> to
> >>>>>>>> search. Much easier. But that may not be important to you right
> now.
> >>>>>> (But
> >>>>>>>> then that could change later?) What if you want to show a list of
> >>>> users
> >>>>>> who
> >>>>>>>> have friended a user? You will be able to do that easily with
> this.
> >>>> With
> >>>>>>>> the first option, it is possible, but more complex and probably
> >> harder
> >>>>>> on
> >>>>>>>> the DB.
> >>>>>>>>
> >>>>>>>> The downside is that there are many more rows in usermeta table.
> >>>>>>>>
> >>>>>>>> So each of these functions let you target a single row (as in
> first
> >>>>>> case)
> >>>>>>>> or all rows with a key (as in the later case). Whichever way you
> go,
> >>>> you
> >>>>>>>> just need to be consistent through all of the code, obviously.
> >>>>>>>>
> >>>>>>>> -J.D.
> >>>>>>>>
> >>>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
> >>>>>> greglancaster71 at gmail.com>
> >>>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> What would be the benefit of storing the friends in separate
> rows?
> >> I
> >>>>>> did
> >>>>>>>>> not know that was an option, but don't see any clear advantages
> >>>> either.
> >>>>>>>>> Also, I did just search the codex but dont see anything about
> >> unique
> >>>>>>>> rows.
> >>>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <
> jdg at codesymphony.co
> >>>
> >>>>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> Yes, when you call get_user_meta() you need to set the third
> >>>> parameter
> >>>>>>>>>> ($single) to true:
> >>>>>>>>>>
> >>>>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
> >> true
> >>>> );
> >>>>>>>>>>
> >>>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
> >>>> alternatively
> >>>>>>>> you
> >>>>>>>>>> could leave the get_user_meta() call the way it is, and change
> it
> >> so
> >>>>>>>> that
> >>>>>>>>>> each friend is stored in a separate meta row (but with the same
> >> meta
> >>>>>>>> key -
> >>>>>>>>>> have a look at the *_user_meta functions on the codex).
> >>>>>>>>>>
> >>>>>>>>>> -J.D.
> >>>>>>>>>>
> >>>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> >>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> I thought so.  One more question if you dont mind helping;
> >>>>>>>>>>>
> >>>>>>>>>>> This is the function I wrote to determine what button to show
> on
> >>>> page
> >>>>>>>>>> load.
> >>>>>>>>>>> But regardless if someone has been friended or not, it shows
> the
> >>>> add
> >>>>>>>>>>> friend option.  Is something wrong with this?
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> function friend_status($author_id) {
> >>>>>>>>>>> global $wpdb, $current_user;
> >>>>>>>>>>> get_currentuserinfo();
> >>>>>>>>>>>
> >>>>>>>>>>> //authorID is the userID of the profile owner
> >>>>>>>>>>>
> >>>>>>>>>>> $active_user = $current_user->ID;
> >>>>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>>>>>>>
> >>>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
> >>>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
> >>>> Friend</button>";
> >>>>>>>>>>> } else {
> >>>>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>>>>>>>> }
> >>>>>>>>>>>
> >>>>>>>>>>> return $friend_status;
> >>>>>>>>>>> }
> >>>>>>>>>>>
> >>>>>>>>>>> Then on page:  echo $friend_status;
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
> >> jdg at codesymphony.co
> >>>>>
> >>>>>>>>>> wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>> Yes, I would write a separate function for removal, and hook
> it
> >>>> to a
> >>>>>>>>>>>> different AJAX action for removal.
> >>>>>>>>>>>>
> >>>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >>>>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>>>> wrote:
> >>>>>>>>>>>>
> >>>>>>>>>>>>> That works easier :)  Once someone is friended I have it set
> so
> >>>> an
> >>>>>>>>>>>> unfriend
> >>>>>>>>>>>>> button replaces the add friend button via ajax.  Is it
> >> necessary
> >>>> to
> >>>>>>>>>> write
> >>>>>>>>>>>>> another function for deleting a person?  Not sure exactly how
> >> to
> >>>>>> make
> >>>>>>>>>> the
> >>>>>>>>>>>>> new button function since the data being sent is not attached
> >> to
> >>>>>> the
> >>>>>>>>>>>> button
> >>>>>>>>>>>>> in any way.  maybe I could add a value to the button that
> says
> >>>>>> remove
> >>>>>>>>>> or
> >>>>>>>>>>>>> add, which would be passed to the function and determine what
> >>>>>> action
> >>>>>>>> to
> >>>>>>>>>>>>> take?
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
> >>>> jdg at codesymphony.co
> >>>>>>>
> >>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>> I would do this:
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>>>>>>>  $chkMetaValue = array();
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> -J.D.
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> >>>>>>>> greglancaster71 at gmail.com
> >>>>>>>>>>>
> >>>>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> I am not sure exactly how this would work because I start
> >> with
> >>>> an
> >>>>>>>>>> empty
> >>>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if
> there
> >>>> is
> >>>>>>>> not
> >>>>>>>>>> at
> >>>>>>>>>>>>>>> least one value in the field, correct?
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> So maybe something like this:
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>>>> if (!empty($chkMetaValue))
> >>>>>>>>>>>>>>>        {
> >>>>>>>>>>>>>>>        array_push($profileID);
> >>>>>>>>>>>>>>>        } else {
> >>>>>>>>>>>>>>>        $profileID;
> >>>>>>>>>>>>>>>        }
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> Is that right?
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> --
> >>>>>>>>>>>>>>> View this message in context:
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> >>>>>> Nabble.com.
> >>>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>> _______________________________________________
> >>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>>> _______________________________________________
> >>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>> _______________________________________________
> >>>>>>>>> wp-hackers mailing list
> >>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From jdg at codesymphony.co  Thu Oct 31 21:33:38 2013
From: jdg at codesymphony.co (J.D. Grimes)
Date: Thu, 31 Oct 2013 17:33:38 -0400
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+Ztc1cxJ2q82++q98LNoNihw1SegzdJHO4gc8o_5k+P6Q@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
 <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>
 <CAPN-N+Ztc1cxJ2q82++q98LNoNihw1SegzdJHO4gc8o_5k+P6Q@mail.gmail.com>
Message-ID: <4C266435-C1C7-4A91-8B25-B3EA2C46AE00@codesymphony.co>

Yes, that is what was happening with the arrays, because each time you pulled the value out of the database, it was being wrapped in an array (because get_user_meta() was pulling the values for all ?friends? keys for the user). You added one user ID to it, and then put it back. That was happening each time you followed a user. Now that it is working correctly, the array will be only one layer deep. I remember coming up against this thing with get_user_meta() myself once when I was first learning WP development. :-)

On Oct 31, 2013, at 5:28 PM, Gregory Lancaster <greglancaster71 at gmail.com> wrote:

> did I really spend a couple hours reading for a solution over the word
> true.  Thank you JD.  Real quick, you said:
> 
> When you call in_array() it is checking if the user ID (say, 3 ) is in the
> outer array. But it isn?t, the only thing in it is another array. When you
> call get_user_meta() with the third parameter set to true, the returned
> value won?t be wrapped in the outer array like that, so it will work.
> 
> Why are arrays stored so many tiers deep like that?  Is this a wordpress
> only thing, or is this normal?  It looks like everytime a persons ID is
> added, another instance of array(array(array( is added.  What is the
> reasoning behind this?  Or do I understand it incorrectly?
> 
> 
> 
> 
> 
> On Thu, Oct 31, 2013 at 2:22 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
> 
>> Ah.. We forgot to add true to the gat_user_meta() in
>> my_add_friend_action(). Add that and you should be good to go.
>> 
>> On Oct 31, 2013, at 5:18 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>> 
>>> Sure;
>>> 
>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>> 'my_add_friend_action');
>>> function my_add_friend_action() {
>>> global $wpdb;
>>> $profileID = $_POST['profileID'];
>>> $userID = $_POST['userID'];
>>> 
>>> $chkMetaValue = get_user_meta($userID,"friends");
>>> if ( ! is_array($chkMetaValue) )
>>> $chkMetaValue = array();
>>> $chkMetaValue[] = $profileID;
>>> 
>>> // activity_tracker($current_user, 'added_friend', 'prof');
>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>> $response = array( 'success' => true );
>>> wp_send_json_success($response);
>>> die();
>>> }
>>> 
>>> function follow_status($author_id) {
>>> global $wpdb, $current_user;
>>> get_currentuserinfo();
>>> 
>>> //authorID is the userID of the profile owner
>>> 
>>> $active_user = $current_user->ID;
>>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>>> 
>>> if (in_array($author_id, $active_user_friends)) {
>>> $follow_status = "<button id='remove_friend'>Remove Friend</button>";
>>> } else {
>>> $follow_status = "<button id='add_friend'>Add Friend</button>";
>>> }
>>> 
>>> return $follow_status;
>>> }
>>> 
>>> and calling in the profile page with:
>>> 
>>> echo follow_status($author_id);
>>> 
>>> 
>>> 
>>> On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>>> 
>>>> Could you post your code again? Somewhere you are still getting the
>> value
>>>> wrapped in an extra array.
>>>> 
>>>> 
>>>> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>>>> wrote:
>>>> 
>>>>> No I must have screwed something up man, it only shows the last value.
>> I
>>>>> searched for awhile before responding here, and I see some people say
>>>>> in_array adds a line between items and sometimes other folks needed to
>>>>> strip those.  But I have no idea if thats whats going on here.  It all
>>>>> looks like it should function.  :-/  Maybe I need to get off the
>> computer
>>>>> for awhile.
>>>>> 
>>>>> I var_dump using the function you shared, and this is what the friend
>>>> array
>>>>> looks like from there:
>>>>> 
>>>>> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
>>>> [0]=>\n
>>>>>   array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
>>>>> array(1) {\n            [0]=>\n            string(1) "1"\n
>> }\n
>>>>>       [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
>>>>> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
>>>>> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
>>>>> 
>>>>> I dont know if that assists in debugging.
>>>>> 
>>>>> 
>>>>> 
>>>>> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
>>>> wrote:
>>>>> 
>>>>>> OK, you need to just delete that meta row and start over. It is messed
>>>> up
>>>>>> from before. Do that and see if it works.
>>>>>> 
>>>>>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
>>>> greglancaster71 at gmail.com>
>>>>>> wrote:
>>>>>> 
>>>>>>> I have it set to true:
>>>>>>> 
>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>>>>>>> But the issue is that it only shows the "friended" code for the last
>>>>>> user I
>>>>>>> added.  If I click add on one profile, and then to a second, the
>> first
>>>> no
>>>>>>> longer shows friend added. Even if I have clearly added several to
>> the
>>>>>>> array:
>>>>>>> 
>>>>>>> 
>>>>>> 
>>>> 
>> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> 
>>>>>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
>>>>>> wrote:
>>>>>>> 
>>>>>>>> No, you don?t need to use unserialize, that is all done
>> automatically
>>>> by
>>>>>>>> the WordPress functions.
>>>>>>>> 
>>>>>>>> In the code you posted you still aren?t calling get_user_meta() with
>>>> the
>>>>>>>> third parameter set to true. You need to do that. Right now the
>> array
>>>>>> it is
>>>>>>>> returning looks something like this:
>>>>>>>> 
>>>>>>>> array(
>>>>>>>>     0 => array( 3, 45, 6, 33 )
>>>>>>>> )
>>>>>>>> 
>>>>>>>> When you call in_array() it is checking if the user ID (say, 3 ) is
>> in
>>>>>> the
>>>>>>>> outer array. But it isn?t, the only thing in it is another array.
>> When
>>>>>> you
>>>>>>>> call get_user_meta() with the third parameter set to true, the
>>>> returned
>>>>>>>> value won?t be wrapped in the outer array like that, so it will
>> work.
>>>>>>>> 
>>>>>>>> 
>>>>>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
>>>>>> greglancaster71 at gmail.com>
>>>>>>>> wrote:
>>>>>>>> 
>>>>>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
>>>> easier
>>>>>>>>> option is to just create a separate table to store the friends list
>>>> in.
>>>>>>>>> Trying to work with user_meta this way seems like a bad idea.
>>>>>>>>> 
>>>>>>>>> Quick question, should I be using unserialize to check the array
>>>> values
>>>>>>>>> using in_array?  Because right now this code isnt working.  Thats
>> the
>>>>>>>> only
>>>>>>>>> thing that seems to be left out - but when I tried using
>> $unserialize
>>>>>>>> like
>>>>>>>>> this:
>>>>>>>>> 
>>>>>>>>> $unserialize = unserialize($active_user_friends);
>>>>>>>>> if (in_array($author_id, $unserialize)) {
>>>>>>>>> 
>>>>>>>>> it says this:
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> *Warning*: unserialize() expects parameter 1 to be string, array
>>>> given
>>>>>>>>> and
>>>>>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean
>> given
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> --------
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>>>>>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>>>>>>>> 'my_add_friend_action');
>>>>>>>>> function my_add_friend_action() {
>>>>>>>>> global $wpdb;
>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>> $userID = $_POST['userID'];
>>>>>>>>> 
>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>> $chkMetaValue = array();
>>>>>>>>> $chkMetaValue[] = $profileID;
>>>>>>>>> 
>>>>>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>> $response = array( 'success' => true );
>>>>>>>>> wp_send_json_success($response);
>>>>>>>>> 
>>>>>>>>> die();
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> function friend_status($author_id) {
>>>>>>>>> global $wpdb, $current_user;
>>>>>>>>>  get_currentuserinfo();
>>>>>>>>> 
>>>>>>>>> //authorID is the userID of the profile owner
>>>>>>>>> 
>>>>>>>>> $active_user = $current_user->ID;
>>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>>>> 
>>>>>>>>> if (in_array($author_id, $active_user_friends, true)) {
>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>> Friend</button>";
>>>>>>>>> } else {
>>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> return $friend_status;
>>>>>>>>> }
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> That is basically the code I am using to insert the users id into
>>>> their
>>>>>>>>> user_meta table.
>>>>>>>>> 
>>>>>>>>> 
>>>>>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <jdg at codesymphony.co>
>>>>>>>> wrote:
>>>>>>>>> 
>>>>>>>>>> There are two ways to use the *_meta functions. The way it looks
>>>> like
>>>>>>>> you
>>>>>>>>>> are doing it is that each user has a single entry in the usermeta
>>>>>> table,
>>>>>>>>>> with the key ?friends?. The value for this meta key will be stored
>>>> in
>>>>>>>> the
>>>>>>>>>> database as a serialized array, and when it is pulled out (by
>>>>>>>>>> get_user_meta()) it gets unserialized into a PHP array.
>>>>>>>>>> 
>>>>>>>>>> Alternative is this: Each user has multiple ?friend? meta key rows
>>>> in
>>>>>>>> the
>>>>>>>>>> usermeta table, each one?s meta_value the ID of a single user that
>>>> the
>>>>>>>> user
>>>>>>>>>> has friended.
>>>>>>>>>> 
>>>>>>>>>> The benefit of the second option is that the values may be easier
>> to
>>>>>>>>>> search. Much easier. But that may not be important to you right
>> now.
>>>>>>>> (But
>>>>>>>>>> then that could change later?) What if you want to show a list of
>>>>>> users
>>>>>>>> who
>>>>>>>>>> have friended a user? You will be able to do that easily with
>> this.
>>>>>> With
>>>>>>>>>> the first option, it is possible, but more complex and probably
>>>> harder
>>>>>>>> on
>>>>>>>>>> the DB.
>>>>>>>>>> 
>>>>>>>>>> The downside is that there are many more rows in usermeta table.
>>>>>>>>>> 
>>>>>>>>>> So each of these functions let you target a single row (as in
>> first
>>>>>>>> case)
>>>>>>>>>> or all rows with a key (as in the later case). Whichever way you
>> go,
>>>>>> you
>>>>>>>>>> just need to be consistent through all of the code, obviously.
>>>>>>>>>> 
>>>>>>>>>> -J.D.
>>>>>>>>>> 
>>>>>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>> wrote:
>>>>>>>>>> 
>>>>>>>>>>> What would be the benefit of storing the friends in separate
>> rows?
>>>> I
>>>>>>>> did
>>>>>>>>>>> not know that was an option, but don't see any clear advantages
>>>>>> either.
>>>>>>>>>>> Also, I did just search the codex but dont see anything about
>>>> unique
>>>>>>>>>> rows.
>>>>>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
>>>>>>>>>>> 
>>>>>>>>>>> 
>>>>>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <
>> jdg at codesymphony.co
>>>>> 
>>>>>>>>>> wrote:
>>>>>>>>>>> 
>>>>>>>>>>>> Yes, when you call get_user_meta() you need to set the third
>>>>>> parameter
>>>>>>>>>>>> ($single) to true:
>>>>>>>>>>>> 
>>>>>>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
>>>> true
>>>>>> );
>>>>>>>>>>>> 
>>>>>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
>>>>>> alternatively
>>>>>>>>>> you
>>>>>>>>>>>> could leave the get_user_meta() call the way it is, and change
>> it
>>>> so
>>>>>>>>>> that
>>>>>>>>>>>> each friend is stored in a separate meta row (but with the same
>>>> meta
>>>>>>>>>> key -
>>>>>>>>>>>> have a look at the *_user_meta functions on the codex).
>>>>>>>>>>>> 
>>>>>>>>>>>> -J.D.
>>>>>>>>>>>> 
>>>>>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>>>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>>>> wrote:
>>>>>>>>>>>> 
>>>>>>>>>>>>> I thought so.  One more question if you dont mind helping;
>>>>>>>>>>>>> 
>>>>>>>>>>>>> This is the function I wrote to determine what button to show
>> on
>>>>>> page
>>>>>>>>>>>> load.
>>>>>>>>>>>>> But regardless if someone has been friended or not, it shows
>> the
>>>>>> add
>>>>>>>>>>>>> friend option.  Is something wrong with this?
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> function friend_status($author_id) {
>>>>>>>>>>>>> global $wpdb, $current_user;
>>>>>>>>>>>>> get_currentuserinfo();
>>>>>>>>>>>>> 
>>>>>>>>>>>>> //authorID is the userID of the profile owner
>>>>>>>>>>>>> 
>>>>>>>>>>>>> $active_user = $current_user->ID;
>>>>>>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>>>>>>>>>>>>> 
>>>>>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
>>>>>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>>>>>> Friend</button>";
>>>>>>>>>>>>> } else {
>>>>>>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>>>>>>>>>>>>> }
>>>>>>>>>>>>> 
>>>>>>>>>>>>> return $friend_status;
>>>>>>>>>>>>> }
>>>>>>>>>>>>> 
>>>>>>>>>>>>> Then on page:  echo $friend_status;
>>>>>>>>>>>>> 
>>>>>>>>>>>>> 
>>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
>>>> jdg at codesymphony.co
>>>>>>> 
>>>>>>>>>>>> wrote:
>>>>>>>>>>>>> 
>>>>>>>>>>>>>> Yes, I would write a separate function for removal, and hook
>> it
>>>>>> to a
>>>>>>>>>>>>>> different AJAX action for removal.
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>>>>>>>>>>>> greglancaster71 at gmail.com>
>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> That works easier :)  Once someone is friended I have it set
>> so
>>>>>> an
>>>>>>>>>>>>>> unfriend
>>>>>>>>>>>>>>> button replaces the add friend button via ajax.  Is it
>>>> necessary
>>>>>> to
>>>>>>>>>>>> write
>>>>>>>>>>>>>>> another function for deleting a person?  Not sure exactly how
>>>> to
>>>>>>>> make
>>>>>>>>>>>> the
>>>>>>>>>>>>>>> new button function since the data being sent is not attached
>>>> to
>>>>>>>> the
>>>>>>>>>>>>>> button
>>>>>>>>>>>>>>> in any way.  maybe I could add a value to the button that
>> says
>>>>>>>> remove
>>>>>>>>>>>> or
>>>>>>>>>>>>>>> add, which would be passed to the function and determine what
>>>>>>>> action
>>>>>>>>>> to
>>>>>>>>>>>>>>> take?
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
>>>>>> jdg at codesymphony.co
>>>>>>>>> 
>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> I would do this:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>>>>>>>>>>>>>>>> $chkMetaValue = array();
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> -J.D.
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>>>>>>>>>> greglancaster71 at gmail.com
>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> wrote:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> I am not sure exactly how this would work because I start
>>>> with
>>>>>> an
>>>>>>>>>>>> empty
>>>>>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if
>> there
>>>>>> is
>>>>>>>>>> not
>>>>>>>>>>>> at
>>>>>>>>>>>>>>>>> least one value in the field, correct?
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> So maybe something like this:
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>>>>>>>>>>>>>>>>> if (!empty($chkMetaValue))
>>>>>>>>>>>>>>>>>       {
>>>>>>>>>>>>>>>>>       array_push($profileID);
>>>>>>>>>>>>>>>>>       } else {
>>>>>>>>>>>>>>>>>       $profileID;
>>>>>>>>>>>>>>>>>       }
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> Is that right?
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>>> --
>>>>>>>>>>>>>>>>> View this message in context:
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> 
>>>>>>>>>>>> 
>>>>>>>>>> 
>>>>>>>> 
>>>>>> 
>>>> 
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>>>>>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>>>>>>>> Nabble.com.
>>>>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>>>> 
>>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>> 
>>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>>>> 
>>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>>> _______________________________________________
>>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>>>> 
>>>>>>>>>>> _______________________________________________
>>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>>> _______________________________________________
>>>>>>>>>> wp-hackers mailing list
>>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>>>> 
>>>>>>>>> _______________________________________________
>>>>>>>>> wp-hackers mailing list
>>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>>> _______________________________________________
>>>>>>>> wp-hackers mailing list
>>>>>>>> wp-hackers at lists.automattic.com
>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>>>> 
>>>>>>> _______________________________________________
>>>>>>> wp-hackers mailing list
>>>>>>> wp-hackers at lists.automattic.com
>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>>> _______________________________________________
>>>>>> wp-hackers mailing list
>>>>>> wp-hackers at lists.automattic.com
>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>>>> 
>>>>> _______________________________________________
>>>>> wp-hackers mailing list
>>>>> wp-hackers at lists.automattic.com
>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>>> _______________________________________________
>>>> wp-hackers mailing list
>>>> wp-hackers at lists.automattic.com
>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>>> 
>>> _______________________________________________
>>> wp-hackers mailing list
>>> wp-hackers at lists.automattic.com
>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> 
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers


From greglancaster71 at gmail.com  Thu Oct 31 22:23:09 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 15:23:09 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <4C266435-C1C7-4A91-8B25-B3EA2C46AE00@codesymphony.co>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
 <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>
 <CAPN-N+Ztc1cxJ2q82++q98LNoNihw1SegzdJHO4gc8o_5k+P6Q@mail.gmail.com>
 <4C266435-C1C7-4A91-8B25-B3EA2C46AE00@codesymphony.co>
Message-ID: <CAPN-N+aJsNnyC7j3zVq2=_5SOPzE1rBcfxige3PkO_rGvXQ_MQ@mail.gmail.com>

Ah i see. The wordpress codex is inexpendable to me right now haha, I dont
have all this stuff programmed into my brain yet.

So for the unfollow option, I will be using unset right?  and there isnt
any special magic or voodoo I should know about here?

unset($reChkMetaValue[ $profileID ]);
I have unset arrays before in class, but never a wordpress serialized
array.  Same thing?




On Thu, Oct 31, 2013 at 2:33 PM, J.D. Grimes <jdg at codesymphony.co> wrote:

> Yes, that is what was happening with the arrays, because each time you
> pulled the value out of the database, it was being wrapped in an array
> (because get_user_meta() was pulling the values for all ?friends? keys for
> the user). You added one user ID to it, and then put it back. That was
> happening each time you followed a user. Now that it is working correctly,
> the array will be only one layer deep. I remember coming up against this
> thing with get_user_meta() myself once when I was first learning WP
> development. :-)
>
> On Oct 31, 2013, at 5:28 PM, Gregory Lancaster <greglancaster71 at gmail.com>
> wrote:
>
> > did I really spend a couple hours reading for a solution over the word
> > true.  Thank you JD.  Real quick, you said:
> >
> > When you call in_array() it is checking if the user ID (say, 3 ) is in
> the
> > outer array. But it isn?t, the only thing in it is another array. When
> you
> > call get_user_meta() with the third parameter set to true, the returned
> > value won?t be wrapped in the outer array like that, so it will work.
> >
> > Why are arrays stored so many tiers deep like that?  Is this a wordpress
> > only thing, or is this normal?  It looks like everytime a persons ID is
> > added, another instance of array(array(array( is added.  What is the
> > reasoning behind this?  Or do I understand it incorrectly?
> >
> >
> >
> >
> >
> > On Thu, Oct 31, 2013 at 2:22 PM, J.D. Grimes <jdg at codesymphony.co>
> wrote:
> >
> >> Ah.. We forgot to add true to the gat_user_meta() in
> >> my_add_friend_action(). Add that and you should be good to go.
> >>
> >> On Oct 31, 2013, at 5:18 PM, Gregory Lancaster <
> greglancaster71 at gmail.com>
> >> wrote:
> >>
> >>> Sure;
> >>>
> >>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
> >>> add_action('wp_ajax_nopriv_my_add_friend_action',
> >> 'my_add_friend_action');
> >>> function my_add_friend_action() {
> >>> global $wpdb;
> >>> $profileID = $_POST['profileID'];
> >>> $userID = $_POST['userID'];
> >>>
> >>> $chkMetaValue = get_user_meta($userID,"friends");
> >>> if ( ! is_array($chkMetaValue) )
> >>> $chkMetaValue = array();
> >>> $chkMetaValue[] = $profileID;
> >>>
> >>> // activity_tracker($current_user, 'added_friend', 'prof');
> >>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>> $response = array( 'success' => true );
> >>> wp_send_json_success($response);
> >>> die();
> >>> }
> >>>
> >>> function follow_status($author_id) {
> >>> global $wpdb, $current_user;
> >>> get_currentuserinfo();
> >>>
> >>> //authorID is the userID of the profile owner
> >>>
> >>> $active_user = $current_user->ID;
> >>> $active_user_friends = get_user_meta($active_user, 'friends', true);
> >>>
> >>> if (in_array($author_id, $active_user_friends)) {
> >>> $follow_status = "<button id='remove_friend'>Remove Friend</button>";
> >>> } else {
> >>> $follow_status = "<button id='add_friend'>Add Friend</button>";
> >>> }
> >>>
> >>> return $follow_status;
> >>> }
> >>>
> >>> and calling in the profile page with:
> >>>
> >>> echo follow_status($author_id);
> >>>
> >>>
> >>>
> >>> On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co>
> >> wrote:
> >>>
> >>>> Could you post your code again? Somewhere you are still getting the
> >> value
> >>>> wrapped in an extra array.
> >>>>
> >>>>
> >>>> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <
> >> greglancaster71 at gmail.com>
> >>>> wrote:
> >>>>
> >>>>> No I must have screwed something up man, it only shows the last
> value.
> >> I
> >>>>> searched for awhile before responding here, and I see some people say
> >>>>> in_array adds a line between items and sometimes other folks needed
> to
> >>>>> strip those.  But I have no idea if thats whats going on here.  It
> all
> >>>>> looks like it should function.  :-/  Maybe I need to get off the
> >> computer
> >>>>> for awhile.
> >>>>>
> >>>>> I var_dump using the function you shared, and this is what the friend
> >>>> array
> >>>>> looks like from there:
> >>>>>
> >>>>> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
> >>>> [0]=>\n
> >>>>>   array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
> >>>>> array(1) {\n            [0]=>\n            string(1) "1"\n
> >> }\n
> >>>>>       [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
> >>>>> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
> >>>>> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
> >>>>>
> >>>>> I dont know if that assists in debugging.
> >>>>>
> >>>>>
> >>>>>
> >>>>> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>> wrote:
> >>>>>
> >>>>>> OK, you need to just delete that meta row and start over. It is
> messed
> >>>> up
> >>>>>> from before. Do that and see if it works.
> >>>>>>
> >>>>>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
> >>>> greglancaster71 at gmail.com>
> >>>>>> wrote:
> >>>>>>
> >>>>>>> I have it set to true:
> >>>>>>>
> >>>>>>> $active_user_friends = get_user_meta($active_user, 'friends',
> true);
> >>>>>>> But the issue is that it only shows the "friended" code for the
> last
> >>>>>> user I
> >>>>>>> added.  If I click add on one profile, and then to a second, the
> >> first
> >>>> no
> >>>>>>> longer shows friend added. Even if I have clearly added several to
> >> the
> >>>>>>> array:
> >>>>>>>
> >>>>>>>
> >>>>>>
> >>>>
> >>
> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>>
> >>>>>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co>
> >>>>>> wrote:
> >>>>>>>
> >>>>>>>> No, you don?t need to use unserialize, that is all done
> >> automatically
> >>>> by
> >>>>>>>> the WordPress functions.
> >>>>>>>>
> >>>>>>>> In the code you posted you still aren?t calling get_user_meta()
> with
> >>>> the
> >>>>>>>> third parameter set to true. You need to do that. Right now the
> >> array
> >>>>>> it is
> >>>>>>>> returning looks something like this:
> >>>>>>>>
> >>>>>>>> array(
> >>>>>>>>     0 => array( 3, 45, 6, 33 )
> >>>>>>>> )
> >>>>>>>>
> >>>>>>>> When you call in_array() it is checking if the user ID (say, 3 )
> is
> >> in
> >>>>>> the
> >>>>>>>> outer array. But it isn?t, the only thing in it is another array.
> >> When
> >>>>>> you
> >>>>>>>> call get_user_meta() with the third parameter set to true, the
> >>>> returned
> >>>>>>>> value won?t be wrapped in the outer array like that, so it will
> >> work.
> >>>>>>>>
> >>>>>>>>
> >>>>>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
> >>>>>> greglancaster71 at gmail.com>
> >>>>>>>> wrote:
> >>>>>>>>
> >>>>>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
> >>>> easier
> >>>>>>>>> option is to just create a separate table to store the friends
> list
> >>>> in.
> >>>>>>>>> Trying to work with user_meta this way seems like a bad idea.
> >>>>>>>>>
> >>>>>>>>> Quick question, should I be using unserialize to check the array
> >>>> values
> >>>>>>>>> using in_array?  Because right now this code isnt working.  Thats
> >> the
> >>>>>>>> only
> >>>>>>>>> thing that seems to be left out - but when I tried using
> >> $unserialize
> >>>>>>>> like
> >>>>>>>>> this:
> >>>>>>>>>
> >>>>>>>>> $unserialize = unserialize($active_user_friends);
> >>>>>>>>> if (in_array($author_id, $unserialize)) {
> >>>>>>>>>
> >>>>>>>>> it says this:
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> *Warning*: unserialize() expects parameter 1 to be string, array
> >>>> given
> >>>>>>>>> and
> >>>>>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean
> >> given
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> --------
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> add_action('wp_ajax_my_add_friend_action',
> 'my_add_friend_action');
> >>>>>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
> >>>>>>>> 'my_add_friend_action');
> >>>>>>>>> function my_add_friend_action() {
> >>>>>>>>> global $wpdb;
> >>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>> $userID = $_POST['userID'];
> >>>>>>>>>
> >>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>> $chkMetaValue = array();
> >>>>>>>>> $chkMetaValue[] = $profileID;
> >>>>>>>>>
> >>>>>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
> >>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>> $response = array( 'success' => true );
> >>>>>>>>> wp_send_json_success($response);
> >>>>>>>>>
> >>>>>>>>> die();
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> function friend_status($author_id) {
> >>>>>>>>> global $wpdb, $current_user;
> >>>>>>>>>  get_currentuserinfo();
> >>>>>>>>>
> >>>>>>>>> //authorID is the userID of the profile owner
> >>>>>>>>>
> >>>>>>>>> $active_user = $current_user->ID;
> >>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
> >>>>>>>>>
> >>>>>>>>> if (in_array($author_id, $active_user_friends, true)) {
> >>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
> >> Friend</button>";
> >>>>>>>>> } else {
> >>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>> return $friend_status;
> >>>>>>>>> }
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> That is basically the code I am using to insert the users id into
> >>>> their
> >>>>>>>>> user_meta table.
> >>>>>>>>>
> >>>>>>>>>
> >>>>>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <
> jdg at codesymphony.co>
> >>>>>>>> wrote:
> >>>>>>>>>
> >>>>>>>>>> There are two ways to use the *_meta functions. The way it looks
> >>>> like
> >>>>>>>> you
> >>>>>>>>>> are doing it is that each user has a single entry in the
> usermeta
> >>>>>> table,
> >>>>>>>>>> with the key ?friends?. The value for this meta key will be
> stored
> >>>> in
> >>>>>>>> the
> >>>>>>>>>> database as a serialized array, and when it is pulled out (by
> >>>>>>>>>> get_user_meta()) it gets unserialized into a PHP array.
> >>>>>>>>>>
> >>>>>>>>>> Alternative is this: Each user has multiple ?friend? meta key
> rows
> >>>> in
> >>>>>>>> the
> >>>>>>>>>> usermeta table, each one?s meta_value the ID of a single user
> that
> >>>> the
> >>>>>>>> user
> >>>>>>>>>> has friended.
> >>>>>>>>>>
> >>>>>>>>>> The benefit of the second option is that the values may be
> easier
> >> to
> >>>>>>>>>> search. Much easier. But that may not be important to you right
> >> now.
> >>>>>>>> (But
> >>>>>>>>>> then that could change later?) What if you want to show a list
> of
> >>>>>> users
> >>>>>>>> who
> >>>>>>>>>> have friended a user? You will be able to do that easily with
> >> this.
> >>>>>> With
> >>>>>>>>>> the first option, it is possible, but more complex and probably
> >>>> harder
> >>>>>>>> on
> >>>>>>>>>> the DB.
> >>>>>>>>>>
> >>>>>>>>>> The downside is that there are many more rows in usermeta table.
> >>>>>>>>>>
> >>>>>>>>>> So each of these functions let you target a single row (as in
> >> first
> >>>>>>>> case)
> >>>>>>>>>> or all rows with a key (as in the later case). Whichever way you
> >> go,
> >>>>>> you
> >>>>>>>>>> just need to be consistent through all of the code, obviously.
> >>>>>>>>>>
> >>>>>>>>>> -J.D.
> >>>>>>>>>>
> >>>>>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
> >>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>> wrote:
> >>>>>>>>>>
> >>>>>>>>>>> What would be the benefit of storing the friends in separate
> >> rows?
> >>>> I
> >>>>>>>> did
> >>>>>>>>>>> not know that was an option, but don't see any clear advantages
> >>>>>> either.
> >>>>>>>>>>> Also, I did just search the codex but dont see anything about
> >>>> unique
> >>>>>>>>>> rows.
> >>>>>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta. )
> >>>>>>>>>>>
> >>>>>>>>>>>
> >>>>>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <
> >> jdg at codesymphony.co
> >>>>>
> >>>>>>>>>> wrote:
> >>>>>>>>>>>
> >>>>>>>>>>>> Yes, when you call get_user_meta() you need to set the third
> >>>>>> parameter
> >>>>>>>>>>>> ($single) to true:
> >>>>>>>>>>>>
> >>>>>>>>>>>> $active_user_friends = get_user_meta( $active_user, ?friends?,
> >>>> true
> >>>>>> );
> >>>>>>>>>>>>
> >>>>>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
> >>>>>> alternatively
> >>>>>>>>>> you
> >>>>>>>>>>>> could leave the get_user_meta() call the way it is, and change
> >> it
> >>>> so
> >>>>>>>>>> that
> >>>>>>>>>>>> each friend is stored in a separate meta row (but with the
> same
> >>>> meta
> >>>>>>>>>> key -
> >>>>>>>>>>>> have a look at the *_user_meta functions on the codex).
> >>>>>>>>>>>>
> >>>>>>>>>>>> -J.D.
> >>>>>>>>>>>>
> >>>>>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
> >>>>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>>>> wrote:
> >>>>>>>>>>>>
> >>>>>>>>>>>>> I thought so.  One more question if you dont mind helping;
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> This is the function I wrote to determine what button to show
> >> on
> >>>>>> page
> >>>>>>>>>>>> load.
> >>>>>>>>>>>>> But regardless if someone has been friended or not, it shows
> >> the
> >>>>>> add
> >>>>>>>>>>>>> friend option.  Is something wrong with this?
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> function friend_status($author_id) {
> >>>>>>>>>>>>> global $wpdb, $current_user;
> >>>>>>>>>>>>> get_currentuserinfo();
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> //authorID is the userID of the profile owner
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> $active_user = $current_user->ID;
> >>>>>>>>>>>>> $active_user_friends = get_user_meta($active_user,
> 'friends');
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
> >>>>>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
> >>>>>> Friend</button>";
> >>>>>>>>>>>>> } else {
> >>>>>>>>>>>>> $friend_status = "<button id='add_friend'>Add
> Friend</button>";
> >>>>>>>>>>>>> }
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> return $friend_status;
> >>>>>>>>>>>>> }
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> Then on page:  echo $friend_status;
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>
> >>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
> >>>> jdg at codesymphony.co
> >>>>>>>
> >>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>> Yes, I would write a separate function for removal, and hook
> >> it
> >>>>>> to a
> >>>>>>>>>>>>>> different AJAX action for removal.
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
> >>>>>>>>>>>> greglancaster71 at gmail.com>
> >>>>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> That works easier :)  Once someone is friended I have it
> set
> >> so
> >>>>>> an
> >>>>>>>>>>>>>> unfriend
> >>>>>>>>>>>>>>> button replaces the add friend button via ajax.  Is it
> >>>> necessary
> >>>>>> to
> >>>>>>>>>>>> write
> >>>>>>>>>>>>>>> another function for deleting a person?  Not sure exactly
> how
> >>>> to
> >>>>>>>> make
> >>>>>>>>>>>> the
> >>>>>>>>>>>>>>> new button function since the data being sent is not
> attached
> >>>> to
> >>>>>>>> the
> >>>>>>>>>>>>>> button
> >>>>>>>>>>>>>>> in any way.  maybe I could add a value to the button that
> >> says
> >>>>>>>> remove
> >>>>>>>>>>>> or
> >>>>>>>>>>>>>>> add, which would be passed to the function and determine
> what
> >>>>>>>> action
> >>>>>>>>>> to
> >>>>>>>>>>>>>>> take?
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
> >>>>>> jdg at codesymphony.co
> >>>>>>>>>
> >>>>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> I would do this:
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
> >>>>>>>>>>>>>>>> $chkMetaValue = array();
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> -J.D.
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
> >>>>>>>>>> greglancaster71 at gmail.com
> >>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> wrote:
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> I am not sure exactly how this would work because I start
> >>>> with
> >>>>>> an
> >>>>>>>>>>>> empty
> >>>>>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if
> >> there
> >>>>>> is
> >>>>>>>>>> not
> >>>>>>>>>>>> at
> >>>>>>>>>>>>>>>>> least one value in the field, correct?
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> So maybe something like this:
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
> >>>>>>>>>>>>>>>>> if (!empty($chkMetaValue))
> >>>>>>>>>>>>>>>>>       {
> >>>>>>>>>>>>>>>>>       array_push($profileID);
> >>>>>>>>>>>>>>>>>       } else {
> >>>>>>>>>>>>>>>>>       $profileID;
> >>>>>>>>>>>>>>>>>       }
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> Is that right?
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>>> --
> >>>>>>>>>>>>>>>>> View this message in context:
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>
> >>>>>>>>>>
> >>>>>>>>
> >>>>>>
> >>>>
> >>
> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
> >>>>>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
> >>>>>>>> Nabble.com.
> >>>>>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>>>
> >>>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>>>
> >>>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>>> _______________________________________________
> >>>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>>>
> >>>>>>>>>>> _______________________________________________
> >>>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>>> _______________________________________________
> >>>>>>>>>> wp-hackers mailing list
> >>>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>>>
> >>>>>>>>> _______________________________________________
> >>>>>>>>> wp-hackers mailing list
> >>>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>>> _______________________________________________
> >>>>>>>> wp-hackers mailing list
> >>>>>>>> wp-hackers at lists.automattic.com
> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>>>
> >>>>>>> _______________________________________________
> >>>>>>> wp-hackers mailing list
> >>>>>>> wp-hackers at lists.automattic.com
> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> wp-hackers mailing list
> >>>>>> wp-hackers at lists.automattic.com
> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>>>
> >>>>> _______________________________________________
> >>>>> wp-hackers mailing list
> >>>>> wp-hackers at lists.automattic.com
> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>>> _______________________________________________
> >>>> wp-hackers mailing list
> >>>> wp-hackers at lists.automattic.com
> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>>>
> >>> _______________________________________________
> >>> wp-hackers mailing list
> >>> wp-hackers at lists.automattic.com
> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> >> _______________________________________________
> >> wp-hackers mailing list
> >> wp-hackers at lists.automattic.com
> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
> >>
> > _______________________________________________
> > wp-hackers mailing list
> > wp-hackers at lists.automattic.com
> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>
> _______________________________________________
> wp-hackers mailing list
> wp-hackers at lists.automattic.com
> http://lists.automattic.com/mailman/listinfo/wp-hackers
>

From greglancaster71 at gmail.com  Thu Oct 31 23:55:38 2013
From: greglancaster71 at gmail.com (Gregory Lancaster)
Date: Thu, 31 Oct 2013 16:55:38 -0700
Subject: [wp-hackers] array_push on update_user_meta
In-Reply-To: <CAPN-N+aJsNnyC7j3zVq2=_5SOPzE1rBcfxige3PkO_rGvXQ_MQ@mail.gmail.com>
References: <1383240754206-42688.post@n5.nabble.com>
 <800FEE2D-D9B5-4BE9-B2B6-8ED6C8659DD8@codesymphony.co>
 <CAPN-N+az8BnjnDk4RrmWt_7mBYwgAO58EvwN4NUATEvpuMxJ0g@mail.gmail.com>
 <F420E1AB-0ADE-4619-9EEB-690156B2A0E1@codesymphony.co>
 <CAPN-N+ZFtE+6RtHc1HjyquQ8BK1P9oe9Gggs38MgpvaRyr9o6A@mail.gmail.com>
 <5D4E1D4E-25DC-49F7-9701-F3A07130C4C3@codesymphony.co>
 <CAPN-N+bUSPKU1gmtCa9k9TW_BB1KucLEv4Op26A7HOO=jH03kA@mail.gmail.com>
 <952AC2FA-331B-4F81-BBEC-2600DB9784A3@codesymphony.co>
 <CAPN-N+aPt+7dsEUAGJU3qoNig7g3gj6rdgD-xNnav6yfx-6-xg@mail.gmail.com>
 <F2D1FB05-1477-43DC-848D-E43072D79056@codesymphony.co>
 <CAPN-N+axg6b-CAkK6LOeNxER0GSTq9H4wCZ1Q_QJ3RBoEqkH2A@mail.gmail.com>
 <5970A825-8707-4484-8108-D9BFF9FE78AF@codesymphony.co>
 <CAPN-N+ZDhQzwued2Hg46czxkXgcuYQzkDEx==6YWpyUgnY85xw@mail.gmail.com>
 <93396194-EDCE-4FA8-917A-1C7A42AAF43C@codesymphony.co>
 <CAPN-N+aJZUb8vYmXU14RPzvgQQMAGr+8EkQCCJbnCz9yz6AxPQ@mail.gmail.com>
 <5B084E63-3062-4563-AC0C-BF074B946474@codesymphony.co>
 <CAPN-N+Ztc1cxJ2q82++q98LNoNihw1SegzdJHO4gc8o_5k+P6Q@mail.gmail.com>
 <4C266435-C1C7-4A91-8B25-B3EA2C46AE00@codesymphony.co>
 <CAPN-N+aJsNnyC7j3zVq2=_5SOPzE1rBcfxige3PkO_rGvXQ_MQ@mail.gmail.com>
Message-ID: <CAPN-N+aTN71E1EwhxYO+aF7y9skSkEg4TmgR6F0=_ZKUkMQboQ@mail.gmail.com>

That was a stupid question - used delete_user_meta.  Thanks again


On Thu, Oct 31, 2013 at 3:23 PM, Gregory Lancaster <
greglancaster71 at gmail.com> wrote:

> Ah i see. The wordpress codex is inexpendable to me right now haha, I dont
> have all this stuff programmed into my brain yet.
>
> So for the unfollow option, I will be using unset right?  and there isnt
> any special magic or voodoo I should know about here?
>
> unset($reChkMetaValue[ $profileID ]);
> I have unset arrays before in class, but never a wordpress serialized
> array.  Same thing?
>
>
>
>
> On Thu, Oct 31, 2013 at 2:33 PM, J.D. Grimes <jdg at codesymphony.co> wrote:
>
>> Yes, that is what was happening with the arrays, because each time you
>> pulled the value out of the database, it was being wrapped in an array
>> (because get_user_meta() was pulling the values for all ?friends? keys for
>> the user). You added one user ID to it, and then put it back. That was
>> happening each time you followed a user. Now that it is working correctly,
>> the array will be only one layer deep. I remember coming up against this
>> thing with get_user_meta() myself once when I was first learning WP
>> development. :-)
>>
>> On Oct 31, 2013, at 5:28 PM, Gregory Lancaster <greglancaster71 at gmail.com>
>> wrote:
>>
>> > did I really spend a couple hours reading for a solution over the word
>> > true.  Thank you JD.  Real quick, you said:
>> >
>> > When you call in_array() it is checking if the user ID (say, 3 ) is in
>> the
>> > outer array. But it isn?t, the only thing in it is another array. When
>> you
>> > call get_user_meta() with the third parameter set to true, the returned
>> > value won?t be wrapped in the outer array like that, so it will work.
>> >
>> > Why are arrays stored so many tiers deep like that?  Is this a wordpress
>> > only thing, or is this normal?  It looks like everytime a persons ID is
>> > added, another instance of array(array(array( is added.  What is the
>> > reasoning behind this?  Or do I understand it incorrectly?
>> >
>> >
>> >
>> >
>> >
>> > On Thu, Oct 31, 2013 at 2:22 PM, J.D. Grimes <jdg at codesymphony.co>
>> wrote:
>> >
>> >> Ah.. We forgot to add true to the gat_user_meta() in
>> >> my_add_friend_action(). Add that and you should be good to go.
>> >>
>> >> On Oct 31, 2013, at 5:18 PM, Gregory Lancaster <
>> greglancaster71 at gmail.com>
>> >> wrote:
>> >>
>> >>> Sure;
>> >>>
>> >>> add_action('wp_ajax_my_add_friend_action', 'my_add_friend_action');
>> >>> add_action('wp_ajax_nopriv_my_add_friend_action',
>> >> 'my_add_friend_action');
>> >>> function my_add_friend_action() {
>> >>> global $wpdb;
>> >>> $profileID = $_POST['profileID'];
>> >>> $userID = $_POST['userID'];
>> >>>
>> >>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>> if ( ! is_array($chkMetaValue) )
>> >>> $chkMetaValue = array();
>> >>> $chkMetaValue[] = $profileID;
>> >>>
>> >>> // activity_tracker($current_user, 'added_friend', 'prof');
>> >>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>> $response = array( 'success' => true );
>> >>> wp_send_json_success($response);
>> >>> die();
>> >>> }
>> >>>
>> >>> function follow_status($author_id) {
>> >>> global $wpdb, $current_user;
>> >>> get_currentuserinfo();
>> >>>
>> >>> //authorID is the userID of the profile owner
>> >>>
>> >>> $active_user = $current_user->ID;
>> >>> $active_user_friends = get_user_meta($active_user, 'friends', true);
>> >>>
>> >>> if (in_array($author_id, $active_user_friends)) {
>> >>> $follow_status = "<button id='remove_friend'>Remove Friend</button>";
>> >>> } else {
>> >>> $follow_status = "<button id='add_friend'>Add Friend</button>";
>> >>> }
>> >>>
>> >>> return $follow_status;
>> >>> }
>> >>>
>> >>> and calling in the profile page with:
>> >>>
>> >>> echo follow_status($author_id);
>> >>>
>> >>>
>> >>>
>> >>> On Thu, Oct 31, 2013 at 2:16 PM, J.D. Grimes <jdg at codesymphony.co>
>> >> wrote:
>> >>>
>> >>>> Could you post your code again? Somewhere you are still getting the
>> >> value
>> >>>> wrapped in an extra array.
>> >>>>
>> >>>>
>> >>>> On Oct 31, 2013, at 5:08 PM, Gregory Lancaster <
>> >> greglancaster71 at gmail.com>
>> >>>> wrote:
>> >>>>
>> >>>>> No I must have screwed something up man, it only shows the last
>> value.
>> >> I
>> >>>>> searched for awhile before responding here, and I see some people
>> say
>> >>>>> in_array adds a line between items and sometimes other folks needed
>> to
>> >>>>> strip those.  But I have no idea if thats whats going on here.  It
>> all
>> >>>>> looks like it should function.  :-/  Maybe I need to get off the
>> >> computer
>> >>>>> for awhile.
>> >>>>>
>> >>>>> I var_dump using the function you shared, and this is what the
>> friend
>> >>>> array
>> >>>>> looks like from there:
>> >>>>>
>> >>>>> array(2) {\n  [0]=>\n  array(2) {\n    [0]=>\n    array(2) {\n
>> >>>> [0]=>\n
>> >>>>>   array(2) {\n        [0]=>\n        array(2) {\n          [0]=>\n
>> >>>>> array(1) {\n            [0]=>\n            string(1) "1"\n
>> >> }\n
>> >>>>>       [1]=>\n          string(1) "9"\n        }\n        [1]=>\n
>> >>>>> string(2) "13"\n      }\n      [1]=>\n      string(2) "16"\n    }\n
>> >>>>> [1]=>\n    string(2) "13"\n  }\n  [1]=>\n  string(1) "3"\n}\n
>> >>>>>
>> >>>>> I dont know if that assists in debugging.
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>> On Thu, Oct 31, 2013 at 1:52 PM, J.D. Grimes <jdg at codesymphony.co>
>> >>>> wrote:
>> >>>>>
>> >>>>>> OK, you need to just delete that meta row and start over. It is
>> messed
>> >>>> up
>> >>>>>> from before. Do that and see if it works.
>> >>>>>>
>> >>>>>> On Oct 31, 2013, at 4:49 PM, Gregory Lancaster <
>> >>>> greglancaster71 at gmail.com>
>> >>>>>> wrote:
>> >>>>>>
>> >>>>>>> I have it set to true:
>> >>>>>>>
>> >>>>>>> $active_user_friends = get_user_meta($active_user, 'friends',
>> true);
>> >>>>>>> But the issue is that it only shows the "friended" code for the
>> last
>> >>>>>> user I
>> >>>>>>> added.  If I click add on one profile, and then to a second, the
>> >> first
>> >>>> no
>> >>>>>>> longer shows friend added. Even if I have clearly added several to
>> >> the
>> >>>>>>> array:
>> >>>>>>>
>> >>>>>>>
>> >>>>>>
>> >>>>
>> >>
>> a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;a:2:{i:0;s:0:"";i:1;s:2:"16";}i:1;s:2:"12";}i:1;s:2:"13";}i:1;s:2:"12";}i:1;s:1:"3";}i:1;s:2:"13";}
>> >>>>>>>
>> >>>>>>>
>> >>>>>>>
>> >>>>>>>
>> >>>>>>> On Thu, Oct 31, 2013 at 1:40 PM, J.D. Grimes <jdg at codesymphony.co
>> >
>> >>>>>> wrote:
>> >>>>>>>
>> >>>>>>>> No, you don?t need to use unserialize, that is all done
>> >> automatically
>> >>>> by
>> >>>>>>>> the WordPress functions.
>> >>>>>>>>
>> >>>>>>>> In the code you posted you still aren?t calling get_user_meta()
>> with
>> >>>> the
>> >>>>>>>> third parameter set to true. You need to do that. Right now the
>> >> array
>> >>>>>> it is
>> >>>>>>>> returning looks something like this:
>> >>>>>>>>
>> >>>>>>>> array(
>> >>>>>>>>     0 => array( 3, 45, 6, 33 )
>> >>>>>>>> )
>> >>>>>>>>
>> >>>>>>>> When you call in_array() it is checking if the user ID (say, 3 )
>> is
>> >> in
>> >>>>>> the
>> >>>>>>>> outer array. But it isn?t, the only thing in it is another array.
>> >> When
>> >>>>>> you
>> >>>>>>>> call get_user_meta() with the third parameter set to true, the
>> >>>> returned
>> >>>>>>>> value won?t be wrapped in the outer array like that, so it will
>> >> work.
>> >>>>>>>>
>> >>>>>>>>
>> >>>>>>>> On Oct 31, 2013, at 4:30 PM, Gregory Lancaster <
>> >>>>>> greglancaster71 at gmail.com>
>> >>>>>>>> wrote:
>> >>>>>>>>
>> >>>>>>>>> Ah I see. Thank you for explaining JD.  It sounds like maybe the
>> >>>> easier
>> >>>>>>>>> option is to just create a separate table to store the friends
>> list
>> >>>> in.
>> >>>>>>>>> Trying to work with user_meta this way seems like a bad idea.
>> >>>>>>>>>
>> >>>>>>>>> Quick question, should I be using unserialize to check the array
>> >>>> values
>> >>>>>>>>> using in_array?  Because right now this code isnt working.
>>  Thats
>> >> the
>> >>>>>>>> only
>> >>>>>>>>> thing that seems to be left out - but when I tried using
>> >> $unserialize
>> >>>>>>>> like
>> >>>>>>>>> this:
>> >>>>>>>>>
>> >>>>>>>>> $unserialize = unserialize($active_user_friends);
>> >>>>>>>>> if (in_array($author_id, $unserialize)) {
>> >>>>>>>>>
>> >>>>>>>>> it says this:
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> *Warning*: unserialize() expects parameter 1 to be string, array
>> >>>> given
>> >>>>>>>>> and
>> >>>>>>>>> *Warning*: in_array() expects parameter 2 to be array, boolean
>> >> given
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> --------
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> add_action('wp_ajax_my_add_friend_action',
>> 'my_add_friend_action');
>> >>>>>>>>> add_action('wp_ajax_nopriv_my_add_friend_action',
>> >>>>>>>> 'my_add_friend_action');
>> >>>>>>>>> function my_add_friend_action() {
>> >>>>>>>>> global $wpdb;
>> >>>>>>>>> $profileID = $_POST['profileID'];
>> >>>>>>>>> $userID = $_POST['userID'];
>> >>>>>>>>>
>> >>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>>>>>> if ( ! is_array($chkMetaValue) )
>> >>>>>>>>> $chkMetaValue = array();
>> >>>>>>>>> $chkMetaValue[] = $profileID;
>> >>>>>>>>>
>> >>>>>>>>> // activity_tracker($current_user, 'added_friend', 'prof');
>> >>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>>>>>> $response = array( 'success' => true );
>> >>>>>>>>> wp_send_json_success($response);
>> >>>>>>>>>
>> >>>>>>>>> die();
>> >>>>>>>>> }
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> function friend_status($author_id) {
>> >>>>>>>>> global $wpdb, $current_user;
>> >>>>>>>>>  get_currentuserinfo();
>> >>>>>>>>>
>> >>>>>>>>> //authorID is the userID of the profile owner
>> >>>>>>>>>
>> >>>>>>>>> $active_user = $current_user->ID;
>> >>>>>>>>> $active_user_friends = get_user_meta($active_user, 'friends');
>> >>>>>>>>>
>> >>>>>>>>> if (in_array($author_id, $active_user_friends, true)) {
>> >>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>> >> Friend</button>";
>> >>>>>>>>> } else {
>> >>>>>>>>> $friend_status = "<button id='add_friend'>Add Friend</button>";
>> >>>>>>>>> }
>> >>>>>>>>>
>> >>>>>>>>> return $friend_status;
>> >>>>>>>>> }
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> That is basically the code I am using to insert the users id
>> into
>> >>>> their
>> >>>>>>>>> user_meta table.
>> >>>>>>>>>
>> >>>>>>>>>
>> >>>>>>>>> On Thu, Oct 31, 2013 at 1:08 PM, J.D. Grimes <
>> jdg at codesymphony.co>
>> >>>>>>>> wrote:
>> >>>>>>>>>
>> >>>>>>>>>> There are two ways to use the *_meta functions. The way it
>> looks
>> >>>> like
>> >>>>>>>> you
>> >>>>>>>>>> are doing it is that each user has a single entry in the
>> usermeta
>> >>>>>> table,
>> >>>>>>>>>> with the key ?friends?. The value for this meta key will be
>> stored
>> >>>> in
>> >>>>>>>> the
>> >>>>>>>>>> database as a serialized array, and when it is pulled out (by
>> >>>>>>>>>> get_user_meta()) it gets unserialized into a PHP array.
>> >>>>>>>>>>
>> >>>>>>>>>> Alternative is this: Each user has multiple ?friend? meta key
>> rows
>> >>>> in
>> >>>>>>>> the
>> >>>>>>>>>> usermeta table, each one?s meta_value the ID of a single user
>> that
>> >>>> the
>> >>>>>>>> user
>> >>>>>>>>>> has friended.
>> >>>>>>>>>>
>> >>>>>>>>>> The benefit of the second option is that the values may be
>> easier
>> >> to
>> >>>>>>>>>> search. Much easier. But that may not be important to you right
>> >> now.
>> >>>>>>>> (But
>> >>>>>>>>>> then that could change later?) What if you want to show a list
>> of
>> >>>>>> users
>> >>>>>>>> who
>> >>>>>>>>>> have friended a user? You will be able to do that easily with
>> >> this.
>> >>>>>> With
>> >>>>>>>>>> the first option, it is possible, but more complex and probably
>> >>>> harder
>> >>>>>>>> on
>> >>>>>>>>>> the DB.
>> >>>>>>>>>>
>> >>>>>>>>>> The downside is that there are many more rows in usermeta
>> table.
>> >>>>>>>>>>
>> >>>>>>>>>> So each of these functions let you target a single row (as in
>> >> first
>> >>>>>>>> case)
>> >>>>>>>>>> or all rows with a key (as in the later case). Whichever way
>> you
>> >> go,
>> >>>>>> you
>> >>>>>>>>>> just need to be consistent through all of the code, obviously.
>> >>>>>>>>>>
>> >>>>>>>>>> -J.D.
>> >>>>>>>>>>
>> >>>>>>>>>> On Oct 31, 2013, at 3:30 PM, Gregory Lancaster <
>> >>>>>>>> greglancaster71 at gmail.com>
>> >>>>>>>>>> wrote:
>> >>>>>>>>>>
>> >>>>>>>>>>> What would be the benefit of storing the friends in separate
>> >> rows?
>> >>>> I
>> >>>>>>>> did
>> >>>>>>>>>>> not know that was an option, but don't see any clear
>> advantages
>> >>>>>> either.
>> >>>>>>>>>>> Also, I did just search the codex but dont see anything about
>> >>>> unique
>> >>>>>>>>>> rows.
>> >>>>>>>>>>> (I checked get_user_meta, delete_user_meta, update_user_meta.
>> )
>> >>>>>>>>>>>
>> >>>>>>>>>>>
>> >>>>>>>>>>> On Thu, Oct 31, 2013 at 12:24 PM, J.D. Grimes <
>> >> jdg at codesymphony.co
>> >>>>>
>> >>>>>>>>>> wrote:
>> >>>>>>>>>>>
>> >>>>>>>>>>>> Yes, when you call get_user_meta() you need to set the third
>> >>>>>> parameter
>> >>>>>>>>>>>> ($single) to true:
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> $active_user_friends = get_user_meta( $active_user,
>> ?friends?,
>> >>>> true
>> >>>>>> );
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> Otherwise it will return a nested array. Also, just FYI,
>> >>>>>> alternatively
>> >>>>>>>>>> you
>> >>>>>>>>>>>> could leave the get_user_meta() call the way it is, and
>> change
>> >> it
>> >>>> so
>> >>>>>>>>>> that
>> >>>>>>>>>>>> each friend is stored in a separate meta row (but with the
>> same
>> >>>> meta
>> >>>>>>>>>> key -
>> >>>>>>>>>>>> have a look at the *_user_meta functions on the codex).
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> -J.D.
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> On Oct 31, 2013, at 3:14 PM, Gregory Lancaster <
>> >>>>>>>>>> greglancaster71 at gmail.com>
>> >>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>
>> >>>>>>>>>>>>> I thought so.  One more question if you dont mind helping;
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> This is the function I wrote to determine what button to
>> show
>> >> on
>> >>>>>> page
>> >>>>>>>>>>>> load.
>> >>>>>>>>>>>>> But regardless if someone has been friended or not, it shows
>> >> the
>> >>>>>> add
>> >>>>>>>>>>>>> friend option.  Is something wrong with this?
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> function friend_status($author_id) {
>> >>>>>>>>>>>>> global $wpdb, $current_user;
>> >>>>>>>>>>>>> get_currentuserinfo();
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> //authorID is the userID of the profile owner
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> $active_user = $current_user->ID;
>> >>>>>>>>>>>>> $active_user_friends = get_user_meta($active_user,
>> 'friends');
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> if (in_array($author_id, $active_user_friends)) {
>> >>>>>>>>>>>>> $friend_status = "<button id='remove_friend'>Remove
>> >>>>>> Friend</button>";
>> >>>>>>>>>>>>> } else {
>> >>>>>>>>>>>>> $friend_status = "<button id='add_friend'>Add
>> Friend</button>";
>> >>>>>>>>>>>>> }
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> return $friend_status;
>> >>>>>>>>>>>>> }
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> Then on page:  echo $friend_status;
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:53 AM, J.D. Grimes <
>> >>>> jdg at codesymphony.co
>> >>>>>>>
>> >>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>> Yes, I would write a separate function for removal, and
>> hook
>> >> it
>> >>>>>> to a
>> >>>>>>>>>>>>>> different AJAX action for removal.
>> >>>>>>>>>>>>>>
>> >>>>>>>>>>>>>> On Oct 31, 2013, at 2:48 PM, Gregory Lancaster <
>> >>>>>>>>>>>> greglancaster71 at gmail.com>
>> >>>>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>> That works easier :)  Once someone is friended I have it
>> set
>> >> so
>> >>>>>> an
>> >>>>>>>>>>>>>> unfriend
>> >>>>>>>>>>>>>>> button replaces the add friend button via ajax.  Is it
>> >>>> necessary
>> >>>>>> to
>> >>>>>>>>>>>> write
>> >>>>>>>>>>>>>>> another function for deleting a person?  Not sure exactly
>> how
>> >>>> to
>> >>>>>>>> make
>> >>>>>>>>>>>> the
>> >>>>>>>>>>>>>>> new button function since the data being sent is not
>> attached
>> >>>> to
>> >>>>>>>> the
>> >>>>>>>>>>>>>> button
>> >>>>>>>>>>>>>>> in any way.  maybe I could add a value to the button that
>> >> says
>> >>>>>>>> remove
>> >>>>>>>>>>>> or
>> >>>>>>>>>>>>>>> add, which would be passed to the function and determine
>> what
>> >>>>>>>> action
>> >>>>>>>>>> to
>> >>>>>>>>>>>>>>> take?
>> >>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>> On Thu, Oct 31, 2013 at 11:32 AM, J.D. Grimes <
>> >>>>>> jdg at codesymphony.co
>> >>>>>>>>>
>> >>>>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> I would do this:
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> if ( ! is_array($chkMetaValue) )
>> >>>>>>>>>>>>>>>> $chkMetaValue = array();
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> $chkMetaValue[] = $profileID; // or use array_push()
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> -J.D.
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> On Oct 31, 2013, at 1:32 PM, BenderisGreat <
>> >>>>>>>>>> greglancaster71 at gmail.com
>> >>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> wrote:
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> I am not sure exactly how this would work because I
>> start
>> >>>> with
>> >>>>>> an
>> >>>>>>>>>>>> empty
>> >>>>>>>>>>>>>>>>> meta_value field.  I dont think I can use array_push if
>> >> there
>> >>>>>> is
>> >>>>>>>>>> not
>> >>>>>>>>>>>> at
>> >>>>>>>>>>>>>>>>> least one value in the field, correct?
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> So maybe something like this:
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> $profileID = $_POST['profileID'];
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> $chkMetaValue = get_user_meta($userID,"friends");
>> >>>>>>>>>>>>>>>>> if (!empty($chkMetaValue))
>> >>>>>>>>>>>>>>>>>       {
>> >>>>>>>>>>>>>>>>>       array_push($profileID);
>> >>>>>>>>>>>>>>>>>       } else {
>> >>>>>>>>>>>>>>>>>       $profileID;
>> >>>>>>>>>>>>>>>>>       }
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> update_user_meta( $userID, 'friends', $chkMetaValue );
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> Is that right?
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>>> --
>> >>>>>>>>>>>>>>>>> View this message in context:
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>
>> >>>>>>>>>>>>
>> >>>>>>>>>>
>> >>>>>>>>
>> >>>>>>
>> >>>>
>> >>
>> http://wordpress-hackers.1065353.n5.nabble.com/array-push-on-update-user-meta-tp42688.html
>> >>>>>>>>>>>>>>>>> Sent from the Wordpress Hackers mailing list archive at
>> >>>>>>>> Nabble.com.
>> >>>>>>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>>>>>
>> >>>>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>>>
>> >>>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>>>
>> >>>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>
>> >>>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>>>
>> >>>>>>>>>>> _______________________________________________
>> >>>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>
>> >>>>>>>>>> _______________________________________________
>> >>>>>>>>>> wp-hackers mailing list
>> >>>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>>>
>> >>>>>>>>> _______________________________________________
>> >>>>>>>>> wp-hackers mailing list
>> >>>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>
>> >>>>>>>> _______________________________________________
>> >>>>>>>> wp-hackers mailing list
>> >>>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>>>
>> >>>>>>> _______________________________________________
>> >>>>>>> wp-hackers mailing list
>> >>>>>>> wp-hackers at lists.automattic.com
>> >>>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>
>> >>>>>> _______________________________________________
>> >>>>>> wp-hackers mailing list
>> >>>>>> wp-hackers at lists.automattic.com
>> >>>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>>>
>> >>>>> _______________________________________________
>> >>>>> wp-hackers mailing list
>> >>>>> wp-hackers at lists.automattic.com
>> >>>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>
>> >>>> _______________________________________________
>> >>>> wp-hackers mailing list
>> >>>> wp-hackers at lists.automattic.com
>> >>>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>>>
>> >>> _______________________________________________
>> >>> wp-hackers mailing list
>> >>> wp-hackers at lists.automattic.com
>> >>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> >> _______________________________________________
>> >> wp-hackers mailing list
>> >> wp-hackers at lists.automattic.com
>> >> http://lists.automattic.com/mailman/listinfo/wp-hackers
>> >>
>> > _______________________________________________
>> > wp-hackers mailing list
>> > wp-hackers at lists.automattic.com
>> > http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>> _______________________________________________
>> wp-hackers mailing list
>> wp-hackers at lists.automattic.com
>> http://lists.automattic.com/mailman/listinfo/wp-hackers
>>
>
>

